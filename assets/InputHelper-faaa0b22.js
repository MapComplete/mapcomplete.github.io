var yx=Object.defineProperty;var bx=(n,e,t)=>e in n?yx(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ft=(n,e,t)=>(bx(n,typeof e!="symbol"?e+"":e,t),t),vx=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var ip=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)};var $h=(n,e,t)=>(vx(n,e,"access private method"),t);import{a as ki,U as Gn,S as dd,I as fd,b as xx}from"./UIEventSource-f39c8b5a.js";import{L as wx}from"./LocalStorageSource-0ef3f4e1.js";import{Q as kx,a as yr,S as zd,B as Hu,t as tc,C as dm,c as ul,T as fa,b as Sx,e as Mx,L as fm}from"./tw-merge-60e45232.js";import{n as z2,g as R2,e as _s,o as Dx,A as vg,r as Tx,B as Cx,W as Lu,a4 as np,G as F2,b as Px,S as Ax,a5 as Np}from"./Searchbar-c849c14f.js";import{S as Zi,i as Gi,s as $i,e as mt,a as Jt,b as he,f as ve,d as at,n as ci,h as nt,a2 as sc,V as $r,R as Fs,y as Ra,k as Wi,l as et,p as va,q as xt,z as Fa,A as Oa,B as Ba,r as ar,t as Fe,g as He,u as rr,v as Vn,w as nr,x as ei,o as Ke,C as $n,D as Qi,E as en,a7 as ic,c as jt,m as Ut,a8 as Rd,j as Wt,N as Kr,O as Sn,Q as br,M as Vp,ab as Ix,I as pd,ae as O2,H as Fd,_ as Ex,J as xg,a4 as wg,K as Od,Z as Fo,T as B2,U as N2,F as ya,G as Vo,$ as Bd,Y as Oo,ad as Lx,a0 as zx,a1 as Rx,W as Is,a5 as V2}from"./index-34c7dc31.js";import{t as Fx}from"./tw-join-70ce42f3.js";import{a as Ox,L as H2}from"./Loading-aa985c94.js";import{t as io,F as pm,E as Bx}from"./Checkbox-a6af77f2.js";import{C as Nx}from"./Constants-269ad162.js";import{D as Vx}from"./Dropdown-6d9b489e.js";var j2={exports:{}},ap={exports:{}},kg;function Hx(){return kg||(kg=1,function(n,e){(function(){var t=Math.PI,i=Math.sin,s=Math.cos,c=Math.tan,u=Math.asin,o=Math.atan2,p=Math.acos,_=t/180,v=1e3*60*60*24,M=2440588,S=2451545;function I(_t){return _t.valueOf()/v-.5+M}function R(_t){return new Date((_t+.5-M)*v)}function G(_t){return I(_t)-S}var Y=_*23.4397;function X(_t,Dt){return o(i(_t)*s(Y)-c(Dt)*i(Y),s(_t))}function oe(_t,Dt){return u(i(Dt)*s(Y)+s(Dt)*i(Y)*i(_t))}function Q(_t,Dt,Ft){return o(i(_t),s(_t)*i(Dt)-c(Ft)*s(Dt))}function ce(_t,Dt,Ft){return u(i(Dt)*i(Ft)+s(Dt)*s(Ft)*s(_t))}function De(_t,Dt){return _*(280.16+360.9856235*_t)-Dt}function Oe(_t){return _t<0&&(_t=0),2967e-7/Math.tan(_t+.00312536/(_t+.08901179))}function Pe(_t){return _*(357.5291+.98560028*_t)}function Se(_t){var Dt=_*(1.9148*i(_t)+.02*i(2*_t)+3e-4*i(3*_t)),Ft=_*102.9372;return _t+Dt+Ft+t}function _e(_t){var Dt=Pe(_t),Ft=Se(Dt);return{dec:oe(Ft,0),ra:X(Ft,0)}}var ze={};ze.getPosition=function(_t,Dt,Ft){var oi=_*-Ft,pi=_*Dt,vi=G(_t),Ti=_e(vi),ht=De(vi,oi)-Ti.ra;return{azimuth:Q(ht,pi,Ti.dec),altitude:ce(ht,pi,Ti.dec)}};var Re=ze.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];ze.addTime=function(_t,Dt,Ft){Re.push([_t,Dt,Ft])};var Ye=9e-4;function Xe(_t,Dt){return Math.round(_t-Ye-Dt/(2*t))}function si(_t,Dt,Ft){return Ye+(_t+Dt)/(2*t)+Ft}function Bt(_t,Dt,Ft){return S+_t+.0053*i(Dt)-.0069*i(2*Ft)}function bi(_t,Dt,Ft){return p((i(_t)-i(Dt)*i(Ft))/(s(Dt)*s(Ft)))}function Et(_t){return-2.076*Math.sqrt(_t)/60}function Vt(_t,Dt,Ft,oi,pi,vi,Ti){var ht=bi(_t,Ft,oi),mi=si(ht,Dt,pi);return Bt(mi,vi,Ti)}ze.getTimes=function(_t,Dt,Ft,oi){oi=oi||0;var pi=_*-Ft,vi=_*Dt,Ti=Et(oi),ht=G(_t),mi=Xe(ht,pi),Pi=si(0,pi,mi),Ni=Pe(Pi),Oi=Se(Ni),mn=oe(Oi,0),vn=Bt(Pi,Ni,Oi),Yi,Kn,je,Ci,Dn,xi,tn={solarNoon:R(vn),nadir:R(vn-.5)};for(Yi=0,Kn=Re.length;Yi<Kn;Yi+=1)je=Re[Yi],Ci=(je[0]+Ti)*_,Dn=Vt(Ci,pi,vi,mn,mi,Ni,Oi),xi=vn-(Dn-vn),tn[je[1]]=R(xi),tn[je[2]]=R(Dn);return tn};function Ki(_t){var Dt=_*(218.316+13.176396*_t),Ft=_*(134.963+13.064993*_t),oi=_*(93.272+13.22935*_t),pi=Dt+_*6.289*i(Ft),vi=_*5.128*i(oi),Ti=385001-20905*s(Ft);return{ra:X(pi,vi),dec:oe(pi,vi),dist:Ti}}ze.getMoonPosition=function(_t,Dt,Ft){var oi=_*-Ft,pi=_*Dt,vi=G(_t),Ti=Ki(vi),ht=De(vi,oi)-Ti.ra,mi=ce(ht,pi,Ti.dec),Pi=o(i(ht),c(pi)*s(Ti.dec)-i(Ti.dec)*s(ht));return mi=mi+Oe(mi),{azimuth:Q(ht,pi,Ti.dec),altitude:mi,distance:Ti.dist,parallacticAngle:Pi}},ze.getMoonIllumination=function(_t){var Dt=G(_t||new Date),Ft=_e(Dt),oi=Ki(Dt),pi=149598e3,vi=p(i(Ft.dec)*i(oi.dec)+s(Ft.dec)*s(oi.dec)*s(Ft.ra-oi.ra)),Ti=o(pi*i(vi),oi.dist-pi*s(vi)),ht=o(s(Ft.dec)*i(Ft.ra-oi.ra),i(Ft.dec)*s(oi.dec)-s(Ft.dec)*i(oi.dec)*s(Ft.ra-oi.ra));return{fraction:(1+s(Ti))/2,phase:.5+.5*Ti*(ht<0?-1:1)/Math.PI,angle:ht}};function zt(_t,Dt){return new Date(_t.valueOf()+Dt*v/24)}ze.getMoonTimes=function(_t,Dt,Ft,oi){var pi=new Date(_t);oi?pi.setUTCHours(0,0,0,0):pi.setHours(0,0,0,0);for(var vi=.133*_,Ti=ze.getMoonPosition(pi,Dt,Ft).altitude-vi,ht,mi,Pi,Ni,Oi,mn,vn,Yi,Kn,je,Ci,Dn,xi,tn=1;tn<=24&&(ht=ze.getMoonPosition(zt(pi,tn),Dt,Ft).altitude-vi,mi=ze.getMoonPosition(zt(pi,tn+1),Dt,Ft).altitude-vi,Oi=(Ti+mi)/2-ht,mn=(mi-Ti)/2,vn=-mn/(2*Oi),Yi=(Oi*vn+mn)*vn+ht,Kn=mn*mn-4*Oi*ht,je=0,Kn>=0&&(xi=Math.sqrt(Kn)/(Math.abs(Oi)*2),Ci=vn-xi,Dn=vn+xi,Math.abs(Ci)<=1&&je++,Math.abs(Dn)<=1&&je++,Ci<-1&&(Ci=Dn)),je===1?Ti<0?Pi=tn+Ci:Ni=tn+Ci:je===2&&(Pi=tn+(Yi<0?Dn:Ci),Ni=tn+(Yi<0?Ci:Dn)),!(Pi&&Ni));tn+=2)Ti=mi;var xn={};return Pi&&(xn.rise=zt(pi,Pi)),Ni&&(xn.set=zt(pi,Ni)),!Pi&&!Ni&&(xn[Yi>0?"alwaysUp":"alwaysDown"]=!0),xn},n.exports=ze})()}(ap)),ap.exports}var rp={exports:{}},Sg;function Nd(){return Sg||(Sg=1,function(n){function e(t){"@babel/helpers - typeof";return n.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},n.exports.__esModule=!0,n.exports.default=n.exports,e(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports}(rp)),rp.exports}var sp={exports:{}},Mg;function jx(){return Mg||(Mg=1,function(n){function e(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports}(sp)),sp.exports}var op={exports:{}},lp={exports:{}},cp={exports:{}},Dg;function Ux(){return Dg||(Dg=1,function(n){var e=Nd().default;function t(i,s){if(e(i)!="object"||!i)return i;var c=i[Symbol.toPrimitive];if(c!==void 0){var u=c.call(i,s||"default");if(e(u)!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(i)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports}(cp)),cp.exports}var Tg;function U2(){return Tg||(Tg=1,function(n){var e=Nd().default,t=Ux();function i(s){var c=t(s,"string");return e(c)=="symbol"?c:c+""}n.exports=i,n.exports.__esModule=!0,n.exports.default=n.exports}(lp)),lp.exports}var Cg;function Wx(){return Cg||(Cg=1,function(n){var e=U2();function t(s,c){for(var u=0;u<c.length;u++){var o=c[u];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,e(o.key),o)}}function i(s,c,u){return c&&t(s.prototype,c),u&&t(s,u),Object.defineProperty(s,"prototype",{writable:!1}),s}n.exports=i,n.exports.__esModule=!0,n.exports.default=n.exports}(op)),op.exports}var up={exports:{}},Pg;function W2(){return Pg||(Pg=1,function(n){function e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports}(up)),up.exports}var hp={exports:{}},dp={exports:{}},Ag;function qx(){return Ag||(Ag=1,function(n){function e(t,i){return n.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,c){return s.__proto__=c,s},n.exports.__esModule=!0,n.exports.default=n.exports,e(t,i)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports}(dp)),dp.exports}var Ig;function Zx(){return Ig||(Ig=1,function(n){var e=qx();function t(i,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(s&&s.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),s&&e(i,s)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports}(hp)),hp.exports}var fp={exports:{}},Eg;function Gx(){return Eg||(Eg=1,function(n){var e=Nd().default,t=W2();function i(s,c){if(c&&(e(c)=="object"||typeof c=="function"))return c;if(c!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t(s)}n.exports=i,n.exports.__esModule=!0,n.exports.default=n.exports}(fp)),fp.exports}var pp={exports:{}},Lg;function $x(){return Lg||(Lg=1,function(n){function e(t){return n.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},n.exports.__esModule=!0,n.exports.default=n.exports,e(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports}(pp)),pp.exports}var mp={exports:{}},zg;function Kx(){return zg||(zg=1,function(n){var e=U2();function t(i,s,c){return(s=e(s))in i?Object.defineProperty(i,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):i[s]=c,i}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports}(mp)),mp.exports}var gp={exports:{}},_p={exports:{}},Rg;function Yx(){return Rg||(Rg=1,function(n){function e(t){if(Array.isArray(t))return t}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports}(_p)),_p.exports}var yp={exports:{}},Fg;function Jx(){return Fg||(Fg=1,function(n){function e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports}(yp)),yp.exports}var bp={exports:{}},vp={exports:{}},Og;function Xx(){return Og||(Og=1,function(n){function e(t,i){(i==null||i>t.length)&&(i=t.length);for(var s=0,c=Array(i);s<i;s++)c[s]=t[s];return c}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports}(vp)),vp.exports}var Bg;function Qx(){return Bg||(Bg=1,function(n){var e=Xx();function t(i,s){if(i){if(typeof i=="string")return e(i,s);var c={}.toString.call(i).slice(8,-1);return c==="Object"&&i.constructor&&(c=i.constructor.name),c==="Map"||c==="Set"?Array.from(i):c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?e(i,s):void 0}}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports}(bp)),bp.exports}var xp={exports:{}},Ng;function ew(){return Ng||(Ng=1,function(n){function e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports}(xp)),xp.exports}var Vg;function tw(){return Vg||(Vg=1,function(n){var e=Yx(),t=Jx(),i=Qx(),s=ew();function c(u){return e(u)||t(u)||i(u)||s()}n.exports=c,n.exports.__esModule=!0,n.exports.default=n.exports}(gp)),gp.exports}var wp,Hg;function iw(){if(Hg)return wp;Hg=1;var n=Nd(),e=jx(),t=Wx(),i=W2(),s=Zx(),c=Gx(),u=$x(),o=Kx(),p=tw();function _($){return $&&typeof $=="object"&&"default"in $?$:{default:$}}var v=_(n),M=_(e),S=_(t),I=_(i),R=_(s),G=_(c),Y=_(u),X=_(o),oe=_(p);function Q($,O){var V=Object.keys($);if(Object.getOwnPropertySymbols){var q=Object.getOwnPropertySymbols($);O&&(q=q.filter(function(L){return Object.getOwnPropertyDescriptor($,L).enumerable})),V.push.apply(V,q)}return V}function ce($){for(var O=1;O<arguments.length;O++){var V=arguments[O]!=null?arguments[O]:{};O%2?Q(Object(V),!0).forEach(function(q){X.default($,q,V[q])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(V)):Q(Object(V)).forEach(function(q){Object.defineProperty($,q,Object.getOwnPropertyDescriptor(V,q))})}return $}var De={type:"logger",log:function(O){this.output("log",O)},warn:function(O){this.output("warn",O)},error:function(O){this.output("error",O)},output:function(O,V){console&&console[O]&&console[O].apply(console,V)}},Oe=function(){function $(O){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};M.default(this,$),this.init(O,V)}return S.default($,[{key:"init",value:function(V){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=q.prefix||"i18next:",this.logger=V||De,this.options=q,this.debug=q.debug}},{key:"setDebug",value:function(V){this.debug=V}},{key:"log",value:function(){for(var V=arguments.length,q=new Array(V),L=0;L<V;L++)q[L]=arguments[L];return this.forward(q,"log","",!0)}},{key:"warn",value:function(){for(var V=arguments.length,q=new Array(V),L=0;L<V;L++)q[L]=arguments[L];return this.forward(q,"warn","",!0)}},{key:"error",value:function(){for(var V=arguments.length,q=new Array(V),L=0;L<V;L++)q[L]=arguments[L];return this.forward(q,"error","")}},{key:"deprecate",value:function(){for(var V=arguments.length,q=new Array(V),L=0;L<V;L++)q[L]=arguments[L];return this.forward(q,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(V,q,L,W){return W&&!this.debug?null:(typeof V[0]=="string"&&(V[0]="".concat(L).concat(this.prefix," ").concat(V[0])),this.logger[q](V))}},{key:"create",value:function(V){return new $(this.logger,ce(ce({},{prefix:"".concat(this.prefix,":").concat(V,":")}),this.options))}},{key:"clone",value:function(V){return V=V||this.options,V.prefix=V.prefix||this.prefix,new $(this.logger,V)}}]),$}(),Pe=new Oe,Se=function(){function $(){M.default(this,$),this.observers={}}return S.default($,[{key:"on",value:function(V,q){var L=this;return V.split(" ").forEach(function(W){L.observers[W]=L.observers[W]||[],L.observers[W].push(q)}),this}},{key:"off",value:function(V,q){if(this.observers[V]){if(!q){delete this.observers[V];return}this.observers[V]=this.observers[V].filter(function(L){return L!==q})}}},{key:"emit",value:function(V){for(var q=arguments.length,L=new Array(q>1?q-1:0),W=1;W<q;W++)L[W-1]=arguments[W];if(this.observers[V]){var ae=[].concat(this.observers[V]);ae.forEach(function(Ie){Ie.apply(void 0,L)})}if(this.observers["*"]){var Me=[].concat(this.observers["*"]);Me.forEach(function(Ie){Ie.apply(Ie,[V].concat(L))})}}}]),$}();function _e(){var $,O,V=new Promise(function(q,L){$=q,O=L});return V.resolve=$,V.reject=O,V}function ze($){return $==null?"":""+$}function Re($,O,V){$.forEach(function(q){O[q]&&(V[q]=O[q])})}function Ye($,O,V){function q(Me){return Me&&Me.indexOf("###")>-1?Me.replace(/###/g,"."):Me}function L(){return!$||typeof $=="string"}for(var W=typeof O!="string"?[].concat(O):O.split(".");W.length>1;){if(L())return{};var ae=q(W.shift());!$[ae]&&V&&($[ae]=new V),Object.prototype.hasOwnProperty.call($,ae)?$=$[ae]:$={}}return L()?{}:{obj:$,k:q(W.shift())}}function Xe($,O,V){var q=Ye($,O,Object),L=q.obj,W=q.k;L[W]=V}function si($,O,V,q){var L=Ye($,O,Object),W=L.obj,ae=L.k;W[ae]=W[ae]||[],q&&(W[ae]=W[ae].concat(V)),q||W[ae].push(V)}function Bt($,O){var V=Ye($,O),q=V.obj,L=V.k;if(q)return q[L]}function bi($,O,V){var q=Bt($,V);return q!==void 0?q:Bt(O,V)}function Et($,O,V){for(var q in O)q!=="__proto__"&&q!=="constructor"&&(q in $?typeof $[q]=="string"||$[q]instanceof String||typeof O[q]=="string"||O[q]instanceof String?V&&($[q]=O[q]):Et($[q],O[q],V):$[q]=O[q]);return $}function Vt($){return $.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var Ki={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function zt($){return typeof $=="string"?$.replace(/[&<>"'\/]/g,function(O){return Ki[O]}):$}var _t=typeof window<"u"&&window.navigator&&typeof window.navigator.userAgentData>"u"&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,Dt=[" ",",","?","!",";"];function Ft($,O,V){O=O||"",V=V||"";var q=Dt.filter(function(Me){return O.indexOf(Me)<0&&V.indexOf(Me)<0});if(q.length===0)return!0;var L=new RegExp("(".concat(q.map(function(Me){return Me==="?"?"\\?":Me}).join("|"),")")),W=!L.test($);if(!W){var ae=$.indexOf(V);ae>0&&!L.test($.substring(0,ae))&&(W=!0)}return W}function oi($,O){var V=Object.keys($);if(Object.getOwnPropertySymbols){var q=Object.getOwnPropertySymbols($);O&&(q=q.filter(function(L){return Object.getOwnPropertyDescriptor($,L).enumerable})),V.push.apply(V,q)}return V}function pi($){for(var O=1;O<arguments.length;O++){var V=arguments[O]!=null?arguments[O]:{};O%2?oi(Object(V),!0).forEach(function(q){X.default($,q,V[q])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(V)):oi(Object(V)).forEach(function(q){Object.defineProperty($,q,Object.getOwnPropertyDescriptor(V,q))})}return $}function vi($){var O=Ti();return function(){var q=Y.default($),L;if(O){var W=Y.default(this).constructor;L=Reflect.construct(q,arguments,W)}else L=q.apply(this,arguments);return G.default(this,L)}}function Ti(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ht($,O){var V=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if($){if($[O])return $[O];for(var q=O.split(V),L=$,W=0;W<q.length;++W){if(!L||typeof L[q[W]]=="string"&&W+1<q.length)return;if(L[q[W]]===void 0){for(var ae=2,Me=q.slice(W,W+ae).join(V),Ie=L[Me];Ie===void 0&&q.length>W+ae;)ae++,Me=q.slice(W,W+ae).join(V),Ie=L[Me];if(Ie===void 0)return;if(Ie===null)return null;if(O.endsWith(Me)){if(typeof Ie=="string")return Ie;if(Me&&typeof Ie[Me]=="string")return Ie[Me]}var Qe=q.slice(W+ae).join(V);return Qe?ht(Ie,Qe,V):void 0}L=L[q[W]]}return L}}var mi=function($){R.default(V,$);var O=vi(V);function V(q){var L,W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};return M.default(this,V),L=O.call(this),_t&&Se.call(I.default(L)),L.data=q||{},L.options=W,L.options.keySeparator===void 0&&(L.options.keySeparator="."),L.options.ignoreJSONStructure===void 0&&(L.options.ignoreJSONStructure=!0),L}return S.default(V,[{key:"addNamespaces",value:function(L){this.options.ns.indexOf(L)<0&&this.options.ns.push(L)}},{key:"removeNamespaces",value:function(L){var W=this.options.ns.indexOf(L);W>-1&&this.options.ns.splice(W,1)}},{key:"getResource",value:function(L,W,ae){var Me=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},Ie=Me.keySeparator!==void 0?Me.keySeparator:this.options.keySeparator,Qe=Me.ignoreJSONStructure!==void 0?Me.ignoreJSONStructure:this.options.ignoreJSONStructure,Ge=[L,W];ae&&typeof ae!="string"&&(Ge=Ge.concat(ae)),ae&&typeof ae=="string"&&(Ge=Ge.concat(Ie?ae.split(Ie):ae)),L.indexOf(".")>-1&&(Ge=L.split("."));var $e=Bt(this.data,Ge);return $e||!Qe||typeof ae!="string"?$e:ht(this.data&&this.data[L]&&this.data[L][W],ae,Ie)}},{key:"addResource",value:function(L,W,ae,Me){var Ie=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1},Qe=this.options.keySeparator;Qe===void 0&&(Qe=".");var Ge=[L,W];ae&&(Ge=Ge.concat(Qe?ae.split(Qe):ae)),L.indexOf(".")>-1&&(Ge=L.split("."),Me=W,W=Ge[1]),this.addNamespaces(W),Xe(this.data,Ge,Me),Ie.silent||this.emit("added",L,W,ae,Me)}},{key:"addResources",value:function(L,W,ae){var Me=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(var Ie in ae)(typeof ae[Ie]=="string"||Object.prototype.toString.apply(ae[Ie])==="[object Array]")&&this.addResource(L,W,Ie,ae[Ie],{silent:!0});Me.silent||this.emit("added",L,W,ae)}},{key:"addResourceBundle",value:function(L,W,ae,Me,Ie){var Qe=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1},Ge=[L,W];L.indexOf(".")>-1&&(Ge=L.split("."),Me=ae,ae=W,W=Ge[1]),this.addNamespaces(W);var $e=Bt(this.data,Ge)||{};Me?Et($e,ae,Ie):$e=pi(pi({},$e),ae),Xe(this.data,Ge,$e),Qe.silent||this.emit("added",L,W,ae)}},{key:"removeResourceBundle",value:function(L,W){this.hasResourceBundle(L,W)&&delete this.data[L][W],this.removeNamespaces(W),this.emit("removed",L,W)}},{key:"hasResourceBundle",value:function(L,W){return this.getResource(L,W)!==void 0}},{key:"getResourceBundle",value:function(L,W){return W||(W=this.options.defaultNS),this.options.compatibilityAPI==="v1"?pi(pi({},{}),this.getResource(L,W)):this.getResource(L,W)}},{key:"getDataByLanguage",value:function(L){return this.data[L]}},{key:"hasLanguageSomeTranslations",value:function(L){var W=this.getDataByLanguage(L),ae=W&&Object.keys(W)||[];return!!ae.find(function(Me){return W[Me]&&Object.keys(W[Me]).length>0})}},{key:"toJSON",value:function(){return this.data}}]),V}(Se),Pi={processors:{},addPostProcessor:function(O){this.processors[O.name]=O},handle:function(O,V,q,L,W){var ae=this;return O.forEach(function(Me){ae.processors[Me]&&(V=ae.processors[Me].process(V,q,L,W))}),V}};function Ni($,O){var V=Object.keys($);if(Object.getOwnPropertySymbols){var q=Object.getOwnPropertySymbols($);O&&(q=q.filter(function(L){return Object.getOwnPropertyDescriptor($,L).enumerable})),V.push.apply(V,q)}return V}function Oi($){for(var O=1;O<arguments.length;O++){var V=arguments[O]!=null?arguments[O]:{};O%2?Ni(Object(V),!0).forEach(function(q){X.default($,q,V[q])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(V)):Ni(Object(V)).forEach(function(q){Object.defineProperty($,q,Object.getOwnPropertyDescriptor(V,q))})}return $}function mn($){var O=vn();return function(){var q=Y.default($),L;if(O){var W=Y.default(this).constructor;L=Reflect.construct(q,arguments,W)}else L=q.apply(this,arguments);return G.default(this,L)}}function vn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Yi={},Kn=function($){R.default(V,$);var O=mn(V);function V(q){var L,W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return M.default(this,V),L=O.call(this),_t&&Se.call(I.default(L)),Re(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],q,I.default(L)),L.options=W,L.options.keySeparator===void 0&&(L.options.keySeparator="."),L.logger=Pe.create("translator"),L}return S.default(V,[{key:"changeLanguage",value:function(L){L&&(this.language=L)}},{key:"exists",value:function(L){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(L==null)return!1;var ae=this.resolve(L,W);return ae&&ae.res!==void 0}},{key:"extractFromKey",value:function(L,W){var ae=W.nsSeparator!==void 0?W.nsSeparator:this.options.nsSeparator;ae===void 0&&(ae=":");var Me=W.keySeparator!==void 0?W.keySeparator:this.options.keySeparator,Ie=W.ns||this.options.defaultNS||[],Qe=ae&&L.indexOf(ae)>-1,Ge=!this.options.userDefinedKeySeparator&&!W.keySeparator&&!this.options.userDefinedNsSeparator&&!W.nsSeparator&&!Ft(L,ae,Me);if(Qe&&!Ge){var $e=L.match(this.interpolator.nestingRegexp);if($e&&$e.length>0)return{key:L,namespaces:Ie};var Te=L.split(ae);(ae!==Me||ae===Me&&this.options.ns.indexOf(Te[0])>-1)&&(Ie=Te.shift()),L=Te.join(Me)}return typeof Ie=="string"&&(Ie=[Ie]),{key:L,namespaces:Ie}}},{key:"translate",value:function(L,W,ae){var Me=this;if(v.default(W)!=="object"&&this.options.overloadTranslationOptionHandler&&(W=this.options.overloadTranslationOptionHandler(arguments)),W||(W={}),L==null)return"";Array.isArray(L)||(L=[String(L)]);var Ie=W.returnDetails!==void 0?W.returnDetails:this.options.returnDetails,Qe=W.keySeparator!==void 0?W.keySeparator:this.options.keySeparator,Ge=this.extractFromKey(L[L.length-1],W),$e=Ge.key,Te=Ge.namespaces,gt=Te[Te.length-1],wt=W.lng||this.language,St=W.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(wt&&wt.toLowerCase()==="cimode"){if(St){var $t=W.nsSeparator||this.options.nsSeparator;return Ie?(Tt.res="".concat(gt).concat($t).concat($e),Tt):"".concat(gt).concat($t).concat($e)}return Ie?(Tt.res=$e,Tt):$e}var Tt=this.resolve(L,W),Ct=Tt&&Tt.res,Si=Tt&&Tt.usedKey||$e,Ai=Tt&&Tt.exactUsedKey||$e,Wn=Object.prototype.toString.apply(Ct),Aa=["[object Number]","[object Function]","[object RegExp]"],Fi=W.joinArrays!==void 0?W.joinArrays:this.options.joinArrays,ia=!this.i18nFormat||this.i18nFormat.handleAsObject,Wa=typeof Ct!="string"&&typeof Ct!="boolean"&&typeof Ct!="number";if(ia&&Ct&&Wa&&Aa.indexOf(Wn)<0&&!(typeof Fi=="string"&&Wn==="[object Array]")){if(!W.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");var In=this.options.returnedObjectHandler?this.options.returnedObjectHandler(Si,Ct,Oi(Oi({},W),{},{ns:Te})):"key '".concat($e," (").concat(this.language,")' returned an object instead of string.");return Ie?(Tt.res=In,Tt):In}if(Qe){var ma=Wn==="[object Array]",Na=ma?[]:{},la=ma?Ai:Si;for(var na in Ct)if(Object.prototype.hasOwnProperty.call(Ct,na)){var Yr="".concat(la).concat(Qe).concat(na);Na[na]=this.translate(Yr,Oi(Oi({},W),{joinArrays:!1,ns:Te})),Na[na]===Yr&&(Na[na]=Ct[na])}Ct=Na}}else if(ia&&typeof Fi=="string"&&Wn==="[object Array]")Ct=Ct.join(Fi),Ct&&(Ct=this.extendTranslation(Ct,L,W,ae));else{var Va=!1,Tn=!1,Jr=W.count!==void 0&&typeof W.count!="string",xr=V.hasDefaultValue(W),Rn=Jr?this.pluralResolver.getSuffix(wt,W.count,W):"",xa=W["defaultValue".concat(Rn)]||W.defaultValue;!this.isValidLookup(Ct)&&xr&&(Va=!0,Ct=xa),this.isValidLookup(Ct)||(Tn=!0,Ct=$e);var Ia=W.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey,ls=Ia&&Tn?void 0:Ct,wa=xr&&xa!==Ct&&this.options.updateMissing;if(Tn||Va||wa){if(this.logger.log(wa?"updateKey":"missingKey",wt,gt,$e,wa?xa:Ct),Qe){var xs=this.resolve($e,Oi(Oi({},W),{},{keySeparator:!1}));xs&&xs.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var z=[],N=this.languageUtils.getFallbackCodes(this.options.fallbackLng,W.lng||this.language);if(this.options.saveMissingTo==="fallback"&&N&&N[0])for(var be=0;be<N.length;be++)z.push(N[be]);else this.options.saveMissingTo==="all"?z=this.languageUtils.toResolveHierarchy(W.lng||this.language):z.push(W.lng||this.language);var we=function(Ue,xe,st){var bt=xr&&st!==Ct?st:ls;Me.options.missingKeyHandler?Me.options.missingKeyHandler(Ue,gt,xe,bt,wa,W):Me.backendConnector&&Me.backendConnector.saveMissing&&Me.backendConnector.saveMissing(Ue,gt,xe,bt,wa,W),Me.emit("missingKey",Ue,gt,xe,Ct)};this.options.saveMissing&&(this.options.saveMissingPlurals&&Jr?z.forEach(function(de){Me.pluralResolver.getSuffixes(de,W).forEach(function(Ue){we([de],$e+Ue,W["defaultValue".concat(Ue)]||xa)})}):we(z,$e,xa))}Ct=this.extendTranslation(Ct,L,W,Tt,ae),Tn&&Ct===$e&&this.options.appendNamespaceToMissingKey&&(Ct="".concat(gt,":").concat($e)),(Tn||Va)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?Ct=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?"".concat(gt,":").concat($e):$e,Va?Ct:void 0):Ct=this.options.parseMissingKeyHandler(Ct))}return Ie?(Tt.res=Ct,Tt):Ct}},{key:"extendTranslation",value:function(L,W,ae,Me,Ie){var Qe=this;if(this.i18nFormat&&this.i18nFormat.parse)L=this.i18nFormat.parse(L,Oi(Oi({},this.options.interpolation.defaultVariables),ae),Me.usedLng,Me.usedNS,Me.usedKey,{resolved:Me});else if(!ae.skipInterpolation){ae.interpolation&&this.interpolator.init(Oi(Oi({},ae),{interpolation:Oi(Oi({},this.options.interpolation),ae.interpolation)}));var Ge=typeof L=="string"&&(ae&&ae.interpolation&&ae.interpolation.skipOnVariables!==void 0?ae.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables),$e;if(Ge){var Te=L.match(this.interpolator.nestingRegexp);$e=Te&&Te.length}var gt=ae.replace&&typeof ae.replace!="string"?ae.replace:ae;if(this.options.interpolation.defaultVariables&&(gt=Oi(Oi({},this.options.interpolation.defaultVariables),gt)),L=this.interpolator.interpolate(L,gt,ae.lng||this.language,ae),Ge){var wt=L.match(this.interpolator.nestingRegexp),St=wt&&wt.length;$e<St&&(ae.nest=!1)}ae.nest!==!1&&(L=this.interpolator.nest(L,function(){for(var Ct=arguments.length,Si=new Array(Ct),Ai=0;Ai<Ct;Ai++)Si[Ai]=arguments[Ai];return Ie&&Ie[0]===Si[0]&&!ae.context?(Qe.logger.warn("It seems you are nesting recursively key: ".concat(Si[0]," in key: ").concat(W[0])),null):Qe.translate.apply(Qe,Si.concat([W]))},ae)),ae.interpolation&&this.interpolator.reset()}var $t=ae.postProcess||this.options.postProcess,Tt=typeof $t=="string"?[$t]:$t;return L!=null&&Tt&&Tt.length&&ae.applyPostProcessor!==!1&&(L=Pi.handle(Tt,L,W,this.options&&this.options.postProcessPassResolved?Oi({i18nResolved:Me},ae):ae,this)),L}},{key:"resolve",value:function(L){var W=this,ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Me,Ie,Qe,Ge,$e;return typeof L=="string"&&(L=[L]),L.forEach(function(Te){if(!W.isValidLookup(Me)){var gt=W.extractFromKey(Te,ae),wt=gt.key;Ie=wt;var St=gt.namespaces;W.options.fallbackNS&&(St=St.concat(W.options.fallbackNS));var $t=ae.count!==void 0&&typeof ae.count!="string",Tt=$t&&!ae.ordinal&&ae.count===0&&W.pluralResolver.shouldUseIntlApi(),Ct=ae.context!==void 0&&(typeof ae.context=="string"||typeof ae.context=="number")&&ae.context!=="",Si=ae.lngs?ae.lngs:W.languageUtils.toResolveHierarchy(ae.lng||W.language,ae.fallbackLng);St.forEach(function(Ai){W.isValidLookup(Me)||($e=Ai,!Yi["".concat(Si[0],"-").concat(Ai)]&&W.utils&&W.utils.hasLoadedNamespace&&!W.utils.hasLoadedNamespace($e)&&(Yi["".concat(Si[0],"-").concat(Ai)]=!0,W.logger.warn('key "'.concat(Ie,'" for languages "').concat(Si.join(", "),`" won't get resolved as namespace "`).concat($e,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),Si.forEach(function(Wn){if(!W.isValidLookup(Me)){Ge=Wn;var Aa=[wt];if(W.i18nFormat&&W.i18nFormat.addLookupKeys)W.i18nFormat.addLookupKeys(Aa,wt,Wn,Ai,ae);else{var Fi;$t&&(Fi=W.pluralResolver.getSuffix(Wn,ae.count,ae));var ia="".concat(W.options.pluralSeparator,"zero");if($t&&(Aa.push(wt+Fi),Tt&&Aa.push(wt+ia)),Ct){var Wa="".concat(wt).concat(W.options.contextSeparator).concat(ae.context);Aa.push(Wa),$t&&(Aa.push(Wa+Fi),Tt&&Aa.push(Wa+ia))}}for(var In;In=Aa.pop();)W.isValidLookup(Me)||(Qe=In,Me=W.getResource(Wn,Ai,In,ae))}}))})}}),{res:Me,usedKey:Ie,exactUsedKey:Qe,usedLng:Ge,usedNS:$e}}},{key:"isValidLookup",value:function(L){return L!==void 0&&!(!this.options.returnNull&&L===null)&&!(!this.options.returnEmptyString&&L==="")}},{key:"getResource",value:function(L,W,ae){var Me=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(L,W,ae,Me):this.resourceStore.getResource(L,W,ae,Me)}}],[{key:"hasDefaultValue",value:function(L){var W="defaultValue";for(var ae in L)if(Object.prototype.hasOwnProperty.call(L,ae)&&W===ae.substring(0,W.length)&&L[ae]!==void 0)return!0;return!1}}]),V}(Se);function je($){return $.charAt(0).toUpperCase()+$.slice(1)}var Ci=function(){function $(O){M.default(this,$),this.options=O,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Pe.create("languageUtils")}return S.default($,[{key:"getScriptPartFromCode",value:function(V){if(!V||V.indexOf("-")<0)return null;var q=V.split("-");return q.length===2||(q.pop(),q[q.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(q.join("-"))}},{key:"getLanguagePartFromCode",value:function(V){if(!V||V.indexOf("-")<0)return V;var q=V.split("-");return this.formatLanguageCode(q[0])}},{key:"formatLanguageCode",value:function(V){if(typeof V=="string"&&V.indexOf("-")>-1){var q=["hans","hant","latn","cyrl","cans","mong","arab"],L=V.split("-");return this.options.lowerCaseLng?L=L.map(function(W){return W.toLowerCase()}):L.length===2?(L[0]=L[0].toLowerCase(),L[1]=L[1].toUpperCase(),q.indexOf(L[1].toLowerCase())>-1&&(L[1]=je(L[1].toLowerCase()))):L.length===3&&(L[0]=L[0].toLowerCase(),L[1].length===2&&(L[1]=L[1].toUpperCase()),L[0]!=="sgn"&&L[2].length===2&&(L[2]=L[2].toUpperCase()),q.indexOf(L[1].toLowerCase())>-1&&(L[1]=je(L[1].toLowerCase())),q.indexOf(L[2].toLowerCase())>-1&&(L[2]=je(L[2].toLowerCase()))),L.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?V.toLowerCase():V}},{key:"isSupportedCode",value:function(V){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(V=this.getLanguagePartFromCode(V)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(V)>-1}},{key:"getBestMatchFromCodes",value:function(V){var q=this;if(!V)return null;var L;return V.forEach(function(W){if(!L){var ae=q.formatLanguageCode(W);(!q.options.supportedLngs||q.isSupportedCode(ae))&&(L=ae)}}),!L&&this.options.supportedLngs&&V.forEach(function(W){if(!L){var ae=q.getLanguagePartFromCode(W);if(q.isSupportedCode(ae))return L=ae;L=q.options.supportedLngs.find(function(Me){if(Me.indexOf(ae)===0)return Me})}}),L||(L=this.getFallbackCodes(this.options.fallbackLng)[0]),L}},{key:"getFallbackCodes",value:function(V,q){if(!V)return[];if(typeof V=="function"&&(V=V(q)),typeof V=="string"&&(V=[V]),Object.prototype.toString.apply(V)==="[object Array]")return V;if(!q)return V.default||[];var L=V[q];return L||(L=V[this.getScriptPartFromCode(q)]),L||(L=V[this.formatLanguageCode(q)]),L||(L=V[this.getLanguagePartFromCode(q)]),L||(L=V.default),L||[]}},{key:"toResolveHierarchy",value:function(V,q){var L=this,W=this.getFallbackCodes(q||this.options.fallbackLng||[],V),ae=[],Me=function(Qe){Qe&&(L.isSupportedCode(Qe)?ae.push(Qe):L.logger.warn("rejecting language code not found in supportedLngs: ".concat(Qe)))};return typeof V=="string"&&V.indexOf("-")>-1?(this.options.load!=="languageOnly"&&Me(this.formatLanguageCode(V)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&Me(this.getScriptPartFromCode(V)),this.options.load!=="currentOnly"&&Me(this.getLanguagePartFromCode(V))):typeof V=="string"&&Me(this.formatLanguageCode(V)),W.forEach(function(Ie){ae.indexOf(Ie)<0&&Me(L.formatLanguageCode(Ie))}),ae}}]),$}(),Dn=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],xi={1:function(O){return+(O>1)},2:function(O){return+(O!=1)},3:function(O){return 0},4:function(O){return O%10==1&&O%100!=11?0:O%10>=2&&O%10<=4&&(O%100<10||O%100>=20)?1:2},5:function(O){return O==0?0:O==1?1:O==2?2:O%100>=3&&O%100<=10?3:O%100>=11?4:5},6:function(O){return O==1?0:O>=2&&O<=4?1:2},7:function(O){return O==1?0:O%10>=2&&O%10<=4&&(O%100<10||O%100>=20)?1:2},8:function(O){return O==1?0:O==2?1:O!=8&&O!=11?2:3},9:function(O){return+(O>=2)},10:function(O){return O==1?0:O==2?1:O<7?2:O<11?3:4},11:function(O){return O==1||O==11?0:O==2||O==12?1:O>2&&O<20?2:3},12:function(O){return+(O%10!=1||O%100==11)},13:function(O){return+(O!==0)},14:function(O){return O==1?0:O==2?1:O==3?2:3},15:function(O){return O%10==1&&O%100!=11?0:O%10>=2&&(O%100<10||O%100>=20)?1:2},16:function(O){return O%10==1&&O%100!=11?0:O!==0?1:2},17:function(O){return O==1||O%10==1&&O%100!=11?0:1},18:function(O){return O==0?0:O==1?1:2},19:function(O){return O==1?0:O==0||O%100>1&&O%100<11?1:O%100>10&&O%100<20?2:3},20:function(O){return O==1?0:O==0||O%100>0&&O%100<20?1:2},21:function(O){return O%100==1?1:O%100==2?2:O%100==3||O%100==4?3:0},22:function(O){return O==1?0:O==2?1:(O<0||O>10)&&O%10==0?2:3}},tn=["v1","v2","v3"],xn={zero:0,one:1,two:2,few:3,many:4,other:5};function tt(){var $={};return Dn.forEach(function(O){O.lngs.forEach(function(V){$[V]={numbers:O.nr,plurals:xi[O.fc]}})}),$}var bn=function(){function $(O){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};M.default(this,$),this.languageUtils=O,this.options=V,this.logger=Pe.create("pluralResolver"),(!this.options.compatibilityJSON||this.options.compatibilityJSON==="v4")&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=tt()}return S.default($,[{key:"addRule",value:function(V,q){this.rules[V]=q}},{key:"getRule",value:function(V){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(V,{type:q.ordinal?"ordinal":"cardinal"})}catch{return}return this.rules[V]||this.rules[this.languageUtils.getLanguagePartFromCode(V)]}},{key:"needsPlural",value:function(V){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},L=this.getRule(V,q);return this.shouldUseIntlApi()?L&&L.resolvedOptions().pluralCategories.length>1:L&&L.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(V,q){var L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(V,L).map(function(W){return"".concat(q).concat(W)})}},{key:"getSuffixes",value:function(V){var q=this,L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},W=this.getRule(V,L);return W?this.shouldUseIntlApi()?W.resolvedOptions().pluralCategories.sort(function(ae,Me){return xn[ae]-xn[Me]}).map(function(ae){return"".concat(q.options.prepend).concat(ae)}):W.numbers.map(function(ae){return q.getSuffix(V,ae,L)}):[]}},{key:"getSuffix",value:function(V,q){var L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},W=this.getRule(V,L);return W?this.shouldUseIntlApi()?"".concat(this.options.prepend).concat(W.select(q)):this.getSuffixRetroCompatible(W,q):(this.logger.warn("no plural rule found for: ".concat(V)),"")}},{key:"getSuffixRetroCompatible",value:function(V,q){var L=this,W=V.noAbs?V.plurals(q):V.plurals(Math.abs(q)),ae=V.numbers[W];this.options.simplifyPluralSuffix&&V.numbers.length===2&&V.numbers[0]===1&&(ae===2?ae="plural":ae===1&&(ae=""));var Me=function(){return L.options.prepend&&ae.toString()?L.options.prepend+ae.toString():ae.toString()};return this.options.compatibilityJSON==="v1"?ae===1?"":typeof ae=="number"?"_plural_".concat(ae.toString()):Me():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&V.numbers.length===2&&V.numbers[0]===1?Me():this.options.prepend&&W.toString()?this.options.prepend+W.toString():W.toString()}},{key:"shouldUseIntlApi",value:function(){return!tn.includes(this.options.compatibilityJSON)}}]),$}();function _n($,O){var V=Object.keys($);if(Object.getOwnPropertySymbols){var q=Object.getOwnPropertySymbols($);O&&(q=q.filter(function(L){return Object.getOwnPropertyDescriptor($,L).enumerable})),V.push.apply(V,q)}return V}function cn($){for(var O=1;O<arguments.length;O++){var V=arguments[O]!=null?arguments[O]:{};O%2?_n(Object(V),!0).forEach(function(q){X.default($,q,V[q])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(V)):_n(Object(V)).forEach(function(q){Object.defineProperty($,q,Object.getOwnPropertyDescriptor(V,q))})}return $}var ta=function(){function $(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};M.default(this,$),this.logger=Pe.create("interpolator"),this.options=O,this.format=O.interpolation&&O.interpolation.format||function(V){return V},this.init(O)}return S.default($,[{key:"init",value:function(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};V.interpolation||(V.interpolation={escapeValue:!0});var q=V.interpolation;this.escape=q.escape!==void 0?q.escape:zt,this.escapeValue=q.escapeValue!==void 0?q.escapeValue:!0,this.useRawValueToEscape=q.useRawValueToEscape!==void 0?q.useRawValueToEscape:!1,this.prefix=q.prefix?Vt(q.prefix):q.prefixEscaped||"{{",this.suffix=q.suffix?Vt(q.suffix):q.suffixEscaped||"}}",this.formatSeparator=q.formatSeparator?q.formatSeparator:q.formatSeparator||",",this.unescapePrefix=q.unescapeSuffix?"":q.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":q.unescapeSuffix||"",this.nestingPrefix=q.nestingPrefix?Vt(q.nestingPrefix):q.nestingPrefixEscaped||Vt("$t("),this.nestingSuffix=q.nestingSuffix?Vt(q.nestingSuffix):q.nestingSuffixEscaped||Vt(")"),this.nestingOptionsSeparator=q.nestingOptionsSeparator?q.nestingOptionsSeparator:q.nestingOptionsSeparator||",",this.maxReplaces=q.maxReplaces?q.maxReplaces:1e3,this.alwaysFormat=q.alwaysFormat!==void 0?q.alwaysFormat:!1,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var V="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(V,"g");var q="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(q,"g");var L="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(L,"g")}},{key:"interpolate",value:function(V,q,L,W){var ae=this,Me,Ie,Qe,Ge=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function $e($t){return $t.replace(/\$/g,"$$$$")}var Te=function(Tt){if(Tt.indexOf(ae.formatSeparator)<0){var Ct=bi(q,Ge,Tt);return ae.alwaysFormat?ae.format(Ct,void 0,L,cn(cn(cn({},W),q),{},{interpolationkey:Tt})):Ct}var Si=Tt.split(ae.formatSeparator),Ai=Si.shift().trim(),Wn=Si.join(ae.formatSeparator).trim();return ae.format(bi(q,Ge,Ai),Wn,L,cn(cn(cn({},W),q),{},{interpolationkey:Ai}))};this.resetRegExp();var gt=W&&W.missingInterpolationHandler||this.options.missingInterpolationHandler,wt=W&&W.interpolation&&W.interpolation.skipOnVariables!==void 0?W.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables,St=[{regex:this.regexpUnescape,safeValue:function(Tt){return $e(Tt)}},{regex:this.regexp,safeValue:function(Tt){return ae.escapeValue?$e(ae.escape(Tt)):$e(Tt)}}];return St.forEach(function($t){for(Qe=0;Me=$t.regex.exec(V);){var Tt=Me[1].trim();if(Ie=Te(Tt),Ie===void 0)if(typeof gt=="function"){var Ct=gt(V,Me,W);Ie=typeof Ct=="string"?Ct:""}else if(W&&W.hasOwnProperty(Tt))Ie="";else if(wt){Ie=Me[0];continue}else ae.logger.warn("missed to pass in variable ".concat(Tt," for interpolating ").concat(V)),Ie="";else typeof Ie!="string"&&!ae.useRawValueToEscape&&(Ie=ze(Ie));var Si=$t.safeValue(Ie);if(V=V.replace(Me[0],Si),wt?($t.regex.lastIndex+=Ie.length,$t.regex.lastIndex-=Me[0].length):$t.regex.lastIndex=0,Qe++,Qe>=ae.maxReplaces)break}}),V}},{key:"nest",value:function(V,q){var L=this,W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},ae,Me,Ie=cn({},W);Ie.applyPostProcessor=!1,delete Ie.defaultValue;function Qe(gt,wt){var St=this.nestingOptionsSeparator;if(gt.indexOf(St)<0)return gt;var $t=gt.split(new RegExp("".concat(St,"[ ]*{"))),Tt="{".concat($t[1]);gt=$t[0],Tt=this.interpolate(Tt,Ie);var Ct=Tt.match(/'/g),Si=Tt.match(/"/g);(Ct&&Ct.length%2===0&&!Si||Si.length%2!==0)&&(Tt=Tt.replace(/'/g,'"'));try{Ie=JSON.parse(Tt),wt&&(Ie=cn(cn({},wt),Ie))}catch(Ai){return this.logger.warn("failed parsing options string in nesting for key ".concat(gt),Ai),"".concat(gt).concat(St).concat(Tt)}return delete Ie.defaultValue,gt}for(;ae=this.nestingRegexp.exec(V);){var Ge=[],$e=!1;if(ae[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(ae[1])){var Te=ae[1].split(this.formatSeparator).map(function(gt){return gt.trim()});ae[1]=Te.shift(),Ge=Te,$e=!0}if(Me=q(Qe.call(this,ae[1].trim(),Ie),Ie),Me&&ae[0]===V&&typeof Me!="string")return Me;typeof Me!="string"&&(Me=ze(Me)),Me||(this.logger.warn("missed to resolve ".concat(ae[1]," for nesting ").concat(V)),Me=""),$e&&(Me=Ge.reduce(function(gt,wt){return L.format(gt,wt,W.lng,cn(cn({},W),{},{interpolationkey:ae[1].trim()}))},Me.trim())),V=V.replace(ae[0],Me),this.regexp.lastIndex=0}return V}}]),$}();function pa($,O){var V=Object.keys($);if(Object.getOwnPropertySymbols){var q=Object.getOwnPropertySymbols($);O&&(q=q.filter(function(L){return Object.getOwnPropertyDescriptor($,L).enumerable})),V.push.apply(V,q)}return V}function rt($){for(var O=1;O<arguments.length;O++){var V=arguments[O]!=null?arguments[O]:{};O%2?pa(Object(V),!0).forEach(function(q){X.default($,q,V[q])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(V)):pa(Object(V)).forEach(function(q){Object.defineProperty($,q,Object.getOwnPropertyDescriptor(V,q))})}return $}function jn($){var O=$.toLowerCase().trim(),V={};if($.indexOf("(")>-1){var q=$.split("(");O=q[0].toLowerCase().trim();var L=q[1].substring(0,q[1].length-1);if(O==="currency"&&L.indexOf(":")<0)V.currency||(V.currency=L.trim());else if(O==="relativetime"&&L.indexOf(":")<0)V.range||(V.range=L.trim());else{var W=L.split(";");W.forEach(function(ae){if(ae){var Me=ae.split(":"),Ie=oe.default(Me),Qe=Ie[0],Ge=Ie.slice(1),$e=Ge.join(":").trim().replace(/^'+|'+$/g,"");V[Qe.trim()]||(V[Qe.trim()]=$e),$e==="false"&&(V[Qe.trim()]=!1),$e==="true"&&(V[Qe.trim()]=!0),isNaN($e)||(V[Qe.trim()]=parseInt($e,10))}})}}return{formatName:O,formatOptions:V}}function hn($){var O={};return function(q,L,W){var ae=L+JSON.stringify(W),Me=O[ae];return Me||(Me=$(L,W),O[ae]=Me),Me(q)}}var Un=function(){function $(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};M.default(this,$),this.logger=Pe.create("formatter"),this.options=O,this.formats={number:hn(function(V,q){var L=new Intl.NumberFormat(V,q);return function(W){return L.format(W)}}),currency:hn(function(V,q){var L=new Intl.NumberFormat(V,rt(rt({},q),{},{style:"currency"}));return function(W){return L.format(W)}}),datetime:hn(function(V,q){var L=new Intl.DateTimeFormat(V,rt({},q));return function(W){return L.format(W)}}),relativetime:hn(function(V,q){var L=new Intl.RelativeTimeFormat(V,rt({},q));return function(W){return L.format(W,q.range||"day")}}),list:hn(function(V,q){var L=new Intl.ListFormat(V,rt({},q));return function(W){return L.format(W)}})},this.init(O)}return S.default($,[{key:"init",value:function(V){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}},L=q.interpolation;this.formatSeparator=L.formatSeparator?L.formatSeparator:L.formatSeparator||","}},{key:"add",value:function(V,q){this.formats[V.toLowerCase().trim()]=q}},{key:"addCached",value:function(V,q){this.formats[V.toLowerCase().trim()]=hn(q)}},{key:"format",value:function(V,q,L,W){var ae=this,Me=q.split(this.formatSeparator),Ie=Me.reduce(function(Qe,Ge){var $e=jn(Ge),Te=$e.formatName,gt=$e.formatOptions;if(ae.formats[Te]){var wt=Qe;try{var St=W&&W.formatParams&&W.formatParams[W.interpolationkey]||{},$t=St.locale||St.lng||W.locale||W.lng||L;wt=ae.formats[Te](Qe,$t,rt(rt(rt({},gt),W),St))}catch(Tt){ae.logger.warn(Tt)}return wt}else ae.logger.warn("there was no format function for ".concat(Te));return Qe},V);return Ie}}]),$}();function Ii($,O){var V=Object.keys($);if(Object.getOwnPropertySymbols){var q=Object.getOwnPropertySymbols($);O&&(q=q.filter(function(L){return Object.getOwnPropertyDescriptor($,L).enumerable})),V.push.apply(V,q)}return V}function lt($){for(var O=1;O<arguments.length;O++){var V=arguments[O]!=null?arguments[O]:{};O%2?Ii(Object(V),!0).forEach(function(q){X.default($,q,V[q])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(V)):Ii(Object(V)).forEach(function(q){Object.defineProperty($,q,Object.getOwnPropertyDescriptor(V,q))})}return $}function gi($){var O=_i();return function(){var q=Y.default($),L;if(O){var W=Y.default(this).constructor;L=Reflect.construct(q,arguments,W)}else L=q.apply(this,arguments);return G.default(this,L)}}function _i(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function on($,O){$.pending[O]!==void 0&&(delete $.pending[O],$.pendingCount--)}var wn=function($){R.default(V,$);var O=gi(V);function V(q,L,W){var ae,Me=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return M.default(this,V),ae=O.call(this),_t&&Se.call(I.default(ae)),ae.backend=q,ae.store=L,ae.services=W,ae.languageUtils=W.languageUtils,ae.options=Me,ae.logger=Pe.create("backendConnector"),ae.waitingReads=[],ae.maxParallelReads=Me.maxParallelReads||10,ae.readingCalls=0,ae.maxRetries=Me.maxRetries>=0?Me.maxRetries:5,ae.retryTimeout=Me.retryTimeout>=1?Me.retryTimeout:350,ae.state={},ae.queue=[],ae.backend&&ae.backend.init&&ae.backend.init(W,Me.backend,Me),ae}return S.default(V,[{key:"queueLoad",value:function(L,W,ae,Me){var Ie=this,Qe={},Ge={},$e={},Te={};return L.forEach(function(gt){var wt=!0;W.forEach(function(St){var $t="".concat(gt,"|").concat(St);!ae.reload&&Ie.store.hasResourceBundle(gt,St)?Ie.state[$t]=2:Ie.state[$t]<0||(Ie.state[$t]===1?Ge[$t]===void 0&&(Ge[$t]=!0):(Ie.state[$t]=1,wt=!1,Ge[$t]===void 0&&(Ge[$t]=!0),Qe[$t]===void 0&&(Qe[$t]=!0),Te[St]===void 0&&(Te[St]=!0)))}),wt||($e[gt]=!0)}),(Object.keys(Qe).length||Object.keys(Ge).length)&&this.queue.push({pending:Ge,pendingCount:Object.keys(Ge).length,loaded:{},errors:[],callback:Me}),{toLoad:Object.keys(Qe),pending:Object.keys(Ge),toLoadLanguages:Object.keys($e),toLoadNamespaces:Object.keys(Te)}}},{key:"loaded",value:function(L,W,ae){var Me=L.split("|"),Ie=Me[0],Qe=Me[1];W&&this.emit("failedLoading",Ie,Qe,W),ae&&this.store.addResourceBundle(Ie,Qe,ae),this.state[L]=W?-1:2;var Ge={};this.queue.forEach(function($e){si($e.loaded,[Ie],Qe),on($e,L),W&&$e.errors.push(W),$e.pendingCount===0&&!$e.done&&(Object.keys($e.loaded).forEach(function(Te){Ge[Te]||(Ge[Te]={});var gt=$e.loaded[Te];gt.length&&gt.forEach(function(wt){Ge[Te][wt]===void 0&&(Ge[Te][wt]=!0)})}),$e.done=!0,$e.errors.length?$e.callback($e.errors):$e.callback())}),this.emit("loaded",Ge),this.queue=this.queue.filter(function($e){return!$e.done})}},{key:"read",value:function(L,W,ae){var Me=this,Ie=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,Qe=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,Ge=arguments.length>5?arguments[5]:void 0;if(!L.length)return Ge(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:L,ns:W,fcName:ae,tried:Ie,wait:Qe,callback:Ge});return}return this.readingCalls++,this.backend[ae](L,W,function($e,Te){if(Me.readingCalls--,Me.waitingReads.length>0){var gt=Me.waitingReads.shift();Me.read(gt.lng,gt.ns,gt.fcName,gt.tried,gt.wait,gt.callback)}if($e&&Te&&Ie<Me.maxRetries){setTimeout(function(){Me.read.call(Me,L,W,ae,Ie+1,Qe*2,Ge)},Qe);return}Ge($e,Te)})}},{key:"prepareLoading",value:function(L,W){var ae=this,Me=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Ie=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),Ie&&Ie();typeof L=="string"&&(L=this.languageUtils.toResolveHierarchy(L)),typeof W=="string"&&(W=[W]);var Qe=this.queueLoad(L,W,Me,Ie);if(!Qe.toLoad.length)return Qe.pending.length||Ie(),null;Qe.toLoad.forEach(function(Ge){ae.loadOne(Ge)})}},{key:"load",value:function(L,W,ae){this.prepareLoading(L,W,{},ae)}},{key:"reload",value:function(L,W,ae){this.prepareLoading(L,W,{reload:!0},ae)}},{key:"loadOne",value:function(L){var W=this,ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",Me=L.split("|"),Ie=Me[0],Qe=Me[1];this.read(Ie,Qe,"read",void 0,void 0,function(Ge,$e){Ge&&W.logger.warn("".concat(ae,"loading namespace ").concat(Qe," for language ").concat(Ie," failed"),Ge),!Ge&&$e&&W.logger.log("".concat(ae,"loaded namespace ").concat(Qe," for language ").concat(Ie),$e),W.loaded(L,Ge,$e)})}},{key:"saveMissing",value:function(L,W,ae,Me,Ie){var Qe=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(W)){this.logger.warn('did not save key "'.concat(ae,'" as the namespace "').concat(W,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}ae==null||ae===""||(this.backend&&this.backend.create&&this.backend.create(L,W,ae,Me,null,lt(lt({},Qe),{},{isUpdate:Ie})),!(!L||!L[0])&&this.store.addResource(L[0],W,ae,Me))}}]),V}(Se);function ni(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(O){var V={};if(v.default(O[1])==="object"&&(V=O[1]),typeof O[1]=="string"&&(V.defaultValue=O[1]),typeof O[2]=="string"&&(V.tDescription=O[2]),v.default(O[2])==="object"||v.default(O[3])==="object"){var q=O[3]||O[2];Object.keys(q).forEach(function(L){V[L]=q[L]})}return V},interpolation:{escapeValue:!0,format:function(O,V,q,L){return O},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function Ei($){return typeof $.ns=="string"&&($.ns=[$.ns]),typeof $.fallbackLng=="string"&&($.fallbackLng=[$.fallbackLng]),typeof $.fallbackNS=="string"&&($.fallbackNS=[$.fallbackNS]),$.supportedLngs&&$.supportedLngs.indexOf("cimode")<0&&($.supportedLngs=$.supportedLngs.concat(["cimode"])),$}function ji($,O){var V=Object.keys($);if(Object.getOwnPropertySymbols){var q=Object.getOwnPropertySymbols($);O&&(q=q.filter(function(L){return Object.getOwnPropertyDescriptor($,L).enumerable})),V.push.apply(V,q)}return V}function re($){for(var O=1;O<arguments.length;O++){var V=arguments[O]!=null?arguments[O]:{};O%2?ji(Object(V),!0).forEach(function(q){X.default($,q,V[q])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(V)):ji(Object(V)).forEach(function(q){Object.defineProperty($,q,Object.getOwnPropertyDescriptor(V,q))})}return $}function U($){var O=J();return function(){var q=Y.default($),L;if(O){var W=Y.default(this).constructor;L=Reflect.construct(q,arguments,W)}else L=q.apply(this,arguments);return G.default(this,L)}}function J(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function te(){}function se($){var O=Object.getOwnPropertyNames(Object.getPrototypeOf($));O.forEach(function(V){typeof $[V]=="function"&&($[V]=$[V].bind($))})}var Ae=function($){R.default(V,$);var O=U(V);function V(){var q,L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},W=arguments.length>1?arguments[1]:void 0;if(M.default(this,V),q=O.call(this),_t&&Se.call(I.default(q)),q.options=Ei(L),q.services={},q.logger=Pe,q.modules={external:[]},se(I.default(q)),W&&!q.isInitialized&&!L.isClone){if(!q.options.initImmediate)return q.init(L,W),G.default(q,I.default(q));setTimeout(function(){q.init(L,W)},0)}return q}return S.default(V,[{key:"init",value:function(){var L=this,W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ae=arguments.length>1?arguments[1]:void 0;typeof W=="function"&&(ae=W,W={}),!W.defaultNS&&W.defaultNS!==!1&&W.ns&&(typeof W.ns=="string"?W.defaultNS=W.ns:W.ns.indexOf("translation")<0&&(W.defaultNS=W.ns[0]));var Me=ni();this.options=re(re(re({},Me),this.options),Ei(W)),this.options.compatibilityAPI!=="v1"&&(this.options.interpolation=re(re({},Me.interpolation),this.options.interpolation)),W.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=W.keySeparator),W.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=W.nsSeparator);function Ie(Tt){return Tt?typeof Tt=="function"?new Tt:Tt:null}if(!this.options.isClone){this.modules.logger?Pe.init(Ie(this.modules.logger),this.options):Pe.init(null,this.options);var Qe;this.modules.formatter?Qe=this.modules.formatter:typeof Intl<"u"&&(Qe=Un);var Ge=new Ci(this.options);this.store=new mi(this.options.resources,this.options);var $e=this.services;$e.logger=Pe,$e.resourceStore=this.store,$e.languageUtils=Ge,$e.pluralResolver=new bn(Ge,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),Qe&&(!this.options.interpolation.format||this.options.interpolation.format===Me.interpolation.format)&&($e.formatter=Ie(Qe),$e.formatter.init($e,this.options),this.options.interpolation.format=$e.formatter.format.bind($e.formatter)),$e.interpolator=new ta(this.options),$e.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},$e.backendConnector=new wn(Ie(this.modules.backend),$e.resourceStore,$e,this.options),$e.backendConnector.on("*",function(Tt){for(var Ct=arguments.length,Si=new Array(Ct>1?Ct-1:0),Ai=1;Ai<Ct;Ai++)Si[Ai-1]=arguments[Ai];L.emit.apply(L,[Tt].concat(Si))}),this.modules.languageDetector&&($e.languageDetector=Ie(this.modules.languageDetector),$e.languageDetector.init($e,this.options.detection,this.options)),this.modules.i18nFormat&&($e.i18nFormat=Ie(this.modules.i18nFormat),$e.i18nFormat.init&&$e.i18nFormat.init(this)),this.translator=new Kn(this.services,this.options),this.translator.on("*",function(Tt){for(var Ct=arguments.length,Si=new Array(Ct>1?Ct-1:0),Ai=1;Ai<Ct;Ai++)Si[Ai-1]=arguments[Ai];L.emit.apply(L,[Tt].concat(Si))}),this.modules.external.forEach(function(Tt){Tt.init&&Tt.init(L)})}if(this.format=this.options.interpolation.format,ae||(ae=te),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var Te=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);Te.length>0&&Te[0]!=="dev"&&(this.options.lng=Te[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined");var gt=["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"];gt.forEach(function(Tt){L[Tt]=function(){var Ct;return(Ct=L.store)[Tt].apply(Ct,arguments)}});var wt=["addResource","addResources","addResourceBundle","removeResourceBundle"];wt.forEach(function(Tt){L[Tt]=function(){var Ct;return(Ct=L.store)[Tt].apply(Ct,arguments),L}});var St=_e(),$t=function(){var Ct=function(Ai,Wn){L.isInitialized&&!L.initializedStoreOnce&&L.logger.warn("init: i18next is already initialized. You should call init just once!"),L.isInitialized=!0,L.options.isClone||L.logger.log("initialized",L.options),L.emit("initialized",L.options),St.resolve(Wn),ae(Ai,Wn)};if(L.languages&&L.options.compatibilityAPI!=="v1"&&!L.isInitialized)return Ct(null,L.t.bind(L));L.changeLanguage(L.options.lng,Ct)};return this.options.resources||!this.options.initImmediate?$t():setTimeout($t,0),St}},{key:"loadResources",value:function(L){var W=this,ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:te,Me=ae,Ie=typeof L=="string"?L:this.language;if(typeof L=="function"&&(Me=L),!this.options.resources||this.options.partialBundledLanguages){if(Ie&&Ie.toLowerCase()==="cimode")return Me();var Qe=[],Ge=function(gt){if(gt){var wt=W.services.languageUtils.toResolveHierarchy(gt);wt.forEach(function(St){Qe.indexOf(St)<0&&Qe.push(St)})}};if(Ie)Ge(Ie);else{var $e=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);$e.forEach(function(Te){return Ge(Te)})}this.options.preload&&this.options.preload.forEach(function(Te){return Ge(Te)}),this.services.backendConnector.load(Qe,this.options.ns,function(Te){!Te&&!W.resolvedLanguage&&W.language&&W.setResolvedLanguage(W.language),Me(Te)})}else Me(null)}},{key:"reloadResources",value:function(L,W,ae){var Me=_e();return L||(L=this.languages),W||(W=this.options.ns),ae||(ae=te),this.services.backendConnector.reload(L,W,function(Ie){Me.resolve(),ae(Ie)}),Me}},{key:"use",value:function(L){if(!L)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!L.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return L.type==="backend"&&(this.modules.backend=L),(L.type==="logger"||L.log&&L.warn&&L.error)&&(this.modules.logger=L),L.type==="languageDetector"&&(this.modules.languageDetector=L),L.type==="i18nFormat"&&(this.modules.i18nFormat=L),L.type==="postProcessor"&&Pi.addPostProcessor(L),L.type==="formatter"&&(this.modules.formatter=L),L.type==="3rdParty"&&this.modules.external.push(L),this}},{key:"setResolvedLanguage",value:function(L){if(!(!L||!this.languages)&&!(["cimode","dev"].indexOf(L)>-1))for(var W=0;W<this.languages.length;W++){var ae=this.languages[W];if(!(["cimode","dev"].indexOf(ae)>-1)&&this.store.hasLanguageSomeTranslations(ae)){this.resolvedLanguage=ae;break}}}},{key:"changeLanguage",value:function(L,W){var ae=this;this.isLanguageChangingTo=L;var Me=_e();this.emit("languageChanging",L);var Ie=function(Te){ae.language=Te,ae.languages=ae.services.languageUtils.toResolveHierarchy(Te),ae.resolvedLanguage=void 0,ae.setResolvedLanguage(Te)},Qe=function(Te,gt){gt?(Ie(gt),ae.translator.changeLanguage(gt),ae.isLanguageChangingTo=void 0,ae.emit("languageChanged",gt),ae.logger.log("languageChanged",gt)):ae.isLanguageChangingTo=void 0,Me.resolve(function(){return ae.t.apply(ae,arguments)}),W&&W(Te,function(){return ae.t.apply(ae,arguments)})},Ge=function(Te){!L&&!Te&&ae.services.languageDetector&&(Te=[]);var gt=typeof Te=="string"?Te:ae.services.languageUtils.getBestMatchFromCodes(Te);gt&&(ae.language||Ie(gt),ae.translator.language||ae.translator.changeLanguage(gt),ae.services.languageDetector&&ae.services.languageDetector.cacheUserLanguage(gt)),ae.loadResources(gt,function(wt){Qe(wt,gt)})};return!L&&this.services.languageDetector&&!this.services.languageDetector.async?Ge(this.services.languageDetector.detect()):!L&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(Ge):Ge(L),Me}},{key:"getFixedT",value:function(L,W,ae){var Me=this,Ie=function Qe(Ge,$e){var Te;if(v.default($e)!=="object"){for(var gt=arguments.length,wt=new Array(gt>2?gt-2:0),St=2;St<gt;St++)wt[St-2]=arguments[St];Te=Me.options.overloadTranslationOptionHandler([Ge,$e].concat(wt))}else Te=re({},$e);Te.lng=Te.lng||Qe.lng,Te.lngs=Te.lngs||Qe.lngs,Te.ns=Te.ns||Qe.ns,Te.keyPrefix=Te.keyPrefix||ae||Qe.keyPrefix;var $t=Me.options.keySeparator||".",Tt=Te.keyPrefix?"".concat(Te.keyPrefix).concat($t).concat(Ge):Ge;return Me.t(Tt,Te)};return typeof L=="string"?Ie.lng=L:Ie.lngs=L,Ie.ns=W,Ie.keyPrefix=ae,Ie}},{key:"t",value:function(){var L;return this.translator&&(L=this.translator).translate.apply(L,arguments)}},{key:"exists",value:function(){var L;return this.translator&&(L=this.translator).exists.apply(L,arguments)}},{key:"setDefaultNamespace",value:function(L){this.options.defaultNS=L}},{key:"hasLoadedNamespace",value:function(L){var W=this,ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var Me=this.resolvedLanguage||this.languages[0],Ie=this.options?this.options.fallbackLng:!1,Qe=this.languages[this.languages.length-1];if(Me.toLowerCase()==="cimode")return!0;var Ge=function(gt,wt){var St=W.services.backendConnector.state["".concat(gt,"|").concat(wt)];return St===-1||St===2};if(ae.precheck){var $e=ae.precheck(this,Ge);if($e!==void 0)return $e}return!!(this.hasResourceBundle(Me,L)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||Ge(Me,L)&&(!Ie||Ge(Qe,L)))}},{key:"loadNamespaces",value:function(L,W){var ae=this,Me=_e();return this.options.ns?(typeof L=="string"&&(L=[L]),L.forEach(function(Ie){ae.options.ns.indexOf(Ie)<0&&ae.options.ns.push(Ie)}),this.loadResources(function(Ie){Me.resolve(),W&&W(Ie)}),Me):(W&&W(),Promise.resolve())}},{key:"loadLanguages",value:function(L,W){var ae=_e();typeof L=="string"&&(L=[L]);var Me=this.options.preload||[],Ie=L.filter(function(Qe){return Me.indexOf(Qe)<0});return Ie.length?(this.options.preload=Me.concat(Ie),this.loadResources(function(Qe){ae.resolve(),W&&W(Qe)}),ae):(W&&W(),Promise.resolve())}},{key:"dir",value:function(L){if(L||(L=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!L)return"rtl";var W=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"];return W.indexOf(this.services.languageUtils.getLanguagePartFromCode(L))>-1||L.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}},{key:"cloneInstance",value:function(){var L=this,W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:te,Me=re(re(re({},this.options),W),{isClone:!0}),Ie=new V(Me);(W.debug!==void 0||W.prefix!==void 0)&&(Ie.logger=Ie.logger.clone(W));var Qe=["store","services","language"];return Qe.forEach(function(Ge){Ie[Ge]=L[Ge]}),Ie.services=re({},this.services),Ie.services.utils={hasLoadedNamespace:Ie.hasLoadedNamespace.bind(Ie)},Ie.translator=new Kn(Ie.services,Ie.options),Ie.translator.on("*",function(Ge){for(var $e=arguments.length,Te=new Array($e>1?$e-1:0),gt=1;gt<$e;gt++)Te[gt-1]=arguments[gt];Ie.emit.apply(Ie,[Ge].concat(Te))}),Ie.init(Me,ae),Ie.translator.options=Ie.options,Ie.translator.backendConnector.services.utils={hasLoadedNamespace:Ie.hasLoadedNamespace.bind(Ie)},Ie}},{key:"toJSON",value:function(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}]),V}(Se);X.default(Ae,"createInstance",function(){var $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},O=arguments.length>1?arguments[1]:void 0;return new Ae($,O)});var Ee=Ae.createInstance();return Ee.createInstance=Ae.createInstance,wp=Ee,wp}(function(n,e){(function(t,i){n.exports=i(Hx(),iw())})(z2,function(t,i){function s(mi){return mi&&typeof mi=="object"&&"default"in mi?mi:{default:mi}}var c=s(t),u=s(i),o={PH:[{name:"Año Nuevo",fixed_date:[1,1]},{name:"Día Nacional de la Memoria por la Verdad y la Justicia",fixed_date:[3,24]},{name:"Día del Veterano y de los Caídos en la Guerra de Malvinas",fixed_date:[4,2]},{name:"Día del Trabajador",fixed_date:[5,1]},{name:"Día de la Revolución de Mayo",fixed_date:[5,25]},{name:"Paso a la Inmortalidad del General Manuel Belgrano",fixed_date:[6,20]},{name:"Día de la Independencia",fixed_date:[7,9]},{name:"Inmaculada Concepción de María",fixed_date:[12,8]},{name:"Navidad",fixed_date:[12,25]}]};o.PH;var p={PH:[{name:"Neujahrstag",fixed_date:[1,1]},{name:"Heilige Drei Könige",fixed_date:[1,6]},{name:"Ostermontag",variable_date:"easter",offset:1},{name:"Staatsfeiertag",fixed_date:[5,1]},{name:"Christi Himmelfahrt",variable_date:"easter",offset:39},{name:"Pfingstmontag",variable_date:"easter",offset:50},{name:"Fronleichnam",variable_date:"easter",offset:60},{name:"Mariä Himmelfahrt",fixed_date:[8,15]},{name:"Nationalfeiertag",fixed_date:[10,26]},{name:"Allerheiligen",fixed_date:[11,1]},{name:"Mariä Empfängnis",fixed_date:[12,8]},{name:"Christtag",fixed_date:[12,25]},{name:"Stefanitag",fixed_date:[12,26]}],SH:[{2017:[4,8,4,18],2018:[3,24,4,3],2019:[4,13,4,23],2020:[4,4,4,14],2021:[3,27,4,6],2022:[4,9,4,19],2023:[4,1,4,11],2024:[3,23,4,2],name:"Osterferien"},{2017:[6,3,6,6],2018:[5,19,5,22],2019:[6,8,6,11],2020:[5,30,6,2],2021:[5,22,5,25],2022:[6,4,6,7],2023:[5,57,5,30],2024:[5,18,5,21],name:"Pfingstferien"},{2016:[11,2],2017:[11,2],2018:[11,2],2019:[11,2],2020:[11,2],2021:[11,2],2022:[11,2],2023:[11,2],name:"Allerseelen"},{2016:[12,24,1,7],2017:[12,24,1,6],2018:[12,24,1,6],2019:[12,23,1,6],2020:[12,24,1,6],2021:[12,24,1,6],2022:[12,24,1,6],2023:[12,24,1,6],name:"Weihnachtsferien"}],Burgenland:{_state_code:1,SH:[{2016:[2,8,2,13],2017:[2,13,2,18],2018:[2,12,2,17],2019:[2,11,2,16],2020:[2,10,2,15],2021:[2,8,2,13],name:"Semesterferien"},{2016:[7,2,9,3],2017:[7,1,9,3],2018:[6,30,9,2],2019:[6,29,9,1],2020:[7,4,9,6],2021:[7,3,9,4],name:"Sommerferien"}]},Kärnten:{_state_code:2,SH:[{2016:[2,8,2,13],2017:[2,13,2,18],2018:[2,12,2,17],2019:[2,11,2,16],2020:[2,10,2,15],2021:[2,8,2,13],name:"Semesterferien"},{2016:[7,9,9,10],2017:[7,8,9,10],2018:[7,7,9,9],2019:[7,6,9,8],2020:[7,11,9,13],2021:[7,10,9,11],name:"Sommerferien"}]},Niederösterreich:{_state_code:3,SH:[{2016:[2,1,2,6],2017:[2,6,2,11],2018:[2,5,2,10],2019:[2,4,2,9],2020:[2,3,2,8],2021:[2,1,2,6],name:"Semesterferien"},{2016:[7,2,9,3],2017:[7,1,9,3],2018:[6,30,9,2],2019:[6,29,9,1],2020:[7,4,9,6],2021:[7,3,9,4],name:"Sommerferien"}]},Oberösterreich:{_state_code:4,SH:[{2016:[2,15,2,20],2017:[2,20,2,25],2018:[2,19,2,24],2019:[2,18,2,23],2020:[2,17,2,22],2021:[2,15,2,20],name:"Semesterferien"},{2016:[7,9,9,10],2017:[7,8,9,10],2018:[7,7,9,9],2019:[7,6,9,8],2020:[7,11,9,13],2021:[7,10,9,11],name:"Sommerferien"}]},Salzburg:{_state_code:5,SH:[{2016:[2,8,2,13],2017:[2,13,2,18],2018:[2,12,2,17],2019:[2,11,2,16],2020:[2,10,2,15],2021:[2,8,2,13],name:"Semesterferien"},{2016:[7,9,9,10],2017:[7,8,9,10],2018:[7,7,9,9],2019:[7,6,9,8],2020:[7,11,9,13],2021:[7,10,9,11],name:"Sommerferien"}]},Steiermark:{_state_code:6,SH:[{2016:[2,15,2,20],2017:[2,20,2,25],2018:[2,19,2,24],2019:[2,18,2,23],2020:[2,17,2,22],2021:[2,15,2,20],name:"Semesterferien"},{2016:[7,9,9,10],2017:[7,8,9,10],2018:[7,7,9,9],2019:[7,6,9,8],2020:[7,11,9,13],2021:[7,10,9,12],name:"Sommerferien"}]},Tirol:{_state_code:7,SH:[{2016:[2,8,2,13],2017:[2,13,2,18],2018:[2,12,2,17],2019:[2,11,2,16],2020:[2,10,2,15],2021:[2,8,2,13],name:"Semesterferien"},{2016:[7,9,9,10],2017:[7,8,9,10],2018:[7,7,9,9],2019:[7,6,9,8],2020:[7,11,9,13],2021:[7,10,9,11],name:"Sommerferien"}]},Vorarlberg:{_state_code:8,SH:[{2016:[2,15,2,20],2017:[2,13,2,18],2018:[2,5,2,10],2019:[2,11,2,16],2020:[2,10,2,15],2021:[2,8,2,13],name:"Semesterferien"},{2016:[7,9,9,10],2017:[7,8,9,10],2018:[7,7,9,9],2019:[7,6,9,8],2020:[7,11,9,13],2021:[7,10,9,11],name:"Sommerferien"}]},Wien:{_state_code:9,SH:[{2016:[2,1,2,6],2017:[2,6,2,11],2018:[2,5,2,10],2019:[2,4,2,9],2020:[2,3,2,8],2021:[2,1,2,6],name:"Semesterferien"},{2016:[7,2,9,3],2017:[7,1,9,3],2018:[6,30,9,2],2019:[6,29,9,1],2020:[7,4,9,6],2021:[7,3,9,4],name:"Sommerferien"}]}};p.PH,p.SH,p.Burgenland,p.Salzburg,p.Steiermark,p.Tirol,p.Vorarlberg,p.Wien;var _={PH:[{name:"New Years Day",fixed_date:[1,1]},{name:"Australia Day",fixed_date:[1,26]},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Easter Monday",variable_date:"easter",offset:1},{name:"ANZAC Day",fixed_date:[4,25]},{name:"Christmas Day",fixed_date:[12,25]},{name:"Boxing Day",fixed_date:[12,26]}],"Australian Capital Territory":{_state_code:"act",PH:[{name:"New Years Day",fixed_date:[1,1]},{name:"Australia Day",fixed_date:[1,26]},{name:"Canberra Day",variable_date:"firstMarchMonday",offset:7},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Easter Saturday",variable_date:"easter",offset:-1},{name:"Easter Sunday",variable_date:"easter"},{name:"Easter Monday",variable_date:"easter",offset:1},{name:"ANZAC Day",fixed_date:[4,25]},{name:"Reconciliation Day",variable_date:"lastMayMonday"},{name:"Queens Birthday",variable_date:"firstJuneMonday",offset:7},{name:"Family and Community Day",variable_date:"lastSeptemberMonday"},{name:"Labour Day",variable_date:"firstOctoberMonday"},{name:"Christmas Day",fixed_date:[12,25]},{name:"Boxing Day",fixed_date:[12,26]}]},"New South Wales":{_state_code:"nsw",PH:[{name:"New Years Day",fixed_date:[1,1]},{name:"Australia Day",fixed_date:[1,26]},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Easter Saturday",variable_date:"easter",offset:-1},{name:"Easter Sunday",variable_date:"easter"},{name:"Easter Monday",variable_date:"easter",offset:1},{name:"ANZAC Day",fixed_date:[4,25]},{name:"Queens Birthday",variable_date:"firstJuneMonday",offset:7},{name:"Labour Day",variable_date:"firstOctoberMonday"},{name:"Christmas Day",fixed_date:[12,25]},{name:"Boxing Day",fixed_date:[12,26]}]},"Northern Territory":{_state_code:"nt",PH:[{name:"New Years Day",fixed_date:[1,1]},{name:"Australia Day",fixed_date:[1,26]},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Easter Saturday",variable_date:"easter",offset:-1},{name:"Easter Monday",variable_date:"easter",offset:1},{name:"ANZAC Day",fixed_date:[4,25]},{name:"May Day",variable_date:"firstMayMonday"},{name:"Queens Birthday",variable_date:"firstJuneMonday",offset:7},{name:"Picnic Day",variable_date:"firstAugustMonday"},{name:"Christmas Day",fixed_date:[12,25]},{name:"Boxing Day",fixed_date:[12,26]}]},Queensland:{_state_code:"qld",PH:[{name:"New Years Day",fixed_date:[1,1]},{name:"Australia Day",fixed_date:[1,26]},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Easter Saturday",variable_date:"easter",offset:-1},{name:"Easter Monday",variable_date:"easter",offset:1},{name:"ANZAC Day",fixed_date:[4,25]},{name:"Labour Day",variable_date:"firstMayMonday"},{name:"Queens Birthday",variable_date:"firstOctoberMonday"},{name:"Christmas Day",fixed_date:[12,25]},{name:"Boxing Day",fixed_date:[12,26]}]},"South Australia":{_state_code:"sa",PH:[{name:"New Years Day",fixed_date:[1,1]},{name:"Australia Day",fixed_date:[1,26]},{name:"Adelaide Cup",variable_date:"firstMarchMonday",offset:7},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Easter Saturday",variable_date:"easter",offset:-1},{name:"Easter Monday",variable_date:"easter",offset:1},{name:"ANZAC Day",fixed_date:[4,25]},{name:"Queens Birthday",variable_date:"firstJuneMonday",offset:7},{name:"Labour Day",variable_date:"firstOctoberMonday"},{name:"Christmas Day",fixed_date:[12,25]},{name:"Boxing Day",fixed_date:[12,26]}]},Tasmania:{_state_code:"tas",PH:[{name:"New Years Day",fixed_date:[1,1]},{name:"Australia Day",fixed_date:[1,26]},{name:"Eight Hours Day",variable_date:"firstMarchMonday",offset:7},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Easter Monday",variable_date:"easter",offset:1},{name:"ANZAC Day",fixed_date:[4,25]},{name:"Queens Birthday",variable_date:"firstJuneMonday",offset:7},{name:"Christmas Day",fixed_date:[12,25]},{name:"Boxing Day",fixed_date:[12,26]}]},Victoria:{_state_code:"vic",PH:[{name:"New Years Day",fixed_date:[1,1]},{name:"Australia Day",fixed_date:[1,26]},{name:"Labour Day",variable_date:"firstMarchMonday",offset:7},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Easter Saturday",variable_date:"easter",offset:-1},{name:"Easter Sunday",variable_date:"easter"},{name:"Easter Monday",variable_date:"easter",offset:1},{name:"ANZAC Day",fixed_date:[4,25]},{name:"Queens Birthday",variable_date:"firstJuneMonday",offset:7},{name:"AFL Grand Final",variable_date:"lastSeptemberFriday"},{name:"Melbourne Cup",variable_date:"firstNovemberTuesday"},{name:"Christmas Day",fixed_date:[12,25]},{name:"Boxing Day",fixed_date:[12,26]}]},"Western Australia":{_state_code:"wa",PH:[{name:"New Years Day",fixed_date:[1,1]},{name:"Australia Day",fixed_date:[1,26]},{name:"Labour Day",variable_date:"firstMarchMonday"},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Easter Monday",variable_date:"easter",offset:1},{name:"ANZAC Day",fixed_date:[4,25]},{name:"Western Australia Day",variable_date:"firstJuneMonday"},{name:"Christmas Day",fixed_date:[12,25]},{name:"Boxing Day",fixed_date:[12,26]}]}};_.PH,_.Queensland,_.Tasmania,_.Victoria;var v={PH:[{name:"Nieuwjaar - Jour de l'an",fixed_date:[1,1]},{name:"Paasmaandag - Lundi de Pâques",variable_date:"easter",offset:1},{name:"Dag van de Arbeid - Fête du Travail",fixed_date:[5,1]},{name:"Onze-Lieve-Heer-Hemelvaart - Jeudi de l'Ascensionn",variable_date:"easter",offset:39},{name:"Pinkstermaandag - Lundi de Pentecôte",variable_date:"easter",offset:50},{name:"Nationale feestdag van België - Fête nationale",fixed_date:[7,21]},{name:"Onze-Lieve-Vrouw-Hemelvaart - Assomption",fixed_date:[8,15]},{name:"Allerheiligen - Toussaint",fixed_date:[11,1]},{name:"Wapenstilstand - Armistice",fixed_date:[11,11]},{name:"Kerstmis - Noël",fixed_date:[12,25]}],SH:[{2020:[2,24,3,1],2021:[2,15,2,21],2022:[2,28,3,6],2023:[2,20,2,26],name:"Krokusvakantie - Vacances de carnaval"},{2020:[4,6,4,19],2021:[4,5,4,18],2022:[4,4,4,18],2023:[4,3,4,16],name:"Paasvakantie - Vacances de pâques"},{2020:[7,1,8,31],2021:[7,1,8,31],2022:[7,1,8,31],2023:[7,1,8,31],name:"Zomervakantie - Vacances d'été"},{2019:[10,28,11,3],2020:[11,2,11,15],2021:[11,1,11,7],2022:[10,31,11,6],name:"Herfstvakantie - Vacances automne"},{2019:[12,23,1,5],2020:[12,21,1,3],2021:[12,27,1,9],2022:[12,26,1,8],name:"Kerstvakantie - Vacances de Noël"}]};v.PH,v.SH;var M={PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Natal",fixed_date:[12,25]}],Acre:{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Dia do evangélico",fixed_date:[1,23]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Alusivo ao Dia Internacional da Mulher",fixed_date:[3,8]},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Aniversário do estado",fixed_date:[6,15]},{name:"Dia da Amazônia",fixed_date:[9,5]},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Assinatura do Tratado de Petrópolis",fixed_date:[11,17]},{name:"Natal",fixed_date:[12,25]}]},Alagoas:{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"São João",fixed_date:[6,24]},{name:"São Pedro",fixed_date:[6,29]},{name:"Independência",fixed_date:[9,7]},{name:"Emancipação política",fixed_date:[9,16]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Morte de Zumbi dos Palmares",fixed_date:[11,20]},{name:"Natal",fixed_date:[12,25]}]},Amapá:{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Dia de São José",fixed_date:[3,19]},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Independência",fixed_date:[9,7]},{name:"Data Magna do estado",fixed_date:[9,13]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Natal",fixed_date:[12,25]}]},Amazonas:{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Data Magna do estado",fixed_date:[9,5]},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Dia da Consciência Negra",fixed_date:[11,20]},{name:"Natal",fixed_date:[12,25]}]},Bahia:{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Data magna do estado",fixed_date:[2,7]},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Natal",fixed_date:[12,25]}]},Ceará:{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Data magna do estado",fixed_date:[3,25]},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Natal",fixed_date:[12,25]}]},"Distrito Federal":{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Dia do evangélico",fixed_date:[11,30]},{name:"Natal",fixed_date:[12,25]}]},"Espírito Santo":{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Data magna do estado",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Natal",fixed_date:[12,25]}]},Goiás:{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Natal",fixed_date:[12,25]}]},Maranhão:{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Data magna do estado",fixed_date:[7,28]},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Natal",fixed_date:[12,25]}]},"Mato Grosso":{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Dia da Consciência Negra",fixed_date:[11,20]},{name:"Natal",fixed_date:[12,25]}]},"Mato Grosso do Sul":{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Independência",fixed_date:[9,7]},{name:"Criação do estado",fixed_date:[10,11]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Natal",fixed_date:[12,25]}]},"Minas Gerais":{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Data magna do estado",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Natal",fixed_date:[12,25]}]},Pará:{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Data magna do estado",fixed_date:[8,15]},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Natal",fixed_date:[12,25]}]},Paraíba:{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Homenagem a João Pessoa",fixed_date:[7,26]},{name:"Data magna do estado",fixed_date:[8,5]},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Natal",fixed_date:[12,25]}]},Paraná:{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Data magna do estado",fixed_date:[12,19]},{name:"Natal",fixed_date:[12,25]}]},Pernambuco:{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Data magna do estado",variable_date:"firstMarchSunday"},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Natal",fixed_date:[12,25]}]},Piauí:{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Data magna do estado",fixed_date:[10,19]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Natal",fixed_date:[12,25]}]},"Rio de Janeiro":{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Dia da Consciência Negra",fixed_date:[11,20]},{name:"Natal",fixed_date:[12,25]}]},"Rio Grande do Norte":{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"São Jorge",fixed_date:[4,23]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Independência",fixed_date:[9,7]},{name:"Mártires de Cunhaú e Uruaçu",fixed_date:[10,3]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Natal",fixed_date:[12,25]}]},"Rio Grande do Sul":{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Independência",fixed_date:[9,7]},{name:"Proclamação da República Rio-Grandense",fixed_date:[9,20]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Natal",fixed_date:[12,25]}]},Rondônia:{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Data magna do estado",fixed_date:[1,4]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Dia do evangélico",fixed_date:[6,18]},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Natal",fixed_date:[12,25]}]},Roraima:{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Independência",fixed_date:[9,7]},{name:"Data magna do estado",fixed_date:[10,5]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Natal",fixed_date:[12,25]}]},"Santa Catarina":{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Data magna do estado",fixed_date:[8,11]},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Santa Catarina de Alexandria",fixed_date:[11,25]},{name:"Natal",fixed_date:[12,25]}]},"São Paulo":{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Data magna do estado",fixed_date:[7,9]},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Natal",fixed_date:[12,25]}]},Sergipe:{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Aniversário de Aracaju",fixed_date:[3,17]},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"São João",fixed_date:[6,24]},{name:"Data magna do estado",fixed_date:[7,8]},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Nossa Senhora da Conceição",fixed_date:[12,8]},{name:"Natal",fixed_date:[12,25]}]},Tocantins:{PH:[{name:"Ano Novo",fixed_date:[1,1]},{name:"Carnaval",variable_date:"easter",offset:-47},{name:"Autonomia do estado",fixed_date:[3,18]},{name:"Sexta-feira santa",variable_date:"easter",offset:-2},{name:"Tiradentes",fixed_date:[4,21]},{name:"Dia do Trabalhador",fixed_date:[5,1]},{name:"Corpus Christi",variable_date:"easter",offset:60},{name:"Independência",fixed_date:[9,7]},{name:"Nossa Senhora da Natividade",fixed_date:[9,8]},{name:"Criação do estado",fixed_date:[10,5]},{name:"Nossa Senhora Aparecida",fixed_date:[10,12]},{name:"Finados",fixed_date:[11,2]},{name:"Proclamação da República",fixed_date:[11,15]},{name:"Natal",fixed_date:[12,25]}]}};M.PH,M.Acre,M.Alagoas,M.Amazonas,M.Bahia,M.Pernambuco,M.Roraima,M.Sergipe,M.Tocantins;var S={PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Canada Day",variable_date:"canadaDay"},{name:"Labour Day",variable_date:"firstSeptemberMonday"},{name:"Christmas Day",fixed_date:[12,25]}],Alberta:{PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Alberta Family Day",variable_date:"firstFebruaryMonday",offset:14},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Easter Monday",variable_date:"easter",offset:1},{name:"Victoria Day",variable_date:"victoriaDay"},{name:"Canada Day",variable_date:"canadaDay"},{name:"Heritage Day",variable_date:"firstAugustMonday"},{name:"Labour Day",variable_date:"firstSeptemberMonday"},{name:"Thanksgiving",variable_date:"firstOctoberMonday",offset:7},{name:"Remembrance Day",fixed_date:[11,11]},{name:"Christmas Day",fixed_date:[12,25]},{name:"Boxing Day",fixed_date:[12,26]}]},"British Columbia":{PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Family Day",variable_date:"firstFebruaryMonday",offset:7},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Victoria Day",variable_date:"victoriaDay"},{name:"Canada Day",variable_date:"canadaDay"},{name:"British Columbia Day",variable_date:"firstAugustMonday"},{name:"Labour Day",variable_date:"firstSeptemberMonday"},{name:"Thanksgiving",variable_date:"firstOctoberMonday",offset:7},{name:"Remembrance Day",fixed_date:[11,11]},{name:"Christmas Day",fixed_date:[12,25]}]},Manitoba:{PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Louis Riel Day",variable_date:"firstFebruaryMonday",offset:14},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Victoria Day",variable_date:"victoriaDay"},{name:"Canada Day",variable_date:"canadaDay"},{name:"Civic Holiday",variable_date:"firstAugustMonday"},{name:"Labour Day",variable_date:"firstSeptemberMonday"},{name:"Thanksgiving",variable_date:"firstOctoberMonday",offset:7},{name:"Remembrance Day",fixed_date:[11,11]},{name:"Christmas Day",fixed_date:[12,25]}]},"New Brunswick":{PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Victoria Day",variable_date:"victoriaDay"},{name:"Canada Day",variable_date:"canadaDay"},{name:"New Brunswick Day",variable_date:"firstAugustMonday"},{name:"Labour Day",variable_date:"firstSeptemberMonday"},{name:"Thanksgiving",variable_date:"firstOctoberMonday",offset:7},{name:"Remembrance Day",fixed_date:[11,11]},{name:"Christmas Day",fixed_date:[12,25]},{name:"Boxing Day",fixed_date:[12,26]}]},"Newfoundland and Labrador":{PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Saint Patrick's Day",fixed_date:[3,17]},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Saint George's Day",fixed_date:[4,23]},{name:"Discovery Day",fixed_date:[6,24]},{name:"Memorial Day",fixed_date:[7,1]},{name:"Orangemen's Day",fixed_date:[7,12]},{name:"Labour Day",variable_date:"firstSeptemberMonday"},{name:"Armistice Day",fixed_date:[11,11]},{name:"Christmas Day",fixed_date:[12,25]}]},"Northwest Territories":{PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Victoria Day",variable_date:"victoriaDay"},{name:"National Aboriginal Day",fixed_date:[6,21]},{name:"Canada Day",variable_date:"canadaDay"},{name:"Civic Holiday",variable_date:"firstAugustMonday"},{name:"Labour Day",variable_date:"firstSeptemberMonday"},{name:"Thanksgiving",variable_date:"firstOctoberMonday",offset:7},{name:"Remembrance Day",fixed_date:[11,11]},{name:"Christmas Day",fixed_date:[12,25]}]},"Nova Scotia":{PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Victoria Day",variable_date:"victoriaDay"},{name:"Canada Day",variable_date:"canadaDay"},{name:"Natal Day",variable_date:"firstAugustMonday"},{name:"Labour Day",variable_date:"firstSeptemberMonday"},{name:"Thanksgiving",variable_date:"firstOctoberMonday",offset:7},{name:"Remembrance Day",fixed_date:[11,11]},{name:"Christmas Day",fixed_date:[12,25]},{name:"Boxing Day",fixed_date:[12,26]}]},Nunavut:{PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Victoria Day",variable_date:"victoriaDay"},{name:"Canada Day",variable_date:"canadaDay"},{name:"Nunavut Day",fixed_date:[7,9]},{name:"Civic Holiday",variable_date:"firstAugustMonday"},{name:"Labour Day",variable_date:"firstSeptemberMonday"},{name:"Thanksgiving",variable_date:"firstOctoberMonday",offset:7},{name:"Remembrance Day",fixed_date:[11,11]},{name:"Christmas Day",fixed_date:[12,25]}]},Ontario:{PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Family Day",variable_date:"firstFebruaryMonday",offset:14},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Victoria Day",variable_date:"victoriaDay"},{name:"Canada Day",variable_date:"canadaDay"},{name:"August Civic Public Holiday",variable_date:"firstAugustMonday"},{name:"Labour Day",variable_date:"firstSeptemberMonday"},{name:"Thanksgiving",variable_date:"firstOctoberMonday",offset:7},{name:"Remembrance Day",fixed_date:[11,11]},{name:"Christmas Day",fixed_date:[12,25]},{name:"Boxing Day",fixed_date:[12,26]}]},"Prince Edward Island":{PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Islander Day",variable_date:"firstFebruaryMonday",offset:14},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Easter Monday",variable_date:"easter",offset:1},{name:"Victoria Day",variable_date:"victoriaDay"},{name:"Canada Day",variable_date:"canadaDay"},{name:"Civic Holiday",variable_date:"firstAugustMonday"},{name:"Gold Cup Parade Day",variable_date:"firstAugustMonday",offset:18},{name:"Labour Day",variable_date:"firstSeptemberMonday"},{name:"Thanksgiving",variable_date:"firstOctoberMonday",offset:7},{name:"Remembrance Day",fixed_date:[11,11]},{name:"Christmas Day",fixed_date:[12,25]},{name:"Boxing Day",fixed_date:[12,26]}]},Quebec:{PH:[{name:"Jour de l'an",fixed_date:[1,1]},{name:"Vendredi saint",variable_date:"easter",offset:-2},{name:"Lundi de Pâques",variable_date:"easter",offset:1},{name:"Journée nationale des patriotes",variable_date:"victoriaDay"},{name:"Fête nationale du Québec",fixed_date:[6,24]},{name:"Fête du Canada",variable_date:"canadaDay"},{name:"Fête du Travail",variable_date:"firstSeptemberMonday"},{name:"Jour de l'Action de grâce",variable_date:"firstOctoberMonday",offset:7},{name:"Noël",fixed_date:[12,25]}]},Saskatchewan:{PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Family Day",variable_date:"firstFebruaryMonday",offset:14},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Victoria Day",variable_date:"victoriaDay"},{name:"Canada Day",variable_date:"canadaDay"},{name:"Saskatchewan Day",variable_date:"firstAugustMonday"},{name:"Labour Day",variable_date:"firstSeptemberMonday"},{name:"Thanksgiving",variable_date:"firstOctoberMonday",offset:7},{name:"Remembrance Day",fixed_date:[11,11]},{name:"Christmas Day",fixed_date:[12,25]}]},Yukon:{PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Heritage Day",variable_date:"lastFebruarySunday",offset:-2},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Easter Monday",variable_date:"easter",offset:1},{name:"Victoria Day",variable_date:"victoriaDay"},{name:"Canada Day",variable_date:"canadaDay"},{name:"Discovery Day",variable_date:"firstAugustMonday",offset:14},{name:"Labour Day",variable_date:"firstSeptemberMonday"},{name:"Thanksgiving",variable_date:"firstOctoberMonday",offset:7},{name:"Remembrance Day",fixed_date:[11,11]},{name:"Christmas Day",fixed_date:[12,25]},{name:"Boxing Day",fixed_date:[12,26]}]}};S.PH,S.Alberta,S.Manitoba,S.Nunavut,S.Ontario,S.Quebec,S.Saskatchewan,S.Yukon;var I={PH:[{name:"Neujahrstag/Nouvel an/Capo d'anno",fixed_date:[1,1]},{name:"Berchtoldstag/2 janvier",fixed_date:[1,2],only_states:["Zürich","Bern","Luzern","Obwalden","Nidwalden","Glarus","Zug","Freiburg","Solothurn","Schaffhausen","Graubünden","Aargau","Thurgau","Waadt","Neuenburg","Genf","Jura","Sankt Gallen","Wallis"]},{name:"Heilige Drei Könige/Epifania",fixed_date:[1,6],only_states:["Uri","Schwyz","Graubünden","Tessin"]},{name:"Instauration de la République",fixed_date:[3,1],only_states:["Neuenburg"]},{name:"Josefstag/Saint-Joseph/San Giuseppe",fixed_date:[3,19],only_states:["Luzern","Uri","Schwyz","Nidwalden","Zug","Graubünden","Tessin","Wallis"]},{name:"Karfreitag/Vendredi saint",variable_date:"easter",offset:-2,only_states:["Zürich","Bern","Luzern","Uri","Schwyz","Obwalden","Nidwalden","Glarus","Zug","Freiburg","Solothurn","Basel-Stadt","Basel-Landschaft","Schaffhausen","Appenzell Ausserrhoden","Appenzell Innerrhoden","Sankt Gallen","Graubünden","Aargau","Thurgau","Waadt","Neuenburg","Genf","Jura"]},{name:"Ostermontag/Lundi de Pâques/Lunedi di Pasqua",variable_date:"easter",offset:1,only_states:["Zürich","Bern","Luzern","Uri","Schwyz","Obwalden","Nidwalden","Glarus","Zug","Freiburg","Solothurn","Basel-Stadt","Basel-Landschaft","Schaffhausen","Appenzell Ausserrhoden","Appenzell Innerrhoden","Sankt Gallen","Graubünden","Aargau","Thurgau","Tessin","Waadt","Neuenburg","Genf","Jura","Wallis"]},{name:"Tag der Arbeit/Festa dei lavoratori",fixed_date:[5,1],only_states:["Zürich","Freiburg","Solothurn","Basel-Stadt","Basel-Landschaft","Schaffhausen","Aargau","Thurgau","Tessin","Neuenburg","Jura"]},{name:"Auffahrt/Ascension/Ascensione",variable_date:"easter",offset:39},{name:"Pfingstmontag/Lundi de Pentecôte/Lunedi di Pentecoste",variable_date:"easter",offset:50,only_states:["Zürich","Bern","Luzern","Uri","Schwyz","Obwalden","Nidwalden","Glarus","Zug","Freiburg","Solothurn","Basel-Stadt","Basel-Landschaft","Schaffhausen","Appenzell Ausserrhoden","Appenzell Innerrhoden","Sankt Gallen","Graubünden","Aargau","Thurgau","Tessin","Waadt","Neuenburg","Genf","Jura","Wallis"]},{name:"Fronleichnam/Fête-Dieu/Corpus domini",variable_date:"easter",offset:60,only_states:["Luzern","Uri","Schwyz","Obwalden","Nidwalden","Zug","Freiburg","Solothurn","Basel-Landschaft","Appenzell Innerrhoden","Graubünden","Aargau","Tessin","Wallis","Neuenburg","Jura"]},{name:"Commémoration du plébiscite jurassien",fixed_date:[6,23],only_states:["Jura"]},{name:"San Pietro e Paolo",fixed_date:[6,29],only_states:["Tessin"]},{name:"Bundesfeiertag/Jour de la fête nationale/Giorno festivo federale",fixed_date:[8,1]},{name:"Mariä Himmelfahrt/Assomption/Assunzione",fixed_date:[8,15],only_states:["Luzern","Uri","Schwyz","Obwalden","Nidwalden","Zug","Freiburg","Solothurn","Basel-Landschaft","Appenzell Innerrhoden","Graubünden","Aargau","Tessin","Wallis","Jura"]},{name:"Mauritiustag",fixed_date:[9,22],only_states:["Appenzell Innerrhoden"]},{name:"Bruderklausenfest",fixed_date:[9,25],only_states:["Obwalden"]},{name:"Allerheiligen/Toussaint/Ognissanti",fixed_date:[11,1],only_states:["Luzern","Uri","Schwyz","Obwalden","Nidwalden","Glarus","Zug","Freiburg","Solothurn","Appenzell Innerrhoden","Sankt Gallen","Graubünden","Aargau","Tessin","Wallis","Jura"]},{name:"Mariä Empfängnis/Immaculée Conception/Ognissanti",fixed_date:[12,8],only_states:["Luzern","Uri","Schwyz","Obwalden","Nidwalden","Zug","Freiburg","Solothurn","Appenzell Innerrhoden","Graubünden","Aargau","Tessin","Wallis"]},{name:"Weihnachtstag/Noël/Natale",fixed_date:[12,25]},{name:"Stephanstag/Saint-Etienne/Santo Stefano",fixed_date:[12,26],only_states:["Zürich","Bern","Luzern","Uri","Schwyz","Obwalden","Nidwalden","Glarus","Zug","Freiburg","Solothurn","Basel-Stadt","Basel-Landschaft","Schaffhausen","Appenzell Ausserrhoden","Appenzell Innerrhoden","Sankt Gallen","Graubünden","Aargau","Thurgau","Tessin","Wallis"]},{name:"Restauration de la République",fixed_date:[12,31],only_states:["Genf"]}],Aargau:{_state_code:"ag"},"Appenzell Ausserrhoden":{_state_code:"ar"},"Appenzell Innerrhoden":{_state_code:"ai"},"Basel-Landschaft":{_state_code:"bl"},"Basel-Stadt":{_state_code:"bs"},Bern:{_state_code:"be"},Freiburg:{_state_code:"fr"},Genf:{_state_code:"ge"},Glarus:{_state_code:"gl"},Graubünden:{_state_code:"gr"},Jura:{_state_code:"ju"},Luzern:{_state_code:"lu"},Neuenburg:{_state_code:"ne"},Nidwalden:{_state_code:"nw"},Obwalden:{_state_code:"ow"},Schaffhausen:{_state_code:"sh"},Schwyz:{_state_code:"sz"},Solothurn:{_state_code:"so"},"Sankt Gallen":{_state_code:"sg"},Tessin:{_state_code:"ti"},Thurgau:{_state_code:"tg"},Uri:{_state_code:"ur"},Waadt:{_state_code:"vd"},Wallis:{_state_code:"vs"},Zug:{_state_code:"zg"},Zürich:{_state_code:"zh"}};I.PH,I.Aargau,I.Bern,I.Freiburg,I.Genf,I.Glarus,I.Jura,I.Luzern,I.Neuenburg,I.Nidwalden,I.Obwalden,I.Schaffhausen,I.Schwyz,I.Solothurn,I.Tessin,I.Thurgau,I.Uri,I.Waadt,I.Wallis,I.Zug;var R={PH:[{name:"Fête du 1ᵉʳ janvier",fixed_date:[1,1]},{name:"Lundi de Pâques",variable_date:"easter",offset:1},{name:"Fête du travail",fixed_date:[5,1]},{name:"Lendemain de la Fête du travail",variable_date:"nextMo-Sa01May"},{name:"Jour de l’Ascension",variable_date:"easter",offset:39},{name:"Lundi de la Pentecôte",variable_date:"easter",offset:50},{name:"Fête nationale",fixed_date:[8,7]},{name:"Lendemain de la Fête nationale",variable_date:"nextMo-Sa07August"},{name:"Fête de l’Assomption",fixed_date:[8,15]},{name:"Fête de la Toussaint",fixed_date:[11,1]},{name:"Journée Nationale de la Paix",fixed_date:[11,15]},{name:"Fête de Noël",fixed_date:[12,25]},{name:"Lendemain de la Fête de Noël",variable_date:"nextMo-Sa25December"}]};R.PH;var G={PH:[{name:"Den obnovy samostatného českého státu",fixed_date:[1,1]},{name:"Velký pátek",variable_date:"easter",offset:-2},{name:"Velikonoční pondělí",variable_date:"easter",offset:1},{name:"Svátek práce",fixed_date:[5,1]},{name:"Den vítězství",fixed_date:[5,8]},{name:"Den slovanských věrozvěstů Cyrila a Metoděje",fixed_date:[7,5]},{name:"Den upálení mistra Jana Husa",fixed_date:[7,6]},{name:"Den české státnosti",fixed_date:[9,28]},{name:"Den vzniku samostatného československého státu",fixed_date:[10,28]},{name:"Den boje za svobodu a demokracii",fixed_date:[11,17]},{name:"Štědrý den",fixed_date:[12,24]},{name:"1. svátek vánoční",fixed_date:[12,25]},{name:"2. svátek vánoční",fixed_date:[12,26]}]};G.PH;var Y={PH:[{name:"Neujahrstag",fixed_date:[1,1]},{name:"Heilige Drei Könige",fixed_date:[1,6],only_states:["Baden-Württemberg","Bayern","Sachsen-Anhalt"]},{name:"Frauentag",fixed_date:[3,8],only_states:["Berlin"]},{name:"Tag der Arbeit",fixed_date:[5,1]},{name:"Karfreitag",variable_date:"easter",offset:-2},{name:"Ostersonntag",variable_date:"easter",only_states:["Brandenburg"]},{name:"Ostermontag",variable_date:"easter",offset:1},{name:"Christi Himmelfahrt",variable_date:"easter",offset:39},{name:"Pfingstsonntag",variable_date:"easter",offset:49,only_states:["Brandenburg"]},{name:"Pfingstmontag",variable_date:"easter",offset:50},{name:"Fronleichnam",variable_date:"easter",offset:60,only_states:["Baden-Württemberg","Bayern","Hessen","Nordrhein-Westfalen","Rheinland-Pfalz","Saarland"]},{name:"Mariä Himmelfahrt",fixed_date:[8,15],only_states:["Saarland"]},{name:"Weltkindertag",fixed_date:[9,20],only_states:["Thüringen"]},{name:"Tag der Deutschen Einheit",fixed_date:[10,3]},{name:"Reformationstag",fixed_date:[10,31],only_states:["Brandenburg","Bremen","Hamburg","Mecklenburg-Vorpommern","Niedersachsen","Sachsen","Sachsen-Anhalt","Schleswig-Holstein","Thüringen"]},{name:"Allerheiligen",fixed_date:[11,1],only_states:["Baden-Württemberg","Bayern","Nordrhein-Westfalen","Rheinland-Pfalz","Saarland"]},{name:"Buß- und Bettag",variable_date:"nextWednesday16Nov",only_states:["Sachsen"]},{name:"1. Weihnachtstag",fixed_date:[12,25]},{name:"2. Weihnachtstag",fixed_date:[12,26]}],"Baden-Württemberg":{_state_code:"bw",SH:[{2012:[4,2,4,13],2013:[3,25,4,5],2014:[4,14,4,25],2015:[3,30,4,10],2016:[3,24,3,24,3,29,4,2],2017:[4,10,4,21],2018:[3,26,4,6],2019:[4,15,4,27],2020:[4,6,4,18],name:"Osterferien"},{2012:[5,29,6,9],2013:[5,21,6,1],2014:[6,10,6,21],2015:[5,26,6,6],2016:[5,17,5,28],2017:[6,6,6,16],2018:[5,22,6,2],2019:[6,11,6,21],2020:[6,2,6,13],name:"Pfingstferien"},{2012:[7,26,9,8],2013:[7,25,9,7],2014:[7,31,9,13],2015:[7,30,9,12],2016:[7,28,9,10],2017:[7,27,9,9],2018:[7,26,9,8],2019:[7,29,9,10],2020:[7,30,9,12],2021:[7,29,9,11],2022:[7,28,9,10],2023:[7,27,9,9],2024:[7,25,9,7],name:"Sommerferien"},{2012:[10,29,11,2],2013:[10,28,10,30],2014:[10,27,10,30],2015:[10,31,10,31,11,2,11,6],2016:[10,31,10,31,11,2,11,4],2017:[10,30,11,3],2018:[10,29,11,2],2019:[10,28,10,30],name:"Herbstferien"},{2011:[12,23,1,5],2012:[12,24,1,5],2013:[12,23,1,4],2014:[12,22,1,5],2015:[12,23,1,9],2016:[12,23,1,7],2017:[12,22,1,5],2018:[12,24,1,5],2019:[12,23,1,4],name:"Weihnachtsferien"}]},Bayern:{_state_code:"by",SH:[{2012:[2,20,2,24],2013:[2,11,2,15],2014:[3,3,3,7],2015:[2,16,2,20],2016:[2,8,2,12],2017:[2,27,3,3],2018:[2,12,2,16],2019:[3,4,3,8],2020:[2,24,2,28],2021:[2,15,2,19],2022:[2,28,3,4],2023:[2,20,2,24],2024:[2,12,2,16],name:"Winterferien"},{2012:[4,2,4,14],2013:[3,25,4,6],2014:[4,14,4,26],2015:[3,30,4,11],2016:[3,21,4,1],2017:[4,10,4,22],2018:[3,26,4,7],2019:[4,15,4,27],2020:[4,6,4,18],2021:[3,29,4,10],2022:[4,11,4,23],2023:[4,3,4,15],2024:[3,25,4,6],name:"Osterferien"},{2012:[5,29,6,9],2013:[5,21,5,31],2014:[6,10,6,21],2015:[5,26,6,5],2016:[5,17,5,28],2017:[6,6,6,16],2018:[5,22,6,2],2019:[6,11,6,21],2020:[6,2,6,13],2021:[5,25,6,4],2022:[6,7,6,18],2023:[5,30,6,9],2024:[5,21,6,1],name:"Pfingstferien"},{2012:[8,1,9,12],2013:[7,31,9,11],2014:[7,30,9,15],2015:[8,1,9,14],2016:[7,30,9,12],2017:[7,29,9,11],2018:[7,30,9,10],2019:[7,29,9,9],2020:[7,27,9,7],2021:[7,30,9,13],2022:[8,1,9,12],2023:[7,31,9,11],2024:[7,29,9,9],name:"Sommerferien"},{2012:[10,29,11,3],2013:[10,28,10,31],2014:[10,27,10,31,11,19,11,19],2015:[11,2,11,7,11,18,11,18],2016:[10,31,11,4,11,16,11,16],2017:[10,30,11,3,11,22,11,22],2018:[10,29,11,2,11,21,11,21],2019:[10,28,10,31,11,20,11,20],2020:[10,31,11,6,11,18,11,18],2021:[11,2,11,5,11,17,11,17],2022:[10,31,11,4,11,16,11,16],2023:[10,30,11,3,11,22,11,22],name:"Herbstferien"},{2011:[12,27,1,5],2012:[12,24,1,5],2013:[12,23,1,4],2014:[12,24,1,5],2015:[12,24,1,5],2016:[12,24,1,5],2017:[12,23,1,5],2018:[12,22,1,5],2019:[12,23,1,4],2020:[12,23,1,9],2021:[12,24,1,8],2022:[12,24,1,7],2023:[12,23,1,5],name:"Weihnachtsferien"}]},Berlin:{_state_code:"be",SH:[{2012:[1,30,2,4],2013:[2,4,2,9],2014:[2,3,2,8],2015:[2,2,2,7],2016:[2,1,2,6],2017:[1,30,2,3],2018:[2,5,2,10],2019:[2,4,2,9],2020:[2,3,2,8],2021:[2,1,2,6],2022:[1,29,2,5],2023:[1,30,2,4],2024:[2,5,2,10],name:"Winterferien"},{2012:[4,2,4,14,4,30,4,30],2013:[3,25,4,6],2014:[4,14,4,26,5,2,5,2],2015:[3,30,4,11],2016:[3,21,4,2],2017:[4,10,4,18],2018:[3,26,4,6],2019:[4,15,4,26],2020:[4,6,4,17],2021:[3,29,4,10],2022:[4,11,4,23],2023:[4,3,4,14],2024:[3,25,4,5],name:"Osterferien"},{2012:[5,18,5,18],2013:[5,10,5,10,5,21,5,21],2014:[5,30,5,30],2015:[5,15,5,15,5,26,5,26],2016:[5,6,5,6,5,17,5,18],2017:[5,24,5,24,5,26,5,26,6,6,6,9],2018:[4,30,4,30,5,11,5,11,5,22,5,22],2019:[5,31,5,31,6,11,6,11],2020:[5,22,5,22],2021:[5,14,5,14],2022:[5,27,5,27,6,7,6,7],2023:[5,19,5,19,5,30,5,30],2024:[5,10,5,10],name:"Pfingstferien"},{2012:[6,20,8,3],2013:[6,19,8,2],2014:[7,9,8,22],2015:[7,16,8,28],2016:[7,21,9,2],2017:[7,20,9,1],2018:[7,5,8,17],2019:[6,20,8,2],2020:[6,25,8,7],2021:[6,24,8,6],2022:[7,7,8,19],2023:[7,13,8,25],2024:[7,18,8,30],name:"Sommerferien"},{2012:[10,1,10,13],2013:[9,30,10,12],2014:[10,20,11,1],2015:[10,19,10,31],2016:[10,17,10,28],2017:[10,2,10,2,10,23,11,4],2018:[10,22,11,2],2019:[10,4,10,4,10,7,10,19],2020:[10,12,10,24],2021:[10,11,10,23],2022:[10,24,11,5],2023:[10,2,10,2,10,23,11,4],name:"Herbstferien"},{2011:[12,23,1,3],2012:[12,24,1,4],2013:[12,23,1,3],2014:[12,22,1,2],2015:[12,23,1,2],2016:[12,23,1,3],2017:[12,21,1,2],2018:[12,22,1,5],2019:[12,23,1,4],2020:[12,21,1,2],2021:[12,23,12,31],2022:[12,22,1,2],2023:[12,23,1,5],name:"Weihnachtsferien"}]},Brandenburg:{_state_code:"bb",SH:[{2012:[1,30,2,4],2013:[2,4,2,9],2014:[2,3,2,8],2015:[2,2,2,7],2016:[2,1,2,6],2017:[1,30,2,4],2018:[2,5,2,10],2019:[2,4,2,9],2020:[2,3,2,8],2021:[2,1,2,6],2022:[1,31,2,5],2023:[1,30,2,3],2024:[2,5,2,9],name:"Winterferien"},{2012:[4,4,4,14,4,30,4,30],2013:[3,27,4,6],2014:[4,16,4,26,5,2,5,2],2015:[4,1,4,11],2016:[3,23,4,2],2017:[4,10,4,22],2018:[3,26,4,6],2019:[4,15,4,26],2020:[4,6,4,17],2021:[3,29,4,9],2022:[4,11,4,23],2023:[4,3,4,14],2024:[3,25,4,5],name:"Osterferien"},{2012:[5,18,5,18],2013:[5,10,5,10],2014:[5,30,5,30],2015:[5,15,5,15],2016:[5,6,5,6,5,17,5,17],2017:[5,26,5,26],2018:[4,30,4,30,5,11,5,11],2019:[5,31,5,31],2020:[5,22,5,22],2021:[5,14,5,14],2022:[5,27,5,27],2023:[5,19,5,19],2024:[5,10,5,10],name:"Pfingstferien"},{2012:[6,21,8,3],2013:[6,20,8,2],2014:[7,10,8,22],2015:[7,16,8,28],2016:[7,21,9,3],2017:[7,20,9,1],2018:[7,5,8,18],2019:[6,20,8,3],2020:[6,25,8,8],2021:[6,24,8,7],2022:[7,7,8,20],2023:[7,13,8,26],2024:[7,18,8,31],name:"Sommerferien"},{2012:[10,1,10,13],2013:[9,30,10,12,11,1,11,1],2014:[10,20,11,1],2015:[10,19,10,30],2016:[10,17,10,28],2017:[10,2,10,2,10,23,11,4],2018:[10,22,11,2],2019:[10,4,10,18,11,1,11,1],2020:[10,12,10,24],2021:[10,11,10,23],2022:[10,24,11,5],2023:[10,2,10,2,10,23,11,4],name:"Herbstferien"},{2011:[12,23,1,3],2012:[12,24,1,4],2013:[12,23,1,3],2014:[12,22,1,2],2015:[12,23,1,2],2016:[12,23,1,3],2017:[12,21,1,2],2018:[12,21,1,5],2019:[12,23,1,3],2020:[12,21,1,2],2021:[12,23,12,31],2022:[12,22,1,3],2023:[12,23,1,5],name:"Weihnachtsferien"}]},Bremen:{_state_code:"hb",SH:[{2012:[1,30,1,31],2013:[1,31,2,1],2014:[1,30,1,31],2015:[2,2,2,3],2016:[1,28,1,29],2017:[1,30,1,31],2018:[2,1,2,2],2019:[1,31,2,1],2020:[2,3,2,4],2021:[2,1,2,2],2022:[1,31,2,1],2023:[1,30,1,31],2024:[2,1,2,2],name:"Winterferien"},{2012:[3,26,4,11,4,30,4,30],2013:[3,16,4,2],2014:[4,3,4,22,5,2,5,2],2015:[3,25,4,10],2016:[3,18,4,2],2017:[4,10,4,22],2018:[3,19,4,3],2019:[4,6,4,23],2020:[3,28,4,14],2021:[3,27,4,10],2022:[4,4,4,19],2023:[3,27,4,11],2024:[3,18,4,2],name:"Osterferien"},{2012:[5,18,5,18,5,29,5,29],2013:[5,10,5,10,5,21,5,21],2014:[5,30,5,30,6,10,6,10],2015:[5,15,5,15,5,26,5,26],2016:[5,6,5,6,5,17,5,17],2017:[5,26,5,26,6,6,6,6],2018:[4,30,4,30,5,11,5,11,5,22,5,22],2019:[5,31,5,31,6,11,6,11],2020:[5,22,5,22,6,2,6,2],2021:[5,14,5,14,5,25,5,25],2022:[5,27,5,27,6,7,6,7],2023:[5,19,5,19,5,30,5,30],2024:[5,10,5,10,5,21,5,21],name:"Pfingstferien"},{2012:[7,23,8,31],2013:[6,27,8,7],2014:[7,31,9,10],2015:[7,23,9,2],2016:[6,23,8,3],2017:[6,22,8,2],2018:[6,28,8,8],2019:[7,4,8,14],2020:[7,16,8,26],2021:[7,22,9,1],2022:[7,14,8,24],2023:[7,6,8,16],2024:[6,24,8,2],name:"Sommerferien"},{2012:[10,22,11,3],2013:[10,4,10,18],2014:[10,27,11,8],2015:[10,19,10,31],2016:[10,4,10,15],2017:[10,2,10,14,10,30,10,30],2018:[10,1,10,13],2019:[10,4,10,18],2020:[10,12,10,24],2021:[10,18,10,30],2022:[10,17,10,29],2023:[10,2,10,2,10,16,10,28],name:"Herbstferien"},{2011:[12,23,1,4],2012:[12,24,1,5],2013:[12,23,1,3],2014:[12,22,1,5],2015:[12,23,1,6],2016:[12,21,1,6],2017:[12,22,1,6],2018:[12,24,1,4],2019:[12,21,1,6],2020:[12,23,1,8],2021:[12,23,1,8],2022:[12,23,1,6],2023:[12,23,1,5],name:"Weihnachtsferien"}]},Hamburg:{_state_code:"hh",SH:[{2012:[1,30,1,30],2013:[2,1,2,1],2014:[1,31,1,31],2015:[1,30,1,30],2016:[1,29,1,29],2017:[1,30,1,30],2018:[2,2,2,2],2019:[2,1,2,1],2020:[1,31,1,31],2021:[1,29,1,29],2022:[1,28,1,28],2023:[1,27,1,27],2024:[2,2,2,2],name:"Winterferien"},{2012:[3,5,3,16],2013:[3,4,3,15],2014:[3,3,3,14],2015:[3,2,3,13],2016:[3,7,3,18],2017:[3,6,3,17],2018:[3,5,3,16,4,30,4,30],2019:[3,4,3,15],2020:[3,2,3,13],2021:[3,1,3,12],2022:[3,7,3,18],2023:[3,6,3,17],2024:[3,18,3,28],name:"Osterferien"},{2012:[4,30,5,4,5,18,5,18],2013:[5,2,5,10],2014:[4,28,5,2,5,30,5,30],2015:[5,11,5,15],2016:[5,6,5,6,5,17,5,20],2017:[5,22,5,26],2018:[5,7,5,11],2019:[5,13,5,17,5,31,5,31],2020:[5,4,5,8],2021:[5,10,5,14],2022:[5,23,5,27],2023:[5,15,5,19],2024:[5,21,5,24],name:"Pfingstferien"},{2012:[6,21,8,1],2013:[6,20,7,31],2014:[7,10,8,20],2015:[7,16,8,26],2016:[7,21,8,31],2017:[7,20,8,30],2018:[7,5,8,15],2019:[6,27,8,7],2020:[6,25,8,5],2021:[6,24,8,4],2022:[7,7,8,17],2023:[7,13,8,23],2024:[7,18,8,28],name:"Sommerferien"},{2012:[10,1,10,12],2013:[9,30,10,11],2014:[10,13,10,24],2015:[10,19,10,30],2016:[10,17,10,28],2017:[10,2,10,2,10,16,10,27],2018:[10,1,10,12],2019:[10,4,10,18],2020:[10,5,10,16],2021:[10,4,10,15],2022:[10,10,10,21],2023:[10,2,10,2,10,16,10,27],name:"Herbstferien"},{2011:[12,27,1,6],2012:[12,21,1,4],2013:[12,19,1,3],2014:[12,22,1,6],2015:[12,21,1,1],2016:[12,27,1,6],2017:[12,22,1,5],2018:[12,20,1,4],2019:[12,23,1,3],2020:[12,21,1,4],2021:[12,23,1,4],2022:[12,23,1,6],2023:[12,22,1,5],name:"Weihnachtsferien"}]},Hessen:{_state_code:"he",SH:[{2012:[4,2,4,14],2013:[3,25,4,6],2014:[4,14,4,26],2015:[3,30,4,11],2016:[3,29,4,9],2017:[4,3,4,15],2018:[3,26,4,7],2019:[4,14,4,27],2020:[4,6,4,18],2021:[4,6,4,16],2022:[4,11,4,23],2023:[4,3,4,22],2024:[3,25,4,13],name:"Osterferien"},{2012:[7,2,8,10],2013:[7,8,8,16],2014:[7,28,9,5],2015:[7,27,9,4],2016:[7,18,8,26],2017:[7,3,8,11],2018:[6,25,8,3],2019:[7,1,8,9],2020:[7,6,8,14],2021:[7,19,8,27],2022:[7,25,9,2],2023:[7,24,9,1],2024:[7,15,8,23],name:"Sommerferien"},{2012:[10,15,10,27],2013:[10,14,10,26],2014:[10,20,11,1],2015:[10,19,10,31],2016:[10,17,10,29],2017:[10,9,10,21],2018:[10,1,10,13],2019:[9,30,10,12],2020:[10,5,10,17],2021:[10,11,10,23],2022:[10,24,10,29],2023:[10,23,10,28],name:"Herbstferien"},{2011:[12,21,1,6],2012:[12,24,1,12],2013:[12,23,1,11],2014:[12,22,1,10],2015:[12,23,1,9],2016:[12,22,1,7],2017:[12,24,1,13],2018:[12,24,1,12],2019:[12,23,1,11],2020:[12,21,1,9],2021:[12,23,1,8],2022:[12,22,1,7],2023:[12,27,1,13],name:"Weihnachtsferien"}]},"Mecklenburg-Vorpommern":{_state_code:"mv",SH:[{2012:[2,6,2,17],2013:[2,4,2,15],2014:[2,3,2,15],2015:[2,2,2,14],2016:[2,1,2,13],2017:[2,6,2,18],2018:[2,5,2,16],2019:[2,4,2,15],2020:[2,10,2,21],2021:[2,6,2,19],2022:[2,5,2,17],2023:[2,6,2,18],2024:[2,5,2,16],name:"Winterferien"},{2012:[4,2,4,11],2013:[3,25,4,3],2014:[4,14,4,23],2015:[3,30,4,8],2016:[3,21,3,30],2017:[4,10,4,19],2018:[3,26,4,4],2019:[4,15,4,24],2020:[4,6,4,15],2021:[3,29,4,7],2022:[4,11,4,20],2023:[4,3,4,12],2024:[3,25,4,3],name:"Osterferien"},{2012:[5,25,5,29],2013:[5,17,5,21],2014:[6,6,6,10],2015:[5,22,5,26],2016:[5,14,5,17],2017:[6,2,6,6],2018:[5,11,5,11,5,18,5,22],2019:[5,22,5,22,6,7,6,11],2020:[5,22,5,22,5,29,6,2],2021:[5,14,5,14,5,21,5,25],2022:[5,27,5,27,6,3,6,7],2023:[5,19,5,19,5,26,5,30],2024:[5,10,5,10,5,17,5,21],name:"Pfingstferien"},{2012:[6,23,8,4],2013:[6,22,8,3],2014:[7,14,8,23],2015:[7,20,8,29],2016:[7,25,9,3],2017:[7,24,9,2],2018:[7,9,8,18],2019:[7,1,8,10],2020:[6,22,8,1],2021:[6,21,7,31],2022:[7,4,8,13],2023:[7,17,8,26],2024:[7,22,8,31],name:"Sommerferien"},{2012:[10,1,10,5],2013:[10,14,10,19],2014:[10,20,10,25],2015:[10,24,10,30],2016:[10,24,10,28],2017:[10,2,10,2,10,23,10,30],2018:[10,8,10,13,11,1,11,2],2019:[10,4,10,4,10,7,10,12,11,1,11,1],2020:[10,5,10,10,11,2,11,3],2021:[10,2,10,9,11,1,11,2],2022:[10,10,10,14,11,1,11,2],2023:[10,9,10,14,10,30,10,30,11,1,11,1],name:"Herbstferien"},{2011:[12,23,1,3],2012:[12,21,1,4],2013:[12,23,1,3],2014:[12,22,1,2],2015:[12,21,1,2],2016:[12,22,1,2],2017:[12,21,1,3],2018:[12,24,1,5],2019:[12,23,1,4],2020:[12,21,1,2],2021:[12,22,12,31],2022:[12,22,1,2],2023:[12,21,1,3],name:"Weihnachtsferien"}]},Niedersachsen:{_state_code:"ni",SH:[{2012:[1,30,1,31],2013:[1,31,2,1],2014:[1,30,1,31],2015:[2,2,2,3],2016:[1,28,1,29],2017:[1,30,1,31],2018:[2,1,2,2],2019:[1,31,2,1],2020:[2,3,2,4],2021:[2,1,2,2],2022:[1,31,2,1],2023:[1,30,1,31],2024:[2,1,2,2],name:"Winterferien"},{2012:[3,26,4,11,4,30,4,30],2013:[3,16,4,2],2014:[4,3,4,22,5,2,5,2],2015:[3,25,4,10],2016:[3,18,4,2],2017:[4,10,4,22],2018:[3,19,4,3],2019:[4,8,4,23],2020:[3,30,4,14],2021:[3,29,4,9],2022:[4,4,4,19],2023:[3,27,4,11],2024:[3,18,4,2],name:"Osterferien"},{2012:[5,18,5,18,5,29,5,29],2013:[5,10,5,10,5,21,5,21],2014:[5,30,5,30,6,10,6,10],2015:[5,15,5,15,5,26,5,26],2016:[5,6,5,6,5,17,5,17],2017:[5,26,5,26,6,6,6,6],2018:[4,30,4,30,5,11,5,11,5,22,5,22],2019:[5,31,5,31,6,11,6,11],2020:[5,22,5,22,6,2,6,2],2021:[5,14,5,14,5,25,5,25],2022:[5,27,5,27,6,7,6,7],2023:[5,19,5,19,5,30,5,30],2024:[5,10,5,10,5,21,5,21],name:"Pfingstferien"},{2012:[7,23,8,31],2013:[6,27,8,7],2014:[7,31,9,10],2015:[7,23,9,2],2016:[6,23,8,3],2017:[6,22,8,2],2018:[6,28,8,8],2019:[7,4,8,14],2020:[7,16,8,26],2021:[7,22,9,1],2022:[7,14,8,24],2023:[7,6,8,16],2024:[6,24,8,2],name:"Sommerferien"},{2012:[10,22,11,3],2013:[10,4,10,18],2014:[10,27,11,8],2015:[10,19,10,31],2016:[10,4,10,15],2017:[10,2,10,13,10,30,10,30],2018:[10,1,10,12],2019:[10,4,10,18],2020:[10,12,10,23],2021:[10,18,10,29],2022:[10,17,10,28],2023:[10,2,10,2,10,16,10,27],name:"Herbstferien"},{2011:[12,23,1,4],2012:[12,24,1,5],2013:[12,23,1,3],2014:[12,22,1,5],2015:[12,23,1,6],2016:[12,21,1,6],2017:[12,22,1,5],2018:[12,24,1,4],2019:[12,23,1,6],2020:[12,23,1,8],2021:[12,23,1,7],2022:[12,23,1,6],2023:[12,27,1,5],name:"Weihnachtsferien"}]},"Nordrhein-Westfalen":{_state_code:"nw",SH:[{2012:[4,2,4,14],2013:[3,25,4,6],2014:[4,14,4,26],2015:[3,30,4,11],2016:[3,21,4,2],2017:[4,10,4,22],2018:[3,26,4,7],2019:[4,15,4,27],2020:[4,6,4,18],2021:[3,29,4,10],2022:[4,11,4,23],2023:[4,3,4,15],2024:[3,25,4,6],name:"Osterferien"},{2012:[5,29,5,29],2013:[5,21,5,21],2014:[6,10,6,10],2015:[5,26,5,26],2016:[5,17,5,17],2017:[6,6,6,6],2018:[5,22,5,25],2019:[6,11,6,11],2020:[6,2,6,2],2021:[5,25,5,25],2023:[5,30,5,30],2024:[5,21,5,21],name:"Pfingstferien"},{2012:[7,9,8,21],2013:[7,22,9,3],2014:[7,7,8,19],2015:[6,29,8,11],2016:[7,11,8,23],2017:[7,17,8,29],2018:[7,16,8,28],2019:[7,15,8,27],2020:[6,29,8,11],2021:[7,5,8,17],2022:[6,27,8,9],2023:[6,22,8,4],2024:[7,8,8,20],name:"Sommerferien"},{2012:[10,8,10,20],2013:[10,21,11,2],2014:[10,6,10,18],2015:[10,5,10,17],2016:[10,10,10,21],2017:[10,23,11,4],2018:[10,15,10,27],2019:[10,14,10,26],2020:[10,12,10,24],2021:[10,11,10,23],2022:[10,4,10,15],2023:[10,2,10,14],name:"Herbstferien"},{2011:[12,23,1,6],2012:[12,21,1,4],2013:[12,23,1,7],2014:[12,22,1,6],2015:[12,23,1,6],2016:[12,23,1,6],2017:[12,27,1,6],2018:[12,21,1,4],2019:[12,23,1,6],2020:[12,23,1,6],2021:[12,24,1,8],2022:[12,23,1,6],2023:[12,21,1,5],name:"Weihnachtsferien"}]},"Rheinland-Pfalz":{_state_code:"rp",SH:[{2019:[2,25,3,1],2020:[2,17,2,21],2022:[2,21,2,25],name:"Winterferien"},{2012:[3,29,4,13],2013:[3,20,4,5],2014:[4,11,4,25],2015:[3,26,4,10],2016:[3,18,4,1],2017:[4,10,4,21],2018:[3,26,4,6],2019:[4,23,4,30],2020:[4,9,4,17],2021:[3,29,4,6],2022:[4,13,4,22],2023:[4,3,4,6],2024:[3,25,4,2],name:"Osterferien"},{2021:[5,25,6,2],2023:[5,30,6,7],2024:[5,21,5,29],name:"Pfingstferien"},{2012:[7,2,8,10],2013:[7,8,8,16],2014:[7,28,9,5],2015:[7,27,9,4],2016:[7,18,8,26],2017:[7,3,8,11],2018:[6,25,8,3],2019:[7,1,8,9],2020:[7,6,8,14],2021:[7,19,8,27],2022:[7,25,9,2],2023:[7,24,9,1],2024:[7,15,8,23],name:"Sommerferien"},{2012:[10,1,10,12],2013:[10,4,10,18],2014:[10,20,10,31],2015:[10,19,10,30],2016:[10,10,10,21],2017:[10,2,10,13],2018:[10,1,10,12],2019:[9,30,10,11],2020:[10,12,10,23],2021:[10,11,10,22],2022:[10,17,10,31],2023:[10,16,10,27],name:"Herbstferien"},{2011:[12,22,1,6],2012:[12,20,1,4],2013:[12,23,1,7],2014:[12,22,1,7],2015:[12,23,1,8],2016:[12,22,1,6],2017:[12,22,1,9],2018:[12,20,1,4],2019:[12,23,1,6],2020:[12,21,12,31],2021:[12,23,12,31],2022:[12,23,1,2],2023:[12,27,1,5],name:"Weihnachtsferien"}]},Saarland:{_state_code:"sl",SH:[{2012:[2,20,2,25],2013:[2,11,2,16],2014:[3,3,3,8],2015:[2,16,2,21],2016:[2,8,2,13],2017:[2,27,3,4],2018:[2,12,2,17],2019:[2,25,3,5],2020:[2,17,2,25],2021:[2,15,2,19],2022:[2,21,3,1],2023:[2,20,2,24],2024:[2,12,2,16],name:"Winterferien"},{2012:[4,2,4,14],2013:[3,25,4,6],2014:[4,14,4,26],2015:[3,30,4,11],2016:[3,29,4,9],2017:[4,10,4,22],2018:[3,26,4,6],2019:[4,17,4,26],2020:[4,14,4,24],2021:[3,29,4,7],2022:[4,14,4,22],2023:[4,3,4,12],2024:[2,25,4,5],name:"Osterferien"},{2021:[5,25,5,28],2022:[6,7,6,10],2023:[5,30,6,2],2024:[5,21,5,24],name:"Pfingstferien"},{2012:[7,2,8,14],2013:[7,8,8,17],2014:[7,28,9,6],2015:[7,27,9,5],2016:[7,18,8,27],2017:[7,3,8,14],2018:[6,25,8,3],2019:[7,1,8,9],2020:[7,6,8,14],2021:[7,19,8,27],2022:[7,25,9,2],2023:[7,24,9,1],2024:[7,15,8,23],name:"Sommerferien"},{2012:[10,22,11,3],2013:[10,21,11,2],2014:[10,20,10,31],2015:[10,19,10,31],2016:[10,10,10,22],2017:[10,2,10,14],2018:[10,1,10,12],2019:[10,7,10,18],2020:[10,12,10,23],2021:[10,18,10,29],2022:[10,24,11,4],2023:[10,23,11,3],name:"Herbstferien"},{2011:[12,23,1,4],2012:[12,24,1,5],2013:[12,20,1,4],2014:[12,22,1,7],2015:[12,21,1,2],2016:[12,19,12,31],2017:[12,21,1,5],2018:[12,20,1,4],2019:[12,23,1,3],2020:[12,21,12,31],2021:[12,23,1,3],2022:[12,22,1,4],2023:[12,21,1,2],name:"Weihnachtsferien"}]},Sachsen:{_state_code:"sn",SH:[{2012:[2,13,2,25],2013:[2,4,2,15],2014:[2,17,3,1],2015:[2,9,2,21],2016:[2,8,2,20],2017:[2,13,2,24],2018:[2,12,2,23],2019:[2,18,3,2],2020:[2,10,2,22],2021:[2,8,2,20],2022:[2,12,2,26],2023:[2,13,2,24],2024:[2,12,2,23],name:"Winterferien"},{2012:[4,6,4,14],2013:[3,29,4,6],2014:[4,18,4,26],2015:[4,2,4,11],2016:[3,25,4,2],2017:[4,13,4,22],2018:[3,29,4,6],2019:[4,19,4,26],2020:[4,10,4,18],2021:[4,2,4,10],2022:[4,15,4,23],2023:[4,7,4,15],2024:[3,28,4,5],name:"Osterferien"},{2012:[5,18,5,18],2013:[5,10,5,10,5,18,5,22],2014:[5,30,5,30],2015:[5,15,5,15],2016:[5,6,5,6],2017:[5,26,5,26],2018:[5,11,5,11,5,19,5,22],2019:[5,31,5,31],2020:[5,22,5,22],2021:[5,14,5,14],2022:[5,27,5,27],2023:[5,19,5,19],2024:[5,10,5,10,5,18,5,21],name:"Pfingstferien"},{2012:[7,23,8,31],2013:[7,15,8,23],2014:[7,21,8,29],2015:[7,13,8,21],2016:[6,27,8,5],2017:[6,26,8,4],2018:[7,2,8,10],2019:[7,8,8,16],2020:[7,20,8,28],2021:[7,26,9,3],2022:[7,18,8,26],2023:[7,10,8,18],2024:[6,20,7,31],name:"Sommerferien"},{2012:[10,22,11,2],2013:[10,21,11,1],2014:[10,20,10,31],2015:[10,12,10,24],2016:[10,3,10,15],2017:[10,2,10,14,10,30,10,30],2018:[10,8,10,20],2019:[10,14,10,25],2020:[10,19,10,31],2021:[10,18,10,30],2022:[10,17,10,29],2023:[10,2,10,14,10,30,10,30],name:"Herbstferien"},{2011:[12,23,1,2],2012:[12,22,1,2],2013:[12,21,1,3],2014:[12,22,1,3],2015:[12,21,1,2],2016:[12,23,1,2],2017:[12,23,1,2],2018:[12,22,1,4],2019:[12,21,1,3],2020:[12,23,1,2],2021:[12,23,1,1],2022:[12,22,1,2],2023:[12,23,1,2],name:"Weihnachtsferien"}]},"Sachsen-Anhalt":{_state_code:"st",SH:[{2012:[2,4,2,11],2013:[2,1,2,8],2014:[2,1,2,12],2015:[2,2,2,14],2016:[2,1,2,10],2017:[2,4,2,11],2018:[2,5,2,9],2019:[2,11,2,15],2020:[2,10,2,14],2021:[2,8,2,13],2022:[2,12,2,19],2023:[2,6,2,11],2024:[2,5,2,10],name:"Winterferien"},{2012:[4,2,4,7],2013:[3,25,3,30],2014:[4,14,4,17],2015:[4,2,4,2],2016:[3,24,3,24],2017:[4,10,4,13],2018:[3,26,3,31,4,30,4,30],2019:[4,18,4,30],2020:[4,6,4,11],2021:[3,29,4,3],2022:[4,11,4,16],2023:[4,3,4,8],2024:[3,25,3,30],name:"Osterferien"},{2012:[5,18,5,25],2013:[5,10,5,18],2014:[5,30,6,7],2015:[5,15,5,23],2016:[5,6,5,14],2017:[5,26,5,26],2018:[5,11,5,19],2019:[5,31,6,1],2020:[5,18,5,30],2021:[5,10,5,22],2022:[5,23,5,28],2023:[5,15,5,19],2024:[5,21,5,24],name:"Pfingstferien"},{2012:[7,23,9,5],2013:[7,15,8,28],2014:[7,21,9,3],2015:[7,13,8,26],2016:[6,27,8,10],2017:[6,26,8,9],2018:[6,28,8,8],2019:[7,4,8,14],2020:[7,16,8,26],2021:[7,22,9,1],2022:[7,14,8,24],2023:[7,6,8,16],2024:[6,24,8,3],name:"Sommerferien"},{2012:[10,29,11,2],2013:[10,21,10,25],2014:[10,27,10,30],2015:[10,17,10,24],2016:[10,4,10,15],2017:[10,2,10,13,10,30,10,30],2018:[10,1,10,12],2019:[10,4,10,11,11,1,11,1],2020:[10,19,10,24],2021:[10,25,10,30],2022:[10,24,11,4],2023:[10,2,10,2,10,16,10,30],name:"Herbstferien"},{2011:[12,22,1,7],2012:[12,19,1,4],2013:[12,21,1,3],2014:[12,22,1,5],2015:[12,21,1,5],2016:[12,19,1,2],2017:[12,21,1,3],2018:[12,19,1,4],2019:[12,23,1,4],2020:[12,19,1,5],2021:[12,22,1,8],2022:[12,21,1,5],2023:[12,21,1,3],name:"Weihnachtsferien"}]},"Schleswig-Holstein":{_state_code:"sh",SH:[{2012:[3,30,4,13],2013:[3,25,4,9],2014:[4,16,5,2],2015:[4,1,4,17],2016:[3,24,4,9],2017:[4,7,4,21],2018:[3,29,4,13],2019:[4,4,4,18],2020:[3,30,4,17],2021:[4,1,4,16],2022:[4,4,4,16],2023:[4,6,4,22],2024:[4,2,4,19],name:"Osterferien"},{2012:[5,18,5,18],2013:[5,10,5,10],2014:[5,30,5,30],2015:[5,15,5,15],2016:[5,6,5,6],2017:[5,26,5,26],2018:[5,11,5,11],2019:[5,31,5,31],2020:[5,22,5,22],2021:[5,14,5,14],2022:[5,27,5,27],2023:[5,19,5,20],2024:[5,10,5,11],name:"Pfingstferien"},{2012:[6,25,8,4],2013:[6,24,8,3],2014:[7,14,8,23],2015:[7,20,8,29],2016:[7,25,9,3],2017:[7,24,9,2],2018:[7,9,8,18],2019:[7,1,8,10],2020:[6,29,8,8],2021:[6,21,7,31],2022:[7,4,8,13],2023:[7,17,8,26],2024:[7,22,8,31],name:"Sommerferien"},{2012:[10,4,10,19],2013:[10,4,10,18],2014:[10,13,10,25],2015:[10,19,10,31],2016:[10,17,10,29],2017:[10,16,10,27],2018:[10,1,10,19],2019:[10,4,10,18],2020:[10,5,10,17],2021:[10,4,10,16],2022:[10,10,10,21],2023:[10,16,10,27],name:"Herbstferien"},{2011:[12,23,1,6],2012:[12,24,1,5],2013:[12,23,1,6],2014:[12,22,1,6],2015:[12,21,1,6],2016:[12,23,1,6],2017:[12,21,1,6],2018:[12,21,1,4],2019:[12,23,1,6],2020:[12,21,1,6],2021:[12,23,1,8],2022:[12,23,1,7],2023:[12,27,1,6],name:"Weihnachtsferien"}]},Thüringen:{_state_code:"th",SH:[{2012:[2,6,2,11],2013:[2,18,2,23],2014:[2,17,2,22],2015:[2,2,2,7],2016:[2,1,2,6],2017:[2,6,2,11],2018:[2,5,2,9],2019:[2,11,2,15],2020:[2,10,2,14],2021:[2,8,2,13],2022:[2,12,2,19],2023:[2,13,2,17],2024:[2,12,2,16],name:"Winterferien"},{2012:[4,2,4,13],2013:[3,25,4,6],2014:[4,19,5,2],2015:[3,30,4,11],2016:[3,24,4,2],2017:[4,10,4,21],2018:[3,26,4,7],2019:[4,15,4,27],2020:[4,6,4,18],2021:[3,29,4,10],2022:[4,11,4,23],2023:[4,3,4,15],2024:[3,25,4,6],name:"Osterferien"},{2012:[5,25,5,29],2013:[5,10,5,10],2014:[5,30,5,30],2015:[5,15,5,15],2016:[5,6,5,6],2017:[5,26,5,26],2018:[5,11,5,11],2019:[5,31,5,31],2020:[5,22,5,22],2021:[5,14,5,14],2022:[5,27,5,27],2023:[5,19,5,19],2024:[5,10,5,10],name:"Pfingstferien"},{2012:[7,23,8,31],2013:[7,15,8,23],2014:[7,21,8,29],2015:[7,13,8,21],2016:[6,27,8,10],2017:[6,26,8,9],2018:[7,2,8,11],2019:[7,8,8,17],2020:[7,20,8,29],2021:[7,26,9,4],2022:[7,18,8,27],2023:[7,10,8,19],2024:[6,20,7,31],name:"Sommerferien"},{2012:[10,22,11,3],2013:[10,21,11,2],2014:[10,6,10,18],2015:[10,5,10,17],2016:[10,10,10,22],2017:[10,2,10,14],2018:[10,1,10,13],2019:[10,7,10,19],2020:[10,17,10,30],2021:[10,25,11,6],2022:[10,17,10,29],2023:[10,2,10,14],name:"Herbstferien"},{2011:[12,23,1,1],2012:[12,24,1,5],2013:[12,23,1,4],2014:[12,22,1,3],2015:[12,23,1,2],2016:[12,23,12,31],2017:[12,22,1,5],2018:[12,21,1,4],2019:[12,21,1,3],2020:[12,23,1,2],2021:[12,23,12,31],2022:[12,22,1,3],2023:[12,22,1,5],name:"Weihnachtsferien"}]}};Y.PH,Y.Bayern,Y.Berlin,Y.Brandenburg,Y.Bremen,Y.Hamburg,Y.Hessen,Y.Niedersachsen,Y.Saarland,Y.Sachsen;var X={PH:[{name:"Nytårsdag",fixed_date:[1,1]},{name:"Skærtorsdag",variable_date:"easter",offset:-3},{name:"Langfredag",variable_date:"easter",offset:-2},{name:"Påskedag",variable_date:"easter"},{name:"2. Påskedag",variable_date:"easter",offset:1},{name:"Store Bededag",variable_date:"easter",offset:26},{name:"Kristi Himmelfartsdag",variable_date:"easter",offset:39},{name:"Pinsedag",variable_date:"easter",offset:49},{name:"2. Pinsedag",variable_date:"easter",offset:50},{name:"Grundlovsdag",fixed_date:[6,5]},{name:"Juleaftensdag",fixed_date:[12,24]},{name:"Juledag",fixed_date:[12,25]},{name:"2. Juledag",fixed_date:[12,26]}]};X.PH;var oe={PH:[{name:"Cap d'Any",fixed_date:[1,1],only_states:["Cataluña"]},{name:"Año Nuevo",fixed_date:[1,1]},{name:"Reis",fixed_date:[1,6],only_states:["Cataluña"]},{name:"Epifanía del Señor",fixed_date:[1,6]},{name:"Día de Andalucía",fixed_date:[2,28],only_states:["Andalucía"]},{name:"Dia de les Illes Balears",fixed_date:[3,1],only_states:["Islas Baleares"]},{name:"Sant Josep",fixed_date:[3,19],only_states:["Comunidad Valenciana"]},{name:"San José",fixed_date:[3,19],only_states:["Murcia"]},{name:"Jueve Santo",variable_date:"easter",offset:-3,only_states:["Andalucía","Aragón","Castilla y León","Castilla-La Mancha","Canarias","Extremadura","Galicia","Islas Baleares","La Rioja","Comunidad de Madrid","Región de Murcia","Navarra","Asturias","País Vasco","Cantabria","Ceuta","Melilla"]},{name:"Divendres Sant",variable_date:"easter",offset:-2,only_states:["Cataluña","Comunidad Valenciana","Islas Baleares"]},{name:"Viernes Santo",variable_date:"easter",offset:-2},{name:"Dilluns de Pasqua Florida",variable_date:"easter",offset:1,only_states:["Cataluña","Comunidad Valenciana","Islas Baleares"]},{name:"Lunes de Pascua de Resurrección",variable_date:"easter",offset:1,only_states:["País Vasco","Navarra"]},{name:"Día de Aragón",fixed_date:[4,23],only_states:["Aragón"]},{name:"Día de Castilla y León",fixed_date:[4,23],only_states:["Castilla y León"]},{name:"Festa del Treball",fixed_date:[5,1],only_states:["Cataluña","Comunidad Valenciana","Islas Baleares"]},{name:"Fiesta del Trabajo",fixed_date:[5,1]},{name:"Fiesta de la Comunidad de Madrid",fixed_date:[5,2],only_states:["Comunidad de Madrid"]},{name:"Día das Letras Galegas",fixed_date:[5,2],only_states:["Galicia"]},{name:"Día de Canarias",fixed_date:[5,30],only_states:["Canarias"]},{name:"Día de la Región Castilla-La Mancha",fixed_date:[5,31],only_states:["Castilla-La Mancha"]},{name:"Día de la Región de Murcia",fixed_date:[6,9],only_states:["Región de Murcia"]},{name:"Día de la Rioja",fixed_date:[6,9],only_states:["La Rioja"]},{name:"San Antonio",fixed_date:[6,13],only_states:["Ceuta"]},{name:"Sant Joan",fixed_date:[6,24],only_states:["Cataluña"]},{name:"San Juan",fixed_date:[6,24],only_states:["Ceuta"]},{name:"Santiago Apóstol",fixed_date:[7,25],only_states:["Galicia"]},{name:"Santa María de África",fixed_date:[8,6],only_states:["Ceuta"]},{name:"l'Assumpció",fixed_date:[8,15],only_states:["Cataluña"]},{name:"Asunción de la Virgen",fixed_date:[8,15]},{name:"Día de Ceuta",fixed_date:[9,2],only_states:["Ceuta"]},{name:"Día de Asturias",fixed_date:[9,8],only_states:["Asturias"]},{name:"Día de Extremadura",fixed_date:[9,8],only_states:["Extremadura"]},{name:"Diada Nacional de Catalunya",fixed_date:[9,11],only_states:["Cataluña"]},{name:"Día de Cantabria",fixed_date:[9,17],only_states:["Cantabria"]},{name:"Día de Melilla",fixed_date:[9,15],only_states:["Melilla"]},{name:"Dia de la Comunitat Valenciana",fixed_date:[10,9],only_states:["Comunidad Valenciana"]},{name:"Festa Nacional d'Espanya",fixed_date:[10,12],only_states:["Cataluña"]},{name:"Fiesta Nacional de España",fixed_date:[10,12]},{name:"Euskadi Eguna",fixed_date:[10,25],only_states:["País Vasco"]},{name:"Tots Sants",fixed_date:[11,1],only_states:["Cataluña","Comunidad Valenciana","Islas Baleares"]},{name:"Todos los Santos",fixed_date:[11,1]},{name:"Día de la Constitución Española",fixed_date:[12,6]},{name:"La Puríssima",fixed_date:[12,8],only_states:["Cataluña","Comunidad Valenciana","Islas Baleares"]},{name:"La Immaculada Concepción",fixed_date:[12,8]},{name:"Nadal",fixed_date:[12,25],only_states:["Cataluña","Comunidad Valenciana","Islas Baleares"]},{name:"Natividad del Señor",fixed_date:[12,25]},{name:"Sant Esteve",fixed_date:[12,26],only_states:["Cataluña"]}],Andalucía:{_state_code:"an"},Aragón:{_state_code:"ar"},"Castilla y León":{_state_code:"cl"},"Castilla-La Mancha":{_state_code:"cm"},Canarias:{_state_code:"cn"},Cataluña:{_state_code:"ct"},Extremadura:{_state_code:"ex"},Galicia:{_state_code:"ga"},"Islas Baleares":{_state_code:"ib"},"La Rioja":{_state_code:"ri"},"Comunidad de Madrid":{_state_code:"md"},"Región de Murcia":{_state_code:"mc"},Navarra:{_state_code:"nc"},Asturias:{_state_code:"as"},"País Vasco":{_state_code:"pv"},Cantabria:{_state_code:"cb"},"Comunidad Valenciana":{_state_code:"vc"},Ceuta:{_state_code:"ce"},Melilla:{_state_code:"ml"}};oe.PH,oe.Canarias,oe.Extremadura,oe.Galicia,oe.Navarra,oe.Asturias,oe.Cantabria,oe.Ceuta,oe.Melilla;var Q={PH:[{name:"uudenvuodenpäivä - nyårsdagen",fixed_date:[1,1]},{name:"loppiainen - trettondedagen",fixed_date:[1,6]},{name:"pitkäperjantai - långfredagen",variable_date:"easter",offset:-2},{name:"pääsiäispäivä - påskdagen",variable_date:"easter"},{name:"toinen pääsiäispäivä - annandag påsk",variable_date:"easter",offset:1},{name:"vappu - första maj",fixed_date:[5,1]},{name:"helluntai - pingst",variable_date:"easter",offset:49},{name:"juhannuspäivä - midsommarafton",variable_date:"nextSaturday20Jun"},{name:"pyhäinpäivä - alla helgons dag",variable_date:"nextSaturday31Oct"},{name:"itsenäisyyspäivä - självständighetsdagen",fixed_date:[12,6]},{name:"joulupäivä - juldagen",fixed_date:[12,25]},{name:"toinen joulupäivä - annandag jul",fixed_date:[12,26]}]};Q.PH;var ce={PH:[{name:"Jour de l'an",fixed_date:[1,1]},{name:"Vendredi saint",variable_date:"easter",offset:-2,only_states:["Moselle","Bas-Rhin","Haut-Rhin","Guadeloupe","Martinique","Polynésie française"]},{name:"Lundi de Pâques",variable_date:"easter",offset:1},{name:"Abolition de l'esclavage (Mayotte)",fixed_date:[4,27],only_states:["Mayotte"]},{name:"Saint-Pierre-Chanel",fixed_date:[4,28],only_states:["Wallis-et-Futuna"]},{name:"Fête du Travail",fixed_date:[5,1]},{name:"Fête de la Victoire",fixed_date:[5,8]},{name:"Abolition de l'esclavage (Martinique)",fixed_date:[5,22],only_states:["Martinique"]},{name:"Abolition de l'esclavage (Guadeloupe)",fixed_date:[5,27],only_states:["Guadeloupe"]},{name:"Abolition de l'esclavage (Saint-Martin)",fixed_date:[5,28],only_states:["Saint-Martin (France)"]},{name:"Jeudi de l'Ascension",variable_date:"easter",offset:39},{name:"Lundi de Pentecôte",variable_date:"easter",offset:50},{name:"Abolition de l'esclavage (Guyane)",fixed_date:[6,10],only_states:["Guyane"]},{name:"Fête de l'autonomie",fixed_date:[6,29],only_states:["Polynésie française"]},{name:"Fête nationale",fixed_date:[7,14]},{name:"Fête Victor Schoelcher",fixed_date:[7,21],only_states:["Guadeloupe","Martinique"]},{name:"Fête du Territoire",fixed_date:[7,29],only_states:["Wallis-et-Futuna"]},{name:"Assomption",fixed_date:[8,15]},{name:"Fête de la citoyenneté",fixed_date:[9,24],only_states:["Nouvelle-Calédonie"]},{name:"Abolition de l'esclavage (Saint-Barthélemy)",fixed_date:[10,9],only_states:["Saint-Barthélemy"]},{name:"Toussaint",fixed_date:[11,1]},{name:"Armistice",fixed_date:[11,11]},{name:"Abolition de l'esclavage (Réunion)",fixed_date:[12,20],only_states:["Réunion"]},{name:"Noël",fixed_date:[12,25]},{name:"Saint-Étienne ",fixed_date:[12,26],only_states:["Moselle","Bas-Rhin","Haut-Rhin"]}],"Auvergne-Rhône-Alpes":{_state_code:"ara",SH:[{2018:[2,11,2,25],2019:[2,17,3,3],2020:[2,23,3,8],2021:[2,7,2,21],2022:[2,12,2,27],name:"Vacances d'Hiver"},{2018:[4,8,4,22],2019:[4,14,4,28],2020:[4,19,5,3],2021:[4,11,4,25],2022:[4,16,5,1],name:"Vacances de Printemps"},{2018:[5,10,5,10],2019:[5,30,6,2],2020:[5,21,5,24],2021:[5,14,5,16],2022:[5,26,5,27],name:"Pont de l'Ascension"},{2018:[7,8,9,2],2019:[7,7,9,1],2020:[7,5,8,31],2021:[7,5,9,1],2022:[7,7,8,31],name:"Vacances d'Été"},{2018:[10,21,11,4],2019:[10,20,11,3],2020:[10,18,11,1],2021:[10,24,11,7],2022:[10,22,11,6],name:"Vacances de la Toussaint"},{2018:[12,23,1,6],2019:[12,22,1,5],2020:[12,20,1,3],2021:[12,19,1,2],2022:[12,17,1,2],name:"Vacances de Noël"}]},"Bourgogne-Franche-Comté":{_state_code:"bfc",SH:[{2018:[2,11,2,25],2019:[2,17,3,3],2020:[2,23,3,8],2021:[2,7,2,21],2022:[2,12,2,27],name:"Vacances d'Hiver"},{2018:[4,8,4,22],2019:[4,14,4,28],2020:[4,19,5,3],2021:[4,11,4,25],2022:[4,16,5,1],name:"Vacances de Printemps"},{2018:[5,10,5,10],2019:[5,30,6,2],2020:[5,21,5,24],2021:[5,14,5,16],2022:[5,26,5,27],name:"Pont de l'Ascension"},{2018:[7,8,9,2],2019:[7,7,9,1],2020:[7,5,8,31],2021:[7,5,9,1],2022:[7,7,8,31],name:"Vacances d'Été"},{2018:[10,21,11,4],2019:[10,20,11,3],2020:[10,18,11,1],2021:[10,24,11,7],2022:[10,22,11,6],name:"Vacances de la Toussaint"},{2018:[12,23,1,6],2019:[12,22,1,5],2020:[12,20,1,3],2021:[12,19,1,2],2022:[12,17,1,2],name:"Vacances de Noël"}]},"Nouvelle-Aquitaine":{_state_code:"naq",SH:[{2018:[2,11,2,25],2019:[2,17,3,3],2020:[2,23,3,8],2021:[2,7,2,21],2022:[2,12,2,27],name:"Vacances d'Hiver"},{2018:[4,8,4,22],2019:[4,14,4,28],2020:[4,19,5,3],2021:[4,11,4,25],2022:[4,16,5,1],name:"Vacances de Printemps"},{2018:[5,10,5,10],2019:[5,30,6,2],2020:[5,21,5,24],2021:[5,14,5,16],2022:[5,26,5,27],name:"Pont de l'Ascension"},{2018:[7,8,9,2],2019:[7,7,9,1],2020:[7,5,8,31],2021:[7,5,9,1],2022:[7,7,8,31],name:"Vacances d'Été"},{2018:[10,21,11,4],2019:[10,20,11,3],2020:[10,18,11,1],2021:[10,24,11,7],2022:[10,22,11,6],name:"Vacances de la Toussaint"},{2018:[12,23,1,6],2019:[12,22,1,5],2020:[12,20,1,3],2021:[12,19,1,2],2022:[12,17,1,2],name:"Vacances de Noël"}]},Bretagne:{_state_code:"bre",SH:[{2018:[2,25,3,11],2019:[2,10,2,24],2020:[2,16,3,1],2021:[2,21,3,7],2022:[2,5,2,20],name:"Vacances d'Hiver"},{2018:[4,22,5,6],2019:[4,7,4,22],2020:[4,12,4,26],2021:[4,11,4,25],2022:[4,9,4,24],name:"Vacances de Printemps"},{2018:[5,10,5,10],2019:[5,30,6,2],2020:[5,21,5,24],2021:[5,14,5,16],2022:[5,26,5,27],name:"Pont de l'Ascension"},{2018:[7,8,9,2],2019:[7,7,9,1],2020:[7,5,8,31],2021:[7,7,9,1],2022:[7,7,8,31],name:"Vacances d'Été"},{2018:[10,21,11,4],2019:[10,20,11,3],2020:[10,18,11,1],2021:[10,24,11,7],2022:[10,22,11,6],name:"Vacances de la Toussaint"},{2018:[12,23,1,6],2019:[12,22,1,5],2020:[12,20,1,3],2021:[12,19,1,2],2022:[12,17,1,2],name:"Vacances de Noël"}]},"Centre-Val de Loire":{_state_code:"cvl",SH:[{2018:[2,25,3,11],2019:[2,10,2,24],2020:[2,16,3,1],2021:[2,21,3,7],2022:[2,5,2,20],name:"Vacances d'Hiver"},{2018:[4,22,5,6],2019:[4,7,4,22],2020:[4,12,4,26],2021:[4,11,4,25],2022:[4,9,4,24],name:"Vacances de Printemps"},{2018:[5,10,5,10],2019:[5,30,6,2],2020:[5,21,5,24],2021:[5,14,5,16],2022:[5,26,5,27],name:"Pont de l'Ascension"},{2018:[7,8,9,2],2019:[7,7,9,1],2020:[7,5,8,31],2021:[7,7,9,1],2022:[7,7,8,31],name:"Vacances d'Été"},{2018:[10,21,11,4],2019:[10,20,11,3],2020:[10,18,11,1],2021:[10,24,11,7],2022:[10,22,11,6],name:"Vacances de la Toussaint"},{2018:[12,23,1,6],2019:[12,22,1,5],2020:[12,20,1,3],2021:[12,19,1,2],2022:[12,17,1,2],name:"Vacances de Noël"}]},"Grand Est":{_state_code:"ges",SH:[{2018:[2,25,3,11],2019:[2,10,2,24],2020:[2,16,3,1],2021:[2,21,3,7],2022:[2,5,2,20],name:"Vacances d'Hiver"},{2018:[4,22,5,6],2019:[4,7,4,22],2020:[4,12,4,26],2021:[4,11,4,25],2022:[4,9,4,24],name:"Vacances de Printemps"},{2018:[5,10,5,10],2019:[5,30,6,2],2020:[5,21,5,24],2021:[5,14,5,16],2022:[5,26,5,27],name:"Pont de l'Ascension"},{2018:[7,8,9,2],2019:[7,7,9,1],2020:[7,5,8,31],2021:[7,7,9,1],2022:[7,7,8,31],name:"Vacances d'Été"},{2018:[10,21,11,4],2019:[10,20,11,3],2020:[10,18,11,1],2021:[10,24,11,7],2022:[10,22,11,6],name:"Vacances de la Toussaint"},{2018:[12,23,1,6],2019:[12,22,1,5],2020:[12,20,1,3],2021:[12,19,1,2],2022:[12,17,1,2],name:"Vacances de Noël"}]},"Hauts-de-France":{_state_code:"hdf",SH:[{2018:[2,25,3,11],2019:[2,10,2,24],2020:[2,16,3,1],2021:[2,21,3,7],2022:[2,5,2,20],name:"Vacances d'Hiver"},{2018:[4,22,5,6],2019:[4,7,4,22],2020:[4,12,4,26],2021:[4,11,4,25],2022:[4,9,4,24],name:"Vacances de Printemps"},{2018:[5,10,5,10],2019:[5,30,6,2],2020:[5,21,5,24],2021:[5,14,5,16],2022:[5,26,5,27],name:"Pont de l'Ascension"},{2018:[7,8,9,2],2019:[7,7,9,1],2020:[7,5,8,31],2021:[7,7,9,1],2022:[7,7,8,31],name:"Vacances d'Été"},{2018:[10,21,11,4],2019:[10,20,11,3],2020:[10,18,11,1],2021:[10,24,11,7],2022:[10,22,11,6],name:"Vacances de la Toussaint"},{2018:[12,23,1,6],2019:[12,22,1,5],2020:[12,20,1,3],2021:[12,19,1,2],2022:[12,17,1,2],name:"Vacances de Noël"}]},Normandie:{_state_code:"nor",SH:[{2018:[2,25,3,11],2019:[2,10,2,24],2020:[2,16,3,1],2021:[2,21,3,7],2022:[2,5,2,20],name:"Vacances d'Hiver"},{2018:[4,22,5,6],2019:[4,7,4,22],2020:[4,12,4,26],2021:[4,11,4,25],2022:[4,9,4,24],name:"Vacances de Printemps"},{2018:[5,10,5,10],2019:[5,30,6,2],2020:[5,21,5,24],2021:[5,14,5,16],2022:[5,26,5,27],name:"Pont de l'Ascension"},{2018:[7,8,9,2],2019:[7,7,9,1],2020:[7,5,8,31],2021:[7,7,9,1],2022:[7,7,8,31],name:"Vacances d'Été"},{2018:[10,21,11,4],2019:[10,20,11,3],2020:[10,18,11,1],2021:[10,24,11,7],2022:[10,22,11,6],name:"Vacances de la Toussaint"},{2018:[12,23,1,6],2019:[12,22,1,5],2020:[12,20,1,3],2021:[12,19,1,2],2022:[12,17,1,2],name:"Vacances de Noël"}]},"Pays de la Loire":{_state_code:"pdl",SH:[{2018:[2,25,3,11],2019:[2,10,2,24],2020:[2,16,3,1],2021:[2,21,3,7],2022:[2,5,2,20],name:"Vacances d'Hiver"},{2018:[4,22,5,6],2019:[4,7,4,22],2020:[4,12,4,26],2021:[4,11,4,25],2022:[4,9,4,24],name:"Vacances de Printemps"},{2018:[5,10,5,10],2019:[5,30,6,2],2020:[5,21,5,24],2021:[5,14,5,16],2022:[5,26,5,27],name:"Pont de l'Ascension"},{2018:[7,8,9,2],2019:[7,7,9,1],2020:[7,5,8,31],2021:[7,7,9,1],2022:[7,7,8,31],name:"Vacances d'Été"},{2018:[10,21,11,4],2019:[10,20,11,3],2020:[10,18,11,1],2021:[10,24,11,7],2022:[10,22,11,6],name:"Vacances de la Toussaint"},{2018:[12,23,1,6],2019:[12,22,1,5],2020:[12,20,1,3],2021:[12,19,1,2],2022:[12,17,1,2],name:"Vacances de Noël"}]},"Provence-Alpes-Côte d'Azur":{_state_code:"pac",SH:[{2018:[2,25,3,11],2019:[2,10,2,24],2020:[2,16,3,1],2021:[2,21,3,7],2022:[2,5,2,20],name:"Vacances d'Hiver"},{2018:[4,22,5,6],2019:[4,7,4,22],2020:[4,12,4,26],2021:[4,11,4,25],2022:[4,9,4,24],name:"Vacances de Printemps"},{2018:[5,10,5,10],2019:[5,30,6,2],2020:[5,21,5,24],2021:[5,14,5,16],2022:[5,26,5,27],name:"Pont de l'Ascension"},{2018:[7,8,9,2],2019:[7,7,9,1],2020:[7,5,8,31],2021:[7,7,9,1],2022:[7,7,8,31],name:"Vacances d'Été"},{2018:[10,21,11,4],2019:[10,20,11,3],2020:[10,18,11,1],2021:[10,24,11,7],2022:[10,22,11,6],name:"Vacances de la Toussaint"},{2018:[12,23,1,6],2019:[12,22,1,5],2020:[12,20,1,3],2021:[12,19,1,2],2022:[12,17,1,2],name:"Vacances de Noël"}]},"Île-de-France":{_state_code:"idf",SH:[{2018:[2,18,3,4],2019:[2,24,3,10],2020:[2,9,2,23],2021:[2,14,2,28],2022:[2,19,3,6],name:"Vacances d'Hiver"},{2018:[4,15,4,29],2019:[4,21,5,5],2020:[4,5,4,19],2021:[4,11,4,25],2022:[4,23,5,8],name:"Vacances de Printemps"},{2018:[5,10,5,10],2019:[5,30,6,2],2020:[5,21,5,24],2021:[5,14,5,16],2022:[5,26,5,28],name:"Pont de l'Ascension"},{2018:[7,8,9,2],2019:[7,7,9,1],2020:[7,5,8,31],2021:[7,7,9,1],2022:[7,7,8,31],name:"Vacances d'Été"},{2018:[10,21,11,4],2019:[10,20,11,3],2020:[10,18,11,1],2021:[10,24,11,7],2022:[10,22,11,6],name:"Vacances de la Toussaint"},{2018:[12,23,1,6],2019:[12,22,1,5],2020:[12,20,1,3],2021:[12,19,1,2],2022:[12,17,1,2],name:"Vacances de Noël"}]},Occitanie:{_state_code:"occ",SH:[{2018:[2,18,3,4],2019:[2,24,3,10],2020:[2,9,2,23],2021:[2,14,2,28],2022:[2,19,3,6],name:"Vacances d'Hiver"},{2018:[4,15,4,29],2019:[4,21,5,5],2020:[4,5,4,19],2021:[4,11,4,25],2022:[4,23,5,8],name:"Vacances de Printemps"},{2018:[5,10,5,10],2019:[5,30,6,2],2020:[5,21,5,24],2021:[5,14,5,16],2022:[5,26,5,28],name:"Pont de l'Ascension"},{2018:[7,8,9,2],2019:[7,7,9,1],2020:[7,5,8,31],2021:[7,7,9,1],2022:[7,7,8,31],name:"Vacances d'Été"},{2018:[10,21,11,4],2019:[10,20,11,3],2020:[10,18,11,1],2021:[10,24,11,7],2022:[10,22,11,6],name:"Vacances de la Toussaint"},{2018:[12,23,1,6],2019:[12,22,1,5],2020:[12,20,1,3],2021:[12,19,1,2],2022:[12,17,1,2],name:"Vacances de Noël"}]},Corse:{_state_code:"cor",SH:[{2018:[2,27,3,11],2019:[2,24,3,10],2020:[2,16,3,1],2021:[2,14,2,28],2022:[2,19,3,6],name:"Vacances d'Hiver"},{2018:[4,24,5,6],2019:[4,21,5,5],2020:[4,19,5,3],2021:[4,11,4,25],2022:[4,23,5,8],name:"Vacances de Printemps"},{2018:[5,10,5,10],2019:[5,30,6,2],2020:[5,21,5,24],2021:[5,14,5,16],name:"Pont de l'Ascension"},{2018:[7,11,9,4],2019:[7,7,9,2],2020:[7,5,8,31],2021:[7,8,8,30],2022:[7,8,8,31],name:"Vacances d'Été"},{2018:[10,24,11,4],2019:[10,20,11,3],2020:[10,18,11,1],name:"Vacances de la Toussaint"},{2018:[12,23,1,6],2019:[12,22,1,5],2020:[12,20,1,3],name:"Vacances de Noël"}]},Guadeloupe:{_state_code:"gua",SH:[{2018:[2,9,2,21],2019:[2,24,3,10],2020:[2,16,3,1],2021:[2,10,2,21],2022:[2,19,3,6],name:"Vacances de Carnaval"},{2018:[3,25,4,8],2019:[4,19,5,1],2020:[4,9,4,22],2021:[3,28,4,11],2022:[4,13,4,24],name:"Vacances de Pâques"},{2019:[5,30,6,2],2020:[5,21,5,24],2021:[5,28,5,29],2022:[5,27,5,27],name:"Pont de l'Ascension"},{2018:[7,7,9,3],2019:[7,7,9,1],2020:[7,5,8,31],2021:[7,6,8,30],2022:[7,7,8,31],name:"Grandes Vacances"},{2018:[10,21,11,4],2019:[10,20,11,3],2020:[10,18,11,2],name:"Vacances de la Toussaint"},{2018:[12,23,1,6],2019:[12,22,1,5],2020:[12,20,1,3],name:"Vacances de Noël"}]},"Saint-Martin (France)":{_state_code:"mf",SH:[{2018:[2,9,2,21],2019:[2,24,3,10],2020:[2,16,3,1],2021:[2,10,2,21],name:"Vacances de Carnaval"},{2018:[3,25,4,8],2019:[4,19,5,1],2020:[4,9,4,22],2021:[3,28,4,11],name:"Vacances de Pâques"},{2019:[5,30,6,2],2020:[5,21,5,24],2021:[5,25,5,27],name:"Pont de l'Ascension"},{2018:[7,7,9,3],2019:[7,7,9,1],2020:[7,5,8,31],2021:[7,6,8,30],name:"Grandes Vacances"},{2018:[10,21,11,4],2019:[10,20,11,3],2020:[10,18,11,2],name:"Vacances de la Toussaint"},{2018:[12,23,1,6],2019:[12,22,1,5],2020:[12,20,1,3],name:"Vacances de Noël"}]},"Saint-Barthélemy":{_state_code:"bl",SH:[{2018:[2,9,2,21],2019:[2,24,3,10],2020:[2,16,3,1],2021:[2,10,2,21],name:"Vacances de Carnaval"},{2018:[3,25,4,8],2019:[4,19,5,1],2020:[4,9,4,22],2021:[3,28,4,11],name:"Vacances de Pâques"},{2019:[5,30,6,2],2020:[5,21,5,24],name:"Pont de l'Ascension"},{2018:[7,7,9,3],2019:[7,7,9,1],2020:[7,5,8,31],2021:[7,6,8,30],name:"Grandes Vacances"},{2018:[10,21,11,4],2019:[10,20,11,3],2020:[10,18,11,2],name:"Vacances de la Toussaint"},{2018:[12,23,1,6],2019:[12,22,1,5],2020:[12,20,1,3],name:"Vacances de Noël"}]},Guyane:{_state_code:"guf",SH:[{2018:[2,11,2,25],2019:[2,24,3,10],2020:[2,16,3,1],2021:[2,14,2,28],2022:[2,19,3,6],name:"Vacances de Carnaval"},{2018:[3,30,4,15],2019:[4,19,5,1],2020:[4,10,4,26],2021:[4,2,4,18],2022:[4,14,5,1],name:"Vacances de Pâques"},{2019:[5,30,6,2],2020:[5,21,5,24],2021:[5,13,5,16],2022:[5,25,5,29],name:"Pont de l'Ascension"},{2018:[7,8,9,2],2019:[7,9,9,1],2020:[7,5,8,31],2021:[7,4,8,31],2022:[7,9,8,31],name:"Grandes Vacances"},{2018:[10,21,11,4],2019:[10,20,11,3],2020:[10,25,11,8],name:"Vacances de la Toussaint"},{2018:[12,23,1,5],2019:[12,22,1,5],2020:[12,20,1,3],name:"Vacances de Noël"}]},Martinique:{_state_code:"mtq",SH:[{2018:[2,8,2,18],2019:[2,24,3,10],2020:[2,23,3,8],2021:[2,7,2,21],2022:[2,19,3,6],name:"Vacances de Carnaval"},{2018:[3,25,4,8],2019:[4,14,4,28],2020:[4,5,4,19],2021:[3,28,4,11],2022:[4,9,4,24],name:"Vacances de Pâques"},{2018:[5,8,5,13],2019:[5,30,6,2],2020:[5,14,5,15],2022:[5,27,5,27],name:"Pont de l'Ascension"},{2018:[7,7,9,3],2019:[7,7,9,1],2020:[7,5,8,31],2021:[7,7,8,30],2022:[7,7,8,31],name:"Grandes Vacances"},{2018:[10,21,11,4],2019:[10,20,11,3],2020:[10,25,11,8],name:"Vacances de la Toussaint"},{2018:[12,23,1,5],2019:[12,22,1,5],2020:[12,20,1,3],name:"Vacances de Noël"}]},Mayotte:{_state_code:"may",SH:[{2018:[2,25,3,11],2019:[2,24,3,10],2020:[3,1,3,15],2021:[2,28,3,14],2022:[2,26,3,13],name:"Vacances de Carnaval"},{2018:[5,6,5,13],2019:[4,27,5,5],2020:[5,3,5,10],2021:[5,1,5,16],2022:[4,30,5,15],name:"Vacances de Pâques"},{2020:[5,21,5,24],name:"Pont de l'Ascension"},{2018:[7,8,8,22],2019:[7,7,8,22],2020:[7,5,8,23],2021:[7,7,8,22],2022:[7,6,8,23],name:"Grandes Vacances"},{2018:[10,7,10,21],2019:[10,13,10,27],2020:[10,11,10,25],name:"Vacances de la Toussaint"},{2018:[12,9,1,6],2019:[12,15,1,12],2020:[12,13,1,10],name:"Vacances de Noël"}]},"La Réunion":{_state_code:"lre",SH:[{2018:[3,11,3,25],2019:[3,10,3,24],2020:[3,8,3,22],2021:[3,7,3,21],2022:[3,12,3,27],name:"Vacances après 3ème période"},{2018:[5,6,5,16],2019:[5,8,5,19],2020:[5,1,5,13],2021:[5,5,5,16],2022:[5,14,5,29],name:"Vacances après 4ème période"},{2018:[7,8,8,16],2019:[7,7,8,15],2020:[7,8,8,15],2022:[7,9,8,15],name:"Vacances hiver austral"},{2018:[10,14,10,28],2019:[10,13,10,27],2020:[10,11,11,25],name:"Vacances après 1ère période"},{2018:[12,23,1,27],2019:[12,20,1,26],2020:[12,20,1,24],name:"Vacances été austral"}]},"Nouvelle-Calédonie":{_state_code:"nc",SH:[{2018:[4,7,4,15],2019:[4,6,4,14],2020:[4,4,4,13],2021:[4,3,4,18],2022:[4,2,4,16],name:"Vacances 1ère période"},{2018:[6,9,6,24],2019:[6,8,6,23],2020:[6,6,6,21],2021:[6,5,6,20],2022:[6,4,6,18],name:"Vacances 2ème période"},{2018:[8,11,8,26],2019:[8,10,8,25],2020:[8,8,8,23],2021:[8,7,8,22],2022:[8,6,8,20],name:"Vacances 3ème période"},{2018:[10,13,10,18],2019:[10,12,10,27],2020:[10,10,10,25],2021:[10,9,10,24],2022:[10,8,10,22],name:"Vacances 4ème période"},{2018:[12,15,2,17],2019:[12,14,2,16],2020:[12,18,2,14],2021:[12,18,2,13],2022:[12,17,2,12],name:"Vacances d'Été"}]},"Polynésie française":{_state_code:"pf",SH:[{2018:[2,18,2,25],2019:[2,17,2,24],2020:[2,16,2,23],2021:[2,21,2,28],2022:[2,19,2,27],2023:[2,19,2,26],name:"Vacances de février"},{2018:[3,30,4,15],2019:[4,7,4,22],2020:[3,29,4,13],2021:[4,6,4,18],2022:[4,2,4,18],2023:[4,2,4,16],name:"Vacances d'avril"},{2018:[5,20,5,27],2019:[5,26,6,2],2020:[5,17,5,24],2021:[5,25,5,30],2022:[5,21,5,29],2023:[5,21,5,27],name:"Vacances de mai"},{2018:[7,7,8,15],2019:[7,7,8,13],2020:[7,5,8,9],2021:[7,3,8,8],2022:[7,2,8,7],2023:[7,2,8,7],name:"Grandes Vacances"},{2018:[9,16,9,23],2019:[9,15,9,22],2020:[9,13,9,20],2021:[9,12,9,19],2022:[9,10,9,18],name:"Vacances de septembre"},{2018:[10,28,11,11],2019:[10,27,11,11],2020:[10,25,11,8],2021:[10,24,11,7],2022:[10,22,11,6],name:"Vacances d'octobre-novembre"},{2018:[12,16,1,13],2019:[12,15,1,12],2020:[12,13,1,10],2021:[12,12,1,9],2022:[12,10,1,8],name:"Vacances de Noël"}]},"Saint-Pierre-et-Miquelon":{_state_code:"pm",SH:[{2018:[2,24,3,11],2019:[2,16,3,3],2020:[2,22,3,8],2021:[2,19,3,7],name:"Vacances d'Hiver"},{2018:[4,28,5,13],2019:[4,20,5,5],2020:[4,18,5,3],2021:[4,24,5,9],2022:[4,15,5,1],name:"Vacances de Printemps"},{2020:[5,21,5,24],2021:[5,13,5,16],2022:[5,26,5,29],name:"Pont de l'Ascension"},{2018:[6,30,9,6],2019:[7,4,9,4],2020:[7,4,9,2],2021:[7,3,9,1],2022:[7,1,8,31],name:"Vacances d'Été"},{2018:[10,27,11,4],2019:[10,26,11,5],2020:[10,22,11,1],name:"Vacances de la Toussaint"},{2018:[12,22,1,6],2019:[12,21,1,5],2020:[12,19,1,3],name:"Vacances de Noël"}]},"Wallis-et-Futuna":{_state_code:"wf",SH:[{2018:[4,1,4,15],2019:[3,31,4,14],2020:[3,29,4,13],2021:[4,3,4,18],name:"Vacances 1ère période"},{2018:[6,8,6,24],2019:[6,9,6,23],2020:[6,5,6,21],2021:[6,5,6,20],name:"Vacances 2ème période"},{2018:[8,10,8,26],2019:[8,11,8,25],2020:[8,9,8,23],2021:[8,7,8,22],name:"Vacances 3ème période"},{2018:[10,14,10,28],2019:[10,13,10,27],2020:[10,11,10,25],2021:[10,9,10,24],name:"Vacances 4ème période"},{2018:[12,16,2,10],2019:[12,15,2,9],2020:[12,13,2,14],2021:[12,18,2,19],name:"Vacances d'Été"}]}};ce.PH,ce.Bretagne,ce.Normandie,ce.Occitanie,ce.Corse,ce.Guadeloupe,ce.Guyane,ce.Martinique,ce.Mayotte;var De={England:{PH:[{name:"New Year’s Day",fixed_date:[1,1]},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Easter Monday",variable_date:"easter",offset:1},{name:"Early May bank holiday",variable_date:"firstMayMonday"},{name:"Spring bank holiday",variable_date:"lastMayMonday"},{name:"Summer bank holiday",variable_date:"lastAugustMonday"},{name:"Christmas",fixed_date:[12,25]},{name:"Boxing Day",fixed_date:[12,26]}]},Wales:{PH:[{name:"New Year’s Day",fixed_date:[1,1]},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Easter Monday",variable_date:"easter",offset:1},{name:"Early May bank holiday",variable_date:"firstMayMonday"},{name:"Spring bank holiday",variable_date:"lastMayMonday"},{name:"Summer bank holiday",variable_date:"lastAugustMonday"},{name:"Christmas",fixed_date:[12,25]},{name:"Boxing Day",fixed_date:[12,26]}]}};De.England,De.Wales;var Oe={PH:[{name:"Πρωτοχρονιά",fixed_date:[1,1]},{name:"Θεοφάνια",fixed_date:[1,6]},{name:"Καθαρά Δευτέρα",variable_date:"orthodox easter",offset:-48},{name:"25η Μαρτίου",fixed_date:[3,25]},{name:"Μεγάλη Παρασκευή",variable_date:"orthodox easter",offset:-2},{name:"Πάσχα",variable_date:"orthodox easter",offset:0},{name:"Δευτέρα του Πάσχα",variable_date:"orthodox easter",offset:1},{name:"Πρωτομαγιά",fixed_date:[5,1]},{name:"Κοίμηση της Θεοτόκου",fixed_date:[8,15]},{name:"28η Οκτωβρίου",fixed_date:[10,28]},{name:"Χριστούγεννα",fixed_date:[12,25]},{name:"2η μέρα Χριστουγέννων",fixed_date:[12,26]}],SH:[{2019:[1,30,1,30],2020:[1,30,1,30],name:"Τριών Ιεραρχών"},{2019:[4,22,5,6],2020:[4,13,4,26],name:"Πάσχα"},{2019:[6,17,6,17],2020:[6,8,6,8],name:"Αγίου Πνεύματος"},{2019:[7,1,8,31],2020:[7,1,8,31],name:"Καλοκαίρι"},{2019:[11,17,11,17],name:"Πολυτεχνείο"},{2018:[12,24,1,7],2019:[12,24,1,7],2020:[12,24,1,7],name:"Χριστούγεννα"}]};Oe.PH,Oe.SH;var Pe={PH:[{name:"újév",fixed_date:[1,1]},{name:"az 1848-as forradalom ünnepe",fixed_date:[3,15]},{name:"nagypéntek",variable_date:"easter",offset:-2},{name:"húsvétvasárnap",variable_date:"easter"},{name:"húsvéthétfő",variable_date:"easter",offset:1},{name:"pünkösdvasárnap",variable_date:"easter",offset:49},{name:"pünkösdhétfő",variable_date:"easter",offset:50},{name:"a munka ünnepe",fixed_date:[5,1]},{name:"az államalapítás ünnepe",fixed_date:[8,20]},{name:"az 1956-os forradalom ünnepe",fixed_date:[10,23]},{name:"mindenszentek",fixed_date:[11,1]},{name:"karácsony",fixed_date:[12,25]},{name:"karácsony másnap",fixed_date:[12,26]}],SH:[{2015:[4,2,4,7],2016:[3,24,3,29],2017:[4,13,4,18],name:"tavaszi szünet"},{2015:[6,16,8,31],2016:[6,16,8,31],2017:[6,16,8,31],name:"nyári szünet"},{2014:[10,27,10,31],2015:[10,26,10,30],2016:[11,2,11,4],name:"őszi szünet"},{2014:[12,22,1,2],2015:[12,21,12,31],2016:[12,22,1,2],name:"téli szünet"}]};Pe.PH,Pe.SH;var Se={PH:[{name:"New Year’s Day",fixed_date:[1,1]},{name:"St Patrick’s Day",fixed_date:[3,17]},{name:"St Patrick’s Day",variable_date:"nextMo-Fr17March"},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Easter Monday",variable_date:"easter",offset:1},{name:"May Bank Holiday",variable_date:"firstMayMonday"},{name:"June Bank Holiday",variable_date:"firstJuneMonday"},{name:"August Bank Holiday",variable_date:"firstAugustMonday"},{name:"October Bank Holiday (Halloween)",variable_date:"lastOctoberMonday"},{name:"Christmas",fixed_date:[12,25]},{name:"St Stephen’s Day",fixed_date:[12,26]},{name:"Bank Holiday",fixed_date:[12,27]}]};Se.PH;var _e={PH:[{name:"Capodanno",fixed_date:[1,1]},{name:"Epifania",fixed_date:[1,6]},{name:"Liberazione dal nazifascismo (1945)",fixed_date:[4,25]},{name:"Pasqua",variable_date:"easter"},{name:"Lunedì di Pasqua",variable_date:"easter",offset:1},{name:"Festa del lavoro",fixed_date:[5,1]},{name:"Festa della Repubblica",fixed_date:[6,2]},{name:"Assunzione di Maria",fixed_date:[8,15]},{name:"Ognissanti",fixed_date:[11,1]},{name:"Immacolata Concezione",fixed_date:[12,8]},{name:"Natale di Gesù",fixed_date:[12,25]},{name:"Santo Stefano",fixed_date:[12,26]}]};_e.PH;var ze={PH:[{name:"Nieuwjaarsdag",fixed_date:[1,1]},{name:"Goede vrijdag",variable_date:"easter",offset:-2},{name:"Tweede Paasdag",variable_date:"easter",offset:1},{name:"Koningsdag",fixed_date:[4,27]},{name:"Bevrijdingsdag",fixed_date:[5,5]},{name:"Hemelvaartsdag",variable_date:"easter",offset:39},{name:"Tweede Pinksterdag",variable_date:"easter",offset:50},{name:"Eerste Kerstdag",fixed_date:[12,25]},{name:"Tweede Kerstdag",fixed_date:[12,26]}]};ze.PH;var Re={PH:[{name:"Nyttårsdag",fixed_date:[1,1]},{name:"Skjærtorsdag",variable_date:"easter",offset:-3},{name:"Langfredag",variable_date:"easter",offset:-2},{name:"Påskedag",variable_date:"easter"},{name:"2. Påskedag",variable_date:"easter",offset:1},{name:"1. Mai",fixed_date:[5,1]},{name:"Grunnlovsdagen",fixed_date:[5,17]},{name:"Kristi Himmelfartsdag",variable_date:"easter",offset:39},{name:"Pinsedag",variable_date:"easter",offset:49},{name:"2. Pinsedag",variable_date:"easter",offset:50},{name:"Juledag",fixed_date:[12,25]},{name:"2. Juledag",fixed_date:[12,26]}]};Re.PH;var Ye={PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Day after New Year's Day",fixed_date:[1,2]},{name:"Waitangi Day",fixed_date:[2,6]},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Easter Monday",variable_date:"easter",offset:1},{name:"Anzac Day",fixed_date:[4,25]},{name:"Queen's Birthday",variable_date:"firstJuneMonday"},{name:"Labour Day",variable_date:"firstOctoberMonday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Boxing Day",fixed_date:[12,26]}]};Ye.PH;var Xe={PH:[{name:"Nowy Rok",fixed_date:[1,1]},{name:"Święto Trzech Króli",fixed_date:[1,6]},{name:"Wielkanoc",variable_date:"easter"},{name:"Lany Poniedziałek - drugi dzień Wielkiej Nocy",variable_date:"easter",offset:1},{name:"Pierwszy Maja",fixed_date:[5,1]},{name:"Trzeci Maja",fixed_date:[5,3]},{name:"Zielone Świątki",variable_date:"easter",offset:49},{name:"Boże Ciało",variable_date:"easter",offset:60},{name:"Wniebowzięcie Najświętszej Maryi Panny",fixed_date:[8,15]},{name:"Wszystkich Świętych",fixed_date:[11,1]},{name:"Święto Niepodległości",fixed_date:[11,11]},{name:"pierwszy dzień Bożego Narodzenia",fixed_date:[12,25]},{name:"drugi dzień Bożego Narodzenia",fixed_date:[12,26]}]};Xe.PH;var si={PH:[{name:"Anul Nou",fixed_date:[1,1]},{name:"A doua zi de Anul Nou",fixed_date:[1,2]},{name:"Ziua Unirii Principatelor Române (Ziua Unirii)",fixed_date:[1,24]},{name:"Paștele ortodox",variable_date:"orthodox easter"},{name:"A doua zi de Paște ortodox",variable_date:"orthodox easter",offset:1},{name:"Ziua Muncii",fixed_date:[5,1]},{name:"Rusaliile",variable_date:"orthodox easter",offset:50},{name:"A doua zi de Rusalii",variable_date:"orthodox easter",offset:51},{name:"Adormirea Maicii Domnului",fixed_date:[8,15]},{name:"Sfântul Apostol Andrei",fixed_date:[11,30]},{name:"Ziua Națională (Ziua Marii Uniri)",fixed_date:[12,1]},{name:"Crăciunul",fixed_date:[12,25]},{name:"A doua zi de Crăciun",fixed_date:[12,26]}],SH:[{2015:[1,31,2,8],2016:[1,30,2,7],2021:[1,30,2,7],name:"Vacanţa intersemestrială"},{2015:[4,11,4,19],2016:[4,23,5,3],2021:[4,30,5,9],name:"Vacanța de primăvară"},{2015:[6,20,9,13],2016:[6,18,9,4],2021:[6,26,9,13],name:"Vacanța de vară"},{2014:[12,20,1,4],2015:[12,19,1,3],2020:[12,23,1,10],2021:[12,23,1,9],name:"Vacanța de iarnă"}]};si.PH,si.SH;var Bt={PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]}],Татарстан:{_state_code:"tatarstan",PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]},{name:"Ураза-байрам",fixed_date:[7,28]},{name:"День Республики Татарстан",fixed_date:[8,30]},{name:"Курбан-байрам",fixed_date:[10,4]},{name:"День Конституции Республики Татарстан",fixed_date:[11,6]}]},Башкортостан:{_state_code:"bashkortostan",PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]},{name:"Ураза-байрам",fixed_date:[7,28]},{name:"Курбан-байрам",fixed_date:[10,4]},{name:"День Республики Башкирии",fixed_date:[10,11]},{name:"День Конституции Башкортостана",fixed_date:[12,24]}]},Чувашия:{_state_code:"chuvashia",PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]},{name:"День Чувашской республики",fixed_date:[6,24]}]},"Республика Саха (Якутия)":{_state_code:"sakha",PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]},{name:"День Республики Саха",fixed_date:[4,27]},{name:"Ысыах",fixed_date:[6,23]},{name:"День государственности Республики Саха",fixed_date:[9,27]}]},Калмыкия:{_state_code:"kalmykia",PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]},{name:"Цаган Сар",fixed_date:[1,14]},{name:"День принятия Степного Уложения (Конституции) Республики Калмыкия",fixed_date:[4,5]},{name:"День рождения Будды Шакьямун",fixed_date:[6,6]},{name:"Зул",fixed_date:[12,15]},{name:"День памяти жертв депортации калмыцкого народа",fixed_date:[12,28]}]},"Республика Бурятия":{_state_code:"buryatia",PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]},{name:"Сагаалган",fixed_date:[1,14]}]},"Республика Карелия":{_state_code:"karelia",PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]},{name:"День Республики Карелия",fixed_date:[6,8]},{name:"День освобождения Карелии от фашистских захватчиков",fixed_date:[9,30]}]},"Приволжский федеральный округ":{_state_code:"udmurtia",PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]},{name:"День Государственности Удмуртской Республики",fixed_date:[5,31]}]},Адыгея:{_state_code:"adygea",PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]},{name:"Ураза-байрам",fixed_date:[7,28]},{name:"Курбан-байрам",fixed_date:[10,4]},{name:"День образования Республики Адыгея",fixed_date:[10,5]}]},Дагестан:{_state_code:"dagestan",PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]},{name:"День Конституции Республики Дагестан",fixed_date:[7,26]},{name:"Ураза-байрам",fixed_date:[7,28]},{name:"День единства народов Дагестана",fixed_date:[9,15]},{name:"Курбан-байрам",fixed_date:[10,4]}]},Ингушетия:{_state_code:"ingushetia",PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]},{name:"День образования Республики Ингушетия",fixed_date:[6,4]},{name:"Ураза-байрам",fixed_date:[7,28]},{name:"Курбан-байрам",fixed_date:[10,4]}]},"Карачаево-Черкесия":{_state_code:"karachay_cherkess",PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]},{name:"День возрождения карачаевского народа",fixed_date:[5,3]},{name:"Ураза-байрам",fixed_date:[7,28]},{name:"Курбан-байрам",fixed_date:[10,4]}]},Чечня:{_state_code:"chechnya",PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]},{name:"День мира в Чеченской Республике",fixed_date:[4,16]},{name:"Ураза-байрам",fixed_date:[7,28]},{name:"Курбан-байрам",fixed_date:[10,4]}]},"Кабардино-Балкария":{_state_code:"kabardino_balkaria",PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]},{name:"День возрождения балкарского народа",fixed_date:[3,28]},{name:"Черкесский день траура",fixed_date:[5,21]},{name:"Ураза-байрам",fixed_date:[7,28]},{name:"День государственности Кабардино-Балкарской Республики",fixed_date:[9,1]},{name:"Курбан-байрам",fixed_date:[10,4]}]},"Республика Алтай":{_state_code:"altai",PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]},{name:"Чага-Байрам",fixed_date:[1,14]}]},"Республика Тыва":{_state_code:"tuva",PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]},{name:"Народный праздник Шагаа",fixed_date:[1,14]},{name:"День Республики Тыва",fixed_date:[8,15]}]},"Саратовская область":{_state_code:"saratov",PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]},{name:"Радоница",fixed_date:[4,29]}]},"Брянская область":{_state_code:"bryansk",PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]},{name:"Радоница",fixed_date:[4,29]},{name:"День освобождения города Брянска",fixed_date:[9,17]}]},"Республика Коми":{_state_code:"komi",PH:[{name:"1. Новогодние каникулы",fixed_date:[1,1]},{name:"2. Новогодние каникулы",fixed_date:[1,2]},{name:"3. Новогодние каникулы",fixed_date:[1,3]},{name:"4. Новогодние каникулы",fixed_date:[1,4]},{name:"5. Новогодние каникулы",fixed_date:[1,5]},{name:"6. Новогодние каникулы",fixed_date:[1,6]},{name:"Рождество Христово",fixed_date:[1,7]},{name:"8. Новогодние каникулы",fixed_date:[1,8]},{name:"День защитника Отечества",fixed_date:[2,23]},{name:"Международный женский день",fixed_date:[3,8]},{name:"День Победы",fixed_date:[5,9]},{name:"Праздник Весны и Труда",fixed_date:[5,1]},{name:"День народного единства",fixed_date:[11,4]},{name:"День России",fixed_date:[6,12]},{name:"День Республики Коми",fixed_date:[8,22]}]}};Bt.PH;var bi={PH:[{name:"nyårsdagen",fixed_date:[1,1]},{name:"trettondedag jul",fixed_date:[1,6]},{name:"långfredagen",variable_date:"easter",offset:-2},{name:"påskdagen",variable_date:"easter"},{name:"annandag påsk",variable_date:"easter",offset:1},{name:"första maj",fixed_date:[5,1]},{name:"pingstdagen",variable_date:"easter",offset:49},{name:"nationaldagen",fixed_date:[6,6]},{name:"midsommardagen",variable_date:"nextSaturday20Jun"},{name:"alla helgons dag",variable_date:"nextSaturday31Oct"},{name:"juldagen",fixed_date:[12,25]},{name:"annandag jul",fixed_date:[12,26]}]};bi.PH;var Et={PH:[{name:"novo leto",fixed_date:[1,1]},{name:"Prešernov dan, slovenski kulturni praznik",fixed_date:[2,8]},{name:"velikonočna nedelja",variable_date:"easter"},{name:"velikonočni ponedeljek",variable_date:"easter",offset:1},{name:"dan upora proti okupatorju",fixed_date:[4,27]},{name:"praznik dela 1",fixed_date:[5,1]},{name:"praznik dela 2",fixed_date:[5,2]},{name:"binkoštna nedelja - binkošti",variable_date:"easter",offset:49},{name:"dan državnosti",fixed_date:[6,25]},{name:"Marijino vnebovzetje",fixed_date:[8,15]},{name:"dan reformacije",fixed_date:[10,31]},{name:"dan spomina na mrtve",fixed_date:[11,1]},{name:"božič",fixed_date:[12,25]},{name:"dan samostojnosti in enotnosti",fixed_date:[12,26]}]};Et.PH;var Vt={PH:[{name:"Deň vzniku Slovenskej republiky",fixed_date:[1,1]},{name:"Zjavenie Pána",fixed_date:[1,6]},{name:"Veľký piatok",variable_date:"easter",offset:-2},{name:"Veľkonočná nedeľa",variable_date:"easter"},{name:"Veľkonočný pondelok",variable_date:"easter",offset:1},{name:"Sviatok práce",fixed_date:[5,1]},{name:"Deň víťazstva nad fašizmom",fixed_date:[5,8]},{name:"Sviatok svätého Cyrila a Metoda",fixed_date:[7,5]},{name:"Výročie Slovenského národného povstania",fixed_date:[8,29]},{name:"Deň Ústavy Slovenskej republiky",fixed_date:[9,1]},{name:"Sviatok Panny Márie Sedembolestnej",fixed_date:[9,15]},{name:"Sviatok všetkých svätých",fixed_date:[11,1]},{name:"Deň boja za slobodu a demokraciu",fixed_date:[11,17]},{name:"Štedrý deň",fixed_date:[12,24]},{name:"Prvý sviatok vianočný",fixed_date:[12,25]},{name:"Druhý sviatok vianočný",fixed_date:[12,26]}]};Vt.PH;var Ki={PH:[{name:"Новий рік",fixed_date:[1,1]},{name:"Різдво",fixed_date:[1,7]},{name:"Міжнародний жіночий день",fixed_date:[3,8]},{name:"Великдень",variable_date:"orthodox easter",offset:1},{name:"День Праці 1",fixed_date:[5,1]},{name:"День Праці 2",fixed_date:[5,2]},{name:"День Перемоги",fixed_date:[5,9]},{name:"День Конституції України",fixed_date:[6,28]},{name:"День Незалежності України",fixed_date:[8,24]}]};Ki.PH;var zt={PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]}],Alabama:{_state_code:"al",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Robert E. Lee/Martin Luther King Birthday",variable_date:"firstJanuaryMonday",offset:14},{name:"George Washington/Thomas Jefferson Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Confederate Memorial Day",variable_date:"firstAprilMonday",offset:21},{name:"Jefferson Davis' Birthday",variable_date:"firstJuneMonday"}]},Alaska:{_state_code:"ak",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Seward's Day",variable_date:"lastMarchMonday"},{name:"Alaska Day",fixed_date:[10,18]}]},Arizona:{_state_code:"az",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Dr. Martin Luther King Jr./Civil Rights Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]}]},Arkansas:{_state_code:"ar",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Dr. Martin Luther King Jr. and Robert E. Lee's Birthdays",variable_date:"firstJanuaryMonday",offset:14},{name:"George Washington's Birthday and Daisy Gatson Bates Day",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Eve",fixed_date:[12,24]},{name:"Christmas Day",fixed_date:[12,25]}]},California:{_state_code:"ca",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"César Chávez Day",fixed_date:[3,31]}]},Colorado:{_state_code:"co",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]}]},Connecticut:{_state_code:"ct",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Lincoln's Birthday",fixed_date:[2,12]},{name:"Good Friday",variable_date:"easter",offset:-2}]},Delaware:{_state_code:"de",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Day After Thanksgiving",variable_date:"firstNovemberThursday",offset:22},{name:"Christmas Day",fixed_date:[12,25]},{name:"Good Friday",variable_date:"easter",offset:-2}]},"District of Columbia":{_state_code:"dc",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Emancipation Day",fixed_date:[4,16]}]},Florida:{_state_code:"fl",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Friday after Thanksgiving",variable_date:"firstNovemberThursday",offset:22},{name:"Christmas Day",fixed_date:[12,25]}]},Georgia:{_state_code:"ga",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Robert E. Lee's Birthday",variable_date:"firstNovemberThursday",offset:22},{name:"Washington's Birthday",fixed_date:[12,24]},{name:"Christmas Day",fixed_date:[12,25]},{name:"Confederate Memorial Day",variable_date:"lastAprilMonday"}]},Guam:{_state_code:"gu",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Guam Discovery Day",fixed_date:[3,5]},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Liberation Day",fixed_date:[7,21]},{name:"All Souls' Day",fixed_date:[11,2]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Lady of Camarin Day",fixed_date:[12,8]},{name:"Christmas Day",fixed_date:[12,25]}]},Hawaii:{_state_code:"hi",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Prince Jonah Kuhio Kalanianaole Day",fixed_date:[3,26]},{name:"Kamehameha Day",fixed_date:[6,11]},{name:"Statehood Day",variable_date:"firstAugustFriday",offset:14},{name:"Election Day",variable_date:"firstNovemberMonday",offset:1}]},Idaho:{_state_code:"id",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr.-Idaho Human Rights Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]}]},Illinois:{_state_code:"il",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Lincoln's Birthday",fixed_date:[2,12]},{name:"Casimir Pulaski Day",variable_date:"firstMarchMonday"},{name:"Election Day",variable_date:"firstNovemberMonday",offset:1}]},Indiana:{_state_code:"in",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Lincoln's Birthday",variable_date:"firstNovemberThursday",offset:22},{name:"Christmas Day",fixed_date:[12,25]},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Primary Election Day",variable_date:"firstMayMonday",offset:1},{name:"Election Day",variable_date:"firstNovemberMonday",offset:1}]},Iowa:{_state_code:"ia",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Lincoln's Birthday",fixed_date:[2,12]}]},Kansas:{_state_code:"ks",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]}]},Kentucky:{_state_code:"ky",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Eve",fixed_date:[12,24]},{name:"Christmas Day",fixed_date:[12,25]},{name:"New Year's Eve",fixed_date:[12,31]},{name:"Good Friday",variable_date:"easter",offset:-2}]},Louisiana:{_state_code:"la",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Mardi Gras",variable_date:"easter",offset:-47},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Election Day",variable_date:"firstNovemberMonday",offset:1}]},Maine:{_state_code:"me",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Patriots' Day",variable_date:"firstAprilMonday",offset:14}]},Maryland:{_state_code:"md",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Native American Heritage Day",variable_date:"firstNovemberThursday",offset:22},{name:"Christmas Day",fixed_date:[12,25]}]},Massachusetts:{_state_code:"ma",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Patriots' Day",variable_date:"firstAprilMonday",offset:14}]},Michigan:{_state_code:"mi",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Eve",fixed_date:[12,24]},{name:"Christmas Day",fixed_date:[12,25]},{name:"New Year's Eve",fixed_date:[12,31]}]},Minnesota:{_state_code:"mn",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]}]},Mississippi:{_state_code:"ms",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King's and Robert E. Lee's Birthdays",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Confederate Memorial Day",variable_date:"lastAprilMonday"}]},Missouri:{_state_code:"mo",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Truman Day",fixed_date:[5,8]}]},Montana:{_state_code:"mt",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Election Day",variable_date:"firstNovemberMonday",offset:1},{name:"Christmas Eve",fixed_date:[12,24]},{name:"New Year's Eve",fixed_date:[12,31]}]},Nebraska:{_state_code:"ne",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Arbor Day",variable_date:"lastAprilFriday"}]},Nevada:{_state_code:"nv",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Nevada Day",variable_date:"lastOctoberFriday"},{name:"Family Day",variable_date:"firstNovemberThursday",offset:22}]},"New Hampshire":{_state_code:"nh",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Civil Rights Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Day after Thanksgiving",variable_date:"firstNovemberThursday",offset:22},{name:"Christmas Day",fixed_date:[12,25]},{name:"Election Day",variable_date:"firstNovemberMonday",offset:1}]},"New Jersey":{_state_code:"nj",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Lincoln's Birthday",fixed_date:[2,12]},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Election Day",variable_date:"firstNovemberMonday",offset:1}]},"New Mexico":{_state_code:"nm",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Day after Thanksgiving",variable_date:"firstNovemberThursday",offset:22},{name:"Christmas Day",fixed_date:[12,25]}]},"New York":{_state_code:"ny",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Lincoln's Birthday",fixed_date:[2,12]},{name:"Election Day",variable_date:"firstNovemberMonday",offset:1}]},"North Carolina":{_state_code:"nc",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Day after Thanksgiving",variable_date:"firstNovemberThursday",offset:22},{name:"Christmas Eve",fixed_date:[12,24]},{name:"Christmas Day",fixed_date:[12,25]},{name:"Day after Christmas",fixed_date:[12,26]},{name:"Good Friday",variable_date:"easter",offset:-2}]},"North Dakota":{_state_code:"nd",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]}]},Ohio:{_state_code:"oh",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]}]},Oklahoma:{_state_code:"ok",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Day after Thanksgiving",variable_date:"firstNovemberThursday",offset:22},{name:"Christmas Day",fixed_date:[12,25]}]},Oregon:{_state_code:"or",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]}]},Pennsylvania:{_state_code:"pa",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Flag Day",fixed_date:[6,14]}]},"Puerto Rico":{_state_code:"pr",PH:[{name:"Día de Año Nuevo",fixed_date:[1,1]},{name:"Día de Reyes",fixed_date:[1,6]},{name:"Natalicio de Eugenio María de Hostos",variable_date:"firstJanuaryMonday",offset:7},{name:"Natalicio de Martin Luther King, Jr.",variable_date:"firstJanuaryMonday",offset:14},{name:"Día de los Presidentes",variable_date:"firstFebruaryMonday",offset:14},{name:"Día de la Abolición de Esclavitud",fixed_date:[3,22]},{name:"Viernes Santo",variable_date:"easter",offset:-2},{name:"Natalicio de José de Diego",variable_date:"firstAprilMonday",offset:14},{name:"Recordación de los Muertos de la Guerra",variable_date:"lastMayMonday"},{name:"Día de la Independencia",fixed_date:[7,4]},{name:"Constitución de Puerto Rico",fixed_date:[7,25]},{name:"Natalicio de Dr. José Celso Barbosa",fixed_date:[7,27]},{name:"Día del Trabajo",variable_date:"firstSeptemberMonday"},{name:"Día de la Raza Descubrimiento de América",variable_date:"firstOctoberMonday",offset:7},{name:"Día del Veterano",fixed_date:[11,11]},{name:"Día del Descubrimiento de Puerto Rico",fixed_date:[11,19]},{name:"Día de Acción de Gracias",variable_date:"firstNovemberThursday",offset:21},{name:"Noche Buena",fixed_date:[12,24]},{name:"Día de Navidad",fixed_date:[12,25]}]},"Rhode Island":{_state_code:"ri",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Victory Day",variable_date:"firstAugustMonday",offset:7}]},"South Carolina":{_state_code:"sc",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Confederate Memorial Day",fixed_date:[5,10]}]},"South Dakota":{_state_code:"sd",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Native American Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]}]},Tennessee:{_state_code:"tn",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Eve",fixed_date:[12,24]},{name:"Christmas Day",fixed_date:[12,25]},{name:"Good Friday",variable_date:"easter",offset:-2}]},Texas:{_state_code:"tx",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Friday after Thanksgiving",variable_date:"firstNovemberThursday",offset:22},{name:"Christmas Eve",fixed_date:[12,24]},{name:"Christmas Day",fixed_date:[12,25]},{name:"Day after Christmas",fixed_date:[12,26]}]},"United States Virgin Islands":{_state_code:"vi",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Virgin Islands-Puerto Rico Friendship Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Three Kings Day",fixed_date:[1,6]},{name:"Transfer Day",fixed_date:[3,31]},{name:"Holy Thursday",variable_date:"easter",offset:-3},{name:"Good Friday",variable_date:"easter",offset:-2},{name:"Easter Monday",variable_date:"easter",offset:1},{name:"Emancipation Day",fixed_date:[7,3]},{name:"Hurricane Supplication Day",variable_date:"firstJulyMonday",offset:21},{name:"Hurricane Thanksgiving",fixed_date:[10,25]},{name:"Liberty Day",fixed_date:[11,1]},{name:"Christmas Second Day",fixed_date:[12,26]},{name:"New Year's Eve",fixed_date:[12,31]}]},Utah:{_state_code:"ut",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Pioneer Day",fixed_date:[7,24]}]},Vermont:{_state_code:"vt",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Town Meeting Day",variable_date:"firstMarchTuesday"},{name:"Battle of Bennington",variable_date:"firstAugustMonday",offset:14}]},Virginia:{_state_code:"va",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Election Day",variable_date:"firstNovemberMonday",offset:1},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]}]},Washington:{_state_code:"wa",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]}]},"West Virginia":{_state_code:"wv",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"West Virginia Day",fixed_date:[6,20]},{name:"Lincoln's Day",variable_date:"firstNovemberThursday",offset:22}]},Wisconsin:{_state_code:"wi",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]},{name:"Primary Election Day",variable_date:"firstAugustTuesday",offset:7},{name:"Election Day",variable_date:"firstNovemberMonday",offset:1}]},Wyoming:{_state_code:"wy",PH:[{name:"New Year's Day",fixed_date:[1,1]},{name:"Martin Luther King, Jr. Day",variable_date:"firstJanuaryMonday",offset:14},{name:"Washington's Birthday",variable_date:"firstFebruaryMonday",offset:14},{name:"Memorial Day",variable_date:"lastMayMonday"},{name:"Independence Day",fixed_date:[7,4]},{name:"Labor Day",variable_date:"firstSeptemberMonday"},{name:"Columbus Day",variable_date:"firstOctoberMonday",offset:7},{name:"Veterans Day",fixed_date:[11,11]},{name:"Thanksgiving",variable_date:"firstNovemberThursday",offset:21},{name:"Christmas Day",fixed_date:[12,25]}]}};zt.PH,zt.Alabama,zt.Alaska,zt.Arizona,zt.Arkansas,zt.California,zt.Colorado,zt.Connecticut,zt.Delaware,zt.Florida,zt.Georgia,zt.Guam,zt.Hawaii,zt.Idaho,zt.Illinois,zt.Indiana,zt.Iowa,zt.Kansas,zt.Kentucky,zt.Louisiana,zt.Maine,zt.Maryland,zt.Massachusetts,zt.Michigan,zt.Minnesota,zt.Mississippi,zt.Missouri,zt.Montana,zt.Nebraska,zt.Nevada,zt.Ohio,zt.Oklahoma,zt.Oregon,zt.Pennsylvania,zt.Tennessee,zt.Texas,zt.Utah,zt.Vermont,zt.Virginia,zt.Washington,zt.Wisconsin,zt.Wyoming;var _t={PH:[{name:"Tết Dương Lịch",fixed_date:[1,1]},{name:"Ngày Quốc tế Phụ nữ",fixed_date:[3,8]},{name:"Ngày thành lập Đoàn Thanh niên Cộng sản Hồ Chí Minh",fixed_date:[3,26]},{name:"Ngày Quốc tế Thiếu nhi",fixed_date:[6,1]},{name:"Ngày Nhà giáo Việt Nam",fixed_date:[11,20]},{name:"Ngày Giải phóng miền Nam, Thống nhất Đất nước",fixed_date:[4,30]},{name:"Ngày Quốc tế lao động",fixed_date:[5,1]},{name:"Quốc Khánh",fixed_date:[9,2]},{name:"Lễ Giáng Sinh",fixed_date:[12,25]}]};_t.PH;var Dt={PH:[{name:"New Year",fixed_date:[1,1]}],SH:[{2020:[6,21,9,23],2021:[6,21,9,23],2022:[6,21,9,23],2023:[6,21,9,23],2024:[6,21,9,23],2025:[6,21,9,23],2026:[6,21,9,23],2027:[6,21,9,23],2028:[6,21,9,23],2029:[6,21,9,23],2030:[6,21,9,23],2031:[6,21,9,23],2032:[6,21,9,23],name:"Summer"}]};Dt.PH,Dt.SH;var Ft=Object.freeze({__proto__:null,ar:o,at:p,au:_,be:v,br:M,ca:S,ch:I,ci:R,cz:G,de:Y,dk:X,es:oe,fi:Q,fr:ce,gb:De,gr:Oe,hu:Pe,ie:Se,it:_e,nl:ze,no:Re,nz:Ye,pl:Xe,ro:si,ru:Bt,se:bi,si:Et,sk:Vt,ua:Ki,us:zt,vn:_t,xa:Dt}),oi={"assuming ok for ko":{daytime:"sunrise-sunset",spring:"Mar-May",summer:"Jun-Aug",autumn:"Sep-Nov",winter:"Dec-Feb",_:"-","=":"-",frühling:"Mar-May",frühjahr:"Mar-May",sommer:"Jun-Aug",herbst:"Sep-Nov",gesloten:"off",feestdag:"PH",feestdagen:"PH",m:"Mo",w:"We",f:"Fr",primavera:"Mar-May",estate:"Jun-Aug",autunno:"Sep-Nov",inverno:"Dec-Feb"},"please use English written ok for ko":{"(?:an )?feiertag(?:s|en?)?":"PH"},"please use off for ko":{"ruhetage?":"off",geschlossen:"off",geschl:"off",except:"off"},"please use ok for workday":{wd:"Mo-Fr","on work days?":"Mo-Fr","weekdays?":"Mo-Fr","werktags?":"Mo-Sa",vardagar:"Mo-Fr"},"omit hour keyword":{h:""},"omit ko":{season:"",hs:"",hrs:"",hours:"",uhr:"",geöffnet:"",zwischen:"",ist:"",durchgehend:"","öffnungszeit(?:en)?:?":""},"omit tag key":{"opening_hours\\s*=":""},"omit wrong keyword open end":{from:"",ab:"",von:""},"assuming open end for ko":{"(?:bis|till?|-|–)? ?(?:open ?end|late)":"+"},"please use ok for uncertainty":{"~":"-","～":"-"},"please use fallback rule":{otherwise:"||"},"please use ok for missing data":{"\\?":""},"please use ok for ko":{"→":"-","−":"-","—":"-",ー:"-",to:"-",до:"-",a:"-",as:"-",á:"-",ás:"-",às:"-",ate:"-","till?":"-",until:"-",through:"-",and:",","&":",","：":":","'":'"',always:"24/7","always open":"24/7","always closed":"closed",nonstop:"24/7","24x7":"24/7",anytime:"24/7","all day":"24/7",daily:"Mo-Su",everyday:"Mo-Su","every day":"Mo-Su","all days":"Mo-Su","7j/7":"Mo-Su","7/7":"Mo-Su","7days":"Mo-Su","7 days":"Mo-Su","7 days a week":"Mo-Su","7 days/week":"Mo-Su","24 hours 7 days a week":"24/7","24 hours":"00:00-24:00",midday:"12:00",midnight:"00:00","(?:public )?holidays?":"PH","(?:one )?day after public holiday":"PH +1 day","(?:one )?day before public holiday":"PH -1 day","school ?holidays?":"SH","weekends?":"Sa,Su",daylight:"sunrise-sunset","on(?:_| )?appointments?":'"on appointment"',"by(?:_| )?appointments?":'"by appointment"',"nach(?: |_)vereinbarung":'"Nach Vereinbarung"',"nach(?: |_)absprache":'"Nach Absprache"',bis:"-",täglich:"Mo-Su","(?:schul)?ferien":"SH","(?:an|nur)? ?sonn-?(?: und |/)feiertag(?:s|en?)?":"PH,Su",und:",",u:",",auch:",",fermé:"off",et:",",à:"-","jours fériés":"PH",sundown:"sunset",morgendämmerung:"dawn",abenddämmerung:"dusk",sonnenaufgang:"sunrise",sonnenuntergang:"sunset",ostern:"easter"},"please use English abbreviation ok for so":{so:"Su"},"please use English abbreviation ok for ko":{sun:"Su","sundays?":"Su",mon:"Mo","mondays?":"Mo","tues?":"Tu","tuesdays?":"Tu","weds?":"We","wednesdays?":"We",thu:"Th","thurs?":"Th","thursdays?":"Th",fri:"Fr","fridays?":"Fr",sat:"Sa","saturdays?":"Sa",son:"Su","sonn-":"Su","sonntags?":"Su","montags?":"Mo",di:"Tu","die?":"Tu","dienstags?":"Tu",mi:"We","mit?":"We","mittwochs?":"We","don?":"Th","donnerstags?":"Th",fre:"Fr","freitags?":"Fr",sam:"Sa","samstags?":"Sa",dim:"Su",dimanche:"Su","lun?":"Mo",lundi:"Mo",mardi:"Tu",mer:"We",mercredi:"We","jeu?":"Th",jeudi:"Th","ven?":"Fr",vendredi:"Fr",samedi:"Sa","zon?":"Su",zontag:"Su",zondag:"Su",maandag:"Mo",din:"Tu",dinsdag:"Tu","woe?":"We",woensdag:"We",donderdag:"Th","vri?":"Fr",vrijdag:"Fr","zat?":"Sa",zaterdag:"Sa",neděle:"Su",ne:"Su",pondělí:"Mo",po:"Mo",úterý:"Tu",út:"Tu",středa:"We",st:"We",čtvrtek:"Th",čt:"Th",pátek:"Fr",pá:"Fr",sobota:"Sa",martes:"Tu",miércoles:"We",jueves:"Th",viernes:"Fr",sábado:"Sa",domingo:"Su",lunes:"Mo",selasa:"Su",rabu:"Mo",kami:"Tu",jumat:"We",sabtu:"Th",minggu:"Fr",senin:"Sa",söndag:"Su",söndagar:"Su",måndag:"Mo",ma:"Mo",tisdag:"Tu",onsdag:"We",torsdag:"Th",fredag:"Fr",lördag:"Sa",lördagar:"Sa",niedziela:"Su",niedz:"Su",n:"Su",ndz:"Su",poniedziałek:"Mo",poniedzialek:"Mo",pon:"Mo",pn:"Mo",wtorek:"Tu",wt:"Tu",środa:"We",sroda:"We",śr:"We",sr:"We",czwartek:"Th",czw:"Th",cz:"Th",piątek:"Fr",piatek:"Fr",pt:"Fr",sob:"Sa",воскресенье:"Su",Вс:"Su","voskresen'ye":"Su",понедельник:"Mo",Пн:"Mo","ponedel'nik":"Mo",вторник:"Tu",vtornik:"Tu",среда:"We",sreda:"We",четверг:"Th",chetverk:"Th",пятница:"Fr",pyatnitsa:"Fr",суббота:"Sa",subbota:"Sa",søndag:"Su",mandag:"Mo",tirsdag:"Tu",lørdag:"Sa",dom:"Su","domenica?":"Su","domeniche?":"Su",lun:"Mo","lunedì?":"Mo","mar?":"Tu","martedì?":"Tu","mer?":"We","mercoledì?":"We",gio:"Th","giovedì?":"Th",ven:"Fr","venerdì?":"Fr",sab:"Sa","sabato?":"Sa",jänner:"Jan",january:"Jan",february:"Feb",march:"Mar",april:"Apr","june?":"Jun","july?":"Jul",august:"Aug",september:"Sep",sept:"Sep",october:"Oct",november:"Nov",december:"Dec",januar:"Jan",februar:"Feb","märz?":"Mar",maerz:"Mar",mai:"May",juni:"Jun",juli:"Jul",okt:"Oct",oktober:"Oct",dez:"Dec",dezember:"Dec",janvier:"Jan",février:"Feb",fév:"Feb",mars:"Mar",avril:"Apr",avr:"Apr",juin:"Jun",juillet:"Jul",août:"Aug",aoû:"Aug",septembre:"Sep",octobre:"Oct",novembre:"Nov",décembre:"Dec",januari:"Jan",februari:"Feb",maart:"Mar",mei:"May",augustus:"Aug",gennaio:"Jan",febbraio:"Feb",marzo:"Mar",aprile:"Apr","giugno?":"Jun","luglio?":"Jul",agosto:"Aug",settembre:"Sep",ottobre:"Oct",dicembre:"Dec"},"please use ok for similar looking ko":{оff:"off"},"please use 24 hours time for ko":{pm:"pm","p.m.":"pm",рм:"pm",am:"am","a.m.":"am",ам:"am"},"please use restriction comment time for ko":{damen:'open "Damen"',herren:'open "Herren"'},"please use ok for typographically correct":{"–":"-","„":'"',"“":'"',"”":'"',"«":'"',"»":'"',"‚":'"',"‘":'"',"’":'"',"「":'"',"」":'"',"『":'"',"』":'"'}},pi={"unexpected token":'Unexpected token: "{{token}}" This means that the syntax is not valid at that point or it is currently not supported.',"no string":"The value (first parameter) is not a string.",nothing:"The value contains nothing meaningful which can be parsed.","nothing useful":"This rule does not contain anything useful. Please remove this empty rule.","combine rules":'Separate rules detected each of which only consists of a time selector. These rules should be written as one rule by combining them using "{{ok}}".',"value ends with token":'The value ends with "{{token}}". Please either continue after "{{token}}" or remove "{{token}}".',"programmers joke":"Might it be possible that you are a programmer and adding a semicolon after each statement is hardwired in your muscle memory ;) ? The thing is that the semicolon in the opening_hours syntax is defined as rule separator. So for compatibility reasons you should omit this last semicolon.","interpreted as year":'The number {{number}} will be interpreted as year. This is probably not intended. Times can be specified as "12:00".',"rule before fallback empty":"Rule before fallback rule does not contain anything useful","hour min separator":'Please use ":" as hour/minute-separator',"warnings severity":'The parameter optional_conf_parm["warnings_severity"] must be an integer number between 0 and 7 (inclusive). Given {{severity}}, expected one of the following numbers: {{allowed}}.',"optional conf parm type":"The optional_conf_parm parameter is of unknown type. Given {{given}}","conf param tag key missing":'The optional_conf_parm["tag_key"] is missing, required by optional_conf_parm["map_value"].',"conf param mode invalid":'The optional_conf_parm["mode"] parameter is a invalid number. Gave {{given}}, expected one of the following numbers: {{allowed}}.',"conf param unknown type":'The optional_conf_parm["{{key}}"] parameter is of unknown type. Given {{given}}, expected {{expected}}.',"library bug":'An error occurred during evaluation of the value "{{value}}". Please file a bug report or pull request: {{url}}.{{message}}',"library bug PR only":'An error occurred during evaluation of the value "{{value}}". Please submit a pull request: {{url}}.{{message}}',"use multi":'You have used {{count}} {{part2}} Rules can be separated by ";".',"selector multi 2a":"{{what}} in one rule. You may only use one in one rule.","selector multi 2b":'not connected {{what}} in one rule. This is probably an error. Equal selector types can (and should) always be written in conjunction separated by comma. Example for time ranges "12:00-13:00,15:00-18:00". Example for weekdays "Mo-We,Fr".',"selector state":"state keywords",comments:"comments","holiday ranges":"holiday ranges",months:"months",weekdays:"weekdays",ranges:"ranges","default state":"This rule which changes the default state (which is closed) for all following rules is not the first rule. The rule will overwrite all previous rules. It can be legitimate to change the default state to open for example and then only specify for which times the facility is closed.",vague:'This rule is not very explicit because there is no time selector being used. A time selector is the part specifying hours when the object is opened, for example "10:00-19:00". Please add a time selector to this rule or use a comment to make it more explicit.',"empty comment":"You have used an empty comment. Please either write something in the comment or use the keyword unknown instead.",separator_for_readability:"You have used the optional symbol <separator_for_readability> in the wrong place. Please check the syntax specification to see where it could be used or remove it.","strange 24/7":'You used 24/7 in a way that is probably not interpreted as "24 hours 7 days a week". For correctness you might want to use "open" or "closed" for this rule and then write your exceptions which should achieve the same goal and is more clear e.g. "open; Mo 12:00-14:00 off".',"public holiday":'There was no PH (public holiday) specified. This is not very explicit.{{part2}} Please either append a "PH off" rule if the amenity is closed on all public holidays or use something like "Sa,Su,PH 12:00-16:00" to say that on Saturdays, Sundays and on public holidays the amenity is open 12:00-16:00. If the amenity is open everyday including public holidays then you can make this explicit by writing "Mo-Su,PH". If you are not certain try to find it out. If you can’t then do not add PH to the value and ignore this warning.',"public holiday part2":' Unfortunately the tag key (e.g. "opening_hours", or "lit") is unknown to opening_hours.js. This warning only applies to the key {{keys}}. If your value is for that key than read on. If not you can ignore the following.',"additional_rule_separator not used after time wrapping midnight":'This rule overwrites parts of the previous rule. This happens because normal rules apply to the whole day and overwrite any definition made by previous rules. You can make this rule an additional rule by using a "," instead of the normal ";" to separate the rules. Note that the overwriting can also be desirable in which case you can ignore this warning.',"additional rule which evaluates to closed":'This rule will be evaluated as closed but it was specified as additional rule. It should be specified as normal rule using ";" as rule separator. See https://wiki.openstreetmap.org/wiki/Key:opening_hours/specification#explain:rule_modifier:closed.',switched:'The selector "{{first}}" was switched with the selector "{{second}}" for readability and compatibility reasons.',"no colon after":'Please don’t use ":" after {{token}}.',"number -5 to 5":"Number between -5 and 5 (except 0) expected.","one weekday constraint":"You can not use more than one constrained weekday in a month range","range constrained weekdays":"You can not use a range of constrained weekdays in a month range",expected:'"{{symbol}}" expected.',"range zero":"You can not use {{type}} ranges with period equals zero.","period one year+":'Please don’t use {{type}} ranges with period equals one. If you want to express that a facility is open starting from a year without limit use "<year>+".',"period one":"Please don’t use {{type}} ranges with period equals one.","month 31":"The day for {{month}} must be between 1 and 31.","month 30":"Month {{month}} doesn't have 31 days. The last day of {{month}} is day 30.","month feb":"Month {{month}} either has 28 or 29 days (leap years).","point in time":"hyphen (-) or open end (+) in time range {{calc}}expected. For working with points in time, the mode for {{libraryname}} has to be altered. Maybe wrong tag?",calculation:"calculation","time range continue":"Time range does not continue as expected","period continue":'Time period does not continue as expected. Example "/01:30".',"time range mode":'{{libraryname}} is running in "time range mode". Found point in time.',"point in time mode":'{{libraryname}} is running in "points in time mode". Found time range.',"outside current day":"Time range starts outside of the current day","two midnights":"Time spanning more than two midnights not supported","without minutes":'Time range without minutes specified. Not very explicit! Please use this syntax instead "{{syntax}}".',"outside day":"Time range starts outside of the current day","zero calculation":'Adding zero in a variable time calculation does not change the variable time. Please omit the calculation (example: "sunrise-(sunset-00:00)").',"calculation syntax":"Calculation with variable time is not in the right syntax",missing:'Missing "{{symbol}}"',"(time)":"(time)","bad range":"Bad range: {{from}}-{{to}}","] or more numbers":'"]" or more numbers expected.',"additional rule no sense":'An additional rule does not make sense here. Just use a ";" as rule separator. See https://wiki.openstreetmap.org/wiki/Key:opening_hours/specification#explain:additional_rule_separator',"unexpected token weekday range":"Unexpected token in weekday range: {{token}}","max differ":"There should be no reason to differ more than {{maxdiffer}} days from a {{name}}. If so tell us …","adding 0":"Adding 0 does not change the date. Please omit this.","unexpected token holiday":"Unexpected token (holiday parser): {{token}}","no holiday definition":"There are no holidays ({{name}}) defined for country {{cc}}.","no holiday definition state":"There are no holidays ({{name}}) defined for country {{cc}} and state {{state}}.","no country code":"Country code missing which is needed to select the correct holidays (see README how to provide it)","no SH definition":"School holiday {{name}}not defined for the year {{year}}.","movable no formula":"Movable day {{name}} can not not be calculated. Please add the formula how to calculate it.","movable not in year":"The movable day {{name}} plus {{days}} days is not in the year of the movable day anymore. Currently not supported.","year range one year":'A year range in which the start year is equal to the end year does not make sense. Please remove the end year. E.g. "{{year}} May 23"',"year range reverse":"A year range in which the start year is greater than the end year does not make sense. Please turn it over.","year past":"The year is in the past.","unexpected token year range":"Unexpected token in year range: {{token}}","week range reverse":"You have specified a week range in reverse order or leaping over a year. This is (currently) not supported.","week negative":"You have specified a week date less then one. A valid week date range is 1-53.","week exceed":"You have specified a week date greater then 53. A valid week date range is 1-53.","week period less than 2":'You have specified a week period which is less than two. If you want to select the whole range from week {{weekfrom}} to week {{weekto}} then just omit the "/{{period}}".',"week period greater than 26":'You have specified a week period which is greater than 26. 26.5 is the half of the maximum 53 week dates per year so a week date period greater than 26 would only apply once per year. Please specify the week selector as "week {{weekfrom}}" if that is what you want to express.',"unexpected token week range":"Unexpected token in week range: {{token}}","unexpected token month range":"Unexpected token in month range: {{token}}","day range reverse":"Range in wrong order. From day is greater than to day.","open end":"Specified as open end. Closing time was guessed.","date parameter needed":"Date parameter needed.","assuming ok for ko":'Assuming "{{ok}}" for "{{ko}}".',"please use ok for ko":'Please use notation "{{ok}}" for "{{ko}}".',"please use ok for similar looking ko":'Please use notation "{{ok}}" for "{{ko}}". Those characters look very similar but are not the same!',"rant degree sign used for zero":"Note that this is not a (superscript) zero but a degree sign which is misused as zero. A superscript zero is defined in Unicode (°) and would have been more appropriate/uniform here. But note that the use of none-ASCII digits is not allowed.","please use English written ok for ko":'Please use the English written "{{ok}}" for "{{ko}}".',"please use English abbreviation ok for ko":'Please use the English abbreviation "{{ok}}" for "{{ko}}".',"please use English abbreviation ok for so":'Please use the English abbreviation "{{ok}}" for "{{ko}}". Note that it might also mean Saturday in Polish.',"please use off for ko":'Please use "{{ok}}" for "{{ko}}". Example: "Mo-Fr 08:00-12:00; Tu off".',"please use ok for workday":'Assuming "{{ok}}" for "{{ko}}". Please avoid using "workday": https://wiki.openstreetmap.org/wiki/Talk:Key:opening_hours#need_syntax_for_holidays_and_workingdays',"omit hour keyword":'Please omit "{{ko}}" or use a colon instead. Example: "12:00-14:00".',"omit ko":'Please omit "{{ko}}".',"omit tag key":'Please omit "{{ko}}". The tag key must not be in the tag value.',"omit wrong keyword open end":'Please omit "{{ko}}". The tag key must not be in the tag value.',"assuming open end for ko":'Assuming "{{ok}}" (open end time) for "{{ko}}". Example: "12:00+".',"please use ok for uncertainty":'Please use notation "{{ok}}" for "{{ko}}". If there is reason to suspect uncertainty consider adding a comment. Example: 12:00-14:00 "only on sunshine".',"please use fallback rule":'Please use notation "{{ok}}" (Fallback rule) for "{{ko}}". Example: Mo-Fr 12:00-14:00; PH off || "by appointment"',"please use ok for missing data":"Please consider adding a FIXME tag instead.","please use 24 hours time for ko":"Please use time format in 24 hours notation instead of the legacy 12 hours variant. If the 12 hours variant is used you might have to convert the hours to the 24 hours notation.","please use restriction comment time for ko":'It looks like you might want to define additional restrictions. If that is the case and they can not be expressed by other syntax elements then you could use a comment together with the `open` keyword. Example: open "female only"',"please use ok for typographically correct":'Please use notation "{{ok}}" for "{{ko}}". Although using "{{ko}}" is typographical correct, it is not defined in the opening_hours syntax. Correct typography should be done on application level …'},vi={en:{opening_hours:{pretty:{off:"closed",SH:"school holidays",PH:"public holidays"}}},de:{opening_hours:{texts:{"unexpected token":'Unerwartetes Zeichen: "{{token}}" Das bedeutet, dass die Syntax an dieser Stelle nicht erkannt werden konnte.',"no string":"Der Wert (erster Parameter) ist kein String",nothing:"Der Wert enthält nichts, was ausgewertet werden könnte.","nothing useful":"Diese Regel enthält nichts nützliches. Bitte entferne diese leere Regel.","combine rules":'Getrennte Regeln erkannt welche jeweils nur aus einer Zeit Bereichsdefinition bestehen. Diese Regeln sollten mittels "{{ok}}" zu einer Regel kombiniert werden.',"value ends with token":'Der Wert endet mit "{{token}}". Bitte ergänze den Wert nach "{{token}}" oder lösche "{{token}}".',"programmers joke":"Kann es sein, dass du ein Programmierer bist und das Hinzufügen eines Semikolons nach jedem Statement ist zwanghaft ;) ? Es ist so, dass das Semikolon in der opening_hours-Syntax als Trenner für Regeln definiert ist. Bitte verzichte an dieser Stelle auf ein Semikolon.","interpreted as year":'Die Zahl {{number}} wird als Jahr interpretiert. Vermutlich ist das nicht beabsichtigt. Uhrzeiten werden als "12:00" angegeben.',"rule before fallback empty":"Die Regel vor der Fallback-Regel enthält nichts nützliches","hour min separator":'Bitte benutze ":" als Stunden/Minuten-Trenner',"warnings severity":'Der Parameter optional_conf_parm["warnings_severity"] muss eine ganze Zahl zwischen (einschließlich) 0 und (einschließlich) 7 sein. Gegeben: {{severity}}, erwartet: Eine der Zahlen: {{allowed}}.',"optional conf parm type":"Der optional_conf_parm Parameter hat einen unbekannten Typ. Gegeben: {{given}}","conf param tag key missing":'Der optional_conf_parm["tag_key"] fehlt, ist aber notwendig wegen optional_conf_parm["map_value"].',"conf param mode invalid":'Der optional_conf_parm["mode"]-Parameter ist eine ungültige Zahl. Gegeben: {{given}}, erwartet: Eine der Zahlen: {{allowed}}.',"conf param unknown type":'Der optional_conf_parm["{{key}}"] Parameter hat einen unbekannten Typ. Gegeben: {{given}}, erwartet: {{expected}}.',"library bug":'Bei der Auswertung des Wertes "{{value}}" ist ein Fehler aufgetreten. Bitte melde diesen Fehler oder korrigiere diesen mittels eines Pull Requests oder Patches: {{-url}}.{{message}}',"library bug PR only":'Bei der Auswertung des Wertes "{{value}}" ist ein Fehler aufgetreten. Du kannst dies korrigieren, indem du das Problem löst und in Form eines Pull Requests oder Patches zum Projekt beiträgst: {{-url}}.{{message}}',"use multi":'Du hast {{count}} {{-part2}} Einzelne Regeln können mit ";" getrennt werden.',"selector multi 2a":"{{what}} in einer Regel benutzt. Du kannst nur einen davon je Regel verwenden","selector multi 2b":'nicht verbundene {{what}} in einer Regel benutzt. Das ist vermutlich ein Fehler. Gleiche Selektoren können (und sollten) immer zusammen und durch Kommas getrennt geschrieben werden. Beispiel für Zeitspannen "12:00-13:00,15:00-18:00". Beispiel für Wochentage "Mo-We,Fr".',"selector state":"Status-Schlüsselwörter (offen, geschlossen)",comments:"Kommentare",months:"Monate",weekdays:"Wochentage",ranges:"Zeitspannen","default state":"Diese Regel, welche den Standard-Status (d.h. geschlossen) für alle folgenden Regeln ändert, ist nicht die erste Regel. Diese Regel überschreibt alle vorherigen Regeln. Es kann legitim sein, den Standard-Status z.B. auf geöffnet festzulegen und dann nur die Zeiten, zu denen geschlossen ist, anzugeben.",vague:'Diese Regel ist nicht sehr aussagekräftig, da kein Zeit Selektor angegeben wurde. Ein Zeit Selektor ist die Komponente die angibt, zu welcher Tageszeit ein Objekt geöffnet hat, zum Beispiel "10:00-19:00". Bitte füge eine Zeitangabe oder einen Kommentar hinzu, um dies zu verbessern.',"empty comment":'Du hast einen leeren Kommentar verwendet." Bitte schreibe entweder einen Kommentar-Text oder benutze stattdessen das Schlüsselwort "unknown".',separator_for_readability:"Du hast das optionale Symbol <separator_for_readability> an der falschen Stelle benutzt. Bitte lies die Syntax-Spezifikation um zu sehen, wo es verwendet werden kann, oder entferne es.","strange 24/7":'Du hast 24/7 in einer Art verwendet, welche wahrscheinlich nicht als "24 Stunden, 7 Tage die Woche" interpretiert wird. Der Richtigkeit halber solltest du "open" oder "closed" für diese Regel verwenden und dann die Ausnahmen angeben um das selbe Ziel zu erreichen. So ist es klarer – zum Beispiel "open; Mo 12:00-14:00 off".',"public holiday":'Es wurde keine Regel für "PH" (feiertags) angegeben. Dies ist nicht sehr aussagekräftig.{{-part2}} Bitte füge die Regel "PH off" an, wenn die Einrichtung an allen Feiertagen geschlossen ist oder schreibe "Sa,Su,PH 12:00-16:00" um auszudrücken, dass Samstags, Sonntags und feiertags von 12:00-16:00 geöffnet ist. Falls die Einrichtung täglich und an Feiertagen geöffnet ist, kann dies explizit mittels "Mo-Su,PH" ausgedrückt werden. Wenn du dir im Unklaren bist, versuche die Öffnungszeit zu klären. Falls das nicht möglich ist, lass die Angabe weg und ignoriere diese Warnung.',"public holiday part2":' Leider ist der "tag key" (beispielsweise "opening_hours", oder "lit") in opening_hours.js nicht bekannt. Diese Warnung betrifft nur die Keys: {{keys}}. Falls deine Angabe nicht für einen dieser ist, ignoriere bitte folgenden Hinweis:',"additional_rule_separator not used after time wrapping midnight":'Diese Regel überschreibt Teile der vorherigen Regel. Der Grund dafür ist, dass normale Regeln auf den ganzen Tag zutreffen und alle Definitionen von vorhergehenden Regeln für diesen Tag überschreiben. Du kannst diese Regel als additive Regel deklarieren indem du ein "," anstelle des üblichen ";" für diese Regel verwendest. Beachte das die Überschreibung auch gewünscht sein kann und in so einem Fall diese Warnung ignoriert werden kann.',"additional rule which evaluates to closed":'Diese Regel wird als geschlossen ausgewertet aber wurde als additive Regel angegeben. Sie sollte als normale Regel mittels ";" definiert sein. Siehe https://wiki.openstreetmap.org/wiki/DE:Key:opening_hours/specification#explain:rule_modifier:closed.',switched:'Der Selektor "{{first}}" wurde für eine bessere Lesbarkeit und der Vollständigkeit halber mit "{{second}}" getauscht.',"no colon after":'Bitte Benutze kein ":" nach dem Token {{token}}.',"number -5 to 5":"Zahl zwischen -5 und 5 (außer 0) erwartet.","one weekday constraint":"Du kannst höchstens einen beschränkten Wochentag in einer Monats-Spanne verwenden","range constrained weekdays":"Du kannst keine Wochentags-Spanne als Beschränkung in einer Monats-Spanne verwenden",expected:'"{{-symbol}}" erwartet.',"range zero":'Du kannst keine {{type}}-Spanne mit Periode "0" verwenden.',"period one year+":'Bitte verwende keine {{type}}-Spannen mit Periode "1". Wenn du ausdrücken willst, das eine Einrichtung ab einem bestimmten Jahr immer offen ist, benutze bitte "<year>+".',"period one":'Bitte verwende keine {{type}}-Spannen mit Periode "1".',"month 31":"Die Tagesangabe für {{month}} muss zwischen 1 und 31 liegen.","month 30":"Der Monat {{month}} hat keine 31 Tage. Der letzte Tag von {{month}} ist Tag 30.","month feb":'"Der Monat {{month}} hat entweder 28 oder 29 Tage (Schaltjahre)."',"point in time":"Erwarte Bindestrich (-) oder offenes Ende (+) in der Zeitspanne {{calc}}. Um mit Zeitpunkten zu arbeiten, muss der Modus für  {{libraryname}} umgestellt werden. Vielleicht falsches OSM-tag verwendet?",calculation:"Berechnung","time range continue":"Die Zeitspanne geht nicht wie erwartet weiter","period continue":'Die Zeitspannen-Periode geht nicht wie erwartet weiter. Beispiel "/01:30".',"time range mode":'{{libraryname}} wurde im "Zeitspannen-Modus" aufgerufen. Zeitpunkt gefunden.',"time ranges":"Zeitspannen","holiday ranges":"Feiertagen","point in time mode":'{{libraryname}} wurde im "Zeitpunkt-Modus" aufgerufen. Zeitspanne gefunden.',"outside current day":"Zeitspanne beginnt außerhalb des aktuellen Tages","two midnights":"Zeitspanne welche mehrmals Mitternacht beinhaltet wird nicht unterstützt","without minutes":'Zeitspanne ohne Minutenangabe angegeben. Das ist nicht sehr eindeutig! Bitte verwende stattdessen folgende Syntax "{{syntax}}".',"outside day":"Die Zeitspanne beginnt außerhalb des aktuellen Tages","zero calculation":'Das Hinzufügen von 0 in einer variablen Zeitberechnung ändert die variable Zeit nicht. Bitte entferne die Zeitberechnung (Beispiel: "sunrise-(sunset-00:00)").',"calculation syntax":"Berechnung mit variabler Zeit hat nicht die korrekte Syntax",missing:'Fehlendes "{{symbol}}"',"(time)":"(Zeit)","bad range":"Ungültige Zeitspanne: {{from}}-{{to}}","] or more numbers":'"]" oder weitere Zahlen erwartet.',"additional rule no sense":'Eine weitere Regel an dieser Stelle ergibt keinen Sinn. Benutze einfach ";" als Trenner für Regeln. Siehe https://wiki.openstreetmap.org/wiki/Key:opening_hours/specification#explain:additional_rule_separator',"unexpected token weekday range":"Unerwartes Token in Tages-Spanne: {{token}}","max differ":"Es sollte keinen Grund geben, mehr als {{maxdiffer}} Tage von einem {{name}} abzuweichen. Wenn nötig, teile uns dies bitte mit …","adding 0":"Addition von 0 verändert das Datum nicht. Bitte weglassen.","unexpected token holiday":"Unerwarteter Token (in Feiertags-Auswertung): {{token}}","no holiday definition":"{{name}} ist für das Land {{cc}} nicht definiert.","no holiday definition state":"{{name}} ist für das Land {{cc}} und Bundesland {{state}} nicht definiert.","no country code":"Der Ländercode fehlt. Dieser wird benötigt um die korrekten Feiertage zu bestimmen (siehe in der README wie dieser anzugeben ist)","no SH definition":"Die Schulferien {{name}}sind für das Jahr {{year}} nicht definiert","movable no formula":"Der bewegliche Feiertag {{name}} kann nicht berechnet werden. Bitte füge eine entsprechende Formel hinzu.","movable not in year":"Der bewegliche Feiertag {{name}} plus {{days}} Tage befindet sich nicht mehr im selben Jahr. Aktuell nicht unterstützt.","year range one year":'Eine Jahres-Spanne mit gleichem Jahr als Beginn und Ende ergibt keinen Sinn. Bitte entferne das Ende-Jahr. zum Beispiel: "{{year}} May 23"',"year range reverse":"Eine Jahres-Spanne mit Beginn größer als Ende ergibt keinen Sinn. Bitte umdrehen.","year past":"Das Jahr liegt in der Vergangenheit.","unexpected token year range":"Unerwartetes Token in der Jahres-Spanne: {{token}}","week range reverse":"Du hast eine Wochen-Spanne in umgekehrter Reihenfolge oder mehrere Jahre umfassende angegeben. Dies ist aktuell nicht unterstützt.","week negative":"Du hast eine Kalenderwoche kleiner 1 angegeben. Korrekte Angaben sind 1-53.","week exceed":"Du hast eine Kalenderwoche größer als 53 angegeben. Korrekte Angaben sind 1-53.","week period less than 2":'Du hast eine Wochenperiode kleiner 2 angegeben. Wenn du die gesamte Spanne von {{weekfrom}} bis {{weekto}} angeben willst, lasse "/{{period}}" einfach weg.',"week period greater than 26":'Du hast eine Wochen-Periode größer als 26 angegeben. 26,5 ist die Hälfte des Maximums von 53 Wochen pro Jahr. Damit würde eine Periode größer als 26 nur einmal pro Jahr auftreten. Bitte gibt den Wochen-Selektor als "week {{weekfrom}}" an, wenn es das ist, was du ausdrücken möchtest.',"unexpected token week range":"Unerwartetes Token in Wochen-Spanne: {{token}}","unexpected token month range":"Unerwartetes Token in Monats-Spanne: {{token}}","day range reverse":"Zeitspanne in falscher Reihenfolge. Beginn ist größer als Ende.","open end":'Angegeben als "open end". Schließzeit wurde geraten.',"date parameter needed":"Datumsparameter nötig.","assuming ok for ko":'"{{ko}}" wird als "{{ok}}" interpretiert.',"please use ok for ko":'Bitte verwende "{{-ok}}" anstelle von "{{-ko}}".',"please use ok for similar looking ko":'Please use notation "{{ok}}" for "{{ko}}". Those characters look very similar but are not the same!',"rant degree sign used for zero":"Beachte das dies ein Gradzeichen ist, welches als (hochgestellte) Null missbraucht wurde. Eine hochgestellte Null ist in Unicode definiert (°) und wäre angebrachter/einheitlicher an dieser Stelle. Allerdings ist die Verwendung von nicht ASCII Ziffern nicht erlaubt.","please use English written ok for ko":'Bitte benutze die englische Schreibweise "{{ok}}" für "{{ko}}".',"please use English abbreviation ok for ko":'Bitte benutze die englische Abkürzung "{{ok}}" für "{{ko}}".',"please use English abbreviation ok for so":'Bitte benutze die englische Abkürzung "{{ok}}" für "{{ko}}". Beachte das Samstag in Polnisch gemeint sein kann.',"please use off for ko":'Bitte benutze "{{ok}}" für "{{ko}}". Beispiel: "Mo-Fr 08:00-12:00; Tu off".',"please use ok for workday":'"{{ko}}" wird als "{{ok}}" interpretiert. Werktag sollte nicht verwendet werden. Siehe https://wiki.openstreetmap.org/wiki/Talk:Key:opening_hours#need_syntax_for_holidays_and_workingdays',"omit hour keyword":'Bitte lasse "{{ko}}" weg oder verwende einen Doppelpunkt. Beispiel: "12:00-14:00".',"omit ko":'Bitte verzichte auf "{{ko}}".',"omit tag key":'Bitte lasse "{{ko}}" weg. Der Tag Schlüssel darf nicht im Tag Wert sein.',"omit wrong keyword open end":'Bitte lasse "{{ko}}" weg. Falls du "open end" ausdrücken möchtest verwende bitte ein "+". Beispiel: "12:00+".',"assuming open end for ko":'"{{ko}}" wird als "{{ok}}" ("open end") interpretiert. Example: "12:00+".',"please use ok for uncertainty":'Bitte verwende "{{ok}}" für "{{ko}}". Falls der begründete Verdacht der Ungewissheit vorliegt ziehe die Verwendung eines Kommentars in Betracht. Beispiel: 12:00-14:00 "only on sunshine".',"please use fallback rule":'Bitte verwende "{{ok}}" (Fallback Regel) für "{{ko}}". Beispiel: Mo-Fr 12:00-14:00; PH off || "nach Vereinbarung"',"please use ok for missing data":"Bitte verwende eine FIXME Notiz.","please use 24 hours time for ko":"Bitte verwende 24 Stunden Zeitangaben anstelle der veralteten 12 Stunden Variante. Falls die 12 Stunden Variante verwendet wird ist eventuelle eine Konvertierung notwendig.","please use restriction comment time for ko":'Es sieht so aus also möchtest du zusätzliche Einschränkungen für eine Öffnungszeit geben. Falls sich dies nicht mit der Syntax ausdrücken lässt können Kommentare verwendet werden. Zusätzlich sollte eventuell das Schlüsselwort `open` benutzt werden. Beispiel: open "Nur Frauen".',"please use ok for typographically correct":'Bitte verwende "{{-ok}}" für "{{ko}}". Auch wenn "{{ko}}" typografisch korrekt ist, ist dies in der opening_hours Syntax nicht definiert. Korrekte Typographie sollte auf Anwendungsebene sichergestellt werden …'},pretty:{off:"geschlossen",SH:"Schulferien",PH:"Feiertags"}}},eo:{opening_hours:{texts:{"assuming ok for ko":'"{{ko}}" estas interpretita kiel "{{ok}}".',"please use ok for ko":'Bonvolu uzi la esprimon "{{-ok}}" anstataŭ "{{ko}}".',"please use English abbreviation ok for ko":'Bonvolu uzi la anglan mallongigon "{{ok}}" für "{{ko}}".'},pretty:{off:"fermita",SH:"lernejaj ferioj",PH:"festotagoj"}}},fi:{opening_hours:{pretty:{off:"suljettu",SH:"koululomat",PH:"lailliset vapaapäivät"}}},fr:{opening_hours:{texts:{"assuming ok for ko":`S'il vous plaît utiliser "<ok>" pour "<ko>".`,"please use ok for ko":`S'il vous plaît utiliser "{{-ok}}" pour "{{ko}}".`,"please use English abbreviation ok for ko":`S'il vous plaît utiliser l'abréviation "{{-ok}}" pour "{{ko}}".`},pretty:{off:"fermé",SH:"vacances scolaires",PH:"vacances publiques"}}},nl:{opening_hours:{texts:{"please use English abbreviation ok for ko":'Neem de engelse afkorting "{{ok}}" voor "{{ko}}" alstublieft.'},pretty:{off:"gesloten",SH:"schoolvakantie",PH:"feestdagen"}}},ru:{opening_hours:{pretty:{off:"закрыто",SH:"каникулы",PH:"праздник"}}}};if(vi.en,vi.de,vi.eo,vi.fi,vi.fr,vi.nl,vi.ru,!u.default.isInitialized)u.default.init({fallbackLng:"en",resources:vi,getAsync:!0,useCookie:!0});else for(var Ti in vi)u.default.addResourceBundle(Ti,"opening_hours",vi[Ti].opening_hours,!0);function ht(mi,Pi,Ni){var Oi={dawn:330,sunrise:360,sunset:1080,dusk:1110},mn=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],vn=["Su","Mo","Tu","We","Th","Fr","Sa"],Yi={su:[0,"weekday"],mo:[1,"weekday"],tu:[2,"weekday"],we:[3,"weekday"],th:[4,"weekday"],fr:[5,"weekday"],sa:[6,"weekday"],jan:[0,"month"],feb:[1,"month"],mar:[2,"month"],apr:[3,"month"],may:[4,"month"],jun:[5,"month"],jul:[6,"month"],aug:[7,"month"],sep:[8,"month"],oct:[9,"month"],nov:[10,"month"],dec:[11,"month"],day:["day","calcday"],days:["days","calcday"],sunrise:["sunrise","timevar"],sunset:["sunset","timevar"],dawn:["dawn","timevar"],dusk:["dusk","timevar"],easter:["easter","event"],week:["week","week"],open:["open","state"],closed:["closed","state"],off:["off","state"],unknown:["unknown","state"]},Kn={zero_pad_hour:!0,one_zero_if_hour_zero:!1,leave_off_closed:!0,keyword_for_off_closed:"off",rule_sep_string:" ",print_semicolon:!0,leave_weekday_sep_one_day_betw:!0,sep_one_day_between:",",zero_pad_month_and_week_numbers:!0,locale:"en"},je={opening_hours:{mode:0,warn_for_PH_missing:!0},collection_times:{mode:2},"opening_hours:.+":{mode:0},".+:opening_hours":{mode:0},".+:opening_hours:.+":{mode:0},smoking_hours:{mode:0},service_times:{mode:2},happy_hours:{mode:0},lit:{mode:0,map:{yes:'sunset-sunrise open "specified as yes: At night (unknown time schedule or daylight detection)"',automatic:'unknown "specified as automatic: When someone enters the way the lights are turned on."',no:'off "specified as no: There are no lights installed."',interval:'unknown "specified as interval"',limited:'unknown "specified as limited"'}}},Ci=60*24,Dn=1e3*60*Ci,xi="opening_hours.js",tn="https://github.com/opening-hours/"+xi,xn="en";typeof u.default=="object"&&(xn=u.default.language);var tt=function(z,N){if(typeof u.default=="object"&&typeof u.default.t=="function"&&typeof xn=="string"&&["de"].indexOf(xn)!==-1){var be;u.default.language!==xn?be=u.default.getFixedT(xn):be=u.default.t;var we=be("opening_hours:texts."+z,N);return we}var we=pi[z];return typeof we>"u"&&(we=z),we.replace(/{{([^{}]*)}}/g,function(de,Ue){return typeof N[Ue]<"u"?N[Ue]:de})},bn,_n,cn,ta;if(typeof Pi=="object"&&Pi!==null)typeof Pi.address=="object"&&(typeof Pi.address.country_code=="string"&&(bn=Pi.address.country_code),typeof Pi.address.state=="string"?_n=Pi.address.state:typeof Pi.address.county=="string"&&(_n=Pi.address.county)),typeof Pi.lon=="string"&&typeof Pi.lat=="string"&&(cn=Pi.lat,ta=Pi.lon);else if(Pi===null)bn="de",_n="Baden-Württemberg",cn="49.5400039",ta="9.7937133";else if(typeof Pi<"u")throw"The nominatim_object parameter is of unknown type. Given "+typeof Pi+", expected object.";var pa=4,rt,jn=!1,hn,Un;if(typeof Ni=="number")rt=Ni;else if(typeof Ni=="object"){if(typeof Ni.locale=="string"&&(xn=Ni.locale.split("-")[0]),q("mode","number")&&(rt=Ni.mode),q("warnings_severity","number")&&(pa=Ni.warnings_severity,[0,1,2,3,4,5,6,7].indexOf(pa)===-1))throw tt("warnings severity",{severity:pa,allowed:"[ 0, 1, 2, 3, 4, 5, 6, 7 ]"});q("tag_key","string")&&(hn=Ni.tag_key),q("map_value","boolean")&&(jn=Ni.map_value)}else if(typeof Ni<"u")throw tt("optional conf parm type",{given:typeof Ni});if(typeof hn=="string")Un=V(hn),jn&&typeof je[Un]=="object"&&typeof je[Un].map=="object"&&typeof je[Un].map[mi]=="string"&&(mi=je[Un].map[mi]);else if(jn)throw tt("conf param tag key missing");if(typeof rt>"u")typeof hn=="string"&&je[Un]!==void 0&&typeof je[Un].mode=="number"?rt=je[Un].mode:rt=0;else if([0,1,2].indexOf(rt)===-1)throw tt("conf param mode invalid",{given:rt,allowed:"[ 0, 1, 2 ]"});if(typeof mi!="string")throw tt("no string");if(/^(?:\s*;?)+$/.test(mi))throw tt("nothing");for(var Ii=[],lt=!1,gi=!1,_i=!1,on=ae(mi),wn="",ni=!0,Ei=[],ji={},re=[],U=0;U<on.length;U++){if(on[U][0].length===0){Ii.push([U,-1,tt("nothing useful")+(U===on.length-1&&U>0&&!on[U][1]?" "+tt("programmers joke"):"")]);continue}var J=0,te=!1;do{if(J===on[U][0].length)break;var se={time:[],wraptime:[],weekday:[],holiday:[],week:[],month:[],monthday:[],year:[],date:[],fallback:on[U][1],additional:!!J,meaning:!0,unknown:!1,comment:void 0,build_from_token_rule:void 0};se.build_from_token_rule=[U,J,re.length],J=wt(on[U][0],J,se,U),typeof J=="object"?J=J[0]:J=0,re.push([on[U][0].slice(se.build_from_token_rule[1],J===0?on[U][0].length:J),on[U][1],on[U][2]]),te&&re.length>1&&re[re.length-1][0].unshift(re[re.length-2][0].pop()),te=J!==0;var Ae=["year","holiday","month","monthday","week","weekday"];if(Ae.forEach(function(z){se[z].length>0&&(se.date.push(se[z]),se[z]=[])}),Ei.push(se),se.wraptime.length>0){for(var Ee={time:se.wraptime,date:[],meaning:se.meaning,unknown:se.unknown,comment:se.comment,wrapped:!0,build_from_token_rule:se.build_from_token_rule},$=0;$<se.date.length;$++){Ee.date.push([]);for(var O=0;O<se.date[$].length;O++)Ee.date[Ee.date.length-1].push(gt(se.date[$][O],-Dn))}Ei.push(Ee)}}while(J)}function V(z){var N,be=!1;return Object.keys(je).forEach(function(we){be!==!0&&(z===we?(N=we,be=!0):new RegExp(we).test(z)&&(N=we))}),N}function q(z,N){if(typeof Ni[z]===N)return!0;if(typeof Ni[z]<"u")throw tt("conf param unknown type",{key:z,given:typeof Ni[z],expected:N});return!1}function L(z,N,be,we){if(typeof we>"u"&&(we=on),typeof z=="number"){var de=0;return z===-1?de=mi.length-N:typeof we[z][0][N]>"u"?typeof we[z][0]&&N===-1?(de=mi.length,typeof we[z+1]=="object"&&typeof we[z+1][2]=="number"?de-=we[z+1][2]:typeof we[z][2]=="number"&&(de-=we[z][2])):(W("Bug in warning generation code which could not determine the exact position of the warning or error in value."),de=mi.length,typeof we[z][2]=="number"&&(de-=we[z][2],console.warn("Last token for rule: "+JSON.stringify(we[z])),console.log(mi.substring(0,de)+" <--- ("+be+")"),console.log(`
`)),console.warn("tokens_to_use[nrule][2] is undefined. This is ok if nrule is the last rule.")):(de=mi.length,typeof we[z][0][N+1]=="object"?de-=we[z][0][N+1][2]:typeof we[z][2]=="number"&&(de-=we[z][2])),mi.substring(0,de)+" <--- ("+be+")"}else if(typeof z=="string")return z.substring(0,N)+" <--- ("+be+")"}function W(z,N){return typeof z>"u"?z="":z=" "+z,typeof N!="string"&&(N="library bug"),z=tt(N,{value:mi,url:tn,message:z}),console.error(z),z}function ae(z){for(var N=[],be=[],we=!1;z!=="";){var de=z.match(/^([a-z]{2,})\b((?:[.]| before| after)?)/i),Ue=void 0;if(de&&de[2]===""&&(Ue=Yi[de[1].toLowerCase()]),typeof Ue=="object")be.push(Ue.concat([z.length])),z=z.substr(de[1].length);else if(de=z.match(/^\s+/))z=z.substr(de[0].length);else if(de=z.match(/^24\/7/))be.push([de[0],de[0],z.length]),z=z.substr(de[0].length);else if(/^;/.test(z))N.push([be,we,z.length]),z=z.substr(1),be=[],we=!1;else if(/^[:.]/.test(z))z[0]==="."&&!lt&&Ii.push([-1,z.length-1,tt("hour min separator")]),be.push([":","timesep",z.length]),z=z.substr(1);else if(de=z.match(/^(?:PH|SH)/i))be.push([de[0].toUpperCase(),"holiday",z.length]),z=z.substr(2);else if(de=z.match(/^[°\u2070-\u209F\u00B2\u00B3\u00B9]{1,2}/)){var xe={176:0,8304:0,185:1,178:2,179:3},st=de[0].split("").map(function(ct){var Ot=ct.charCodeAt(0);if(typeof xe[Ot]=="number")return xe[Ot];if(8308<=Ot&&Ot<=8313)return Ot-8304;if(8320<=Ot&&Ot<=8329)return Ot-8320}).join(""),bt="";if(be.length>0&&Te(be,be.length-1,"number")&&(bt+=":"),bt+=st,!lt){for(var Rt=0;Rt<=de[0].length;Rt++)z.charCodeAt(Rt)===176&&Ii.push([-1,z.length-(1+Rt),tt("rant degree sign used for zero")]);Ii.push([-1,z.length-de[0].length,tt("please use ok for ko",{ko:de[0],ok:bt})])}z=bt+z.substr(de[0].length)}else if(de=z.match(/^(&|_|→|–|−|—|ー|=|·|öffnungszeit(?:en)?:?|opening_hours\s*=|\?|~|～|：|always (?:open|closed)|24x7|24 hours 7 days a week|24 hours|7 ?days(?:(?: a |\/)week)?|7j?\/7|all days?|every day|(?:bis|till?|-|–)? ?(?:open ?end|late)|(?:(?:one )?day (?:before|after) )?(?:school|public) holidays?|days?\b|до|рм|ам|jours fériés|on work days?|sonntags?|(?:nur |an )?sonn-?(?:(?: und |\/)feiertag(?:s|en?)?)?|(?:an )?feiertag(?:s|en?)?|(?:nach|on|by) (?:appointments?|vereinbarung|absprache)|p\.m\.|a\.m\.|[_a-zäößàáéøčěíúýřПнВсо]+\b|à|á|mo|tu|we|th|fr|sa|su|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)(\.?)/i)){var vt=Me(de[1].toLowerCase(),z.length);if(typeof vt=="object")be.push([vt[0],vt[1],z.length]),z=z.substr(de[0].length);else if(typeof vt=="string"){if(vt==="am"||vt==="pm"){var Zt=be.length-1,fi;Zt>=0&&(Zt-2>=0&&Te(be,Zt-2,"number","timesep","number")?(Zt-=2,fi=be[Zt]):Te(be,Zt,"number")&&(fi=be[Zt]),typeof fi=="object"&&(vt==="pm"&&fi[0]<12&&(fi[0]+=12),vt==="am"&&fi[0]===12&&(fi[0]=0),be[Zt]=fi)),vt=""}var ii=ae(vt)[0];if(ii[1]===!0)throw W();for(var Rt=0;Rt<ii[0].length;Rt++)be.push([ii[0][Rt][0],ii[0][Rt][1],z.length]);z=z.substr(de[0].length)}else be.push([z[0].toLowerCase(),z[0].toLowerCase(),z.length-1]),z=z.substr(1);typeof de[2]=="string"&&de[2]!==""&&!lt&&Ii.push([-1,z.length,tt("omit ko",{ko:de[2]})])}else if(de=z.match(/^(\d+)(?:([.])([^\d]))?/))Number(de[1])>1900?(be.push([Number(de[1]),"year",z.length]),Number(de[1])>=2100&&Ii.push([-1,z.length-1,tt("interpreted as year",{number:Number(de[1])})])):be.push([Number(de[1]),"number",z.length]),z=z.substr(de[1].length+(typeof de[2]=="string"?de[2].length:0)),typeof de[2]=="string"&&de[2]!==""&&!lt&&Ii.push([-1,z.length,tt("omit ko",{ko:de[2]})]);else if(/^\|\|/.test(z)){if(be.length===0)throw L(-1,z.length-2,tt("rule before fallback empty"));N.push([be,we,z.length]),be=[],z=z.substr(2),we=!0}else if(de=z.match(/^"([^"]+)"/))be.push([de[1],"comment",z.length]),z=z.substr(de[0].length);else if(de=z.match(/^(["'„“‚‘’«「『])([^"'“”‘’»」』;|]*)(["'”“‘’»」』])/)){for(var Mt=1;Mt<=3;Mt+=2){var vt=Me(de[Mt],z.length-(Mt===3?de[1].length+de[2].length:0));if(typeof vt!="string"&&de[Mt]!=='"')throw W("A character for error tolerance was allowed in the regular expression but is not covered by word_error_correction which is needed to format a proper message for the user.")}be.push([de[2],"comment",z.length]),z=z.substr(de[0].length)}else/^(?:␣|\s)/.test(z)||be.push([z[0].toLowerCase(),z[0].toLowerCase(),z.length]),z=z.substr(1)}return N.push([be,we]),N}function Me(z,N){var be,we=Yi[z];return typeof we=="object"?we:(Object.keys(oi).forEach(function(de){be||Object.keys(oi[de]).forEach(function(Ue){if(!be&&new RegExp("^"+Ue+"$").test(z)){var xe=oi[de][Ue];lt||Ii.push([-1,N-z.length,tt(de,{ko:z,ok:xe})]),be=xe}})}),be)}function Ie(z){if(pa<4)return[];if(!lt&&typeof z=="object"){for(var N=["year","month","week","holiday"],be=["weekday","time","24/7","state","comment"],we=[],de=[],Ue={},xe=0;xe<re.length;xe++)if(re[xe][0].length!==0){var st=[0,0,void 0];we[xe]={},de[xe]=[];do{st=Ge(re[xe][0],st[1]);for(var bt=0;bt<=st[1];bt++)typeof re[xe][0][bt]=="object"&&re[xe][0][bt][0]==="PH"&&(Ue.PH=!0);st[0]===st[1]&&re[xe][0][st[0]][0]==="24/7"&&(Ue["24/7"]=!0),typeof we[xe][st[2]]!="object"?we[xe][st[2]]=[st[1]]:we[xe][st[2]].push(st[1]),de[xe].push(st[2]),st[1]++}while(st[1]<re[xe][0].length)}for(var xe=0;xe<we.length;xe++){Object.keys(we[xe]).forEach(function(It){we[xe][It].length>1&&(Ii.push([xe,we[xe][It][we[xe][It].length-1],tt("use multi",{count:we[xe][It].length,part2:/^(?:comment|state)/.test(It)?tt("selector multi 2a",{what:tt(It==="state"?"selector state":"comments")}):tt("selector multi 2b",{what:tt(It+(/^(?:month|weekday)$/.test(It)?"s":" ranges"))})})]),gi=!0)}),typeof we[xe].state=="object"&&Object.keys(we[xe]).length===1?xe!==0&&Ii.push([xe,re[xe][0].length-1,tt("default state")]):typeof we[xe].time>"u"&&(typeof we[xe].state=="object"&&re[xe][0][we[xe].state[0]][0]==="open"&&typeof we[xe].comment>"u"||typeof we[xe].comment>"u"&&typeof we[xe].state>"u"&&typeof we[xe]["24/7"]>"u")&&Ii.push([xe,re[xe][0].length-1,tt("vague")]),typeof we[xe].comment=="object"&&re[xe][0][we[xe].comment[0]][0].length===0&&Ii.push([xe,we[xe].comment[0],tt("empty comment")]);for(var Rt=0;Rt<de[xe].length-1;Rt++){var vt=de[xe][Rt],Zt=de[xe][Rt+1];(N.indexOf(vt)!==-1&&N.indexOf(Zt)!==-1||be.indexOf(vt)!==-1&&be.indexOf(Zt)!==-1)&&re[xe][0][we[xe][vt][0]][0]===":"&&Ii.push([xe,we[xe][vt][0],tt("separator_for_readability")])}if(typeof ji[xe]=="object"&&typeof ji[xe].time_wraps_over_midnight=="boolean"&&ji[xe].time_wraps_over_midnight===!0&&typeof we[xe+1]=="object"&&typeof we[xe+1]["rule separator"]>"u"&&re[xe+1][1]===!1){var fi=[xe,xe+1].map(function(It){for(var Kt=0;Kt<N.length-1;Kt++)if(typeof we[It][N[Kt]]=="object")return!0;return!1}),ii=fi.filter(function(It){return It}).length,Mt=!1;if(typeof ji[xe]=="object"&&typeof ji[xe]=="object"&&typeof ji[xe].week_days=="object"&&typeof ji[xe+1]=="object"&&typeof ji[xe+1].week_days=="object")for(var Rt=0;Rt<ji[xe].week_days.length;Rt++){var ct=ji[xe].week_days[Rt];if(ji[xe+1].week_days.indexOf(ct===6?0:ct+1)!==-1){Mt=!0;break}}else Mt=!0;var Ot=(Ni||{}).additional_rule_separator!==!1;ii<2&&Mt&&Ot&&Ii.push([xe+1,re[xe+1][0].length-1,tt("additional_rule_separator not used after time wrapping midnight"),re])}typeof re[xe][0][0]=="object"&&re[xe][0][0][0]===","&&re[xe][0][0][1]==="rule separator"&&typeof we[xe].state=="object"&&(re[xe][0][we[xe].state[0]][0]==="closed"||re[xe][0][we[xe].state[0]][0]==="off")&&Ii.push([xe,re[xe][0].length-1,tt("additional rule which evaluates to closed"),re])}var ui=z.advance();if(ui===!0&&Ue["24/7"]&&!lt&&Ii.push([-1,0,tt("strange 24/7")]),pa>=5&&!Ue.PH&&!Ue["24/7"]&&!lt&&(typeof hn=="string"&&je[Un].warn_for_PH_missing||typeof hn!="string")){var li=[];Object.keys(je).forEach(function(di){je[di].warn_for_PH_missing&&li.push(di)}),Ii.push([-1,0,tt("public holiday",{part2:typeof hn!="string"?tt("public holiday part2",{keys:li.join(", ")}):""})])}de.length>1&&de.filter(function(di){return di.length===1&&di[0]==="time"}).length===de.length&&Ii.push([-1,0,tt("combine rules",{ok:","})]),$e()}lt=!0;for(var Ji=[],Rt=0;Rt<Ii.length;Rt++)Ji.push(L(Ii[Rt][0],Ii[Rt][1],Ii[Rt][2],Ii[Rt][3]));return Ji}function Qe(z,N){return typeof z[N][3]=="string"?3:z[N][1]==="comment"||z[N][1]==="state"||z[N][1]==="24/7"||z[N][1]==="rule separator"?1:!1}function Ge(z,N){for(var be=N,we,de;be>=0&&(de=Qe(z,be),!de);be--);if(we=be,de===1)return we+1<z.length&&z[we+1][0]===":"&&we++,[be,we,z[be][de]];for(we++;we<z.length;we++)if(Qe(z,we))return[be,we-1,z[be][de]];return[be,we-1,z[be][de]]}function $e(z){var N={},be=!1,we;wn="";var de=[];typeof z=="object"&&(typeof z.conf=="object"&&(N=z.conf),typeof z.rule_index=="number"&&(we=z.rule_index),z.get_internals===!0&&(be=!0)),Object.keys(Kn).forEach(function(It){typeof N[It]>"u"&&(N[It]=Kn[It])});for(var Ue=N.locale==="en"||N.locale==="all",xe=Ue?mn:[1,2,3,4,5,6,7,8,9,10,11,12].map(function(It){return new Date(2018,It-1,1).toLocaleString(N.locale,{month:"short"})}),st=Ue?vn:[1,2,3,4,5,6,7].map(function(It){return new Date(2017,0,It).toLocaleString(N.locale,{weekday:"short"})}),bt=0;bt<re.length;bt++)if(re[bt][0].length!==0){if(typeof we=="number"){if(we!==bt)continue}else bt!==0&&(wn+=re[bt][1]?N.rule_sep_string+"|| ":(re[bt][0][0][1]==="rule separator"?",":N.print_semicolon?";":"")+N.rule_sep_string);var Rt=[0,0,void 0],vt=[],Zt=0;do{if(Rt=Ge(re[bt][0],Rt[1]),Zt>50)throw W("Infinite loop.");Rt[2]!=="rule separator"&&vt.push([Rt,xs(re[bt][0],Rt[0],Rt[1],Rt[2],N)]),Rt[1]++,Zt++}while(Rt[1]<re[bt][0].length);var fi=vt.slice();gi||vt.sort(function(It,Kt){var Xt=["year","month","week","holiday","weekday","time","24/7","state","comment"];return Xt.indexOf(It[0][2])-Xt.indexOf(Kt[0][2])});var ii=wn.length;if(typeof N.locale=="string"&&N.locale!=="en"){var Mt;u.default.language!==N.locale?Mt=u.default.getFixedT(N.locale):Mt=u.default.t;for(var ct=0;ct<vt.length;ct++){var Ot=vt[ct][0][2];if(Ot==="weekday")vn.forEach(function(It,Kt){vt[ct][1]=vt[ct][1].replace(new RegExp(It,"g"),st[Kt])});else if(Ot==="month")mn.forEach(function(It,Kt){vt[ct][1]=vt[ct][1].replace(new RegExp(It,"g"),xe[Kt])});else{var ui=vt[ct][1].indexOf(":")===-1;ui&&(vt[ct][1]=Mt(["opening_hours:pretty."+vt[ct][1],vt[ct][1]]))}}}if(wn+=vt.map(function(It){return It[1]}).join(" "),de.push(vt),!_i){for(var ct=0,li=fi.length;ct<li;ct++)if(fi[ct]!==vt[ct]){for(var Ji=ct+ii,di=0;di<=ct;di++)Ji+=vt[di][1].length;Ii.push([wn,Ji,tt("switched",{first:vt[ct][0][2],second:fi[ct][0][2]})])}}}return _i=!0,be?[de,re]:wn}function Te(z,N){if(N+arguments.length-2>z.length)return!1;for(var be=0;be<arguments.length-2;be++)if(z[N+be][1]!==arguments[be+2])return!1;return!0}function gt(z,N){return function(be){var we=z(new Date(be.getTime()+N));return typeof we[1]>"u"?we:[we[0],new Date(we[1].getTime()-N)]}}function wt(z,N,be,we){for(var de=!1,Ue=[];N<z.length;){if(Te(z,N,"weekday"))N=Wa(z,N,be,void 0,we);else if(Te(z,N,"24/7"))be.time.push(function(){return[!0]}),N++;else if(Te(z,N,"holiday"))Te(z,N+1,",")?N=ma(z,N,be,!0):N=ma(z,N,be,!1),ni=!1;else if(Te(z,N,"month","number")||Te(z,N,"month","weekday")||Te(z,N,"year","month","number")||Te(z,N,"year","event")||Te(z,N,"event"))N=wa(z,N,we),ni=!1;else if(Te(z,N,"year"))N=Tn(z,N),ni=!1;else if(Te(z,N,"month"))N=Ia(z,N);else if(Te(z,N,"week"))z[N][3]="week",N=Jr(z,N);else if(N!==0&&N!==z.length-1&&z[N][0]===":"&&!(typeof Ue[1]=="string"&&Ue[1]==="time"))!lt&&Te(z,N-1,"holiday")&&Ii.push([we,N,tt("no colon after",{token:z[N-1][1]})]),N++;else if(Te(z,N,"number","timesep")||Te(z,N,"timevar")||Te(z,N,"(","timevar")||Te(z,N,"number","-"))N=Aa(z,N,be,!1,we),Ue=[N,"time"];else if(Te(z,N,"state"))z[N][0]==="open"?be.meaning=!0:z[N][0]==="closed"||z[N][0]==="off"?be.meaning=!1:(be.meaning=!1,be.unknown=!0),de=!0,N++,typeof z[N]=="object"&&z[N][0]===","&&(N=[N+1]);else if(Te(z,N,"comment"))be.comment=z[N][0],de||(be.meaning=!1,be.unknown=!0),de=!0,N++,typeof z[N]=="object"&&z[N][0]===","&&(N=[N+1]);else if((N===0||N===z.length-1)&&Te(z,N,"rule separator"))N++;else{var xe=Ie();throw L(we,N,tt("unexpected token",{token:z[N][1]}))+(xe?" "+xe.join("; "):"")}if(typeof N=="object"){z[N[0]-1][1]="rule separator";break}typeof Ue[0]=="number"&&Ue[0]!==N&&(Ue=[])}return N}function St(z,N){return new Date(z.getFullYear(),z.getMonth(),z.getDate(),0,N)}function $t(z,N){var be=N-z.getDay();return new Date(z.getFullYear(),z.getMonth(),z.getDate()+be+(be<0?7:0))}function Tt(z,N,be){for(;N<z.length;N++){if(Te(z,N,"number","-","number"))be(z[N][0],z[N+2][0],N),N+=3;else if(Te(z,N,"-","number"))be(-z[N+1][0],-z[N+1][0],N),N+=2;else if(Te(z,N,"number"))be(z[N][0],z[N][0],N),N++;else throw L(U,N+Te(z,N,"-"),"Unexpected token in number range: "+z[N][1]);if(!Te(z,N,","))break}return N}function Ct(z,N){for(var be=0,we=Tt(z,N,function(Ue,xe,st){if(Ue===0||Ue<-5||Ue>5)throw L(U,st,tt("number -5 to 5"));if(Ue===xe){if(be!==0)throw L(U,st,tt("one weekday constraint"));be=Ue}else throw L(U,st+2,tt("range constrained weekdays"))}),de=N;de<we;de++)z[de][4]="positive_number";if(!Te(z,we,"]"))throw L(U,we,tt("expected",{symbol:"]"}));return[be,we+1]}function Si(z,N,be,we){if(!lt){if(N===0)throw L(U,z,tt("range zero",{type:be}));N===1&&(typeof we=="string"&&we==="no_end_year"?Ii.push([U,z,tt("period one year+",{type:be})]):Ii.push([U,z,tt("period one",{type:be})]))}}function Ai(z,N,be,we,de){var Ue=$t(new Date(z,N+(we[0]>0?0:1),1),be);return Ue.setDate(Ue.getDate()+(we[0]+(we[0]>0?-1:0))*7),typeof de=="object"&&de[1]&&Ue.setDate(Ue.getDate()+de[0]),Ue}function Wn(z,N,be,we){if(N<1||N>31)throw L(be,we,tt("month 31",{month:mn[z]}));if((z===3||z===5||z===8||z===10)&&N===31)throw L(be,we,tt("month 30",{month:mn[z]}));if(z===1&&N===30)throw L(be,we,tt("month feb",{month:mn[z]}))}function Aa(z,N,be,we,de){for(we||(z[N][3]="time");N<z.length;N++){var Ue=[],xe=[];xe[0]=Te(z,N,"number","timesep","number"),Ue[0]=Te(z,N,"(","timevar");var st,bt;if(xe[0]||Te(z,N,"timevar")||Ue[0]){var Rt=!1,vt=!1,Zt=[0,0],fi=[],ii;xe[0]?st=Fi(z,de,N+Ue[0]):(fi[0]=z[N+Ue[0]][0],st=Oi[fi[0]],Ue[0]&&(Zt[0]=ia(z,N),st+=Zt[0]));var Mt=N+(xe[0]?3:Ue[0]?7:1)+1;if(!Te(z,Mt-1,"-"))if(Te(z,Mt-1,"+"))vt=!0;else{if(rt===0)throw L(de,N+(xe[0]?typeof z[N+3]=="object"?3:2:Ue[0]?2:typeof z[N+1]=="object"?1:0),tt("point in time",{calc:Ue[0]?tt("calculation")+" ":"",libraryname:xi}));bt=st+1,Rt=!0}if(vt)we===1&&(st+=Ci),st>=22*60?bt=st+8*60:st>=17*60?bt=st+10*60:bt=Ci;else if(!Rt){if(xe[1]=Te(z,Mt,"number","timesep","number"),Ue[1]=Te(z,Mt,"(","timevar"),!xe[1]&&!Te(z,Mt,"timevar")&&!Ue[1])throw L(de,Mt-(typeof z[Mt]=="object"?0:1),tt("time range continue"));xe[1]?bt=Fi(z,de,Mt):(fi[1]=z[Mt+Ue[1]][0],bt=Oi[fi[1]]),Ue[1]&&(Zt[1]=ia(z,Mt),bt+=Zt[1])}if(N=Mt+(Rt?-1:xe[1]?3:Ue[1]?7:!vt),Te(z,N,"/","number")){if(Te(z,N+2,"timesep","number"))ii=Fi(z,de,N+1),N+=4;else if(ii=z[N+1][0],N+=2,Te(z,N,"timesep"))throw L(de,N,tt("period continue"));if(rt===0)throw L(de,N-1,tt("time range mode",{libraryname:xi}));Rt=!0}else if(Te(z,N,"+"))Aa(z,Mt,be,bt<st?1:!0,de),N++;else if(rt===1&&!Rt)throw L(de,Mt,tt("point in time mode",{libraryname:xi}));if(typeof cn=="string"?(!xe[0]||!(xe[1]||vt||Rt))&&(ni=!1):fi=[],!we&&st>=Ci)throw L(de,Mt-2,tt("outside current day"));if((bt<st||xe[0]&&xe[1]&&st===bt)&&(bt+=Ci),bt>Ci*2)throw L(de,Mt+(xe[1]?4:Ue[1]?7:1)-2,tt("two midnights"));st===0&&bt===Ci?be.time.push(function(){return[!0]}):bt>Ci?(be.time.push(function(ct,Ot,ui,li,Ji,di,It,Kt){return function(Xt){var Li=Xt.getHours()*60+Xt.getMinutes();if(ui[0]){var un=c.default.getTimes(Xt,cn,ta)[ui[0]];ct=un.getHours()*60+un.getMinutes()+li[0]}if(ui[1]){var zi=c.default.getTimes(Xt,cn,ta)[ui[1]];Ot=zi.getHours()*60+zi.getMinutes()+li[1],Ot+=Ci}else di&&typeof It!="number"&&(Ot=ct+1);if(typeof It=="number"){if(Li<ct)return[!1,St(Xt,ct)];if(Li<=Ot)for(var Ui=ct;Li+It>=Ui;Ui+=It){if(Ui===Li)return[!0,St(Xt,Li+1)];if(Li<Ui)return[!1,St(Xt,Ui)]}return[!1,St(Xt,Ci)]}else return Li<ct?[!1,St(Xt,ct)]:[!0,St(Xt,Ot),Ji,Kt]}}(st,bt,fi,Zt,vt,Rt,ii,we)),bt-Ci>0&&(typeof ji[de]>"u"&&(ji[de]={}),ji[de].time_wraps_over_midnight=!0,be.wraptime.push(function(ct,Ot,ui,li,Ji,di){return function(It){var Kt=It.getHours()*60+It.getMinutes();if(Ot[1]){var Xt=c.default.getTimes(It,cn,ta)[Ot[1]];ct=Xt.getHours()*60+Xt.getMinutes()+ui[1]}if(typeof Ji=="number"){if(Kt<=ct)for(var Li=0;Kt+Ji>=Li;Li+=Ji){if(Li===Kt)return[!0,St(It,Kt+1)];if(Kt<Li)return[!1,St(It,Li)]}}else if(Kt<ct)return[!0,St(It,ct),li,di];return[!1,void 0]}}(bt-Ci,fi,Zt,vt,ii,we)))):be.time.push(function(ct,Ot,ui,li,Ji,di,It){return function(Kt){var Xt=Kt.getHours()*60+Kt.getMinutes();if(ui[0]){var Li=c.default.getTimes(Kt,cn,ta)[ui[0]];ct=Li.getHours()*60+Li.getMinutes()+li[0]}if(ui[1]){var un=c.default.getTimes(Kt,cn,ta)[ui[1]];Ot=un.getHours()*60+un.getMinutes()+li[1]}else di&&typeof It!="number"&&(Ot=ct+1);if(typeof It=="number"){if(Xt<ct)return[!1,St(Kt,ct)];if(Xt<=Ot)for(var zi=ct;Xt+It>=zi;zi+=It){if(zi===Xt)return[!0,St(Kt,Xt+1)];if(Xt<zi)return[!1,St(Kt,zi)]}return[!1,St(Kt,Ci)]}else return Xt<ct?[!1,St(Kt,ct)]:Xt<Ot?[!0,St(Kt,Ot),Ji]:[!1,St(Kt,ct+Ci)]}}(st,bt,fi,Zt,vt,Rt,ii))}else if(Te(z,N,"number","-","number")){if(st=z[N][0]*60,bt=z[N+2][0]*60,lt||Ii.push([de,N+2,tt("without minutes",{syntax:(z[N][0]<10?"0":"")+z[N][0]+":00-"+(z[N+2][0]<10?"0":"")+z[N+2][0]+":00"})]),st>=Ci)throw L(de,N,tt("outside day"));if(bt<st&&(bt+=Ci),bt>Ci*2)throw L(de,N+2,tt("two midnights"));bt>Ci?(be.time.push(function(ct,Ot){return function(ui){var li=ui.getHours()*60+ui.getMinutes();return li<ct?[!1,St(ui,ct)]:[!0,St(ui,Ot)]}}(st,bt)),bt-Ci>0&&(typeof ji[de]>"u"&&(ji[de]={}),ji[de].time_wraps_over_midnight=!0,be.wraptime.push(function(ct){return function(Ot){var ui=Ot.getHours()*60+Ot.getMinutes();return ui<ct?[!0,St(Ot,ct)]:[!1,void 0]}}(bt-Ci)))):be.time.push(function(ct,Ot){return function(ui){var li=ui.getHours()*60+ui.getMinutes();return li<ct?[!1,St(ui,ct)]:li<Ot?[!0,St(ui,Ot),vt]:[!1,St(ui,ct+Ci)]}}(st,bt)),N+=3}else{if(Te(z,N,"("))throw L(de,N,'Missing variable time (e.g. sunrise) after: "'+z[N][1]+'"');if(Te(z,N,"number","timesep"))throw L(de,N+1,'Missing minutes in time range after: "'+z[N+1][1]+'"');if(Te(z,N,"number"))throw L(de,N+(typeof z[N+1]=="object"?1:0),'Missing time separator in time range after: "'+z[N][1]+'"');return[N]}if(!Te(z,N,","))break;typeof z[N+1]>"u"&&!lt&&Ii.push([de,N,tt("value ends with token",{token:z[N][1]})])}return N}function Fi(z,N,be){if(z[be+2][0]>59)throw L(N,be+2,"Minutes are greater than 59.");return z[be][0]*60+z[be+2][0]}function ia(z,N){var be;if(Te(z,N+2,"+")||Te(z,N+2,"-"))if(Te(z,N+3,"number","timesep","number"))if(Te(z,N+6,")")){var we=z[N+2][0]==="+"?"1":"-1",de=Fi(z,U,N+3)*we;return de===0&&Ii.push([U,N+5,tt("zero calculation")]),de}else be=[N+6,". "+tt("missing",{symbol:")"})+"."];else be=[N+5," "+tt("(time)")+"."];else be=[N+2,". "+tt("expected",{symbol:'+" or "-'})];if(be)throw L(U,be[0],tt("calculation syntax")+be[1])}function Wa(z,N,be,we,de){for(we||(we=!0,z[N][3]="weekday");N<z.length;N++){if(Te(z,N,"weekday","[")){var Ue=[],xe=Tt(z,N+2,function(ct,Ot,ui){if(ct===0||ct<-5||ct>5)throw L(de,ui,tt("number -5 to 5"));if(ct===Ot)Ue.push(ct);else if(ct<Ot)for(var li=ct;li<=Ot;li++){if(li===0||li<-5||li>5)throw L(de,ui+2,tt("number -5 to 5"));Ue.push(li)}else throw L(de,ui+2,tt("bad range",{from:ct,to:Ot}))});if(!Te(z,xe,"]"))throw L(de,xe+(typeof z[xe]=="object"?0:-1),tt("] or more numbers"));var st=In(z,xe+1,6,"constrained weekdays");ni=!1;for(var bt=0;bt<Ue.length;bt++)be.weekday.push(function(ct,Ot,ui){return function(li){var Ji=Na(li,!1),di=new Date(li.getFullYear(),li.getMonth(),1),It=new Date(li.getFullYear(),li.getMonth()+1,1),Kt;Kt=Ai(li.getFullYear(),li.getMonth(),ct,[Ot]);var Xt=new Date(Kt.getFullYear(),Kt.getMonth(),Kt.getDate()+ui);if(Xt.getTime()<di.getTime())if(Kt.getTime()>=di.getTime())Xt=$t(new Date(li.getFullYear(),li.getMonth()+(Ot>0?0:1)+1,1),ct),Kt.setDate(Xt.getDate()+(Ot+(Ot>0?-1:0))*7+ui);else return[!1,It];else if(Xt.getTime()>=It.getTime()&&Kt.getTime()>=It.getTime())return[!1,It];var Li;if(ui>0){if(Li=$t(new Date(li.getFullYear(),li.getMonth()+(Ot>0?0:1)-1,1),ct),Li.setDate(Li.getDate()+(Ot+(Ot>0?-1:0))*7+ui),Ji===Na(Li,!1))return[!0,St(li,Ci)]}else if(ui<0)if(Li=$t(new Date(li.getFullYear(),li.getMonth()+(Ot>0?0:1)+1,1),ct),Li.setDate(Li.getDate()+(Ot+(Ot>0?-1:0))*7+ui),Li.getTime()>=It.getTime()){if(Xt.getTime()>=It.getTime())return[!1,Li]}else{if(Xt.getTime()<It.getTime()&&Na(Xt,!1)===Ji)return[!0,St(li,Ci)];Xt=Li}return li.getDate()===Xt.getDate()?[!0,St(li,Ci)]:li.getDate()<Xt.getDate()?[!1,Xt]:[!1,It]}}(z[N][0],Ue[bt],st[0]));N=xe+1+st[1]}else if(Te(z,N,"weekday")){var Rt=Te(z,N+1,"-","weekday"),vt=z[N][0],Zt=Rt?z[N+2][0]:vt,fi=!0;if(Zt<vt){var ii=Zt;Zt=vt-1,vt=ii+1,fi=!1}var Mt=Array.apply(0,Array(Zt-vt+1)).map(function(ct,Ot){return Ot+Zt});typeof ji[de]>"u"&&(ji[de]={}),typeof ji[de].week_days=="object"?Array.prototype.push.apply(ji[de].week_days,Mt):ji[de].week_days=Mt,Zt<vt?be.weekday.push(function(){return[!0]}):be.weekday.push(function(ct,Ot,ui){return function(li){var Ji=li.getDay();return Ji<ct||Ji>Ot?[!ui,$t(li,ct)]:[ui,$t(li,Ot+1)]}}(vt,Zt,fi)),N+=Rt?3:1}else{if(Te(z,N,"holiday"))return ni=!1,ma(z,N,be,!0,we);throw Te(z,N-1,",")?L(de,N-1,tt("additional rule no sense")):L(de,N,tt("unexpected token weekday range",{token:z[N][1]}))}if(!Te(z,N,","))break}return N}function In(z,N,be,we){var de=[0,0];if(de[0]=Te(z,N,"+")||(Te(z,N,"-")?-1:0),de[0]!==0&&Te(z,N+1,"number","calcday")){if(z[N+1][0]>be)throw L(U,N+2,tt("max differ",{maxdiffer:be,name:we}));de[0]*=z[N+1][0],de[0]===0&&!lt&&Ii.push([U,N+2,tt("adding 0")]),de[1]=3}else de[0]=0;return de}function ma(z,N,be,we,de){for(de||(we?z[N][3]="weekday":z[N][3]="holiday");N<z.length;N++){if(Te(z,N,"holiday")){if(z[N][0]==="PH"){var Ue=na(z[N][0]),xe=In(z,N+1,1,"public holiday"),st=function(bt,Rt){return function(vt){for(var Zt=Va(bt,vt.getFullYear(),Rt),fi=Na(vt,!0),ii=0;ii<Zt.length;ii++){var Mt=Na(Zt[ii][0],!0);if(fi<Mt){if(Rt[0]>0){var ct=Va(bt,vt.getFullYear()-1,Rt),Ot=ct[ct.length-1],ui=Na(Ot[0],!0);if(fi<ui)return[!1,Ot[0]];if(fi===ui)return[!0,St(Ot[0],Ci),"Day after "+Ot[1]]}return[!1,Zt[ii][0]]}else if(fi===Mt)return[!0,new Date(vt.getFullYear(),vt.getMonth(),vt.getDate()+1),(Rt[0]>0?"Day after ":Rt[0]<0?"Day before ":"")+Zt[ii][1]]}if(Rt[0]<0){var li=Va(bt,vt.getFullYear()+1,Rt),Ji=li[0],di=Na(Ji[0],!0);if(fi===di)return[!0,St(Ji[0],Ci),"Day before "+Ji[1]]}return[!1,new Date(Zt[0][0].getFullYear()+1,Zt[0][0].getMonth(),Zt[0][0].getDate())]}}(Ue,xe);we?be.weekday.push(st):be.holiday.push(st),N+=1+xe[1]}else if(z[N][0]==="SH"){var Ue=na(z[N][0]),st=function(vt){return function(Zt){for(var fi=Na(Zt),ii=0;ii<vt.length;ii++){var Mt=la(vt[ii],Zt.getFullYear(),!1);if(!(typeof Mt>"u"))for(var ct=0;ct<Mt.length;ct+=4){var Ot=new Date(Zt.getFullYear(),Mt[2+ct]-1,Mt[3+ct]+1),ui=(Mt[0+ct]-1)*100+Mt[1+ct],li=(Mt[2+ct]-1)*100+Mt[3+ct];Ot=Na(Ot);var Ji=li<ui;if(fi<ui){var di=la(vt[vt.length-1],Zt.getFullYear()-1,!1);if(typeof di=="object"){var It=(di[di.length-4]-1)*100+di[di.length-3],Kt=(di[di.length-2]-1)*100+di[di.length-1];return It>Kt&&fi<=Kt?[!0,new Date(Zt.getFullYear(),di[di.length-2]-1,di[di.length-1]+1),vt[vt.length-1].name]:[!1,new Date(Zt.getFullYear(),Mt[0+ct]-1,Mt[1+ct])]}else return[!1,new Date(Zt.getFullYear(),Mt[0+ct]-1,Mt[1+ct])]}else{if(ui<=fi&&(fi<=li||Ji))return[!0,new Date(Zt.getFullYear()+Ji,Mt[2+ct]-1,Mt[3+ct]+1),vt[ii].name];if(Ot===fi)return ct+4<Mt.length?(ct+=4,[!1,new Date(Zt.getFullYear(),Mt[0+ct]-1,Mt[1+ct])]):[!1,new Date(Zt.getFullYear(),Mt[2+ct]-1,Mt[3+ct]+2)]}}}throw W(tt("no SH definition",{name:"",year:Zt.getFullYear()}),"library bug PR only")}}(Ue);we?be.weekday.push(st):be.holiday.push(st),N+=1}}else{if(Te(z,N,"weekday"))return Wa(z,N,be,!0,U);throw Te(z,N-1,",")?L(U,N-1,tt("additional rule no sense")):L(U,N,tt("unexpected token holiday",{token:z[N][1]}))}if(!Te(z,N,","))break}return N}function Na(z,N){return(N?z.getFullYear()*1e4:0)+z.getMonth()*100+z.getDate()}function la(z,N,be){typeof be!="boolean"&&(be=!0);var we=z[N];if(typeof we>"u"&&(we=z.default,typeof we>"u")){if(be)throw W(tt("no SH definition",{name:z.name+" ",year:N}),"library bug PR only");return}return we}function na(z){if(typeof bn!="string")throw tt("no country code");if(!Ft[bn])throw W(tt("no holiday definition",{name:z,cc:bn}),"library bug PR only");var N=[];if(typeof _n=="string"&&typeof Ft[bn][_n]=="object"&&typeof Ft[bn][_n][z]=="object"){var be=Ft[bn][z]||[],we=Ft[bn][_n][z];if(z==="PH")N=we;else if(!be.length)N=we;else{var de=be.map(function(st){return st.name}),N=[];N.push.apply(N,be),N.push.apply(N,we.filter(function(bt){return de.indexOf(bt.name)===-1})),N.sort(function(st,bt){var Rt=Object.keys(st).find(function(ii){return ii!=="name"}),vt=Object.keys(bt).find(function(ii){return ii!=="name"}),Zt=st[Rt],fi=bt[vt];return Zt[0]-fi[0]||Zt[1]-fi[1]})}}else if(Ft[bn][z]){var Ue=Ft[bn][z];switch(z){case"PH":Ue.forEach(function(xe){"only_states"in xe&&xe.only_states.indexOf(_n)===-1||N.push(xe)});break;case"SH":N=Ue;break}}else throw W(tt("no holiday definition state",{name:z,cc:bn,state:_n}),"library bug PR only");if(N.length===0)throw W(tt("no holiday definition",{name:z,cc:bn}),"library bug PR only");return N}function Yr(z){var N=Math.floor(z/100),be=z-19*Math.floor(z/19),we=Math.floor((N-17)/25),de=N-Math.floor(N/4)-Math.floor((N-we)/3)+19*be+15;de=de-30*Math.floor(de/30),de=de-Math.floor(de/28)*(1-Math.floor(de/28)*Math.floor(29/(de+1))*Math.floor((21-be)/11));var Ue=z+Math.floor(z/4)+de+2-N+Math.floor(N/4);Ue=Ue-7*Math.floor(Ue/7);var xe=de-Ue,st=3+Math.floor((xe+40)/44),bt=xe+28-31*Math.floor(st/4),Rt=z%4,vt=z%7,Zt=z%19,fi=(19*Zt+15)%30,ii=(2*Rt+4*vt-fi+34)%7,Mt=fi+ii,ct;Mt<9?ct=new Date(z,4-1,Mt+4):Mt+4<31?ct=new Date(z,4-1,Mt+4):ct=new Date(z,5-1,Mt-26);var Ot=new Date(z,2,0),ui=Ot.getDate()-Ot.getDay(),li=new Date(z,4,24),Ji=24-(6+li.getDay())%7,di=new Date(z,6,1),It=di.getDay()===0?2:1;function Kt(zi,Ui){var nn=new Date(z,zi,1);return 1+(7+Ui-nn.getDay())%7}function Xt(zi,Ui){var nn=new Date(z,zi+1,0),Ja=(7+nn.getDay()-Ui)%7;return nn.getDate()-Ja}function Li(zi,Ui){var nn=zi-Ui.getDay();return nn<0&&(nn+=7),Ui.setDate(Ui.getDate()+nn),Ui}function un(zi,Ui,nn){if(zi>=Ui)throw W("Not implemented yet.");if(zi<=nn.getDay()&&nn.getDay()<=Ui)return nn;var Ja=zi-nn.getDay();return Ja<0&&(Ja+=7),nn.setDate(nn.getDate()+Ja),nn}return{easter:new Date(z,st-1,bt),"orthodox easter":ct,victoriaDay:new Date(z,4,Ji),canadaDay:new Date(z,6,It),firstJanuaryMonday:new Date(z,0,Kt(0,1)),firstFebruaryMonday:new Date(z,1,Kt(1,1)),lastFebruarySunday:new Date(z,1,ui),firstMarchMonday:new Date(z,2,Kt(2,1)),firstAprilMonday:new Date(z,3,Kt(3,1)),firstMayMonday:new Date(z,4,Kt(4,1)),firstJuneMonday:new Date(z,5,Kt(5,1)),firstJulyMonday:new Date(z,6,Kt(6,1)),firstAugustMonday:new Date(z,7,Kt(7,1)),firstSeptemberMonday:new Date(z,8,Kt(8,1)),firstSeptemberTuesday:new Date(z,8,Kt(8,2)),firstSeptemberSunday:new Date(z,8,Kt(8,0)),firstOctoberMonday:new Date(z,9,Kt(9,1)),firstNovemberMonday:new Date(z,10,Kt(10,1)),firstNovemberTuesday:new Date(z,10,Kt(10,2)),firstMarchTuesday:new Date(z,2,Kt(2,2)),firstAugustTuesday:new Date(z,7,Kt(7,2)),firstAugustFriday:new Date(z,7,Kt(7,5)),firstNovemberThursday:new Date(z,10,Kt(10,4)),lastMayMonday:new Date(z,4,Xt(4,1)),lastMarchMonday:new Date(z,2,Xt(2,1)),lastAprilMonday:new Date(z,3,Xt(3,1)),lastAprilFriday:new Date(z,3,Xt(3,5)),lastAugustMonday:new Date(z,7,Xt(7,1)),lastSeptemberMonday:new Date(z,8,Xt(8,1)),lastSeptemberFriday:new Date(z,8,Xt(8,5)),lastOctoberMonday:new Date(z,9,Xt(9,1)),lastOctoberFriday:new Date(z,9,Xt(9,5)),nextSaturday20Jun:Li(6,new Date(z,5,20)),nextSaturday31Oct:Li(6,new Date(z,9,31)),nextWednesday16Nov:Li(3,new Date(z,10,16)),"nextMo-Fr17March":un(1,5,new Date(z,2,17)),"nextMo-Sa01May":un(1,6,new Date(z,4,1)),"nextMo-Sa07August":un(1,6,new Date(z,7,7)),"nextMo-Sa25December":un(1,6,new Date(z,11,25))}}function Va(z,N,be){var we=Yr(N),de=[],Ue;return z.forEach(function(xe){if("fixed_date"in xe)Ue=new Date(N,xe.fixed_date[0]-1,xe.fixed_date[1]);else if("variable_date"in xe){var st=we[xe.variable_date];if(!st)throw tt("movable no formula",{name:xe.name});var bt=0;if("offset"in xe&&(bt=xe.offset),Ue=new Date(st.getFullYear(),st.getMonth(),st.getDate()+bt),N!==Ue.getFullYear())throw tt("movable not in year",{name:xe.variable_date,days:bt})}else throw W("Unexpected object: "+JSON.stringify(xe,null,"    "));be[0]&&Ue.setDate(Ue.getDate()+be[0]),de.push([Ue,xe.name])}),de=de.sort(function(xe,st){return xe[0].getTime()<st[0].getTime()?-1:xe[0].getTime()>st[0].getTime()?1:0}),de}function Tn(z,N){for(z[N][3]="year";N<z.length;N++){if(Te(z,N,"year")){var be=!1,we,de;Te(z,N+1,"-","year","/","number")?(be=!0,we=!0,de=parseInt(z[N+4][0]),Si(N+4,de,"year")):(be=Te(z,N+1,"-","year"),we=Te(z,N+1,"/","number"),we?(de=parseInt(z[N+2][0]),Si(N+2,de,"year","no_end_year")):Te(z,N+1,"+")&&(de=1,we=2));var Ue=parseInt(z[N][0]);if(be&&z[N+2][0]<=Ue)throw z[N+2][0]===Ue?L(U,N,tt("year range one year",{year:Ue})):L(U,N,tt("year range reverse"));!be&&Ue<new Date().getFullYear()&&Ii.push([U,N,tt("year past")]),be&&z[N+2][0]<new Date().getFullYear()&&Ii.push([U,N+2,tt("year past")]),se.year.push(function(xe,st,bt,Rt,vt,Zt){return function(fi){var ii=fi.getFullYear(),Mt=Rt?parseInt(xe[st+2][0]):bt;if(ii<bt)return[!1,new Date(bt,0,1)];if(vt){if(bt<=ii){if(Rt&&ii>Mt)return[!1];if(Zt>0)return(ii-bt)%Zt===0?[!0,new Date(ii+1,0,1)]:[!1,new Date(ii+Zt-1,0,1)]}}else if(Rt){if(ii<=Mt)return[!0,new Date(Mt+1,0,1)]}else if(ii===bt)return[!0];return[!1]}}(z,N,Ue,be,we,de)),N+=1+(be?2:0)+(we?we===2?1:2:0)}else throw Te(z,N-1,",")?L(U,N-1,tt("additional rule no sense")):L(U,N,tt("unexpected token year range",{token:z[N][1]}));if(!Te(z,N,","))break}return N}function Jr(z,N){for(;N<z.length;N++){if(Te(z,N,"week")&&N++,Te(z,N,"number")){var be=Te(z,N+1,"-","number"),we=0,de=z[N][0],Ue=be?z[N+2][0]:de;if(de>Ue)throw L(U,N+2,tt("week range reverse"));if(de<1)throw L(U,N,tt("week negative"));if(Ue>53)throw L(U,be?N+2:N,tt("week exceed"));if(be&&(we=Te(z,N+3,"/","number"),we)){if(we=z[N+4][0],z[N+4][4]="positive_number",we<2)throw L(U,N+4,tt("week period less than 2",{weekfrom:de,weekto:Ue,period:we}));if(we>26)throw L(U,N+4,tt("week period greater than 26",{weekfrom:de}))}ni&&(!(de<=1&&Ue>=53)||we)&&(ni=!1),!we&&de===1&&Ue===53?se.week.push(function(){return[!0]}):se.week.push(function(xe,st,bt){return function(Rt){var vt=xr(Rt);if(vt<xe)return[!1,xa(xe,Rt)];if(vt>st)return[!1,xa(xe,Rt)];if(bt){var Zt=(vt-xe)%bt===0;return Zt?[!0,xa(vt+1,Rt)]:[!1,xa(vt+bt-1,Rt)]}return[!0,xa(st===53?1:st+1,Rt)]}}(de,Ue,we)),N+=1+(be?2:0)+(we?2:0)}else throw Te(z,N-1,",")?L(U,N-1,tt("additional rule no sense")):L(U,N,tt("unexpected token week range",{token:z[N][1]}));if(!Te(z,N,","))break}return N}function xr(z){z=new Date(+z),z.setHours(0,0,0,0),z.setDate(z.getDate()+4-(z.getDay()||7));var N=new Date(z.getFullYear(),0,1);return Math.ceil(((z-N)/864e5+1)/7)}function Rn(z,N){var be=new Date(N,0,1+(z-1)*7),we=be.getDay(),de=be;return we<=4?de.setDate(be.getDate()-be.getDay()+1):de.setDate(be.getDate()+8-be.getDay()),de}function xa(z,N){for(var be,we=-1;we<=1;we++)if(be=Rn(z,N.getFullYear()+we),be.getTime()>N.getTime())return be;throw W()}function Ia(z,N,be,we){for(we||(z[N][3]="month");N<z.length;N++){if(Te(z,N,"month","number")&&!Te(z,N+2,"timesep","number"))return wa(z,N,U,!0);if(Te(z,N,"month")){var de=Te(z,N+1,"-","month"),Ue=z[N][0],xe=de?z[N+2][0]:Ue;de&&ni?Ue!==(xe+1)%12&&(ni=!1):ni=!1;var st=!0;if(xe<Ue){var bt=xe;xe=Ue-1,Ue=bt+1,st=!1}var Rt=function(vt,Zt,fi){return function(ii){var Mt=ii.getMonth();return Zt<vt?[!fi]:Mt<vt||Mt>Zt?[!fi,ls(ii,vt)]:[fi,ls(ii,Zt+1)]}}(Ue,xe,st);be===!0?se.monthday.push(Rt):se.month.push(Rt),N+=de?3:1}else throw L(U,N,tt("unexpected token month range",{token:z[N][1]}));if(!Te(z,N,","))break}return N}function ls(z,N){return new Date(z.getFullYear(),N<z.getMonth()?N+12:N)}function wa(z,N,be,we){for(we||(z[N][3]="month");N<z.length;N++){var de=[],Ue=[],xe=[],st=[],bt=[];de[0]=Te(z,N,"year"),Ue[0]=Te(z,N+de[0],"month","number"),xe[0]=Te(z,N+de[0],"event"),xe[0]&&(st[0]=In(z,N+de[0]+1,200,"event like easter"));var Rt;Te(z,N+de[0],"month","weekday","[")?(bt[0]=Ct(z,N+de[0]+3),st[0]=In(z,bt[0][1],6,"constrained weekdays"),Rt=bt[0][1]+(typeof st[0]=="object"&&st[0][1]?3:0)):Rt=N+de[0]+(xe[0]?typeof st[0]=="object"&&st[0][1]?4:1:2);var vt;if((Ue[0]||xe[0]||bt[0])&&Te(z,Rt,"-")&&(de[1]=Te(z,Rt+1,"year"),vt=Rt+1+de[1],Ue[1]=Te(z,vt,"month","number"),Ue[1]||(xe[1]=Te(z,vt,"event"),xe[1]?st[1]=In(z,vt+1,366,"event like easter"):Te(z,vt,"month","weekday","[")&&(bt[1]=Ct(z,vt+3),st[1]=In(z,bt[1][1],6,"constrained weekdays")))),de[0]===de[1]&&(Ue[1]||xe[1]||bt[1])){Ue[0]&&Wn(z[N+de[0]][0],z[N+de[0]+1][0],be,N+de[0]+1),Ue[1]&&Wn(z[vt][0],z[vt+1][0],be,vt+1);var Zt=function(di,It,Kt,Xt,Li,un,zi,Ui){return function(nn){var Ja=new Date(nn.getFullYear()+1,0,1),Rr,qa;if(Li[0]){if(Rr=Yr(Xt[0]?parseInt(di[It][0]):nn.getFullYear()),qa=Rr[di[It+Xt[0]][0]],typeof un[0]=="object"&&un[0][1]){var Cr=qa.getFullYear();if(qa.setDate(qa.getDate()+un[0][0]),Cr!==qa.getFullYear())throw L(Kt,It+Xt[0]+un[0][1]*3,tt("movable not in year",{name:di[It+Xt[0]][0],days:un[0][0]}))}}else Ui[0]?qa=Ai(Xt[0]?di[It][0]:nn.getFullYear(),di[It+Xt[0]][0],di[It+Xt[0]+1][0],Ui[0],un[0]):qa=new Date(Xt[0]?di[It][0]:nn.getFullYear(),di[It+Xt[0]][0],di[It+Xt[0]+1][0]);var Ha;if(Li[1]){if(Rr=Yr(Xt[1]?parseInt(di[zi-1][0]):nn.getFullYear()),Ha=Rr[di[zi][0]],typeof un[1]=="object"&&un[1][1]){var Xa=Ha.getFullYear();if(Ha.setDate(Ha.getDate()+un[1][0]),Xa!==Ha.getFullYear())throw L(Kt,zi+un[1][1],tt("movable not in year",{name:di[zi][0],days:un[1][0]}))}}else Ui[1]?Ha=Ai(Xt[1]?di[zi-1][0]:nn.getFullYear(),di[zi][0],di[zi+1][0],Ui[1],un[1]):Ha=new Date(Xt[1]?di[zi-1][0]:nn.getFullYear(),di[zi][0],di[zi+1][0]+1);var ca=!0;if(Ha<qa){var ws=Ha;Ha=qa,qa=ws,ca=!1}return nn.getTime()<qa.getTime()?[!ca,qa]:nn.getTime()<Ha.getTime()?[ca,Ha]:Xt[0]?[!ca]:[!ca,Ja]}}(z,N,be,de,xe,st,vt,bt);we===!0?se.month.push(Zt):se.monthday.push(Zt),N=(bt[1]?bt[1][1]:vt+(xe[1]?1:2))+(typeof st[1]=="object"?st[1][1]:0)}else if(Ue[0]){de=de[0];var fi=z[N][0],ii=z[N+de][0],Mt=!0;do{var ct=z[N+1+de][0],Ot=Te(z,N+2+de,"-","number"),ui=void 0,li=z[N+de+(Ot?3:1)][0]+1;if(Ot&&Te(z,N+de+4,"/","number")&&(ui=z[N+de+5][0],z[N+de+5][4]="positive_number",Si(N+de+5,ui,"day")),Mt){var Ji=N+de+1+(Ot?2:0)+(ui?2:0)+!(Ot||ui);if(Te(z,Ji,"timesep","number")&&(Te(z,Ji+2,"+")||Te(z,Ji+2,"-")||rt!==0))return Ia(z,N,!0,!0)}if(li<ct)throw L(be,N+de+3,tt("day range reverse"));Wn(ii,ct,be,N+1+de),Wn(ii,li-1,be,N+de+(Ot?3:1));var Zt=function(It,Kt,Xt,Li,un,zi){return function(Ui){var nn=new Date(Ui.getFullYear()+1,0,1),Ja=new Date(Kt?It:Ui.getFullYear(),Xt,Li);if(Xt===1&&Li!==Ja.getDate())return[!1];var Rr=new Date(Ja.getFullYear(),Xt,un);if(Xt===1&&Ot&&un!==Rr.getDate())return[!1];if(Ui.getTime()<Ja.getTime())return[!1,Ja];if(Ui.getTime()>=Rr.getTime())return[!1,nn];if(!zi)return[!0,Rr];var qa=Math.floor((Ui.getTime()-Ja.getTime())/Dn),Cr=qa%zi;return Cr===0?[!0,new Date(Ui.getFullYear(),Ui.getMonth(),Ui.getDate()+1)]:[!1,new Date(Ui.getFullYear(),Ui.getMonth(),Ui.getDate()+zi-Cr)]}}(fi,de,ii,ct,li,ui);we===!0?se.month.push(Zt):se.monthday.push(Zt),N+=2+de+(Ot?2:0)+(ui?2:0),Mt=!1}while(Te(z,N,",","number"))}else if(xe[0]){var Zt=function(It,Kt,Xt,Li,un){return function(zi){var Ui=Yr(Li?It[Kt][0]:zi.getFullYear()),nn=Ui[It[Kt+Li][0]];if(!nn)throw tt("movable no formula",{name:It[Kt+Li][0]});if(un[0]&&(nn.setDate(nn.getDate()+un[0]),zi.getFullYear()!==nn.getFullYear()))throw L(Xt,Kt+Li+un[1],tt("movable not in year",{name:It[Kt+Li][0],days:un[0]}));return zi.getTime()<nn.getTime()?[!1,nn]:nn.getMonth()*100+nn.getDate()===zi.getMonth()*100+zi.getDate()?[!0,new Date(zi.getFullYear(),zi.getMonth(),zi.getDate()+1)]:[!1,new Date(zi.getFullYear()+1,0,1)]}}(z,N,be,de[0],st[0]);we===!0?se.month.push(Zt):se.monthday.push(Zt),N+=de[0]+xe[0]+(typeof st[0][1]=="number"&&st[0][1]?3:0)}else if(bt[0])N=Ia(z,N);else return Te(z,N,"month")?Ia(z,N,!0,!0):N;if(!Te(z,N,","))break}return N}this.getStatePair=function(z){for(var N=!1,be,we=!1,de,Ue,xe=[],st=0;st<Ei.length;st++){for(var bt=!0,Rt=0;Rt<Ei[st].date.length;Rt++){for(var vt=Ei[st].date[Rt],Zt=!1,fi=0;fi<vt.length;fi++){var ii=vt[fi](z);ii[0]&&(Zt=!0,typeof ii[2]=="string"&&(de=[ii[2],st])),(typeof be>"u"||typeof ii[1]=="object"&&ii[1].getTime()<be.getTime())&&(be=ii[1])}if(!Zt){bt=!1;break}}bt&&((Ei[st].date.length>0||st>0&&Ei[st].meaning&&Ei[st-1].date.length===0)&&(Ei[st].meaning||Ei[st].unknown)&&!Ei[st].wrapped&&!Ei[st].additional&&!Ei[st].fallback&&(xe=[]),xe.push(st))}for(var st=0;st<xe.length;st++){var Mt=xe[st];Ei[Mt].time.length===0&&(!Ei[Mt].fallback||Ei[Mt].fallback&&!(N||we))&&(N=Ei[Mt].meaning,we=Ei[Mt].unknown,Ue=Mt);for(var ct=0;ct<Ei[Mt].time.length;ct++){var ii=Ei[Mt].time[ct](z);if(ii[0]&&(!Ei[Mt].fallback||Ei[Mt].fallback&&!(N||we))){if(N=Ei[Mt].meaning,we=Ei[Mt].unknown,Ue=Mt,typeof de=="object"&&de[0]===tt("open end")&&(de=void 0),ii[2]===!0&&(N||we)&&(de=[tt("open end"),Ue],N=!1,we=!0,typeof Ei[Mt].time[ct+1]=="function")){var Ot=Ei[Mt].time[ct+1](z);!Ot[0]&&typeof Ot[1]=="object"&&Ei[Mt].time[ct](new Date(z.getTime()-1))[0]&&(N=!1,we=!1)}Ei[Mt].fallback&&(typeof be>"u"||typeof ii[1]<"u"&&ii[1]<be)&&(be=ii[1])}(typeof be>"u"||typeof ii[1]=="object"&&ii[1]<be)&&(be=ii[1])}}return typeof Ei[Ue]=="object"&&typeof Ei[Ue].comment=="string"?de=Ei[Ue].comment:typeof de=="object"&&(de[1]===Ue?de=de[0]:de=void 0),[N,be,we,de,Ue]};function xs(z,N,be,we,de){for(var Ue="",xe=N;xe<=be;)Te(z,xe,"weekday")?(!de.leave_weekday_sep_one_day_betw&&xe-N>1&&(Te(z,xe-1,",")||Te(z,xe-1,"-"))&&Te(z,xe-2,"weekday")&&z[xe][0]===(z[xe-2][0]+1)%7&&(Ue=Ue.substring(0,Ue.length-1)+de.sep_one_day_between),Ue+=vn[z[xe][0]]):xe-N>0&&we==="time"&&Te(z,xe-1,"timesep")&&Te(z,xe,"number")?Ue+=(z[xe][0]<10?"0":"")+z[xe][0].toString():we==="time"&&de.zero_pad_hour&&xe!==z.length&&Te(z,xe,"number")&&Te(z,xe+1,"timesep")?Ue+=(z[xe][0]<10?z[xe][0]===0&&de.one_zero_if_hour_zero?"":"0":"")+z[xe][0].toString():we==="time"&&xe+2<=be&&Te(z,xe,"number")&&Te(z,xe+1,"-")&&Te(z,xe+2,"number")?(Ue+=(z[xe][0]<10?z[xe][0]===0&&de.one_zero_if_hour_zero?"":"0":"")+z[xe][0].toString(),Ue+=":00-"+(z[xe+2][0]<10?"0":"")+z[xe+2][0].toString()+":00",xe+=2):Te(z,xe,"comment")?Ue+='"'+z[xe][0].toString()+'"':Te(z,xe,"closed")?Ue+=de.leave_off_closed?z[xe][0]:de.keyword_for_off_closed:xe-N>0&&Te(z,xe,"number")&&(we==="month"||we==="week")?Ue+=(Te(z,xe-1,"month")||Te(z,xe-1,"week")?" ":"")+(de.zero_pad_month_and_week_numbers&&z[xe][4]!=="positive_number"&&z[xe][0]<10?"0":"")+z[xe][0]:xe-N>0&&Te(z,xe,"month")&&Te(z,xe-1,"year")?Ue+=" "+mn[[z[xe][0]]]:xe-N>0&&Te(z,xe,"event")&&Te(z,xe-1,"year")?Ue+=" "+z[xe][0]:Te(z,xe,"month")?(Ue+=mn[[z[xe][0]]],xe+1<=be&&Te(z,xe+1,"weekday")&&(Ue+=" ")):xe+2<=be&&(Te(z,xe,"-")||Te(z,xe,"+"))&&Te(z,xe+1,"number","calcday")?(Ue+=" "+z[xe][0]+z[xe+1][0]+" day"+(Math.abs(z[xe+1][0])===1?"":"s"),xe+=2):xe===be&&we==="weekday"&&z[xe][0]===":"||xe===be&&we==="time"&&z[xe][0]===","||(Ue+=z[xe][0].toString()),xe++;return Ue}this.getState=function(z){var N=this.getIterator(z);return N.getState()},this.getUnknown=function(z){var N=this.getIterator(z);return N.getUnknown()},this.getStateString=function(z,N){var be=this.getIterator(z);return be.getStateString(N)},this.getComment=function(z){var N=this.getIterator(z);return N.getComment()},this.getMatchingRule=function(z){var N=this.getIterator(z);return N.getMatchingRule()},this.getWarnings=function(){var z=this.getIterator();return Ie(z)},this.prettifyValue=function(z){return this.getWarnings(),$e(z)},this.getNextChange=function(z,N){var be=this.getIterator(z);if(be.advance(N))return be.getDate()},this.isWeekStable=function(){return ni},this.isEqualTo=function(z,N){if(typeof N>"u")var N=new Date;var be;this.isWeekStable()&&z.isWeekStable()?be=new Date(N.getTime()+Dn*10):be=new Date(N.getTime()+Dn*366*5);for(var we=this.getIterator(N),de=z.getIterator(N);we.advance(be);){de.advance(be);var Ue=[];if(we.getDate().getTime()!==de.getDate().getTime()&&Ue.push("getDate"),we.getState()!==de.getState()&&Ue.push("getState"),we.getUnknown()!==de.getUnknown()&&Ue.push("getUnknown"),we.getComment()!==de.getComment()&&Ue.push("getComment"),Ue.length){var xe={};return xe[we.getDate().getTime()]=Ue,[!1,{matching_rule:we.getMatchingRule(),matching_rule_other:de.getMatchingRule(),deviation_for_time:xe}]}}return[!0]},this.getOpenIntervals=function(z,N){var be=[],we=this.getIterator(z);for((we.getState()||we.getUnknown())&&be.push([z,void 0,we.getUnknown(),we.getComment()]);we.advance(N);)we.getState()||we.getUnknown()?(be.length!==0&&typeof be[be.length-1][1]>"u"&&(be[be.length-1][1]=we.getDate()),be.push([we.getDate(),void 0,we.getUnknown(),we.getComment()])):be.length!==0&&typeof be[be.length-1][1]>"u"&&(be[be.length-1][1]=we.getDate());return be.length>0&&typeof be[be.length-1][1]>"u"&&(be[be.length-1][1]=N),be},this.getOpenDuration=function(z,N){for(var be=0,we=0,de=this.getIterator(z),Ue=de.getState()||de.getUnknown()?z:void 0,xe=de.getState(),st=de.getUnknown();de.advance(N);)de.getState()||de.getUnknown()?(typeof Ue=="object"&&(st?we+=de.getDate().getTime()-Ue.getTime():xe&&(be+=de.getDate().getTime()-Ue.getTime())),Ue=de.getDate(),xe=de.getState(),st=de.getUnknown()):typeof Ue=="object"&&(st?we+=de.getDate().getTime()-Ue.getTime():be+=de.getDate().getTime()-Ue.getTime(),Ue=void 0);return typeof Ue=="object"&&(st?we+=N.getTime()-Ue.getTime():be+=N.getTime()-Ue.getTime()),[be,we]},this.getIterator=function(z){return new function(N){typeof z>"u"&&(z=new Date);var be=[void 0,z,void 0,void 0,void 0],we=N.getStatePair(z);this.getDate=function(){return be[1]},this.setDate=function(de){if(typeof de!="object")throw tt("date parameter needed");be=[void 0,de,void 0,void 0,void 0],we=N.getStatePair(de)},this.getState=function(){return we[0]},this.getUnknown=function(){return we[2]},this.getStateString=function(de){return we[0]?"open":we[2]?"unknown":de?"closed":"close"},this.getComment=function(){return we[3]},this.getMatchingRule=function(){if(!(typeof we[4]>"u"))return Ei[we[4]].build_from_token_rule[2]},this.advance=function(de){if(typeof de>"u")de=new Date(be[1].getTime()+Dn*366*5);else if(de.getTime()<=be[1].getTime())return!1;do{if(typeof we[1]>"u")return!1;if(we[1].getTime()<=be[1].getTime())throw"Fatal: infinite loop in nextChange";if(we[1].getTime()>=de.getTime())return!1;be=we,we=N.getStatePair(be[1])}while(we[0]===be[0]&&we[2]===be[2]&&we[3]===be[3]);return!0}}(this)}}return ht})})(j2);var nw=j2.exports;const aw=R2(nw);class Eo{constructor(e,t,i){ft(this,"isDisplayed");ft(this,"appliedFilters");ft(this,"layerDef");ft(this,"hasFilter");ft(this,"currentFilter");if(this.layerDef=e,this.isDisplayed=i??new ki(!0),!t){const c=new Map;for(const u of this.layerDef.filters)c.set(u.id,new ki(void 0));t=c}this.appliedFilters=t;const s=new ki(void 0);this.appliedFilters.forEach(c=>{c.addCallbackAndRun(()=>{s.setData(this.calculateCurrentTags())})}),this.hasFilter=s.map(c=>c!==void 0),this.currentFilter=s}static fieldsToString(e){for(const t in e)e[t]===""&&delete e[t];return JSON.stringify(e)}static queryParameterKey(e){return"layer-"+e.id}static initLinkedState(e,t,i,s){let c;if(e.syncSelection==="local")c=wx.GetParsed(t+"-layer-"+e.id+"-enabled",e.shownByDefault);else if(e.syncSelection==="theme-only")c=Eo.getPref(i,t+"-layer-"+e.id+"-enabled",e);else if(e.syncSelection==="global")c=Eo.getPref(i,"layer-"+e.id+"-enabled",e);else{let o=e.shownByDefault;s!==void 0&&s.data===!1&&(o=!1),c=kx.GetBooleanQueryParameter(Eo.queryParameterKey(e),o,"Whether or not layer "+e.id+" is shown")}const u=new Map;for(const o of e.filters)u.set(o.id,o.initState(e.id));return new Eo(e,u,c)}static stringToFieldProperties(e){const t=JSON.parse(e);for(const i in t)t[i]===""&&delete t[i];return t}static fieldsToTags(e,t){let i;if(typeof t=="string"?i=Eo.stringToFieldProperties(t):i=t,e.fields.map(u=>u.name).filter(u=>i[u]===void 0).length>0)return;const c=Gn.WalkJson(e.originalTagsSpec,u=>{if(typeof u!="string")return u;for(const o in i)u.match(/[a-zA-Z0-9_:]+~/)?u=u.replace("{"+o+"}","("+i[o]+")"):u=u.replace("{"+o+"}",i[o]);return u});return _s.Tag(c)}static getPref(e,t,i){return e.GetPreference(t,i.shownByDefault+"").sync(s=>{if(s!==void 0)return s==="true"},[],s=>{if(s!==void 0)return""+s})}disableAllFilters(){this.appliedFilters.forEach(e=>e.setData(void 0))}isShown(e,t){if(e._deleted==="yes")return!1;for(const i of t??[]){const s=i.osmTags;if(s!==void 0&&!s.matchesProperties(e))return!1}{const i=this.layerDef.isShown;if(i!==void 0&&!i.matchesProperties(e))return!1}{const i=this.currentFilter.data;if(i!==void 0&&!i.matchesProperties(e))return!1}return!0}calculateCurrentTags(){let e=[];for(const s of this.layerDef.filters){const c=this.appliedFilters.get(s.id);if(c.data!==void 0){if(s.options[0].fields.length>0){const u=Eo.stringToFieldProperties(c.data),o=Eo.fieldsToTags(s.options[0],u);o&&e.push(o);continue}e.push(s.options[c.data].osmTags)}}if(e=Gn.NoNull(e),e.length==0)return;let t;e.length==1?t=e[0]:t=new Dx(e);const i=t.optimize();if(i!==!0)return i===!1?t:i}}var q2={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.1.2/LICENSE.txt
 */(function(n,e){(function(t,i){n.exports=i()})(z2,function(){var t={},i={};function s(u,o,p){if(i[u]=p,u==="index"){var _="var sharedModule = {}; ("+i.shared+")(sharedModule); ("+i.worker+")(sharedModule);",v={};return i.shared(v),i.index(t,v),typeof window<"u"&&t.setWorkerUrl(window.URL.createObjectURL(new Blob([_],{type:"text/javascript"}))),t}}s("shared",["exports"],function(u){function o(l,a,h,f){return new(h||(h=Promise))(function(y,w){function k(E){try{P(f.next(E))}catch(B){w(B)}}function D(E){try{P(f.throw(E))}catch(B){w(B)}}function P(E){var B;E.done?y(E.value):(B=E.value,B instanceof h?B:new h(function(H){H(B)})).then(k,D)}P((f=f.apply(l,a||[])).next())})}function p(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}typeof SuppressedError=="function"&&SuppressedError;var _=v;function v(l,a){this.x=l,this.y=a}v.prototype={clone:function(){return new v(this.x,this.y)},add:function(l){return this.clone()._add(l)},sub:function(l){return this.clone()._sub(l)},multByPoint:function(l){return this.clone()._multByPoint(l)},divByPoint:function(l){return this.clone()._divByPoint(l)},mult:function(l){return this.clone()._mult(l)},div:function(l){return this.clone()._div(l)},rotate:function(l){return this.clone()._rotate(l)},rotateAround:function(l,a){return this.clone()._rotateAround(l,a)},matMult:function(l){return this.clone()._matMult(l)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(l){return this.x===l.x&&this.y===l.y},dist:function(l){return Math.sqrt(this.distSqr(l))},distSqr:function(l){var a=l.x-this.x,h=l.y-this.y;return a*a+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(l){return Math.atan2(this.y-l.y,this.x-l.x)},angleWith:function(l){return this.angleWithSep(l.x,l.y)},angleWithSep:function(l,a){return Math.atan2(this.x*a-this.y*l,this.x*l+this.y*a)},_matMult:function(l){var a=l[2]*this.x+l[3]*this.y;return this.x=l[0]*this.x+l[1]*this.y,this.y=a,this},_add:function(l){return this.x+=l.x,this.y+=l.y,this},_sub:function(l){return this.x-=l.x,this.y-=l.y,this},_mult:function(l){return this.x*=l,this.y*=l,this},_div:function(l){return this.x/=l,this.y/=l,this},_multByPoint:function(l){return this.x*=l.x,this.y*=l.y,this},_divByPoint:function(l){return this.x/=l.x,this.y/=l.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var l=this.y;return this.y=this.x,this.x=-l,this},_rotate:function(l){var a=Math.cos(l),h=Math.sin(l),f=h*this.x+a*this.y;return this.x=a*this.x-h*this.y,this.y=f,this},_rotateAround:function(l,a){var h=Math.cos(l),f=Math.sin(l),y=a.y+f*(this.x-a.x)+h*(this.y-a.y);return this.x=a.x+h*(this.x-a.x)-f*(this.y-a.y),this.y=y,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},v.convert=function(l){return l instanceof v?l:Array.isArray(l)?new v(l[0],l[1]):l};var M=p(_),S=I;function I(l,a,h,f){this.cx=3*l,this.bx=3*(h-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(f-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=a,this.p2x=h,this.p2y=f}I.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,a){if(a===void 0&&(a=1e-6),l<0)return 0;if(l>1)return 1;for(var h=l,f=0;f<8;f++){var y=this.sampleCurveX(h)-l;if(Math.abs(y)<a)return h;var w=this.sampleCurveDerivativeX(h);if(Math.abs(w)<1e-6)break;h-=y/w}var k=0,D=1;for(h=l,f=0;f<20&&(y=this.sampleCurveX(h),!(Math.abs(y-l)<a));f++)l>y?k=h:D=h,h=.5*(D-k)+k;return h},solve:function(l,a){return this.sampleCurveY(this.solveCurveX(l,a))}};var R=p(S);let G,Y;function X(){return G==null&&(G=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),G}function oe(){if(Y==null&&(Y=!1,X())){const a=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(a){for(let f=0;f<5*5;f++){const y=4*f;a.fillStyle=`rgb(${y},${y+1},${y+2})`,a.fillRect(f%5,Math.floor(f/5),1,1)}const h=a.getImageData(0,0,5,5).data;for(let f=0;f<5*5*4;f++)if(f%4!=3&&h[f]!==f){Y=!0;break}}}return Y||!1}function Q(l,a,h,f){const y=new R(l,a,h,f);return function(w){return y.solve(w)}}const ce=Q(.25,.1,.25,1);function De(l,a,h){return Math.min(h,Math.max(a,l))}function Oe(l,a,h){const f=h-a,y=((l-a)%f+f)%f+a;return y===a?h:y}function Pe(l,...a){for(const h of a)for(const f in h)l[f]=h[f];return l}let Se=1;function _e(l,a,h){const f={};for(const y in l)f[y]=a.call(h||this,l[y],y,l);return f}function ze(l,a,h){const f={};for(const y in l)a.call(h||this,l[y],y,l)&&(f[y]=l[y]);return f}function Re(l){return Array.isArray(l)?l.map(Re):typeof l=="object"&&l?_e(l,Re):l}const Ye={};function Xe(l){Ye[l]||(typeof console<"u"&&console.warn(l),Ye[l]=!0)}function si(l,a,h){return(h.y-l.y)*(a.x-l.x)>(a.y-l.y)*(h.x-l.x)}function Bt(l){let a=0;for(let h,f,y=0,w=l.length,k=w-1;y<w;k=y++)h=l[y],f=l[k],a+=(f.x-h.x)*(h.y+f.y);return a}function bi(l){return typeof WorkerGlobalScope<"u"&&l!==void 0&&l instanceof WorkerGlobalScope}let Et=null;function Vt(l){return typeof ImageBitmap<"u"&&l instanceof ImageBitmap}const Ki="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function zt(l,a,h,f,y){return o(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const w=new VideoFrame(l,{timestamp:0});try{const k=w==null?void 0:w.format;if(!k||!k.startsWith("BGR")&&!k.startsWith("RGB"))throw new Error(`Unrecognized format ${k}`);const D=k.startsWith("BGR"),P=new Uint8ClampedArray(f*y*4);if(yield w.copyTo(P,function(E,B,H,K,ee){const ne=4*Math.max(-B,0),ue=(Math.max(0,H)-H)*K*4+ne,me=4*K,ke=Math.max(0,B),Ve=Math.max(0,H);return{rect:{x:ke,y:Ve,width:Math.min(E.width,B+K)-ke,height:Math.min(E.height,H+ee)-Ve},layout:[{offset:ue,stride:me}]}}(l,a,h,f,y)),D)for(let E=0;E<P.length;E+=4){const B=P[E];P[E]=P[E+2],P[E+2]=B}return P}finally{w.close()}})}let _t,Dt;const Ft="AbortError";function oi(){return new Error(Ft)}const pi={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function vi(l){return pi.REGISTERED_PROTOCOLS[l.substring(0,l.indexOf("://"))]}const Ti="global-dispatcher";class ht extends Error{constructor(a,h,f,y){super(`AJAXError: ${h} (${a}): ${f}`),this.status=a,this.statusText=h,this.url=f,this.body=y}}const mi=()=>bi(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Pi=function(l,a){if(/:\/\//.test(l.url)&&!/^https?:|^file:/.test(l.url)){const f=vi(l.url);if(f)return f(l,a);if(bi(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:l,targetMapId:Ti},a)}if(!(/^file:/.test(h=l.url)||/^file:/.test(mi())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(f,y){return o(this,void 0,void 0,function*(){const w=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,cache:f.cache,referrer:mi(),signal:y.signal});f.type==="json"&&w.headers.set("Accept","application/json");const k=yield fetch(w);if(!k.ok){const E=yield k.blob();throw new ht(k.status,k.statusText,f.url,E)}let D;D=f.type==="arrayBuffer"||f.type==="image"?k.arrayBuffer():f.type==="json"?k.json():k.text();const P=yield D;if(y.signal.aborted)throw oi();return{data:P,cacheControl:k.headers.get("Cache-Control"),expires:k.headers.get("Expires")}})}(l,a);if(bi(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:l,mustQueue:!0,targetMapId:Ti},a)}var h;return function(f,y){return new Promise((w,k)=>{const D=new XMLHttpRequest;D.open(f.method||"GET",f.url,!0),f.type!=="arrayBuffer"&&f.type!=="image"||(D.responseType="arraybuffer");for(const P in f.headers)D.setRequestHeader(P,f.headers[P]);f.type==="json"&&(D.responseType="text",D.setRequestHeader("Accept","application/json")),D.withCredentials=f.credentials==="include",D.onerror=()=>{k(new Error(D.statusText))},D.onload=()=>{if(!y.signal.aborted)if((D.status>=200&&D.status<300||D.status===0)&&D.response!==null){let P=D.response;if(f.type==="json")try{P=JSON.parse(D.response)}catch(E){return void k(E)}w({data:P,cacheControl:D.getResponseHeader("Cache-Control"),expires:D.getResponseHeader("Expires")})}else{const P=new Blob([D.response],{type:D.getResponseHeader("Content-Type")});k(new ht(D.status,D.statusText,f.url,P))}},y.signal.addEventListener("abort",()=>{D.abort(),k(oi())}),D.send(f.body)})}(l,a)};function Ni(l){if(!l||l.indexOf("://")<=0||l.indexOf("data:image/")===0||l.indexOf("blob:")===0)return!0;const a=new URL(l),h=window.location;return a.protocol===h.protocol&&a.host===h.host}function Oi(l,a,h){h[l]&&h[l].indexOf(a)!==-1||(h[l]=h[l]||[],h[l].push(a))}function mn(l,a,h){if(h&&h[l]){const f=h[l].indexOf(a);f!==-1&&h[l].splice(f,1)}}class vn{constructor(a,h={}){Pe(this,h),this.type=a}}class Yi extends vn{constructor(a,h={}){super("error",Pe({error:a},h))}}class Kn{on(a,h){return this._listeners=this._listeners||{},Oi(a,h,this._listeners),this}off(a,h){return mn(a,h,this._listeners),mn(a,h,this._oneTimeListeners),this}once(a,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},Oi(a,h,this._oneTimeListeners),this):new Promise(f=>this.once(a,f))}fire(a,h){typeof a=="string"&&(a=new vn(a,h||{}));const f=a.type;if(this.listens(f)){a.target=this;const y=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const D of y)D.call(this,a);const w=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const D of w)mn(f,D,this._oneTimeListeners),D.call(this,a);const k=this._eventedParent;k&&(Pe(a,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),k.fire(a))}else a instanceof Yi&&console.error(a.error);return this}listens(a){return this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a)}setEventedParent(a,h){return this._eventedParent=a,this._eventedParentData=h,this}}var je={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Ci=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Dn(l,a){const h={};for(const f in l)f!=="ref"&&(h[f]=l[f]);return Ci.forEach(f=>{f in a&&(h[f]=a[f])}),h}function xi(l,a){if(Array.isArray(l)){if(!Array.isArray(a)||l.length!==a.length)return!1;for(let h=0;h<l.length;h++)if(!xi(l[h],a[h]))return!1;return!0}if(typeof l=="object"&&l!==null&&a!==null){if(typeof a!="object"||Object.keys(l).length!==Object.keys(a).length)return!1;for(const h in l)if(!xi(l[h],a[h]))return!1;return!0}return l===a}function tn(l,a){l.push(a)}function xn(l,a,h){tn(h,{command:"addSource",args:[l,a[l]]})}function tt(l,a,h){tn(a,{command:"removeSource",args:[l]}),h[l]=!0}function bn(l,a,h,f){tt(l,h,f),xn(l,a,h)}function _n(l,a,h){let f;for(f in l[h])if(Object.prototype.hasOwnProperty.call(l[h],f)&&f!=="data"&&!xi(l[h][f],a[h][f]))return!1;for(f in a[h])if(Object.prototype.hasOwnProperty.call(a[h],f)&&f!=="data"&&!xi(l[h][f],a[h][f]))return!1;return!0}function cn(l,a,h,f,y,w){l=l||{},a=a||{};for(const k in l)Object.prototype.hasOwnProperty.call(l,k)&&(xi(l[k],a[k])||h.push({command:w,args:[f,k,a[k],y]}));for(const k in a)Object.prototype.hasOwnProperty.call(a,k)&&!Object.prototype.hasOwnProperty.call(l,k)&&(xi(l[k],a[k])||h.push({command:w,args:[f,k,a[k],y]}))}function ta(l){return l.id}function pa(l,a){return l[a.id]=a,l}class rt{constructor(a,h,f,y){this.message=(a?`${a}: `:"")+f,y&&(this.identifier=y),h!=null&&h.__line__&&(this.line=h.__line__)}}function jn(l,...a){for(const h of a)for(const f in h)l[f]=h[f];return l}class hn extends Error{constructor(a,h){super(h),this.message=h,this.key=a}}class Un{constructor(a,h=[]){this.parent=a,this.bindings={};for(const[f,y]of h)this.bindings[f]=y}concat(a){return new Un(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}const Ii={kind:"null"},lt={kind:"number"},gi={kind:"string"},_i={kind:"boolean"},on={kind:"color"},wn={kind:"object"},ni={kind:"value"},Ei={kind:"collator"},ji={kind:"formatted"},re={kind:"padding"},U={kind:"resolvedImage"},J={kind:"variableAnchorOffsetCollection"};function te(l,a){return{kind:"array",itemType:l,N:a}}function se(l){if(l.kind==="array"){const a=se(l.itemType);return typeof l.N=="number"?`array<${a}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${a}>`}return l.kind}const Ae=[Ii,lt,gi,_i,on,ji,wn,te(ni),re,U,J];function Ee(l,a){if(a.kind==="error")return null;if(l.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!Ee(l.itemType,a.itemType))&&(typeof l.N!="number"||l.N===a.N))return null}else{if(l.kind===a.kind)return null;if(l.kind==="value"){for(const h of Ae)if(!Ee(h,a))return null}}return`Expected ${se(l)} but found ${se(a)} instead.`}function $(l,a){return a.some(h=>h.kind===l.kind)}function O(l,a){return a.some(h=>h==="null"?l===null:h==="array"?Array.isArray(l):h==="object"?l&&!Array.isArray(l)&&typeof l=="object":h===typeof l)}function V(l,a){return l.kind==="array"&&a.kind==="array"?l.itemType.kind===a.itemType.kind&&typeof l.N=="number":l.kind===a.kind}const q=.96422,L=.82521,W=4/29,ae=6/29,Me=3*ae*ae,Ie=ae*ae*ae,Qe=Math.PI/180,Ge=180/Math.PI;function $e(l){return(l%=360)<0&&(l+=360),l}function Te([l,a,h,f]){let y,w;const k=wt((.2225045*(l=gt(l))+.7168786*(a=gt(a))+.0606169*(h=gt(h)))/1);l===a&&a===h?y=w=k:(y=wt((.4360747*l+.3850649*a+.1430804*h)/q),w=wt((.0139322*l+.0971045*a+.7141733*h)/L));const D=116*k-16;return[D<0?0:D,500*(y-k),200*(k-w),f]}function gt(l){return l<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function wt(l){return l>Ie?Math.pow(l,1/3):l/Me+W}function St([l,a,h,f]){let y=(l+16)/116,w=isNaN(a)?y:y+a/500,k=isNaN(h)?y:y-h/200;return y=1*Tt(y),w=q*Tt(w),k=L*Tt(k),[$t(3.1338561*w-1.6168667*y-.4906146*k),$t(-.9787684*w+1.9161415*y+.033454*k),$t(.0719453*w-.2289914*y+1.4052427*k),f]}function $t(l){return(l=l<=.00304?12.92*l:1.055*Math.pow(l,1/2.4)-.055)<0?0:l>1?1:l}function Tt(l){return l>ae?l*l*l:Me*(l-W)}function Ct(l){return parseInt(l.padEnd(2,l),16)/255}function Si(l,a){return Ai(a?l/100:l,0,1)}function Ai(l,a,h){return Math.min(Math.max(a,l),h)}function Wn(l){return!l.some(Number.isNaN)}const Aa={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Fi{constructor(a,h,f,y=1,w=!0){this.r=a,this.g=h,this.b=f,this.a=y,w||(this.r*=y,this.g*=y,this.b*=y,y||this.overwriteGetter("rgb",[a,h,f,y]))}static parse(a){if(a instanceof Fi)return a;if(typeof a!="string")return;const h=function(f){if((f=f.toLowerCase().trim())==="transparent")return[0,0,0,0];const y=Aa[f];if(y){const[k,D,P]=y;return[k/255,D/255,P/255,1]}if(f.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(f)){const k=f.length<6?1:2;let D=1;return[Ct(f.slice(D,D+=k)),Ct(f.slice(D,D+=k)),Ct(f.slice(D,D+=k)),Ct(f.slice(D,D+k)||"ff")]}if(f.startsWith("rgb")){const k=f.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(k){const[D,P,E,B,H,K,ee,ne,ue,me,ke,Ve]=k,Ce=[B||" ",ee||" ",me].join("");if(Ce==="  "||Ce==="  /"||Ce===",,"||Ce===",,,"){const Be=[E,K,ue].join(""),it=Be==="%%%"?100:Be===""?255:0;if(it){const ot=[Ai(+P/it,0,1),Ai(+H/it,0,1),Ai(+ne/it,0,1),ke?Si(+ke,Ve):1];if(Wn(ot))return ot}}return}}const w=f.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(w){const[k,D,P,E,B,H,K,ee,ne]=w,ue=[P||" ",B||" ",K].join("");if(ue==="  "||ue==="  /"||ue===",,"||ue===",,,"){const me=[+D,Ai(+E,0,100),Ai(+H,0,100),ee?Si(+ee,ne):1];if(Wn(me))return function([ke,Ve,Ce,Be]){function it(ot){const Ht=(ot+ke/30)%12,ti=Ve*Math.min(Ce,1-Ce);return Ce-ti*Math.max(-1,Math.min(Ht-3,9-Ht,1))}return ke=$e(ke),Ve/=100,Ce/=100,[it(0),it(8),it(4),Be]}(me)}}}(a);return h?new Fi(...h,!1):void 0}get rgb(){const{r:a,g:h,b:f,a:y}=this,w=y||1/0;return this.overwriteGetter("rgb",[a/w,h/w,f/w,y])}get hcl(){return this.overwriteGetter("hcl",function(a){const[h,f,y,w]=Te(a),k=Math.sqrt(f*f+y*y);return[Math.round(1e4*k)?$e(Math.atan2(y,f)*Ge):NaN,k,h,w]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Te(this.rgb))}overwriteGetter(a,h){return Object.defineProperty(this,a,{value:h}),h}toString(){const[a,h,f,y]=this.rgb;return`rgba(${[a,h,f].map(w=>Math.round(255*w)).join(",")},${y})`}}Fi.black=new Fi(0,0,0,1),Fi.white=new Fi(1,1,1,1),Fi.transparent=new Fi(0,0,0,0),Fi.red=new Fi(1,0,0,1);class ia{constructor(a,h,f){this.sensitivity=a?h?"variant":"case":h?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,h){return this.collator.compare(a,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Wa{constructor(a,h,f,y,w){this.text=a,this.image=h,this.scale=f,this.fontStack=y,this.textColor=w}}class In{constructor(a){this.sections=a}static fromString(a){return new In([new Wa(a,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(a=>a.text.length!==0||a.image&&a.image.name.length!==0)}static factory(a){return a instanceof In?a:In.fromString(a)}toString(){return this.sections.length===0?"":this.sections.map(a=>a.text).join("")}}class ma{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof ma)return a;if(typeof a=="number")return new ma([a,a,a,a]);if(Array.isArray(a)&&!(a.length<1||a.length>4)){for(const h of a)if(typeof h!="number")return;switch(a.length){case 1:a=[a[0],a[0],a[0],a[0]];break;case 2:a=[a[0],a[1],a[0],a[1]];break;case 3:a=[a[0],a[1],a[2],a[1]]}return new ma(a)}}toString(){return JSON.stringify(this.values)}}const Na=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class la{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof la)return a;if(Array.isArray(a)&&!(a.length<1)&&a.length%2==0){for(let h=0;h<a.length;h+=2){const f=a[h],y=a[h+1];if(typeof f!="string"||!Na.has(f)||!Array.isArray(y)||y.length!==2||typeof y[0]!="number"||typeof y[1]!="number")return}return new la(a)}}toString(){return JSON.stringify(this.values)}}class na{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new na({name:a,available:!1}):null}}function Yr(l,a,h,f){return typeof l=="number"&&l>=0&&l<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof h=="number"&&h>=0&&h<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[l,a,h,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[l,a,h,f]:[l,a,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Va(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof Fi||l instanceof ia||l instanceof In||l instanceof ma||l instanceof la||l instanceof na)return!0;if(Array.isArray(l)){for(const a of l)if(!Va(a))return!1;return!0}if(typeof l=="object"){for(const a in l)if(!Va(l[a]))return!1;return!0}return!1}function Tn(l){if(l===null)return Ii;if(typeof l=="string")return gi;if(typeof l=="boolean")return _i;if(typeof l=="number")return lt;if(l instanceof Fi)return on;if(l instanceof ia)return Ei;if(l instanceof In)return ji;if(l instanceof ma)return re;if(l instanceof la)return J;if(l instanceof na)return U;if(Array.isArray(l)){const a=l.length;let h;for(const f of l){const y=Tn(f);if(h){if(h===y)continue;h=ni;break}h=y}return te(h||ni,a)}return wn}function Jr(l){const a=typeof l;return l===null?"":a==="string"||a==="number"||a==="boolean"?String(l):l instanceof Fi||l instanceof In||l instanceof ma||l instanceof la||l instanceof na?l.toString():JSON.stringify(l)}class xr{constructor(a,h){this.type=a,this.value=h}static parse(a,h){if(a.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!Va(a[1]))return h.error("invalid value");const f=a[1];let y=Tn(f);const w=h.expectedType;return y.kind!=="array"||y.N!==0||!w||w.kind!=="array"||typeof w.N=="number"&&w.N!==0||(y=w),new xr(y,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Rn{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}}const xa={string:gi,number:lt,boolean:_i,object:wn};class Ia{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");let f,y=1;const w=a[0];if(w==="array"){let D,P;if(a.length>2){const E=a[1];if(typeof E!="string"||!(E in xa)||E==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);D=xa[E],y++}else D=ni;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return h.error('The length argument to "array" must be a positive integer literal',2);P=a[2],y++}f=te(D,P)}else{if(!xa[w])throw new Error(`Types doesn't contain name = ${w}`);f=xa[w]}const k=[];for(;y<a.length;y++){const D=h.parse(a[y],y,ni);if(!D)return null;k.push(D)}return new Ia(f,k)}evaluate(a){for(let h=0;h<this.args.length;h++){const f=this.args[h].evaluate(a);if(!Ee(this.type,Tn(f)))return f;if(h===this.args.length-1)throw new Rn(`Expected value to be of type ${se(this.type)}, but found ${se(Tn(f))} instead.`)}throw new Error}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}const ls={"to-boolean":_i,"to-color":on,"to-number":lt,"to-string":gi};class wa{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");const f=a[0];if(!ls[f])throw new Error(`Can't parse ${f} as it is not part of the known types`);if((f==="to-boolean"||f==="to-string")&&a.length!==2)return h.error("Expected one argument.");const y=ls[f],w=[];for(let k=1;k<a.length;k++){const D=h.parse(a[k],k,ni);if(!D)return null;w.push(D)}return new wa(y,w)}evaluate(a){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(a);case"color":{let h,f;for(const y of this.args){if(h=y.evaluate(a),f=null,h instanceof Fi)return h;if(typeof h=="string"){const w=a.parseColor(h);if(w)return w}else if(Array.isArray(h)&&(f=h.length<3||h.length>4?`Invalid rbga value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:Yr(h[0],h[1],h[2],h[3]),!f))return new Fi(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new Rn(f||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"padding":{let h;for(const f of this.args){h=f.evaluate(a);const y=ma.parse(h);if(y)return y}throw new Rn(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"variableAnchorOffsetCollection":{let h;for(const f of this.args){h=f.evaluate(a);const y=la.parse(h);if(y)return y}throw new Rn(`Could not parse variableAnchorOffsetCollection from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"number":{let h=null;for(const f of this.args){if(h=f.evaluate(a),h===null)return 0;const y=Number(h);if(!isNaN(y))return y}throw new Rn(`Could not convert ${JSON.stringify(h)} to number.`)}case"formatted":return In.fromString(Jr(this.args[0].evaluate(a)));case"resolvedImage":return na.fromString(Jr(this.args[0].evaluate(a)));default:return Jr(this.args[0].evaluate(a))}}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}const xs=["Unknown","Point","LineString","Polygon"];class z{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?xs[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(a){let h=this._parseColorCache[a];return h||(h=this._parseColorCache[a]=Fi.parse(a)),h}}class N{constructor(a,h,f=[],y,w=new Un,k=[]){this.registry=a,this.path=f,this.key=f.map(D=>`[${D}]`).join(""),this.scope=w,this.errors=k,this.expectedType=y,this._isConstant=h}parse(a,h,f,y,w={}){return h?this.concat(h,f,y)._parse(a,w):this._parse(a,w)}_parse(a,h){function f(y,w,k){return k==="assert"?new Ia(w,[y]):k==="coerce"?new wa(w,[y]):y}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const y=a[0];if(typeof y!="string")return this.error(`Expression name must be a string, but found ${typeof y} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const w=this.registry[y];if(w){let k=w.parse(a,this);if(!k)return null;if(this.expectedType){const D=this.expectedType,P=k.type;if(D.kind!=="string"&&D.kind!=="number"&&D.kind!=="boolean"&&D.kind!=="object"&&D.kind!=="array"||P.kind!=="value")if(D.kind!=="color"&&D.kind!=="formatted"&&D.kind!=="resolvedImage"||P.kind!=="value"&&P.kind!=="string")if(D.kind!=="padding"||P.kind!=="value"&&P.kind!=="number"&&P.kind!=="array")if(D.kind!=="variableAnchorOffsetCollection"||P.kind!=="value"&&P.kind!=="array"){if(this.checkSubtype(D,P))return null}else k=f(k,D,h.typeAnnotation||"coerce");else k=f(k,D,h.typeAnnotation||"coerce");else k=f(k,D,h.typeAnnotation||"coerce");else k=f(k,D,h.typeAnnotation||"assert")}if(!(k instanceof xr)&&k.type.kind!=="resolvedImage"&&this._isConstant(k)){const D=new z;try{k=new xr(k.type,k.evaluate(D))}catch(P){return this.error(P.message),null}}return k}return this.error(`Unknown expression "${y}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,h,f){const y=typeof a=="number"?this.path.concat(a):this.path,w=f?this.scope.concat(f):this.scope;return new N(this.registry,this._isConstant,y,h||null,w,this.errors)}error(a,...h){const f=`${this.key}${h.map(y=>`[${y}]`).join("")}`;this.errors.push(new hn(f,a))}checkSubtype(a,h){const f=Ee(a,h);return f&&this.error(f),f}}class be{constructor(a,h,f){this.type=Ei,this.locale=f,this.caseSensitive=a,this.diacriticSensitive=h}static parse(a,h){if(a.length!==2)return h.error("Expected one argument.");const f=a[1];if(typeof f!="object"||Array.isArray(f))return h.error("Collator options argument must be an object.");const y=h.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,_i);if(!y)return null;const w=h.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,_i);if(!w)return null;let k=null;return f.locale&&(k=h.parse(f.locale,1,gi),!k)?null:new be(y,w,k)}evaluate(a){return new ia(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}}const we=8192;function de(l,a){l[0]=Math.min(l[0],a[0]),l[1]=Math.min(l[1],a[1]),l[2]=Math.max(l[2],a[0]),l[3]=Math.max(l[3],a[1])}function Ue(l,a){return!(l[0]<=a[0]||l[2]>=a[2]||l[1]<=a[1]||l[3]>=a[3])}function xe(l,a){const h=(180+l[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,y=Math.pow(2,a.z);return[Math.round(h*y*we),Math.round(f*y*we)]}function st(l,a,h){const f=l[0]-a[0],y=l[1]-a[1],w=l[0]-h[0],k=l[1]-h[1];return f*k-w*y==0&&f*w<=0&&y*k<=0}function bt(l,a){let h=!1;for(let k=0,D=a.length;k<D;k++){const P=a[k];for(let E=0,B=P.length;E<B-1;E++){if(st(l,P[E],P[E+1]))return!1;(y=P[E])[1]>(f=l)[1]!=(w=P[E+1])[1]>f[1]&&f[0]<(w[0]-y[0])*(f[1]-y[1])/(w[1]-y[1])+y[0]&&(h=!h)}}var f,y,w;return h}function Rt(l,a){for(let h=0;h<a.length;h++)if(bt(l,a[h]))return!0;return!1}function vt(l,a,h,f){const y=f[0]-h[0],w=f[1]-h[1],k=(l[0]-h[0])*w-y*(l[1]-h[1]),D=(a[0]-h[0])*w-y*(a[1]-h[1]);return k>0&&D<0||k<0&&D>0}function Zt(l,a,h){for(const E of h)for(let B=0;B<E.length-1;++B)if((D=[(k=E[B+1])[0]-(w=E[B])[0],k[1]-w[1]])[0]*(P=[(y=a)[0]-(f=l)[0],y[1]-f[1]])[1]-D[1]*P[0]!=0&&vt(f,y,w,k)&&vt(w,k,f,y))return!0;var f,y,w,k,D,P;return!1}function fi(l,a){for(let h=0;h<l.length;++h)if(!bt(l[h],a))return!1;for(let h=0;h<l.length-1;++h)if(Zt(l[h],l[h+1],a))return!1;return!0}function ii(l,a){for(let h=0;h<a.length;h++)if(fi(l,a[h]))return!0;return!1}function Mt(l,a,h){const f=[];for(let y=0;y<l.length;y++){const w=[];for(let k=0;k<l[y].length;k++){const D=xe(l[y][k],h);de(a,D),w.push(D)}f.push(w)}return f}function ct(l,a,h){const f=[];for(let y=0;y<l.length;y++){const w=Mt(l[y],a,h);f.push(w)}return f}function Ot(l,a,h,f){if(l[0]<h[0]||l[0]>h[2]){const y=.5*f;let w=l[0]-h[0]>y?-f:h[0]-l[0]>y?f:0;w===0&&(w=l[0]-h[2]>y?-f:h[2]-l[0]>y?f:0),l[0]+=w}de(a,l)}function ui(l,a,h,f){const y=Math.pow(2,f.z)*we,w=[f.x*we,f.y*we],k=[];for(const D of l)for(const P of D){const E=[P.x+w[0],P.y+w[1]];Ot(E,a,h,y),k.push(E)}return k}function li(l,a,h,f){const y=Math.pow(2,f.z)*we,w=[f.x*we,f.y*we],k=[];for(const P of l){const E=[];for(const B of P){const H=[B.x+w[0],B.y+w[1]];de(a,H),E.push(H)}k.push(E)}if(a[2]-a[0]<=y/2){(D=a)[0]=D[1]=1/0,D[2]=D[3]=-1/0;for(const P of k)for(const E of P)Ot(E,a,h,y)}var D;return k}class Ji{constructor(a,h){this.type=_i,this.geojson=a,this.geometries=h}static parse(a,h){if(a.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(Va(a[1])){const f=a[1];if(f.type==="FeatureCollection"){const y=[];for(const w of f.features){const{type:k,coordinates:D}=w.geometry;k==="Polygon"&&y.push(D),k==="MultiPolygon"&&y.push(...D)}if(y.length)return new Ji(f,{type:"MultiPolygon",coordinates:y})}else if(f.type==="Feature"){const y=f.geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new Ji(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new Ji(f,f)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(h,f){const y=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],k=h.canonicalID();if(f.type==="Polygon"){const D=Mt(f.coordinates,w,k),P=ui(h.geometry(),y,w,k);if(!Ue(y,w))return!1;for(const E of P)if(!bt(E,D))return!1}if(f.type==="MultiPolygon"){const D=ct(f.coordinates,w,k),P=ui(h.geometry(),y,w,k);if(!Ue(y,w))return!1;for(const E of P)if(!Rt(E,D))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(h,f){const y=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],k=h.canonicalID();if(f.type==="Polygon"){const D=Mt(f.coordinates,w,k),P=li(h.geometry(),y,w,k);if(!Ue(y,w))return!1;for(const E of P)if(!fi(E,D))return!1}if(f.type==="MultiPolygon"){const D=ct(f.coordinates,w,k),P=li(h.geometry(),y,w,k);if(!Ue(y,w))return!1;for(const E of P)if(!ii(E,D))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class di{constructor(a,h){this.type=h.type,this.name=a,this.boundExpression=h}static parse(a,h){if(a.length!==2||typeof a[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const f=a[1];return h.scope.has(f)?new di(f,h.scope.get(f)):h.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}}class It{constructor(a,h,f,y){this.name=a,this.type=h,this._evaluate=f,this.args=y}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}static parse(a,h){const f=a[0],y=It.definitions[f];if(!y)return h.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const w=Array.isArray(y)?y[0]:y.type,k=Array.isArray(y)?[[y[1],y[2]]]:y.overloads,D=k.filter(([E])=>!Array.isArray(E)||E.length===a.length-1);let P=null;for(const[E,B]of D){P=new N(h.registry,Kt,h.path,null,h.scope);const H=[];let K=!1;for(let ee=1;ee<a.length;ee++){const ne=a[ee],ue=Array.isArray(E)?E[ee-1]:E.type,me=P.parse(ne,1+H.length,ue);if(!me){K=!0;break}H.push(me)}if(!K)if(Array.isArray(E)&&E.length!==H.length)P.error(`Expected ${E.length} arguments, but found ${H.length} instead.`);else{for(let ee=0;ee<H.length;ee++){const ne=Array.isArray(E)?E[ee]:E.type,ue=H[ee];P.concat(ee+1).checkSubtype(ne,ue.type)}if(P.errors.length===0)return new It(f,w,B,H)}}if(D.length===1)h.errors.push(...P.errors);else{const E=(D.length?D:k).map(([H])=>{return K=H,Array.isArray(K)?`(${K.map(se).join(", ")})`:`(${se(K.type)}...)`;var K}).join(" | "),B=[];for(let H=1;H<a.length;H++){const K=h.parse(a[H],1+B.length);if(!K)return null;B.push(se(K.type))}h.error(`Expected arguments of type ${E}, but found (${B.join(", ")}) instead.`)}return null}static register(a,h){It.definitions=h;for(const f in h)a[f]=It}}function Kt(l){if(l instanceof di)return Kt(l.boundExpression);if(l instanceof It&&l.name==="error"||l instanceof be||l instanceof Ji)return!1;const a=l instanceof wa||l instanceof Ia;let h=!0;return l.eachChild(f=>{h=a?h&&Kt(f):h&&f instanceof xr}),!!h&&Xt(l)&&un(l,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Xt(l){if(l instanceof It&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof Ji)return!1;let a=!0;return l.eachChild(h=>{a&&!Xt(h)&&(a=!1)}),a}function Li(l){if(l instanceof It&&l.name==="feature-state")return!1;let a=!0;return l.eachChild(h=>{a&&!Li(h)&&(a=!1)}),a}function un(l,a){if(l instanceof It&&a.indexOf(l.name)>=0)return!1;let h=!0;return l.eachChild(f=>{h&&!un(f,a)&&(h=!1)}),h}function zi(l,a){const h=l.length-1;let f,y,w=0,k=h,D=0;for(;w<=k;)if(D=Math.floor((w+k)/2),f=l[D],y=l[D+1],f<=a){if(D===h||a<y)return D;w=D+1}else{if(!(f>a))throw new Rn("Input is not a number.");k=D-1}return 0}class Ui{constructor(a,h,f){this.type=a,this.input=h,this.labels=[],this.outputs=[];for(const[y,w]of f)this.labels.push(y),this.outputs.push(w)}static parse(a,h){if(a.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return h.error("Expected an even number of arguments.");const f=h.parse(a[1],1,lt);if(!f)return null;const y=[];let w=null;h.expectedType&&h.expectedType.kind!=="value"&&(w=h.expectedType);for(let k=1;k<a.length;k+=2){const D=k===1?-1/0:a[k],P=a[k+1],E=k,B=k+1;if(typeof D!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',E);if(y.length&&y[y.length-1][0]>=D)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',E);const H=h.parse(P,B,w);if(!H)return null;w=w||H.type,y.push([D,H])}return new Ui(w,f,y)}evaluate(a){const h=this.labels,f=this.outputs;if(h.length===1)return f[0].evaluate(a);const y=this.input.evaluate(a);if(y<=h[0])return f[0].evaluate(a);const w=h.length;return y>=h[w-1]?f[w-1].evaluate(a):f[zi(h,y)].evaluate(a)}eachChild(a){a(this.input);for(const h of this.outputs)a(h)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function nn(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var Ja=Rr;function Rr(l,a,h,f){this.cx=3*l,this.bx=3*(h-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(f-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=a,this.p2x=h,this.p2y=f}Rr.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,a){if(a===void 0&&(a=1e-6),l<0)return 0;if(l>1)return 1;for(var h=l,f=0;f<8;f++){var y=this.sampleCurveX(h)-l;if(Math.abs(y)<a)return h;var w=this.sampleCurveDerivativeX(h);if(Math.abs(w)<1e-6)break;h-=y/w}var k=0,D=1;for(h=l,f=0;f<20&&(y=this.sampleCurveX(h),!(Math.abs(y-l)<a));f++)l>y?k=h:D=h,h=.5*(D-k)+k;return h},solve:function(l,a){return this.sampleCurveY(this.solveCurveX(l,a))}};var qa=nn(Ja);function Cr(l,a,h){return l+h*(a-l)}function Ha(l,a,h){return l.map((f,y)=>Cr(f,a[y],h))}const Xa={number:Cr,color:function(l,a,h,f="rgb"){switch(f){case"rgb":{const[y,w,k,D]=Ha(l.rgb,a.rgb,h);return new Fi(y,w,k,D,!1)}case"hcl":{const[y,w,k,D]=l.hcl,[P,E,B,H]=a.hcl;let K,ee;if(isNaN(y)||isNaN(P))isNaN(y)?isNaN(P)?K=NaN:(K=P,k!==1&&k!==0||(ee=E)):(K=y,B!==1&&B!==0||(ee=w));else{let Ve=P-y;P>y&&Ve>180?Ve-=360:P<y&&y-P>180&&(Ve+=360),K=y+h*Ve}const[ne,ue,me,ke]=function([Ve,Ce,Be,it]){return Ve=isNaN(Ve)?0:Ve*Qe,St([Be,Math.cos(Ve)*Ce,Math.sin(Ve)*Ce,it])}([K,ee??Cr(w,E,h),Cr(k,B,h),Cr(D,H,h)]);return new Fi(ne,ue,me,ke,!1)}case"lab":{const[y,w,k,D]=St(Ha(l.lab,a.lab,h));return new Fi(y,w,k,D,!1)}}},array:Ha,padding:function(l,a,h){return new ma(Ha(l.values,a.values,h))},variableAnchorOffsetCollection:function(l,a,h){const f=l.values,y=a.values;if(f.length!==y.length)throw new Rn(`Cannot interpolate values of different length. from: ${l.toString()}, to: ${a.toString()}`);const w=[];for(let k=0;k<f.length;k+=2){if(f[k]!==y[k])throw new Rn(`Cannot interpolate values containing mismatched anchors. from[${k}]: ${f[k]}, to[${k}]: ${y[k]}`);w.push(f[k]);const[D,P]=f[k+1],[E,B]=y[k+1];w.push([Cr(D,E,h),Cr(P,B,h)])}return new la(w)}};class ca{constructor(a,h,f,y,w){this.type=a,this.operator=h,this.interpolation=f,this.input=y,this.labels=[],this.outputs=[];for(const[k,D]of w)this.labels.push(k),this.outputs.push(D)}static interpolationFactor(a,h,f,y){let w=0;if(a.name==="exponential")w=ws(h,a.base,f,y);else if(a.name==="linear")w=ws(h,1,f,y);else if(a.name==="cubic-bezier"){const k=a.controlPoints;w=new qa(k[0],k[1],k[2],k[3]).solve(ws(h,1,f,y))}return w}static parse(a,h){let[f,y,w,...k]=a;if(!Array.isArray(y)||y.length===0)return h.error("Expected an interpolation type expression.",1);if(y[0]==="linear")y={name:"linear"};else if(y[0]==="exponential"){const E=y[1];if(typeof E!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);y={name:"exponential",base:E}}else{if(y[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(y[0])}`,1,0);{const E=y.slice(1);if(E.length!==4||E.some(B=>typeof B!="number"||B<0||B>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);y={name:"cubic-bezier",controlPoints:E}}}if(a.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(w=h.parse(w,2,lt),!w)return null;const D=[];let P=null;f==="interpolate-hcl"||f==="interpolate-lab"?P=on:h.expectedType&&h.expectedType.kind!=="value"&&(P=h.expectedType);for(let E=0;E<k.length;E+=2){const B=k[E],H=k[E+1],K=E+3,ee=E+4;if(typeof B!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',K);if(D.length&&D[D.length-1][0]>=B)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',K);const ne=h.parse(H,ee,P);if(!ne)return null;P=P||ne.type,D.push([B,ne])}return V(P,lt)||V(P,on)||V(P,re)||V(P,J)||V(P,te(lt))?new ca(P,f,y,w,D):h.error(`Type ${se(P)} is not interpolatable.`)}evaluate(a){const h=this.labels,f=this.outputs;if(h.length===1)return f[0].evaluate(a);const y=this.input.evaluate(a);if(y<=h[0])return f[0].evaluate(a);const w=h.length;if(y>=h[w-1])return f[w-1].evaluate(a);const k=zi(h,y),D=ca.interpolationFactor(this.interpolation,y,h[k],h[k+1]),P=f[k].evaluate(a),E=f[k+1].evaluate(a);switch(this.operator){case"interpolate":return Xa[this.type.kind](P,E,D);case"interpolate-hcl":return Xa.color(P,E,D,"hcl");case"interpolate-lab":return Xa.color(P,E,D,"lab")}}eachChild(a){a(this.input);for(const h of this.outputs)a(h)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function ws(l,a,h,f){const y=f-h,w=l-h;return y===0?0:a===1?w/y:(Math.pow(a,w)-1)/(Math.pow(a,y)-1)}class dn{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expectected at least one argument.");let f=null;const y=h.expectedType;y&&y.kind!=="value"&&(f=y);const w=[];for(const D of a.slice(1)){const P=h.parse(D,1+w.length,f,void 0,{typeAnnotation:"omit"});if(!P)return null;f=f||P.type,w.push(P)}if(!f)throw new Error("No output type");const k=y&&w.some(D=>Ee(y,D.type));return new dn(k?ni:f,w)}evaluate(a){let h,f=null,y=0;for(const w of this.args)if(y++,f=w.evaluate(a),f&&f instanceof na&&!f.available&&(h||(h=f.name),f=null,y===this.args.length&&(f=h)),f!==null)break;return f}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}class yl{constructor(a,h){this.type=h.type,this.bindings=[].concat(a),this.result=h}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(const h of this.bindings)a(h[1]);a(this.result)}static parse(a,h){if(a.length<4)return h.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);const f=[];for(let w=1;w<a.length-1;w+=2){const k=a[w];if(typeof k!="string")return h.error(`Expected string, but found ${typeof k} instead.`,w);if(/[^a-zA-Z0-9_]/.test(k))return h.error("Variable names must contain only alphanumeric characters or '_'.",w);const D=h.parse(a[w+1],w+1);if(!D)return null;f.push([k,D])}const y=h.parse(a[a.length-1],a.length-1,h.expectedType,f);return y?new yl(f,y):null}outputDefined(){return this.result.outputDefined()}}class lc{constructor(a,h,f){this.type=a,this.index=h,this.input=f}static parse(a,h){if(a.length!==3)return h.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const f=h.parse(a[1],1,lt),y=h.parse(a[2],2,te(h.expectedType||ni));return f&&y?new lc(y.type.itemType,f,y):null}evaluate(a){const h=this.index.evaluate(a),f=this.input.evaluate(a);if(h<0)throw new Rn(`Array index out of bounds: ${h} < 0.`);if(h>=f.length)throw new Rn(`Array index out of bounds: ${h} > ${f.length-1}.`);if(h!==Math.floor(h))throw new Rn(`Array index must be an integer, but found ${h} instead.`);return f[h]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}}class cc{constructor(a,h){this.type=_i,this.needle=a,this.haystack=h}static parse(a,h){if(a.length!==3)return h.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const f=h.parse(a[1],1,ni),y=h.parse(a[2],2,ni);return f&&y?$(f.type,[_i,gi,lt,Ii,ni])?new cc(f,y):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${se(f.type)} instead`):null}evaluate(a){const h=this.needle.evaluate(a),f=this.haystack.evaluate(a);if(!f)return!1;if(!O(h,["boolean","string","number","null"]))throw new Rn(`Expected first argument to be of type boolean, string, number or null, but found ${se(Tn(h))} instead.`);if(!O(f,["string","array"]))throw new Rn(`Expected second argument to be of type array or string, but found ${se(Tn(f))} instead.`);return f.indexOf(h)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}}class bl{constructor(a,h,f){this.type=lt,this.needle=a,this.haystack=h,this.fromIndex=f}static parse(a,h){if(a.length<=2||a.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const f=h.parse(a[1],1,ni),y=h.parse(a[2],2,ni);if(!f||!y)return null;if(!$(f.type,[_i,gi,lt,Ii,ni]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${se(f.type)} instead`);if(a.length===4){const w=h.parse(a[3],3,lt);return w?new bl(f,y,w):null}return new bl(f,y)}evaluate(a){const h=this.needle.evaluate(a),f=this.haystack.evaluate(a);if(!O(h,["boolean","string","number","null"]))throw new Rn(`Expected first argument to be of type boolean, string, number or null, but found ${se(Tn(h))} instead.`);if(!O(f,["string","array"]))throw new Rn(`Expected second argument to be of type array or string, but found ${se(Tn(f))} instead.`);if(this.fromIndex){const y=this.fromIndex.evaluate(a);return f.indexOf(h,y)}return f.indexOf(h)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}}class uc{constructor(a,h,f,y,w,k){this.inputType=a,this.type=h,this.input=f,this.cases=y,this.outputs=w,this.otherwise=k}static parse(a,h){if(a.length<5)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return h.error("Expected an even number of arguments.");let f,y;h.expectedType&&h.expectedType.kind!=="value"&&(y=h.expectedType);const w={},k=[];for(let E=2;E<a.length-1;E+=2){let B=a[E];const H=a[E+1];Array.isArray(B)||(B=[B]);const K=h.concat(E);if(B.length===0)return K.error("Expected at least one branch label.");for(const ne of B){if(typeof ne!="number"&&typeof ne!="string")return K.error("Branch labels must be numbers or strings.");if(typeof ne=="number"&&Math.abs(ne)>Number.MAX_SAFE_INTEGER)return K.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ne=="number"&&Math.floor(ne)!==ne)return K.error("Numeric branch labels must be integer values.");if(f){if(K.checkSubtype(f,Tn(ne)))return null}else f=Tn(ne);if(w[String(ne)]!==void 0)return K.error("Branch labels must be unique.");w[String(ne)]=k.length}const ee=h.parse(H,E,y);if(!ee)return null;y=y||ee.type,k.push(ee)}const D=h.parse(a[1],1,ni);if(!D)return null;const P=h.parse(a[a.length-1],a.length-1,y);return P?D.type.kind!=="value"&&h.concat(1).checkSubtype(f,D.type)?null:new uc(f,y,D,w,k,P):null}evaluate(a){const h=this.input.evaluate(a);return(Tn(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}}class hc{constructor(a,h,f){this.type=a,this.branches=h,this.otherwise=f}static parse(a,h){if(a.length<4)return h.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return h.error("Expected an odd number of arguments.");let f;h.expectedType&&h.expectedType.kind!=="value"&&(f=h.expectedType);const y=[];for(let k=1;k<a.length-1;k+=2){const D=h.parse(a[k],k,_i);if(!D)return null;const P=h.parse(a[k+1],k+1,f);if(!P)return null;y.push([D,P]),f=f||P.type}const w=h.parse(a[a.length-1],a.length-1,f);if(!w)return null;if(!f)throw new Error("Can't infer output type");return new hc(f,y,w)}evaluate(a){for(const[h,f]of this.branches)if(h.evaluate(a))return f.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(const[h,f]of this.branches)a(h),a(f);a(this.otherwise)}outputDefined(){return this.branches.every(([a,h])=>h.outputDefined())&&this.otherwise.outputDefined()}}class vl{constructor(a,h,f,y){this.type=a,this.input=h,this.beginIndex=f,this.endIndex=y}static parse(a,h){if(a.length<=2||a.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const f=h.parse(a[1],1,ni),y=h.parse(a[2],2,lt);if(!f||!y)return null;if(!$(f.type,[te(ni),gi,ni]))return h.error(`Expected first argument to be of type array or string, but found ${se(f.type)} instead`);if(a.length===4){const w=h.parse(a[3],3,lt);return w?new vl(f.type,f,y,w):null}return new vl(f.type,f,y)}evaluate(a){const h=this.input.evaluate(a),f=this.beginIndex.evaluate(a);if(!O(h,["string","array"]))throw new Rn(`Expected first argument to be of type array or string, but found ${se(Tn(h))} instead.`);if(this.endIndex){const y=this.endIndex.evaluate(a);return h.slice(f,y)}return h.slice(f)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}}function Yu(l,a){return l==="=="||l==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function Ju(l,a,h,f){return f.compare(a,h)===0}function oo(l,a,h){const f=l!=="=="&&l!=="!=";return class Z2{constructor(w,k,D){this.type=_i,this.lhs=w,this.rhs=k,this.collator=D,this.hasUntypedArgument=w.type.kind==="value"||k.type.kind==="value"}static parse(w,k){if(w.length!==3&&w.length!==4)return k.error("Expected two or three arguments.");const D=w[0];let P=k.parse(w[1],1,ni);if(!P)return null;if(!Yu(D,P.type))return k.concat(1).error(`"${D}" comparisons are not supported for type '${se(P.type)}'.`);let E=k.parse(w[2],2,ni);if(!E)return null;if(!Yu(D,E.type))return k.concat(2).error(`"${D}" comparisons are not supported for type '${se(E.type)}'.`);if(P.type.kind!==E.type.kind&&P.type.kind!=="value"&&E.type.kind!=="value")return k.error(`Cannot compare types '${se(P.type)}' and '${se(E.type)}'.`);f&&(P.type.kind==="value"&&E.type.kind!=="value"?P=new Ia(E.type,[P]):P.type.kind!=="value"&&E.type.kind==="value"&&(E=new Ia(P.type,[E])));let B=null;if(w.length===4){if(P.type.kind!=="string"&&E.type.kind!=="string"&&P.type.kind!=="value"&&E.type.kind!=="value")return k.error("Cannot use collator to compare non-string types.");if(B=k.parse(w[3],3,Ei),!B)return null}return new Z2(P,E,B)}evaluate(w){const k=this.lhs.evaluate(w),D=this.rhs.evaluate(w);if(f&&this.hasUntypedArgument){const P=Tn(k),E=Tn(D);if(P.kind!==E.kind||P.kind!=="string"&&P.kind!=="number")throw new Rn(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${P.kind}, ${E.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const P=Tn(k),E=Tn(D);if(P.kind!=="string"||E.kind!=="string")return a(w,k,D)}return this.collator?h(w,k,D,this.collator.evaluate(w)):a(w,k,D)}eachChild(w){w(this.lhs),w(this.rhs),this.collator&&w(this.collator)}outputDefined(){return!0}}}const sf=oo("==",function(l,a,h){return a===h},Ju),of=oo("!=",function(l,a,h){return a!==h},function(l,a,h,f){return!Ju(0,a,h,f)}),lf=oo("<",function(l,a,h){return a<h},function(l,a,h,f){return f.compare(a,h)<0}),cf=oo(">",function(l,a,h){return a>h},function(l,a,h,f){return f.compare(a,h)>0}),uf=oo("<=",function(l,a,h){return a<=h},function(l,a,h,f){return f.compare(a,h)<=0}),hf=oo(">=",function(l,a,h){return a>=h},function(l,a,h,f){return f.compare(a,h)>=0});class dc{constructor(a,h,f,y,w){this.type=gi,this.number=a,this.locale=h,this.currency=f,this.minFractionDigits=y,this.maxFractionDigits=w}static parse(a,h){if(a.length!==3)return h.error("Expected two arguments.");const f=h.parse(a[1],1,lt);if(!f)return null;const y=a[2];if(typeof y!="object"||Array.isArray(y))return h.error("NumberFormat options argument must be an object.");let w=null;if(y.locale&&(w=h.parse(y.locale,1,gi),!w))return null;let k=null;if(y.currency&&(k=h.parse(y.currency,1,gi),!k))return null;let D=null;if(y["min-fraction-digits"]&&(D=h.parse(y["min-fraction-digits"],1,lt),!D))return null;let P=null;return y["max-fraction-digits"]&&(P=h.parse(y["max-fraction-digits"],1,lt),!P)?null:new dc(f,w,k,D,P)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}}class xl{constructor(a){this.type=ji,this.sections=a}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");const f=a[1];if(!Array.isArray(f)&&typeof f=="object")return h.error("First argument must be an image or text section.");const y=[];let w=!1;for(let k=1;k<=a.length-1;++k){const D=a[k];if(w&&typeof D=="object"&&!Array.isArray(D)){w=!1;let P=null;if(D["font-scale"]&&(P=h.parse(D["font-scale"],1,lt),!P))return null;let E=null;if(D["text-font"]&&(E=h.parse(D["text-font"],1,te(gi)),!E))return null;let B=null;if(D["text-color"]&&(B=h.parse(D["text-color"],1,on),!B))return null;const H=y[y.length-1];H.scale=P,H.font=E,H.textColor=B}else{const P=h.parse(a[k],1,ni);if(!P)return null;const E=P.type.kind;if(E!=="string"&&E!=="value"&&E!=="null"&&E!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");w=!0,y.push({content:P,scale:null,font:null,textColor:null})}}return new xl(y)}evaluate(a){return new In(this.sections.map(h=>{const f=h.content.evaluate(a);return Tn(f)===U?new Wa("",f,null,null,null):new Wa(Jr(f),null,h.scale?h.scale.evaluate(a):null,h.font?h.font.evaluate(a).join(","):null,h.textColor?h.textColor.evaluate(a):null)}))}eachChild(a){for(const h of this.sections)a(h.content),h.scale&&a(h.scale),h.font&&a(h.font),h.textColor&&a(h.textColor)}outputDefined(){return!1}}class fc{constructor(a){this.type=U,this.input=a}static parse(a,h){if(a.length!==2)return h.error("Expected two arguments.");const f=h.parse(a[1],1,gi);return f?new fc(f):h.error("No image name provided.")}evaluate(a){const h=this.input.evaluate(a),f=na.fromString(h);return f&&a.availableImages&&(f.available=a.availableImages.indexOf(h)>-1),f}eachChild(a){a(this.input)}outputDefined(){return!1}}class pc{constructor(a){this.type=lt,this.input=a}static parse(a,h){if(a.length!==2)return h.error(`Expected 1 argument, but found ${a.length-1} instead.`);const f=h.parse(a[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${se(f.type)} instead.`):new pc(f):null}evaluate(a){const h=this.input.evaluate(a);if(typeof h=="string"||Array.isArray(h))return h.length;throw new Rn(`Expected value to be of type string or array, but found ${se(Tn(h))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}}const lo={"==":sf,"!=":of,">":cf,"<":lf,">=":hf,"<=":uf,array:Ia,at:lc,boolean:Ia,case:hc,coalesce:dn,collator:be,format:xl,image:fc,in:cc,"index-of":bl,interpolate:ca,"interpolate-hcl":ca,"interpolate-lab":ca,length:pc,let:yl,literal:xr,match:uc,number:Ia,"number-format":dc,object:Ia,slice:vl,step:Ui,string:Ia,"to-boolean":wa,"to-color":wa,"to-number":wa,"to-string":wa,var:di,within:Ji};function Xu(l,[a,h,f,y]){a=a.evaluate(l),h=h.evaluate(l),f=f.evaluate(l);const w=y?y.evaluate(l):1,k=Yr(a,h,f,w);if(k)throw new Rn(k);return new Fi(a/255,h/255,f/255,w,!1)}function Qu(l,a){return l in a}function mc(l,a){const h=a[l];return h===void 0?null:h}function Os(l){return{type:l}}function eh(l){return{result:"success",value:l}}function co(l){return{result:"error",value:l}}function uo(l){return l["property-type"]==="data-driven"||l["property-type"]==="cross-faded-data-driven"}function th(l){return!!l.expression&&l.expression.parameters.indexOf("zoom")>-1}function gc(l){return!!l.expression&&l.expression.interpolated}function fn(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}function ho(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)}function df(l){return l}function ih(l,a){const h=a.type==="color",f=l.stops&&typeof l.stops[0][0]=="object",y=f||!(f||l.property!==void 0),w=l.type||(gc(a)?"exponential":"interval");if(h||a.type==="padding"){const B=h?Fi.parse:ma.parse;(l=jn({},l)).stops&&(l.stops=l.stops.map(H=>[H[0],B(H[1])])),l.default=B(l.default?l.default:a.default)}if(l.colorSpace&&(k=l.colorSpace)!=="rgb"&&k!=="hcl"&&k!=="lab")throw new Error(`Unknown color space: "${l.colorSpace}"`);var k;let D,P,E;if(w==="exponential")D=nh;else if(w==="interval")D=ua;else if(w==="categorical"){D=ff,P=Object.create(null);for(const B of l.stops)P[B[0]]=B[1];E=typeof l.stops[0][0]}else{if(w!=="identity")throw new Error(`Unknown function type "${w}"`);D=ln}if(f){const B={},H=[];for(let ne=0;ne<l.stops.length;ne++){const ue=l.stops[ne],me=ue[0].zoom;B[me]===void 0&&(B[me]={zoom:me,type:l.type,property:l.property,default:l.default,stops:[]},H.push(me)),B[me].stops.push([ue[0].value,ue[1]])}const K=[];for(const ne of H)K.push([B[ne].zoom,ih(B[ne],a)]);const ee={name:"linear"};return{kind:"composite",interpolationType:ee,interpolationFactor:ca.interpolationFactor.bind(void 0,ee),zoomStops:K.map(ne=>ne[0]),evaluate:({zoom:ne},ue)=>nh({stops:K,base:l.base},a,ne).evaluate(ne,ue)}}if(y){const B=w==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:B,interpolationFactor:ca.interpolationFactor.bind(void 0,B),zoomStops:l.stops.map(H=>H[0]),evaluate:({zoom:H})=>D(l,a,H,P,E)}}return{kind:"source",evaluate(B,H){const K=H&&H.properties?H.properties[l.property]:void 0;return K===void 0?Uo(l.default,a.default):D(l,a,K,P,E)}}}function Uo(l,a,h){return l!==void 0?l:a!==void 0?a:h!==void 0?h:void 0}function ff(l,a,h,f,y){return Uo(typeof h===y?f[h]:void 0,l.default,a.default)}function ua(l,a,h){if(fn(h)!=="number")return Uo(l.default,a.default);const f=l.stops.length;if(f===1||h<=l.stops[0][0])return l.stops[0][1];if(h>=l.stops[f-1][0])return l.stops[f-1][1];const y=zi(l.stops.map(w=>w[0]),h);return l.stops[y][1]}function nh(l,a,h){const f=l.base!==void 0?l.base:1;if(fn(h)!=="number")return Uo(l.default,a.default);const y=l.stops.length;if(y===1||h<=l.stops[0][0])return l.stops[0][1];if(h>=l.stops[y-1][0])return l.stops[y-1][1];const w=zi(l.stops.map(B=>B[0]),h),k=function(B,H,K,ee){const ne=ee-K,ue=B-K;return ne===0?0:H===1?ue/ne:(Math.pow(H,ue)-1)/(Math.pow(H,ne)-1)}(h,f,l.stops[w][0],l.stops[w+1][0]),D=l.stops[w][1],P=l.stops[w+1][1],E=Xa[a.type]||df;return typeof D.evaluate=="function"?{evaluate(...B){const H=D.evaluate.apply(void 0,B),K=P.evaluate.apply(void 0,B);if(H!==void 0&&K!==void 0)return E(H,K,k,l.colorSpace)}}:E(D,P,k,l.colorSpace)}function ln(l,a,h){switch(a.type){case"color":h=Fi.parse(h);break;case"formatted":h=In.fromString(h.toString());break;case"resolvedImage":h=na.fromString(h.toString());break;case"padding":h=ma.parse(h);break;default:fn(h)===a.type||a.type==="enum"&&a.values[h]||(h=void 0)}return Uo(h,l.default,a.default)}It.register(lo,{error:[{kind:"error"},[gi],(l,[a])=>{throw new Rn(a.evaluate(l))}],typeof:[gi,[ni],(l,[a])=>se(Tn(a.evaluate(l)))],"to-rgba":[te(lt,4),[on],(l,[a])=>{const[h,f,y,w]=a.evaluate(l).rgb;return[255*h,255*f,255*y,w]}],rgb:[on,[lt,lt,lt],Xu],rgba:[on,[lt,lt,lt,lt],Xu],has:{type:_i,overloads:[[[gi],(l,[a])=>Qu(a.evaluate(l),l.properties())],[[gi,wn],(l,[a,h])=>Qu(a.evaluate(l),h.evaluate(l))]]},get:{type:ni,overloads:[[[gi],(l,[a])=>mc(a.evaluate(l),l.properties())],[[gi,wn],(l,[a,h])=>mc(a.evaluate(l),h.evaluate(l))]]},"feature-state":[ni,[gi],(l,[a])=>mc(a.evaluate(l),l.featureState||{})],properties:[wn,[],l=>l.properties()],"geometry-type":[gi,[],l=>l.geometryType()],id:[ni,[],l=>l.id()],zoom:[lt,[],l=>l.globals.zoom],"heatmap-density":[lt,[],l=>l.globals.heatmapDensity||0],"line-progress":[lt,[],l=>l.globals.lineProgress||0],accumulated:[ni,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[lt,Os(lt),(l,a)=>{let h=0;for(const f of a)h+=f.evaluate(l);return h}],"*":[lt,Os(lt),(l,a)=>{let h=1;for(const f of a)h*=f.evaluate(l);return h}],"-":{type:lt,overloads:[[[lt,lt],(l,[a,h])=>a.evaluate(l)-h.evaluate(l)],[[lt],(l,[a])=>-a.evaluate(l)]]},"/":[lt,[lt,lt],(l,[a,h])=>a.evaluate(l)/h.evaluate(l)],"%":[lt,[lt,lt],(l,[a,h])=>a.evaluate(l)%h.evaluate(l)],ln2:[lt,[],()=>Math.LN2],pi:[lt,[],()=>Math.PI],e:[lt,[],()=>Math.E],"^":[lt,[lt,lt],(l,[a,h])=>Math.pow(a.evaluate(l),h.evaluate(l))],sqrt:[lt,[lt],(l,[a])=>Math.sqrt(a.evaluate(l))],log10:[lt,[lt],(l,[a])=>Math.log(a.evaluate(l))/Math.LN10],ln:[lt,[lt],(l,[a])=>Math.log(a.evaluate(l))],log2:[lt,[lt],(l,[a])=>Math.log(a.evaluate(l))/Math.LN2],sin:[lt,[lt],(l,[a])=>Math.sin(a.evaluate(l))],cos:[lt,[lt],(l,[a])=>Math.cos(a.evaluate(l))],tan:[lt,[lt],(l,[a])=>Math.tan(a.evaluate(l))],asin:[lt,[lt],(l,[a])=>Math.asin(a.evaluate(l))],acos:[lt,[lt],(l,[a])=>Math.acos(a.evaluate(l))],atan:[lt,[lt],(l,[a])=>Math.atan(a.evaluate(l))],min:[lt,Os(lt),(l,a)=>Math.min(...a.map(h=>h.evaluate(l)))],max:[lt,Os(lt),(l,a)=>Math.max(...a.map(h=>h.evaluate(l)))],abs:[lt,[lt],(l,[a])=>Math.abs(a.evaluate(l))],round:[lt,[lt],(l,[a])=>{const h=a.evaluate(l);return h<0?-Math.round(-h):Math.round(h)}],floor:[lt,[lt],(l,[a])=>Math.floor(a.evaluate(l))],ceil:[lt,[lt],(l,[a])=>Math.ceil(a.evaluate(l))],"filter-==":[_i,[gi,ni],(l,[a,h])=>l.properties()[a.value]===h.value],"filter-id-==":[_i,[ni],(l,[a])=>l.id()===a.value],"filter-type-==":[_i,[gi],(l,[a])=>l.geometryType()===a.value],"filter-<":[_i,[gi,ni],(l,[a,h])=>{const f=l.properties()[a.value],y=h.value;return typeof f==typeof y&&f<y}],"filter-id-<":[_i,[ni],(l,[a])=>{const h=l.id(),f=a.value;return typeof h==typeof f&&h<f}],"filter->":[_i,[gi,ni],(l,[a,h])=>{const f=l.properties()[a.value],y=h.value;return typeof f==typeof y&&f>y}],"filter-id->":[_i,[ni],(l,[a])=>{const h=l.id(),f=a.value;return typeof h==typeof f&&h>f}],"filter-<=":[_i,[gi,ni],(l,[a,h])=>{const f=l.properties()[a.value],y=h.value;return typeof f==typeof y&&f<=y}],"filter-id-<=":[_i,[ni],(l,[a])=>{const h=l.id(),f=a.value;return typeof h==typeof f&&h<=f}],"filter->=":[_i,[gi,ni],(l,[a,h])=>{const f=l.properties()[a.value],y=h.value;return typeof f==typeof y&&f>=y}],"filter-id->=":[_i,[ni],(l,[a])=>{const h=l.id(),f=a.value;return typeof h==typeof f&&h>=f}],"filter-has":[_i,[ni],(l,[a])=>a.value in l.properties()],"filter-has-id":[_i,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[_i,[te(gi)],(l,[a])=>a.value.indexOf(l.geometryType())>=0],"filter-id-in":[_i,[te(ni)],(l,[a])=>a.value.indexOf(l.id())>=0],"filter-in-small":[_i,[gi,te(ni)],(l,[a,h])=>h.value.indexOf(l.properties()[a.value])>=0],"filter-in-large":[_i,[gi,te(ni)],(l,[a,h])=>function(f,y,w,k){for(;w<=k;){const D=w+k>>1;if(y[D]===f)return!0;y[D]>f?k=D-1:w=D+1}return!1}(l.properties()[a.value],h.value,0,h.value.length-1)],all:{type:_i,overloads:[[[_i,_i],(l,[a,h])=>a.evaluate(l)&&h.evaluate(l)],[Os(_i),(l,a)=>{for(const h of a)if(!h.evaluate(l))return!1;return!0}]]},any:{type:_i,overloads:[[[_i,_i],(l,[a,h])=>a.evaluate(l)||h.evaluate(l)],[Os(_i),(l,a)=>{for(const h of a)if(h.evaluate(l))return!0;return!1}]]},"!":[_i,[_i],(l,[a])=>!a.evaluate(l)],"is-supported-script":[_i,[gi],(l,[a])=>{const h=l.globals&&l.globals.isSupportedScript;return!h||h(a.evaluate(l))}],upcase:[gi,[gi],(l,[a])=>a.evaluate(l).toUpperCase()],downcase:[gi,[gi],(l,[a])=>a.evaluate(l).toLowerCase()],concat:[gi,Os(ni),(l,a)=>a.map(h=>Jr(h.evaluate(l))).join("")],"resolved-locale":[gi,[Ei],(l,[a])=>a.evaluate(l).resolvedLocale()]});class Wo{constructor(a,h){var f;this.expression=a,this._warningHistory={},this._evaluator=new z,this._defaultValue=h?(f=h).type==="color"&&ho(f.default)?new Fi(0,0,0,0):f.type==="color"?Fi.parse(f.default)||null:f.type==="padding"?ma.parse(f.default)||null:f.type==="variableAnchorOffsetCollection"?la.parse(f.default)||null:f.default===void 0?null:f.default:null,this._enumValues=h&&h.type==="enum"?h.values:null}evaluateWithoutErrorHandling(a,h,f,y,w,k){return this._evaluator.globals=a,this._evaluator.feature=h,this._evaluator.featureState=f,this._evaluator.canonical=y,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=k,this.expression.evaluate(this._evaluator)}evaluate(a,h,f,y,w,k){this._evaluator.globals=a,this._evaluator.feature=h||null,this._evaluator.featureState=f||null,this._evaluator.canonical=y,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=k||null;try{const D=this.expression.evaluate(this._evaluator);if(D==null||typeof D=="number"&&D!=D)return this._defaultValue;if(this._enumValues&&!(D in this._enumValues))throw new Rn(`Expected value to be one of ${Object.keys(this._enumValues).map(P=>JSON.stringify(P)).join(", ")}, but found ${JSON.stringify(D)} instead.`);return D}catch(D){return this._warningHistory[D.message]||(this._warningHistory[D.message]=!0,typeof console<"u"&&console.warn(D.message)),this._defaultValue}}}function En(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in lo}function Cn(l,a){const h=new N(lo,Kt,[],a?function(y){const w={color:on,string:gi,number:lt,enum:gi,boolean:_i,formatted:ji,padding:re,resolvedImage:U,variableAnchorOffsetCollection:J};return y.type==="array"?te(w[y.value]||ni,y.length):w[y.type]}(a):void 0),f=h.parse(l,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?eh(new Wo(f,a)):co(h.errors)}class fo{constructor(a,h){this.kind=a,this._styleExpression=h,this.isStateDependent=a!=="constant"&&!Li(h.expression)}evaluateWithoutErrorHandling(a,h,f,y,w,k){return this._styleExpression.evaluateWithoutErrorHandling(a,h,f,y,w,k)}evaluate(a,h,f,y,w,k){return this._styleExpression.evaluate(a,h,f,y,w,k)}}class wl{constructor(a,h,f,y){this.kind=a,this.zoomStops=f,this._styleExpression=h,this.isStateDependent=a!=="camera"&&!Li(h.expression),this.interpolationType=y}evaluateWithoutErrorHandling(a,h,f,y,w,k){return this._styleExpression.evaluateWithoutErrorHandling(a,h,f,y,w,k)}evaluate(a,h,f,y,w,k){return this._styleExpression.evaluate(a,h,f,y,w,k)}interpolationFactor(a,h,f){return this.interpolationType?ca.interpolationFactor(this.interpolationType,a,h,f):0}}function ah(l,a){const h=Cn(l,a);if(h.result==="error")return h;const f=h.value.expression,y=Xt(f);if(!y&&!uo(a))return co([new hn("","data expressions not supported")]);const w=un(f,["zoom"]);if(!w&&!th(a))return co([new hn("","zoom expressions not supported")]);const k=Sl(f);return k||w?k instanceof hn?co([k]):k instanceof ca&&!gc(a)?co([new hn("",'"interpolate" expressions cannot be used with this property')]):eh(k?new wl(y?"camera":"composite",h.value,k.labels,k instanceof ca?k.interpolation:void 0):new fo(y?"constant":"source",h.value)):co([new hn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class kl{constructor(a,h){this._parameters=a,this._specification=h,jn(this,ih(this._parameters,this._specification))}static deserialize(a){return new kl(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function Sl(l){let a=null;if(l instanceof yl)a=Sl(l.result);else if(l instanceof dn){for(const h of l.args)if(a=Sl(h),a)break}else(l instanceof Ui||l instanceof ca)&&l.input instanceof It&&l.input.name==="zoom"&&(a=l);return a instanceof hn||l.eachChild(h=>{const f=Sl(h);f instanceof hn?a=f:!a&&f?a=new hn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&f&&a!==f&&(a=new hn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}function _c(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const a of l.slice(1))if(!_c(a)&&typeof a!="boolean")return!1;return!0;default:return!0}}const rh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ml(l){if(l==null)return{filter:()=>!0,needGeometry:!1};_c(l)||(l=po(l));const a=Cn(l,rh);if(a.result==="error")throw new Error(a.value.map(h=>`${h.key}: ${h.message}`).join(", "));return{filter:(h,f,y)=>a.value.evaluate(h,f,{},y),needGeometry:yc(l)}}function sh(l,a){return l<a?-1:l>a?1:0}function yc(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(let a=1;a<l.length;a++)if(yc(l[a]))return!0;return!1}function po(l){if(!l)return!0;const a=l[0];return l.length<=1?a!=="any":a==="=="?bc(l[1],l[2],"=="):a==="!="?Dl(bc(l[1],l[2],"==")):a==="<"||a===">"||a==="<="||a===">="?bc(l[1],l[2],a):a==="any"?(h=l.slice(1),["any"].concat(h.map(po))):a==="all"?["all"].concat(l.slice(1).map(po)):a==="none"?["all"].concat(l.slice(1).map(po).map(Dl)):a==="in"?oh(l[1],l.slice(2)):a==="!in"?Dl(oh(l[1],l.slice(2))):a==="has"?lh(l[1]):a==="!has"?Dl(lh(l[1])):a!=="within"||l;var h}function bc(l,a,h){switch(l){case"$type":return[`filter-type-${h}`,a];case"$id":return[`filter-id-${h}`,a];default:return[`filter-${h}`,l,a]}}function oh(l,a){if(a.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(h=>typeof h!=typeof a[0])?["filter-in-large",l,["literal",a.sort(sh)]]:["filter-in-small",l,["literal",a]]}}function lh(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function Dl(l){return["!",l]}function vc(l){const a=typeof l;if(a==="number"||a==="boolean"||a==="string"||l==null)return JSON.stringify(l);if(Array.isArray(l)){let y="[";for(const w of l)y+=`${vc(w)},`;return`${y}]`}const h=Object.keys(l).sort();let f="{";for(let y=0;y<h.length;y++)f+=`${JSON.stringify(h[y])}:${vc(l[h[y]])},`;return`${f}}`}function pf(l){let a="";for(const h of Ci)a+=`/${vc(l[h])}`;return a}function ch(l){const a=l.value;return a?[new rt(l.key,a,"constants have been deprecated as of v8")]:[]}function aa(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function ks(l){if(Array.isArray(l))return l.map(ks);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const a={};for(const h in l)a[h]=ks(l[h]);return a}return aa(l)}function wr(l){const a=l.key,h=l.value,f=l.valueSpec||{},y=l.objectElementValidators||{},w=l.style,k=l.styleSpec,D=l.validateSpec;let P=[];const E=fn(h);if(E!=="object")return[new rt(a,h,`object expected, ${E} found`)];for(const B in h){const H=B.split(".")[0],K=f[H]||f["*"];let ee;if(y[H])ee=y[H];else if(f[H])ee=D;else if(y["*"])ee=y["*"];else{if(!f["*"]){P.push(new rt(a,h[B],`unknown property "${B}"`));continue}ee=D}P=P.concat(ee({key:(a&&`${a}.`)+B,value:h[B],valueSpec:K,style:w,styleSpec:k,object:h,objectKey:B,validateSpec:D},h))}for(const B in f)y[B]||f[B].required&&f[B].default===void 0&&h[B]===void 0&&P.push(new rt(a,h,`missing required property "${B}"`));return P}function mo(l){const a=l.value,h=l.valueSpec,f=l.style,y=l.styleSpec,w=l.key,k=l.arrayElementValidator||l.validateSpec;if(fn(a)!=="array")return[new rt(w,a,`array expected, ${fn(a)} found`)];if(h.length&&a.length!==h.length)return[new rt(w,a,`array length ${h.length} expected, length ${a.length} found`)];if(h["min-length"]&&a.length<h["min-length"])return[new rt(w,a,`array length at least ${h["min-length"]} expected, length ${a.length} found`)];let D={type:h.value,values:h.values};y.$version<7&&(D.function=h.function),fn(h.value)==="object"&&(D=h.value);let P=[];for(let E=0;E<a.length;E++)P=P.concat(k({array:a,arrayIndex:E,value:a[E],valueSpec:D,validateSpec:l.validateSpec,style:f,styleSpec:y,key:`${w}[${E}]`}));return P}function xc(l){const a=l.key,h=l.value,f=l.valueSpec;let y=fn(h);return y==="number"&&h!=h&&(y="NaN"),y!=="number"?[new rt(a,h,`number expected, ${y} found`)]:"minimum"in f&&h<f.minimum?[new rt(a,h,`${h} is less than the minimum value ${f.minimum}`)]:"maximum"in f&&h>f.maximum?[new rt(a,h,`${h} is greater than the maximum value ${f.maximum}`)]:[]}function wc(l){const a=l.valueSpec,h=aa(l.value.type);let f,y,w,k={};const D=h!=="categorical"&&l.value.property===void 0,P=!D,E=fn(l.value.stops)==="array"&&fn(l.value.stops[0])==="array"&&fn(l.value.stops[0][0])==="object",B=wr({key:l.key,value:l.value,valueSpec:l.styleSpec.function,validateSpec:l.validateSpec,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{stops:function(ee){if(h==="identity")return[new rt(ee.key,ee.value,'identity function may not have a "stops" property')];let ne=[];const ue=ee.value;return ne=ne.concat(mo({key:ee.key,value:ue,valueSpec:ee.valueSpec,validateSpec:ee.validateSpec,style:ee.style,styleSpec:ee.styleSpec,arrayElementValidator:H})),fn(ue)==="array"&&ue.length===0&&ne.push(new rt(ee.key,ue,"array must have at least one stop")),ne},default:function(ee){return ee.validateSpec({key:ee.key,value:ee.value,valueSpec:a,validateSpec:ee.validateSpec,style:ee.style,styleSpec:ee.styleSpec})}}});return h==="identity"&&D&&B.push(new rt(l.key,l.value,'missing required property "property"')),h==="identity"||l.value.stops||B.push(new rt(l.key,l.value,'missing required property "stops"')),h==="exponential"&&l.valueSpec.expression&&!gc(l.valueSpec)&&B.push(new rt(l.key,l.value,"exponential functions not supported")),l.styleSpec.$version>=8&&(P&&!uo(l.valueSpec)?B.push(new rt(l.key,l.value,"property functions not supported")):D&&!th(l.valueSpec)&&B.push(new rt(l.key,l.value,"zoom functions not supported"))),h!=="categorical"&&!E||l.value.property!==void 0||B.push(new rt(l.key,l.value,'"property" property is required')),B;function H(ee){let ne=[];const ue=ee.value,me=ee.key;if(fn(ue)!=="array")return[new rt(me,ue,`array expected, ${fn(ue)} found`)];if(ue.length!==2)return[new rt(me,ue,`array length 2 expected, length ${ue.length} found`)];if(E){if(fn(ue[0])!=="object")return[new rt(me,ue,`object expected, ${fn(ue[0])} found`)];if(ue[0].zoom===void 0)return[new rt(me,ue,"object stop key must have zoom")];if(ue[0].value===void 0)return[new rt(me,ue,"object stop key must have value")];if(w&&w>aa(ue[0].zoom))return[new rt(me,ue[0].zoom,"stop zoom values must appear in ascending order")];aa(ue[0].zoom)!==w&&(w=aa(ue[0].zoom),y=void 0,k={}),ne=ne.concat(wr({key:`${me}[0]`,value:ue[0],valueSpec:{zoom:{}},validateSpec:ee.validateSpec,style:ee.style,styleSpec:ee.styleSpec,objectElementValidators:{zoom:xc,value:K}}))}else ne=ne.concat(K({key:`${me}[0]`,value:ue[0],valueSpec:{},validateSpec:ee.validateSpec,style:ee.style,styleSpec:ee.styleSpec},ue));return En(ks(ue[1]))?ne.concat([new rt(`${me}[1]`,ue[1],"expressions are not allowed in function stops.")]):ne.concat(ee.validateSpec({key:`${me}[1]`,value:ue[1],valueSpec:a,validateSpec:ee.validateSpec,style:ee.style,styleSpec:ee.styleSpec}))}function K(ee,ne){const ue=fn(ee.value),me=aa(ee.value),ke=ee.value!==null?ee.value:ne;if(f){if(ue!==f)return[new rt(ee.key,ke,`${ue} stop domain type must match previous stop domain type ${f}`)]}else f=ue;if(ue!=="number"&&ue!=="string"&&ue!=="boolean")return[new rt(ee.key,ke,"stop domain value must be a number, string, or boolean")];if(ue!=="number"&&h!=="categorical"){let Ve=`number expected, ${ue} found`;return uo(a)&&h===void 0&&(Ve+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new rt(ee.key,ke,Ve)]}return h!=="categorical"||ue!=="number"||isFinite(me)&&Math.floor(me)===me?h!=="categorical"&&ue==="number"&&y!==void 0&&me<y?[new rt(ee.key,ke,"stop domain values must appear in ascending order")]:(y=me,h==="categorical"&&me in k?[new rt(ee.key,ke,"stop domain values must be unique")]:(k[me]=!0,[])):[new rt(ee.key,ke,`integer expected, found ${me}`)]}}function go(l){const a=(l.expressionContext==="property"?ah:Cn)(ks(l.value),l.valueSpec);if(a.result==="error")return a.value.map(f=>new rt(`${l.key}${f.key}`,l.value,f.message));const h=a.value.expression||a.value._styleExpression.expression;if(l.expressionContext==="property"&&l.propertyKey==="text-font"&&!h.outputDefined())return[new rt(l.key,l.value,`Invalid data expression for "${l.propertyKey}". Output values must be contained as literals within the expression.`)];if(l.expressionContext==="property"&&l.propertyType==="layout"&&!Li(h))return[new rt(l.key,l.value,'"feature-state" data expressions are not supported with layout properties.')];if(l.expressionContext==="filter"&&!Li(h))return[new rt(l.key,l.value,'"feature-state" data expressions are not supported with filters.')];if(l.expressionContext&&l.expressionContext.indexOf("cluster")===0){if(!un(h,["zoom","feature-state"]))return[new rt(l.key,l.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(l.expressionContext==="cluster-initial"&&!Xt(h))return[new rt(l.key,l.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Bs(l){const a=l.key,h=l.value,f=l.valueSpec,y=[];return Array.isArray(f.values)?f.values.indexOf(aa(h))===-1&&y.push(new rt(a,h,`expected one of [${f.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(f.values).indexOf(aa(h))===-1&&y.push(new rt(a,h,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(h)} found`)),y}function _o(l){return _c(ks(l.value))?go(jn({},l,{expressionContext:"filter",valueSpec:{value:"boolean"}})):qo(l)}function qo(l){const a=l.value,h=l.key;if(fn(a)!=="array")return[new rt(h,a,`array expected, ${fn(a)} found`)];const f=l.styleSpec;let y,w=[];if(a.length<1)return[new rt(h,a,"filter array must have at least 1 element")];switch(w=w.concat(Bs({key:`${h}[0]`,value:a[0],valueSpec:f.filter_operator,style:l.style,styleSpec:l.styleSpec})),aa(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&aa(a[1])==="$type"&&w.push(new rt(h,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&w.push(new rt(h,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(y=fn(a[1]),y!=="string"&&w.push(new rt(`${h}[1]`,a[1],`string expected, ${y} found`)));for(let k=2;k<a.length;k++)y=fn(a[k]),aa(a[1])==="$type"?w=w.concat(Bs({key:`${h}[${k}]`,value:a[k],valueSpec:f.geometry_type,style:l.style,styleSpec:l.styleSpec})):y!=="string"&&y!=="number"&&y!=="boolean"&&w.push(new rt(`${h}[${k}]`,a[k],`string, number, or boolean expected, ${y} found`));break;case"any":case"all":case"none":for(let k=1;k<a.length;k++)w=w.concat(qo({key:`${h}[${k}]`,value:a[k],style:l.style,styleSpec:l.styleSpec}));break;case"has":case"!has":y=fn(a[1]),a.length!==2?w.push(new rt(h,a,`filter array for "${a[0]}" operator must have 2 elements`)):y!=="string"&&w.push(new rt(`${h}[1]`,a[1],`string expected, ${y} found`));break;case"within":y=fn(a[1]),a.length!==2?w.push(new rt(h,a,`filter array for "${a[0]}" operator must have 2 elements`)):y!=="object"&&w.push(new rt(`${h}[1]`,a[1],`object expected, ${y} found`))}return w}function kc(l,a){const h=l.key,f=l.validateSpec,y=l.style,w=l.styleSpec,k=l.value,D=l.objectKey,P=w[`${a}_${l.layerType}`];if(!P)return[];const E=D.match(/^(.*)-transition$/);if(a==="paint"&&E&&P[E[1]]&&P[E[1]].transition)return f({key:h,value:k,valueSpec:w.transition,style:y,styleSpec:w});const B=l.valueSpec||P[D];if(!B)return[new rt(h,k,`unknown property "${D}"`)];let H;if(fn(k)==="string"&&uo(B)&&!B.tokens&&(H=/^{([^}]+)}$/.exec(k)))return[new rt(h,k,`"${D}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(H[1])} }\`.`)];const K=[];return l.layerType==="symbol"&&(D==="text-field"&&y&&!y.glyphs&&K.push(new rt(h,k,'use of "text-field" requires a style "glyphs" property')),D==="text-font"&&ho(ks(k))&&aa(k.type)==="identity"&&K.push(new rt(h,k,'"text-font" does not support identity functions'))),K.concat(f({key:l.key,value:k,valueSpec:B,style:y,styleSpec:w,expressionContext:"property",propertyType:a,propertyKey:D}))}function Tl(l){return kc(l,"paint")}function Sc(l){return kc(l,"layout")}function Mc(l){let a=[];const h=l.value,f=l.key,y=l.style,w=l.styleSpec;h.type||h.ref||a.push(new rt(f,h,'either "type" or "ref" is required'));let k=aa(h.type);const D=aa(h.ref);if(h.id){const P=aa(h.id);for(let E=0;E<l.arrayIndex;E++){const B=y.layers[E];aa(B.id)===P&&a.push(new rt(f,h.id,`duplicate layer id "${h.id}", previously used at line ${B.id.__line__}`))}}if("ref"in h){let P;["type","source","source-layer","filter","layout"].forEach(E=>{E in h&&a.push(new rt(f,h[E],`"${E}" is prohibited for ref layers`))}),y.layers.forEach(E=>{aa(E.id)===D&&(P=E)}),P?P.ref?a.push(new rt(f,h.ref,"ref cannot reference another ref layer")):k=aa(P.type):a.push(new rt(f,h.ref,`ref layer "${D}" not found`))}else if(k!=="background")if(h.source){const P=y.sources&&y.sources[h.source],E=P&&aa(P.type);P?E==="vector"&&k==="raster"?a.push(new rt(f,h.source,`layer "${h.id}" requires a raster source`)):E!=="raster-dem"&&k==="hillshade"?a.push(new rt(f,h.source,`layer "${h.id}" requires a raster-dem source`)):E==="raster"&&k!=="raster"?a.push(new rt(f,h.source,`layer "${h.id}" requires a vector source`)):E!=="vector"||h["source-layer"]?E==="raster-dem"&&k!=="hillshade"?a.push(new rt(f,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):k!=="line"||!h.paint||!h.paint["line-gradient"]||E==="geojson"&&P.lineMetrics||a.push(new rt(f,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new rt(f,h,`layer "${h.id}" must specify a "source-layer"`)):a.push(new rt(f,h.source,`source "${h.source}" not found`))}else a.push(new rt(f,h,'missing required property "source"'));return a=a.concat(wr({key:f,value:h,valueSpec:w.layer,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*":()=>[],type:()=>l.validateSpec({key:`${f}.type`,value:h.type,valueSpec:w.layer.type,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,object:h,objectKey:"type"}),filter:_o,layout:P=>wr({layer:h,key:P.key,value:P.value,style:P.style,styleSpec:P.styleSpec,validateSpec:P.validateSpec,objectElementValidators:{"*":E=>Sc(jn({layerType:k},E))}}),paint:P=>wr({layer:h,key:P.key,value:P.value,style:P.style,styleSpec:P.styleSpec,validateSpec:P.validateSpec,objectElementValidators:{"*":E=>Tl(jn({layerType:k},E))}})}})),a}function Xr(l){const a=l.value,h=l.key,f=fn(a);return f!=="string"?[new rt(h,a,`string expected, ${f} found`)]:[]}const uh={promoteId:function({key:l,value:a}){if(fn(a)==="string")return Xr({key:l,value:a});{const h=[];for(const f in a)h.push(...Xr({key:`${l}.${f}`,value:a[f]}));return h}}};function hh(l){const a=l.value,h=l.key,f=l.styleSpec,y=l.style,w=l.validateSpec;if(!a.type)return[new rt(h,a,'"type" is required')];const k=aa(a.type);let D;switch(k){case"vector":case"raster":return D=wr({key:h,value:a,valueSpec:f[`source_${k.replace("-","_")}`],style:l.style,styleSpec:f,objectElementValidators:uh,validateSpec:w}),D;case"raster-dem":return D=function(P){var E;const B=(E=P.sourceName)!==null&&E!==void 0?E:"",H=P.value,K=P.styleSpec,ee=K.source_raster_dem,ne=P.style;let ue=[];const me=fn(H);if(H===void 0)return ue;if(me!=="object")return ue.push(new rt("source_raster_dem",H,`object expected, ${me} found`)),ue;const ke=aa(H.encoding)==="custom",Ve=["redFactor","greenFactor","blueFactor","baseShift"],Ce=P.value.encoding?`"${P.value.encoding}"`:"Default";for(const Be in H)!ke&&Ve.includes(Be)?ue.push(new rt(Be,H[Be],`In "${B}": "${Be}" is only valid when "encoding" is set to "custom". ${Ce} encoding found`)):ee[Be]?ue=ue.concat(P.validateSpec({key:Be,value:H[Be],valueSpec:ee[Be],validateSpec:P.validateSpec,style:ne,styleSpec:K})):ue.push(new rt(Be,H[Be],`unknown property "${Be}"`));return ue}({sourceName:h,value:a,style:l.style,styleSpec:f,validateSpec:w}),D;case"geojson":if(D=wr({key:h,value:a,valueSpec:f.source_geojson,style:y,styleSpec:f,validateSpec:w,objectElementValidators:uh}),a.cluster)for(const P in a.clusterProperties){const[E,B]=a.clusterProperties[P],H=typeof E=="string"?[E,["accumulated"],["get",P]]:E;D.push(...go({key:`${h}.${P}.map`,value:B,validateSpec:w,expressionContext:"cluster-map"})),D.push(...go({key:`${h}.${P}.reduce`,value:H,validateSpec:w,expressionContext:"cluster-reduce"}))}return D;case"video":return wr({key:h,value:a,valueSpec:f.source_video,style:y,validateSpec:w,styleSpec:f});case"image":return wr({key:h,value:a,valueSpec:f.source_image,style:y,validateSpec:w,styleSpec:f});case"canvas":return[new rt(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Bs({key:`${h}.type`,value:a.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:y,validateSpec:w,styleSpec:f})}}function dh(l){const a=l.value,h=l.styleSpec,f=h.light,y=l.style;let w=[];const k=fn(a);if(a===void 0)return w;if(k!=="object")return w=w.concat([new rt("light",a,`object expected, ${k} found`)]),w;for(const D in a){const P=D.match(/^(.*)-transition$/);w=w.concat(P&&f[P[1]]&&f[P[1]].transition?l.validateSpec({key:D,value:a[D],valueSpec:h.transition,validateSpec:l.validateSpec,style:y,styleSpec:h}):f[D]?l.validateSpec({key:D,value:a[D],valueSpec:f[D],validateSpec:l.validateSpec,style:y,styleSpec:h}):[new rt(D,a[D],`unknown property "${D}"`)])}return w}function fh(l){const a=l.value,h=l.styleSpec,f=h.sky,y=l.style,w=fn(a);if(a===void 0)return[];if(w!=="object")return[new rt("sky",a,`object expected, ${w} found`)];let k=[];for(const D in a)k=k.concat(f[D]?Ea({key:D,value:a[D],valueSpec:f[D],style:y,styleSpec:h}):[new rt(D,a[D],`unknown property "${D}"`)]);return k}function ph(l){const a=l.value,h=l.styleSpec,f=h.terrain,y=l.style;let w=[];const k=fn(a);if(a===void 0)return w;if(k!=="object")return w=w.concat([new rt("terrain",a,`object expected, ${k} found`)]),w;for(const D in a)w=w.concat(f[D]?l.validateSpec({key:D,value:a[D],valueSpec:f[D],validateSpec:l.validateSpec,style:y,styleSpec:h}):[new rt(D,a[D],`unknown property "${D}"`)]);return w}function Zo(l){let a=[];const h=l.value,f=l.key;if(Array.isArray(h)){const y=[],w=[];for(const k in h)h[k].id&&y.includes(h[k].id)&&a.push(new rt(f,h,`all the sprites' ids must be unique, but ${h[k].id} is duplicated`)),y.push(h[k].id),h[k].url&&w.includes(h[k].url)&&a.push(new rt(f,h,`all the sprites' URLs must be unique, but ${h[k].url} is duplicated`)),w.push(h[k].url),a=a.concat(wr({key:`${f}[${k}]`,value:h[k],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:l.validateSpec}));return a}return Xr({key:f,value:h})}const Go={"*":()=>[],array:mo,boolean:function(l){const a=l.value,h=l.key,f=fn(a);return f!=="boolean"?[new rt(h,a,`boolean expected, ${f} found`)]:[]},number:xc,color:function(l){const a=l.key,h=l.value,f=fn(h);return f!=="string"?[new rt(a,h,`color expected, ${f} found`)]:Fi.parse(String(h))?[]:[new rt(a,h,`color expected, "${h}" found`)]},constants:ch,enum:Bs,filter:_o,function:wc,layer:Mc,object:wr,source:hh,light:dh,sky:fh,terrain:ph,string:Xr,formatted:function(l){return Xr(l).length===0?[]:go(l)},resolvedImage:function(l){return Xr(l).length===0?[]:go(l)},padding:function(l){const a=l.key,h=l.value;if(fn(h)==="array"){if(h.length<1||h.length>4)return[new rt(a,h,`padding requires 1 to 4 values; ${h.length} values found`)];const f={type:"number"};let y=[];for(let w=0;w<h.length;w++)y=y.concat(l.validateSpec({key:`${a}[${w}]`,value:h[w],validateSpec:l.validateSpec,valueSpec:f}));return y}return xc({key:a,value:h,valueSpec:{}})},variableAnchorOffsetCollection:function(l){const a=l.key,h=l.value,f=fn(h),y=l.styleSpec;if(f!=="array"||h.length<1||h.length%2!=0)return[new rt(a,h,"variableAnchorOffsetCollection requires a non-empty array of even length")];let w=[];for(let k=0;k<h.length;k+=2)w=w.concat(Bs({key:`${a}[${k}]`,value:h[k],valueSpec:y.layout_symbol["text-anchor"]})),w=w.concat(mo({key:`${a}[${k+1}]`,value:h[k+1],valueSpec:{length:2,value:"number"},validateSpec:l.validateSpec,style:l.style,styleSpec:y}));return w},sprite:Zo};function Ea(l){const a=l.value,h=l.valueSpec,f=l.styleSpec;return l.validateSpec=Ea,h.expression&&ho(aa(a))?wc(l):h.expression&&En(ks(a))?go(l):h.type&&Go[h.type]?Go[h.type](l):wr(jn({},l,{valueSpec:h.type?f[h.type]:h}))}function yo(l){const a=l.value,h=l.key,f=Xr(l);return f.length||(a.indexOf("{fontstack}")===-1&&f.push(new rt(h,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&f.push(new rt(h,a,'"glyphs" url must include a "{range}" token'))),f}function Pr(l,a=je){let h=[];return h=h.concat(Ea({key:"",value:l,valueSpec:a.$root,styleSpec:a,style:l,validateSpec:Ea,objectElementValidators:{glyphs:yo,"*":()=>[]}})),l.constants&&(h=h.concat(ch({key:"constants",value:l.constants,style:l,styleSpec:a,validateSpec:Ea}))),mh(h)}function Qr(l){return function(a){return l({...a,validateSpec:Ea})}}function mh(l){return[].concat(l).sort((a,h)=>a.line-h.line)}function sr(l){return function(...a){return mh(l.apply(this,a))}}Pr.source=sr(Qr(hh)),Pr.sprite=sr(Qr(Zo)),Pr.glyphs=sr(Qr(yo)),Pr.light=sr(Qr(dh)),Pr.sky=sr(Qr(fh)),Pr.terrain=sr(Qr(ph)),Pr.layer=sr(Qr(Mc)),Pr.filter=sr(Qr(_o)),Pr.paintProperty=sr(Qr(Tl)),Pr.layoutProperty=sr(Qr(Sc));const bo=Pr,Dc=bo.light,mf=bo.paintProperty,Tc=bo.layoutProperty;function gh(l,a){let h=!1;if(a&&a.length)for(const f of a)l.fire(new Yi(new Error(f.message))),h=!0;return h}class cs{constructor(a,h,f){const y=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;const k=new Int32Array(this.arrayBuffer);a=k[0],this.d=(h=k[1])+2*(f=k[2]);for(let P=0;P<this.d*this.d;P++){const E=k[3+P],B=k[3+P+1];y.push(E===B?null:k.subarray(E,B))}const D=k[3+y.length+1];this.keys=k.subarray(k[3+y.length],D),this.bboxes=k.subarray(D),this.insert=this._insertReadonly}else{this.d=h+2*f;for(let k=0;k<this.d*this.d;k++)y.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=a,this.padding=f,this.scale=h/a,this.uid=0;const w=f/h*a;this.min=-w,this.max=a+w}insert(a,h,f,y,w){this._forEachCell(h,f,y,w,this._insertCell,this.uid++,void 0,void 0),this.keys.push(a),this.bboxes.push(h),this.bboxes.push(f),this.bboxes.push(y),this.bboxes.push(w)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(a,h,f,y,w,k){this.cells[w].push(k)}query(a,h,f,y,w){const k=this.min,D=this.max;if(a<=k&&h<=k&&D<=f&&D<=y&&!w)return Array.prototype.slice.call(this.keys);{const P=[];return this._forEachCell(a,h,f,y,this._queryCell,P,{},w),P}}_queryCell(a,h,f,y,w,k,D,P){const E=this.cells[w];if(E!==null){const B=this.keys,H=this.bboxes;for(let K=0;K<E.length;K++){const ee=E[K];if(D[ee]===void 0){const ne=4*ee;(P?P(H[ne+0],H[ne+1],H[ne+2],H[ne+3]):a<=H[ne+2]&&h<=H[ne+3]&&f>=H[ne+0]&&y>=H[ne+1])?(D[ee]=!0,k.push(B[ee])):D[ee]=!1}}}}_forEachCell(a,h,f,y,w,k,D,P){const E=this._convertToCellCoord(a),B=this._convertToCellCoord(h),H=this._convertToCellCoord(f),K=this._convertToCellCoord(y);for(let ee=E;ee<=H;ee++)for(let ne=B;ne<=K;ne++){const ue=this.d*ne+ee;if((!P||P(this._convertFromCellCoord(ee),this._convertFromCellCoord(ne),this._convertFromCellCoord(ee+1),this._convertFromCellCoord(ne+1)))&&w.call(this,a,h,f,y,ue,k,D,P))return}}_convertFromCellCoord(a){return(a-this.padding)/this.scale}_convertToCellCoord(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const a=this.cells,h=3+this.cells.length+1+1;let f=0;for(let k=0;k<this.cells.length;k++)f+=this.cells[k].length;const y=new Int32Array(h+f+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;let w=h;for(let k=0;k<a.length;k++){const D=a[k];y[3+k]=w,y.set(D,w),w+=D.length}return y[3+a.length]=w,y.set(this.keys,w),w+=this.keys.length,y[3+a.length+1]=w,y.set(this.bboxes,w),w+=this.bboxes.length,y.buffer}static serialize(a,h){const f=a.toArrayBuffer();return h&&h.push(f),{buffer:f}}static deserialize(a){return new cs(a.buffer)}}const Ss={};function Yt(l,a,h={}){if(Ss[l])throw new Error(`${l} is already registered.`);Object.defineProperty(a,"_classRegistryKey",{value:l,writeable:!1}),Ss[l]={klass:a,omit:h.omit||[],shallow:h.shallow||[]}}Yt("Object",Object),Yt("TransferableGridIndex",cs),Yt("Color",Fi),Yt("Error",Error),Yt("AJAXError",ht),Yt("ResolvedImage",na),Yt("StylePropertyFunction",kl),Yt("StyleExpression",Wo,{omit:["_evaluator"]}),Yt("ZoomDependentExpression",wl),Yt("ZoomConstantExpression",fo),Yt("CompoundExpression",It,{omit:["_evaluate"]});for(const l in lo)lo[l]._classRegistryKey||Yt(`Expression_${l}`,lo[l]);function Cc(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function Ns(l,a){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||l instanceof Blob||l instanceof Error)return l;if(Cc(l)||Vt(l))return a&&a.push(l),l;if(ArrayBuffer.isView(l)){const h=l;return a&&a.push(h.buffer),h}if(l instanceof ImageData)return a&&a.push(l.data.buffer),l;if(Array.isArray(l)){const h=[];for(const f of l)h.push(Ns(f,a));return h}if(typeof l=="object"){const h=l.constructor,f=h._classRegistryKey;if(!f)throw new Error(`can't serialize object of unregistered class ${h.name}`);if(!Ss[f])throw new Error(`${f} is not registered.`);const y=h.serialize?h.serialize(l,a):{};if(h.serialize){if(a&&y===a[a.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const w in l){if(!l.hasOwnProperty(w)||Ss[f].omit.indexOf(w)>=0)continue;const k=l[w];y[w]=Ss[f].shallow.indexOf(w)>=0?k:Ns(k,a)}l instanceof Error&&(y.message=l.message)}if(y.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(y.$name=f),y}throw new Error("can't serialize object of type "+typeof l)}function vo(l){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||l instanceof Blob||l instanceof Error||Cc(l)||Vt(l)||ArrayBuffer.isView(l)||l instanceof ImageData)return l;if(Array.isArray(l))return l.map(vo);if(typeof l=="object"){const a=l.$name||"Object";if(!Ss[a])throw new Error(`can't deserialize unregistered class ${a}`);const{klass:h}=Ss[a];if(!h)throw new Error(`can't deserialize unregistered class ${a}`);if(h.deserialize)return h.deserialize(l);const f=Object.create(h.prototype);for(const y of Object.keys(l)){if(y==="$name")continue;const w=l[y];f[y]=Ss[a].shallow.indexOf(y)>=0?w:vo(w)}return f}throw new Error("can't deserialize object of type "+typeof l)}class Pc{constructor(){this.first=!0}update(a,h){const f=Math.floor(a);return this.first?(this.first=!1,this.lastIntegerZoom=f,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=f,!0):(this.lastFloorZoom>f?(this.lastIntegerZoom=f+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<f&&(this.lastIntegerZoom=f,this.lastIntegerZoomTime=h),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=f,!0))}}const qt={"Latin-1 Supplement":l=>l>=128&&l<=255,Arabic:l=>l>=1536&&l<=1791,"Arabic Supplement":l=>l>=1872&&l<=1919,"Arabic Extended-A":l=>l>=2208&&l<=2303,"Hangul Jamo":l=>l>=4352&&l<=4607,"Unified Canadian Aboriginal Syllabics":l=>l>=5120&&l<=5759,Khmer:l=>l>=6016&&l<=6143,"Unified Canadian Aboriginal Syllabics Extended":l=>l>=6320&&l<=6399,"General Punctuation":l=>l>=8192&&l<=8303,"Letterlike Symbols":l=>l>=8448&&l<=8527,"Number Forms":l=>l>=8528&&l<=8591,"Miscellaneous Technical":l=>l>=8960&&l<=9215,"Control Pictures":l=>l>=9216&&l<=9279,"Optical Character Recognition":l=>l>=9280&&l<=9311,"Enclosed Alphanumerics":l=>l>=9312&&l<=9471,"Geometric Shapes":l=>l>=9632&&l<=9727,"Miscellaneous Symbols":l=>l>=9728&&l<=9983,"Miscellaneous Symbols and Arrows":l=>l>=11008&&l<=11263,"CJK Radicals Supplement":l=>l>=11904&&l<=12031,"Kangxi Radicals":l=>l>=12032&&l<=12255,"Ideographic Description Characters":l=>l>=12272&&l<=12287,"CJK Symbols and Punctuation":l=>l>=12288&&l<=12351,Hiragana:l=>l>=12352&&l<=12447,Katakana:l=>l>=12448&&l<=12543,Bopomofo:l=>l>=12544&&l<=12591,"Hangul Compatibility Jamo":l=>l>=12592&&l<=12687,Kanbun:l=>l>=12688&&l<=12703,"Bopomofo Extended":l=>l>=12704&&l<=12735,"CJK Strokes":l=>l>=12736&&l<=12783,"Katakana Phonetic Extensions":l=>l>=12784&&l<=12799,"Enclosed CJK Letters and Months":l=>l>=12800&&l<=13055,"CJK Compatibility":l=>l>=13056&&l<=13311,"CJK Unified Ideographs Extension A":l=>l>=13312&&l<=19903,"Yijing Hexagram Symbols":l=>l>=19904&&l<=19967,"CJK Unified Ideographs":l=>l>=19968&&l<=40959,"Yi Syllables":l=>l>=40960&&l<=42127,"Yi Radicals":l=>l>=42128&&l<=42191,"Hangul Jamo Extended-A":l=>l>=43360&&l<=43391,"Hangul Syllables":l=>l>=44032&&l<=55215,"Hangul Jamo Extended-B":l=>l>=55216&&l<=55295,"Private Use Area":l=>l>=57344&&l<=63743,"CJK Compatibility Ideographs":l=>l>=63744&&l<=64255,"Arabic Presentation Forms-A":l=>l>=64336&&l<=65023,"Vertical Forms":l=>l>=65040&&l<=65055,"CJK Compatibility Forms":l=>l>=65072&&l<=65103,"Small Form Variants":l=>l>=65104&&l<=65135,"Arabic Presentation Forms-B":l=>l>=65136&&l<=65279,"Halfwidth and Fullwidth Forms":l=>l>=65280&&l<=65519};function $o(l){for(const a of l)if(Pl(a.charCodeAt(0)))return!0;return!1}function Cl(l){for(const a of l)if(!_h(a.charCodeAt(0)))return!1;return!0}function _h(l){return!(qt.Arabic(l)||qt["Arabic Supplement"](l)||qt["Arabic Extended-A"](l)||qt["Arabic Presentation Forms-A"](l)||qt["Arabic Presentation Forms-B"](l))}function Pl(l){return!(l!==746&&l!==747&&(l<4352||!(qt["Bopomofo Extended"](l)||qt.Bopomofo(l)||qt["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||qt["CJK Compatibility Ideographs"](l)||qt["CJK Compatibility"](l)||qt["CJK Radicals Supplement"](l)||qt["CJK Strokes"](l)||!(!qt["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||qt["CJK Unified Ideographs Extension A"](l)||qt["CJK Unified Ideographs"](l)||qt["Enclosed CJK Letters and Months"](l)||qt["Hangul Compatibility Jamo"](l)||qt["Hangul Jamo Extended-A"](l)||qt["Hangul Jamo Extended-B"](l)||qt["Hangul Jamo"](l)||qt["Hangul Syllables"](l)||qt.Hiragana(l)||qt["Ideographic Description Characters"](l)||qt.Kanbun(l)||qt["Kangxi Radicals"](l)||qt["Katakana Phonetic Extensions"](l)||qt.Katakana(l)&&l!==12540||!(!qt["Halfwidth and Fullwidth Forms"](l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!qt["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||qt["Unified Canadian Aboriginal Syllabics"](l)||qt["Unified Canadian Aboriginal Syllabics Extended"](l)||qt["Vertical Forms"](l)||qt["Yijing Hexagram Symbols"](l)||qt["Yi Syllables"](l)||qt["Yi Radicals"](l))))}function Ac(l){return!(Pl(l)||function(a){return!!(qt["Latin-1 Supplement"](a)&&(a===167||a===169||a===174||a===177||a===188||a===189||a===190||a===215||a===247)||qt["General Punctuation"](a)&&(a===8214||a===8224||a===8225||a===8240||a===8241||a===8251||a===8252||a===8258||a===8263||a===8264||a===8265||a===8273)||qt["Letterlike Symbols"](a)||qt["Number Forms"](a)||qt["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||a===9003||a>=9085&&a<=9114||a>=9150&&a<=9165||a===9167||a>=9169&&a<=9179||a>=9186&&a<=9215)||qt["Control Pictures"](a)&&a!==9251||qt["Optical Character Recognition"](a)||qt["Enclosed Alphanumerics"](a)||qt["Geometric Shapes"](a)||qt["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||qt["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||qt["CJK Symbols and Punctuation"](a)||qt.Katakana(a)||qt["Private Use Area"](a)||qt["CJK Compatibility Forms"](a)||qt["Small Form Variants"](a)||qt["Halfwidth and Fullwidth Forms"](a)||a===8734||a===8756||a===8757||a>=9984&&a<=10087||a>=10102&&a<=10131||a===65532||a===65533)}(l))}function Ic(l){return l>=1424&&l<=2303||qt["Arabic Presentation Forms-A"](l)||qt["Arabic Presentation Forms-B"](l)}function Ec(l,a){return!(!a&&Ic(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||qt.Khmer(l))}function yh(l){for(const a of l)if(Ic(a.charCodeAt(0)))return!0;return!1}const Vs=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(l){this.pluginStatus=l.pluginStatus,this.pluginURL=l.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(l){this.applyArabicShaping=l.applyArabicShaping,this.processBidirectionalText=l.processBidirectionalText,this.processStyledBidirectionalText=l.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Fn{constructor(a,h){this.zoom=a,h?(this.now=h.now,this.fadeDuration=h.fadeDuration,this.zoomHistory=h.zoomHistory,this.transition=h.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Pc,this.transition={})}isSupportedScript(a){return function(h,f){for(const y of h)if(!Ec(y.charCodeAt(0),f))return!1;return!0}(a,Vs.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const a=this.zoom,h=a-Math.floor(a),f=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*f}:{fromScale:.5,toScale:1,t:1-(1-f)*h}}}class Al{constructor(a,h){this.property=a,this.value=h,this.expression=function(f,y){if(ho(f))return new kl(f,y);if(En(f)){const w=ah(f,y);if(w.result==="error")throw new Error(w.value.map(k=>`${k.key}: ${k.message}`).join(", "));return w.value}{let w=f;return y.type==="color"&&typeof f=="string"?w=Fi.parse(f):y.type!=="padding"||typeof f!="number"&&!Array.isArray(f)?y.type==="variableAnchorOffsetCollection"&&Array.isArray(f)&&(w=la.parse(f)):w=ma.parse(f),{kind:"constant",evaluate:()=>w}}}(h===void 0?a.specification.default:h,a.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(a,h,f){return this.property.possiblyEvaluate(this,a,h,f)}}class Il{constructor(a){this.property=a,this.value=new Al(a,void 0)}transitioned(a,h){return new zc(this.property,this.value,h,Pe({},a.transition,this.transition),a.now)}untransitioned(){return new zc(this.property,this.value,null,{},0)}}class Lc{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)}getValue(a){return Re(this._values[a].value.value)}setValue(a,h){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new Il(this._values[a].property)),this._values[a].value=new Al(this._values[a].property,h===null?void 0:Re(h))}getTransition(a){return Re(this._values[a].transition)}setTransition(a,h){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new Il(this._values[a].property)),this._values[a].transition=Re(h)||void 0}serialize(){const a={};for(const h of Object.keys(this._values)){const f=this.getValue(h);f!==void 0&&(a[h]=f);const y=this.getTransition(h);y!==void 0&&(a[`${h}-transition`]=y)}return a}transitioned(a,h){const f=new bh(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].transitioned(a,h._values[y]);return f}untransitioned(){const a=new bh(this._properties);for(const h of Object.keys(this._values))a._values[h]=this._values[h].untransitioned();return a}}class zc{constructor(a,h,f,y,w){this.property=a,this.value=h,this.begin=w+y.delay||0,this.end=this.begin+y.duration||0,a.specification.transition&&(y.delay||y.duration)&&(this.prior=f)}possiblyEvaluate(a,h,f){const y=a.now||0,w=this.value.possiblyEvaluate(a,h,f),k=this.prior;if(k){if(y>this.end)return this.prior=null,w;if(this.value.isDataDriven())return this.prior=null,w;if(y<this.begin)return k.possiblyEvaluate(a,h,f);{const D=(y-this.begin)/(this.end-this.begin);return this.property.interpolate(k.possiblyEvaluate(a,h,f),w,function(P){if(P<=0)return 0;if(P>=1)return 1;const E=P*P,B=E*P;return 4*(P<.5?B:3*(P-E)+B-.75)}(D))}}return w}}class bh{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,h,f){const y=new Ko(this._properties);for(const w of Object.keys(this._values))y._values[w]=this._values[w].possiblyEvaluate(a,h,f);return y}hasTransition(){for(const a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class gf{constructor(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)}hasValue(a){return this._values[a].value!==void 0}getValue(a){return Re(this._values[a].value)}setValue(a,h){this._values[a]=new Al(this._values[a].property,h===null?void 0:Re(h))}serialize(){const a={};for(const h of Object.keys(this._values)){const f=this.getValue(h);f!==void 0&&(a[h]=f)}return a}possiblyEvaluate(a,h,f){const y=new Ko(this._properties);for(const w of Object.keys(this._values))y._values[w]=this._values[w].possiblyEvaluate(a,h,f);return y}}class Fr{constructor(a,h,f){this.property=a,this.value=h,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(a){return this.value.kind==="constant"?this.value.value:a}evaluate(a,h,f,y){return this.property.evaluate(this.value,this.parameters,a,h,f,y)}}class Ko{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class ri{constructor(a){this.specification=a}possiblyEvaluate(a,h){if(a.isDataDriven())throw new Error("Value should not be data driven");return a.expression.evaluate(h)}interpolate(a,h,f){const y=Xa[this.specification.type];return y?y(a,h,f):a}}class yi{constructor(a,h){this.specification=a,this.overrides=h}possiblyEvaluate(a,h,f,y){return new Fr(this,a.expression.kind==="constant"||a.expression.kind==="camera"?{kind:"constant",value:a.expression.evaluate(h,null,{},f,y)}:a.expression,h)}interpolate(a,h,f){if(a.value.kind!=="constant"||h.value.kind!=="constant")return a;if(a.value.value===void 0||h.value.value===void 0)return new Fr(this,{kind:"constant",value:void 0},a.parameters);const y=Xa[this.specification.type];if(y){const w=y(a.value.value,h.value.value,f);return new Fr(this,{kind:"constant",value:w},a.parameters)}return a}evaluate(a,h,f,y,w,k){return a.kind==="constant"?a.value:a.evaluate(h,f,y,w,k)}}class Hs extends yi{possiblyEvaluate(a,h,f,y){if(a.value===void 0)return new Fr(this,{kind:"constant",value:void 0},h);if(a.expression.kind==="constant"){const w=a.expression.evaluate(h,null,{},f,y),k=a.property.specification.type==="resolvedImage"&&typeof w!="string"?w.name:w,D=this._calculate(k,k,k,h);return new Fr(this,{kind:"constant",value:D},h)}if(a.expression.kind==="camera"){const w=this._calculate(a.expression.evaluate({zoom:h.zoom-1}),a.expression.evaluate({zoom:h.zoom}),a.expression.evaluate({zoom:h.zoom+1}),h);return new Fr(this,{kind:"constant",value:w},h)}return new Fr(this,a.expression,h)}evaluate(a,h,f,y,w,k){if(a.kind==="source"){const D=a.evaluate(h,f,y,w,k);return this._calculate(D,D,D,h)}return a.kind==="composite"?this._calculate(a.evaluate({zoom:Math.floor(h.zoom)-1},f,y),a.evaluate({zoom:Math.floor(h.zoom)},f,y),a.evaluate({zoom:Math.floor(h.zoom)+1},f,y),h):a.value}_calculate(a,h,f,y){return y.zoom>y.zoomHistory.lastIntegerZoom?{from:a,to:h}:{from:f,to:h}}interpolate(a){return a}}class Rc{constructor(a){this.specification=a}possiblyEvaluate(a,h,f,y){if(a.value!==void 0){if(a.expression.kind==="constant"){const w=a.expression.evaluate(h,null,{},f,y);return this._calculate(w,w,w,h)}return this._calculate(a.expression.evaluate(new Fn(Math.floor(h.zoom-1),h)),a.expression.evaluate(new Fn(Math.floor(h.zoom),h)),a.expression.evaluate(new Fn(Math.floor(h.zoom+1),h)),h)}}_calculate(a,h,f,y){return y.zoom>y.zoomHistory.lastIntegerZoom?{from:a,to:h}:{from:f,to:h}}interpolate(a){return a}}class Yo{constructor(a){this.specification=a}possiblyEvaluate(a,h,f,y){return!!a.expression.evaluate(h,null,{},f,y)}interpolate(){return!1}}class or{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const h in a){const f=a[h];f.specification.overridable&&this.overridableProperties.push(h);const y=this.defaultPropertyValues[h]=new Al(f,void 0),w=this.defaultTransitionablePropertyValues[h]=new Il(f);this.defaultTransitioningPropertyValues[h]=w.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=y.possiblyEvaluate({})}}}Yt("DataDrivenProperty",yi),Yt("DataConstantProperty",ri),Yt("CrossFadedDataDrivenProperty",Hs),Yt("CrossFadedProperty",Rc),Yt("ColorRampProperty",Yo);const vh="-transition";class Or extends Kn{constructor(a,h){if(super(),this.id=a.id,this.type=a.type,this._featureFilter={filter:()=>!0,needGeometry:!1},a.type!=="custom"&&(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,a.type!=="background"&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter),h.layout&&(this._unevaluatedLayout=new gf(h.layout)),h.paint)){this._transitionablePaint=new Lc(h.paint);for(const f in a.paint)this.setPaintProperty(f,a.paint[f],{validate:!1});for(const f in a.layout)this.setLayoutProperty(f,a.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ko(h.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(a){return a==="visibility"?this.visibility:this._unevaluatedLayout.getValue(a)}setLayoutProperty(a,h,f={}){h!=null&&this._validate(Tc,`layers.${this.id}.layout.${a}`,a,h,f)||(a!=="visibility"?this._unevaluatedLayout.setValue(a,h):this.visibility=h)}getPaintProperty(a){return a.endsWith(vh)?this._transitionablePaint.getTransition(a.slice(0,-11)):this._transitionablePaint.getValue(a)}setPaintProperty(a,h,f={}){if(h!=null&&this._validate(mf,`layers.${this.id}.paint.${a}`,a,h,f))return!1;if(a.endsWith(vh))return this._transitionablePaint.setTransition(a.slice(0,-11),h||void 0),!1;{const y=this._transitionablePaint._values[a],w=y.property.specification["property-type"]==="cross-faded-data-driven",k=y.value.isDataDriven(),D=y.value;this._transitionablePaint.setValue(a,h),this._handleSpecialPaintPropertyUpdate(a);const P=this._transitionablePaint._values[a].value;return P.isDataDriven()||k||w||this._handleOverridablePaintPropertyUpdate(a,D,P)}}_handleSpecialPaintPropertyUpdate(a){}_handleOverridablePaintPropertyUpdate(a,h,f){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||this.visibility==="none"}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,h){a.getCrossfadeParameters&&(this._crossfadeParameters=a.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,h)}serialize(){const a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),ze(a,(h,f)=>!(h===void 0||f==="layout"&&!Object.keys(h).length||f==="paint"&&!Object.keys(h).length))}_validate(a,h,f,y,w={}){return(!w||w.validate!==!1)&&gh(this,a.call(bo,{key:h,layerType:this.type,objectKey:f,value:y,styleSpec:je,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const a in this.paint._values){const h=this.paint.get(a);if(h instanceof Fr&&uo(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}const xh={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class xo{constructor(a,h){this._structArray=a,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Qn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,h){return a._trim(),h&&(a.isTransferred=!0,h.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){const h=Object.create(this.prototype);return h.arrayBuffer=a.arrayBuffer,h.length=a.length,h.capacity=a.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ha(l,a=1){let h=0,f=0;return{members:l.map(y=>{const w=xh[y.type].BYTES_PER_ELEMENT,k=h=wh(h,Math.max(a,w)),D=y.components||1;return f=Math.max(f,w),h+=w*D,{name:y.name,type:y.type,components:D,offset:k}}),size:wh(h,Math.max(f,a)),alignment:a}}function wh(l,a){return Math.ceil(l/a)*a}class Jo extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h){const f=this.length;return this.resize(f+1),this.emplace(f,a,h)}emplace(a,h,f){const y=2*a;return this.int16[y+0]=h,this.int16[y+1]=f,a}}Jo.prototype.bytesPerElement=4,Yt("StructArrayLayout2i4",Jo);class El extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,f){const y=this.length;return this.resize(y+1),this.emplace(y,a,h,f)}emplace(a,h,f,y){const w=3*a;return this.int16[w+0]=h,this.int16[w+1]=f,this.int16[w+2]=y,a}}El.prototype.bytesPerElement=6,Yt("StructArrayLayout3i6",El);class Ms extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,f,y){const w=this.length;return this.resize(w+1),this.emplace(w,a,h,f,y)}emplace(a,h,f,y,w){const k=4*a;return this.int16[k+0]=h,this.int16[k+1]=f,this.int16[k+2]=y,this.int16[k+3]=w,a}}Ms.prototype.bytesPerElement=8,Yt("StructArrayLayout4i8",Ms);class Fc extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,f,y,w,k){const D=this.length;return this.resize(D+1),this.emplace(D,a,h,f,y,w,k)}emplace(a,h,f,y,w,k,D){const P=6*a;return this.int16[P+0]=h,this.int16[P+1]=f,this.int16[P+2]=y,this.int16[P+3]=w,this.int16[P+4]=k,this.int16[P+5]=D,a}}Fc.prototype.bytesPerElement=12,Yt("StructArrayLayout2i4i12",Fc);class Oc extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,f,y,w,k){const D=this.length;return this.resize(D+1),this.emplace(D,a,h,f,y,w,k)}emplace(a,h,f,y,w,k,D){const P=4*a,E=8*a;return this.int16[P+0]=h,this.int16[P+1]=f,this.uint8[E+4]=y,this.uint8[E+5]=w,this.uint8[E+6]=k,this.uint8[E+7]=D,a}}Oc.prototype.bytesPerElement=8,Yt("StructArrayLayout2i4ub8",Oc);class Xo extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h){const f=this.length;return this.resize(f+1),this.emplace(f,a,h)}emplace(a,h,f){const y=2*a;return this.float32[y+0]=h,this.float32[y+1]=f,a}}Xo.prototype.bytesPerElement=8,Yt("StructArrayLayout2f8",Xo);class Bc extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,f,y,w,k,D,P,E,B){const H=this.length;return this.resize(H+1),this.emplace(H,a,h,f,y,w,k,D,P,E,B)}emplace(a,h,f,y,w,k,D,P,E,B,H){const K=10*a;return this.uint16[K+0]=h,this.uint16[K+1]=f,this.uint16[K+2]=y,this.uint16[K+3]=w,this.uint16[K+4]=k,this.uint16[K+5]=D,this.uint16[K+6]=P,this.uint16[K+7]=E,this.uint16[K+8]=B,this.uint16[K+9]=H,a}}Bc.prototype.bytesPerElement=20,Yt("StructArrayLayout10ui20",Bc);class Ll extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,f,y,w,k,D,P,E,B,H,K){const ee=this.length;return this.resize(ee+1),this.emplace(ee,a,h,f,y,w,k,D,P,E,B,H,K)}emplace(a,h,f,y,w,k,D,P,E,B,H,K,ee){const ne=12*a;return this.int16[ne+0]=h,this.int16[ne+1]=f,this.int16[ne+2]=y,this.int16[ne+3]=w,this.uint16[ne+4]=k,this.uint16[ne+5]=D,this.uint16[ne+6]=P,this.uint16[ne+7]=E,this.int16[ne+8]=B,this.int16[ne+9]=H,this.int16[ne+10]=K,this.int16[ne+11]=ee,a}}Ll.prototype.bytesPerElement=24,Yt("StructArrayLayout4i4ui4i24",Ll);class Nc extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,f){const y=this.length;return this.resize(y+1),this.emplace(y,a,h,f)}emplace(a,h,f,y){const w=3*a;return this.float32[w+0]=h,this.float32[w+1]=f,this.float32[w+2]=y,a}}Nc.prototype.bytesPerElement=12,Yt("StructArrayLayout3f12",Nc);class Vc extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){const h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.uint32[1*a+0]=h,a}}Vc.prototype.bytesPerElement=4,Yt("StructArrayLayout1ul4",Vc);class us extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,f,y,w,k,D,P,E){const B=this.length;return this.resize(B+1),this.emplace(B,a,h,f,y,w,k,D,P,E)}emplace(a,h,f,y,w,k,D,P,E,B){const H=10*a,K=5*a;return this.int16[H+0]=h,this.int16[H+1]=f,this.int16[H+2]=y,this.int16[H+3]=w,this.int16[H+4]=k,this.int16[H+5]=D,this.uint32[K+3]=P,this.uint16[H+8]=E,this.uint16[H+9]=B,a}}us.prototype.bytesPerElement=20,Yt("StructArrayLayout6i1ul2ui20",us);class zl extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,f,y,w,k){const D=this.length;return this.resize(D+1),this.emplace(D,a,h,f,y,w,k)}emplace(a,h,f,y,w,k,D){const P=6*a;return this.int16[P+0]=h,this.int16[P+1]=f,this.int16[P+2]=y,this.int16[P+3]=w,this.int16[P+4]=k,this.int16[P+5]=D,a}}zl.prototype.bytesPerElement=12,Yt("StructArrayLayout2i2i2i12",zl);class Qo extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,f,y,w){const k=this.length;return this.resize(k+1),this.emplace(k,a,h,f,y,w)}emplace(a,h,f,y,w,k){const D=4*a,P=8*a;return this.float32[D+0]=h,this.float32[D+1]=f,this.float32[D+2]=y,this.int16[P+6]=w,this.int16[P+7]=k,a}}Qo.prototype.bytesPerElement=16,Yt("StructArrayLayout2f1f2i16",Qo);class Rl extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,f,y){const w=this.length;return this.resize(w+1),this.emplace(w,a,h,f,y)}emplace(a,h,f,y,w){const k=12*a,D=3*a;return this.uint8[k+0]=h,this.uint8[k+1]=f,this.float32[D+1]=y,this.float32[D+2]=w,a}}Rl.prototype.bytesPerElement=12,Yt("StructArrayLayout2ub2f12",Rl);class wo extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,f){const y=this.length;return this.resize(y+1),this.emplace(y,a,h,f)}emplace(a,h,f,y){const w=3*a;return this.uint16[w+0]=h,this.uint16[w+1]=f,this.uint16[w+2]=y,a}}wo.prototype.bytesPerElement=6,Yt("StructArrayLayout3ui6",wo);class Hc extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,f,y,w,k,D,P,E,B,H,K,ee,ne,ue,me,ke){const Ve=this.length;return this.resize(Ve+1),this.emplace(Ve,a,h,f,y,w,k,D,P,E,B,H,K,ee,ne,ue,me,ke)}emplace(a,h,f,y,w,k,D,P,E,B,H,K,ee,ne,ue,me,ke,Ve){const Ce=24*a,Be=12*a,it=48*a;return this.int16[Ce+0]=h,this.int16[Ce+1]=f,this.uint16[Ce+2]=y,this.uint16[Ce+3]=w,this.uint32[Be+2]=k,this.uint32[Be+3]=D,this.uint32[Be+4]=P,this.uint16[Ce+10]=E,this.uint16[Ce+11]=B,this.uint16[Ce+12]=H,this.float32[Be+7]=K,this.float32[Be+8]=ee,this.uint8[it+36]=ne,this.uint8[it+37]=ue,this.uint8[it+38]=me,this.uint32[Be+10]=ke,this.int16[Ce+22]=Ve,a}}Hc.prototype.bytesPerElement=48,Yt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Hc);class ko extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,f,y,w,k,D,P,E,B,H,K,ee,ne,ue,me,ke,Ve,Ce,Be,it,ot,Ht,ti,Nt,Lt,kt,Qt){const At=this.length;return this.resize(At+1),this.emplace(At,a,h,f,y,w,k,D,P,E,B,H,K,ee,ne,ue,me,ke,Ve,Ce,Be,it,ot,Ht,ti,Nt,Lt,kt,Qt)}emplace(a,h,f,y,w,k,D,P,E,B,H,K,ee,ne,ue,me,ke,Ve,Ce,Be,it,ot,Ht,ti,Nt,Lt,kt,Qt,At){const yt=32*a,hi=16*a;return this.int16[yt+0]=h,this.int16[yt+1]=f,this.int16[yt+2]=y,this.int16[yt+3]=w,this.int16[yt+4]=k,this.int16[yt+5]=D,this.int16[yt+6]=P,this.int16[yt+7]=E,this.uint16[yt+8]=B,this.uint16[yt+9]=H,this.uint16[yt+10]=K,this.uint16[yt+11]=ee,this.uint16[yt+12]=ne,this.uint16[yt+13]=ue,this.uint16[yt+14]=me,this.uint16[yt+15]=ke,this.uint16[yt+16]=Ve,this.uint16[yt+17]=Ce,this.uint16[yt+18]=Be,this.uint16[yt+19]=it,this.uint16[yt+20]=ot,this.uint16[yt+21]=Ht,this.uint16[yt+22]=ti,this.uint32[hi+12]=Nt,this.float32[hi+13]=Lt,this.float32[hi+14]=kt,this.uint16[yt+30]=Qt,this.uint16[yt+31]=At,a}}ko.prototype.bytesPerElement=64,Yt("StructArrayLayout8i15ui1ul2f2ui64",ko);class Ds extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){const h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.float32[1*a+0]=h,a}}Ds.prototype.bytesPerElement=4,Yt("StructArrayLayout1f4",Ds);class jc extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,f){const y=this.length;return this.resize(y+1),this.emplace(y,a,h,f)}emplace(a,h,f,y){const w=3*a;return this.uint16[6*a+0]=h,this.float32[w+1]=f,this.float32[w+2]=y,a}}jc.prototype.bytesPerElement=12,Yt("StructArrayLayout1ui2f12",jc);class Fl extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,f){const y=this.length;return this.resize(y+1),this.emplace(y,a,h,f)}emplace(a,h,f,y){const w=4*a;return this.uint32[2*a+0]=h,this.uint16[w+2]=f,this.uint16[w+3]=y,a}}Fl.prototype.bytesPerElement=8,Yt("StructArrayLayout1ul2ui8",Fl);class js extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h){const f=this.length;return this.resize(f+1),this.emplace(f,a,h)}emplace(a,h,f){const y=2*a;return this.uint16[y+0]=h,this.uint16[y+1]=f,a}}js.prototype.bytesPerElement=4,Yt("StructArrayLayout2ui4",js);class Uc extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){const h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.uint16[1*a+0]=h,a}}Uc.prototype.bytesPerElement=2,Yt("StructArrayLayout1ui2",Uc);class Wc extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,f,y){const w=this.length;return this.resize(w+1),this.emplace(w,a,h,f,y)}emplace(a,h,f,y,w){const k=4*a;return this.float32[k+0]=h,this.float32[k+1]=f,this.float32[k+2]=y,this.float32[k+3]=w,a}}Wc.prototype.bytesPerElement=16,Yt("StructArrayLayout4f16",Wc);class qc extends xo{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new M(this.anchorPointX,this.anchorPointY)}}qc.prototype.size=20;class kh extends us{get(a){return new qc(this,a)}}Yt("CollisionBoxArray",kh);class b extends xo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(a){this._structArray.uint8[this._pos1+37]=a}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(a){this._structArray.uint8[this._pos1+38]=a}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(a){this._structArray.uint32[this._pos4+10]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}b.prototype.size=48;class r extends Hc{get(a){return new b(this,a)}}Yt("PlacedSymbolArray",r);class d extends xo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(a){this._structArray.uint32[this._pos4+12]=a}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}d.prototype.size=64;class m extends ko{get(a){return new d(this,a)}}Yt("SymbolInstanceArray",m);class g extends Ds{getoffsetX(a){return this.float32[1*a+0]}}Yt("GlyphOffsetArray",g);class x extends El{getx(a){return this.int16[3*a+0]}gety(a){return this.int16[3*a+1]}gettileUnitDistanceFromAnchor(a){return this.int16[3*a+2]}}Yt("SymbolLineVertexArray",x);class T extends xo{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}T.prototype.size=12;class C extends jc{get(a){return new T(this,a)}}Yt("TextAnchorOffsetArray",C);class A extends xo{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}A.prototype.size=8;class F extends Fl{get(a){return new A(this,a)}}Yt("FeatureIndexArray",F);class j extends Jo{}class Z extends Jo{}class ie extends Jo{}class pe extends Fc{}class fe extends Oc{}class ge extends Xo{}class le extends Bc{}class Le extends Ll{}class We extends Nc{}class ye extends Vc{}class Ne extends zl{}class qe extends Rl{}class Ze extends wo{}class Je extends js{}const pt=ha([{name:"a_pos",components:2,type:"Int16"}],4),{members:ut}=pt;class dt{constructor(a=[]){this.segments=a}prepareSegment(a,h,f,y){let w=this.segments[this.segments.length-1];return a>dt.MAX_VERTEX_ARRAY_LENGTH&&Xe(`Max vertices per segment is ${dt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}`),(!w||w.vertexLength+a>dt.MAX_VERTEX_ARRAY_LENGTH||w.sortKey!==y)&&(w={vertexOffset:h.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0},y!==void 0&&(w.sortKey=y),this.segments.push(w)),w}get(){return this.segments}destroy(){for(const a of this.segments)for(const h in a.vaos)a.vaos[h].destroy()}static simpleSegment(a,h,f,y){return new dt([{vertexOffset:a,primitiveOffset:h,vertexLength:f,primitiveLength:y,vaos:{},sortKey:0}])}}function Gt(l,a){return 256*(l=De(Math.floor(l),0,255))+De(Math.floor(a),0,255)}dt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Yt("SegmentVector",dt);const Ri=ha([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Pt={exports:{}},wi={exports:{}};wi.exports=function(l,a){var h,f,y,w,k,D,P,E;for(f=l.length-(h=3&l.length),y=a,k=3432918353,D=461845907,E=0;E<f;)P=255&l.charCodeAt(E)|(255&l.charCodeAt(++E))<<8|(255&l.charCodeAt(++E))<<16|(255&l.charCodeAt(++E))<<24,++E,y=27492+(65535&(w=5*(65535&(y=(y^=P=(65535&(P=(P=(65535&P)*k+(((P>>>16)*k&65535)<<16)&4294967295)<<15|P>>>17))*D+(((P>>>16)*D&65535)<<16)&4294967295)<<13|y>>>19))+((5*(y>>>16)&65535)<<16)&4294967295))+((58964+(w>>>16)&65535)<<16);switch(P=0,h){case 3:P^=(255&l.charCodeAt(E+2))<<16;case 2:P^=(255&l.charCodeAt(E+1))<<8;case 1:y^=P=(65535&(P=(P=(65535&(P^=255&l.charCodeAt(E)))*k+(((P>>>16)*k&65535)<<16)&4294967295)<<15|P>>>17))*D+(((P>>>16)*D&65535)<<16)&4294967295}return y^=l.length,y=2246822507*(65535&(y^=y>>>16))+((2246822507*(y>>>16)&65535)<<16)&4294967295,y=3266489909*(65535&(y^=y>>>13))+((3266489909*(y>>>16)&65535)<<16)&4294967295,(y^=y>>>16)>>>0};var Bi=wi.exports,an={exports:{}};an.exports=function(l,a){for(var h,f=l.length,y=a^f,w=0;f>=4;)h=1540483477*(65535&(h=255&l.charCodeAt(w)|(255&l.charCodeAt(++w))<<8|(255&l.charCodeAt(++w))<<16|(255&l.charCodeAt(++w))<<24))+((1540483477*(h>>>16)&65535)<<16),y=1540483477*(65535&y)+((1540483477*(y>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),f-=4,++w;switch(f){case 3:y^=(255&l.charCodeAt(w+2))<<16;case 2:y^=(255&l.charCodeAt(w+1))<<8;case 1:y=1540483477*(65535&(y^=255&l.charCodeAt(w)))+((1540483477*(y>>>16)&65535)<<16)}return y=1540483477*(65535&(y^=y>>>13))+((1540483477*(y>>>16)&65535)<<16),(y^=y>>>15)>>>0};var Di=Bi,Vi=an.exports;Pt.exports=Di,Pt.exports.murmur3=Di,Pt.exports.murmur2=Vi;var Hi=p(Pt.exports);class Yn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(a,h,f,y){this.ids.push(Pn(a)),this.positions.push(h,f,y)}getPositions(a){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const h=Pn(a);let f=0,y=this.ids.length-1;for(;f<y;){const k=f+y>>1;this.ids[k]>=h?y=k:f=k+1}const w=[];for(;this.ids[f]===h;)w.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return w}static serialize(a,h){const f=new Float64Array(a.ids),y=new Uint32Array(a.positions);return lr(f,y,0,f.length-1),h&&h.push(f.buffer,y.buffer),{ids:f,positions:y}}static deserialize(a){const h=new Yn;return h.ids=a.ids,h.positions=a.positions,h.indexed=!0,h}}function Pn(l){const a=+l;return!isNaN(a)&&a<=Number.MAX_SAFE_INTEGER?a:Hi(String(l))}function lr(l,a,h,f){for(;h<f;){const y=l[h+f>>1];let w=h-1,k=f+1;for(;;){do w++;while(l[w]<y);do k--;while(l[k]>y);if(w>=k)break;ga(l,w,k),ga(a,3*w,3*k),ga(a,3*w+1,3*k+1),ga(a,3*w+2,3*k+2)}k-h<f-k?(lr(l,a,h,k),h=k+1):(lr(l,a,k+1,f),f=k)}}function ga(l,a,h){const f=l[a];l[a]=l[h],l[h]=f}Yt("FeaturePositionMap",Yn);class Ln{constructor(a,h){this.gl=a.gl,this.location=h}}class Za extends Ln{constructor(a,h){super(a,h),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class Br extends Ln{constructor(a,h){super(a,h),this.current=[0,0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3]))}}class es extends Ln{constructor(a,h){super(a,h),this.current=Fi.transparent}set(a){a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a))}}const Us=new Float32Array(16);function Ws(l){return[Gt(255*l.r,255*l.g),Gt(255*l.b,255*l.a)]}class ts{constructor(a,h,f){this.value=a,this.uniformNames=h.map(y=>`u_${y}`),this.type=f}setUniform(a,h,f){a.set(f.constantOr(this.value))}getBinding(a,h,f){return this.type==="color"?new es(a,h):new Za(a,h)}}class Nr{constructor(a,h){this.uniformNames=h.map(f=>`u_${f}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(a,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=a.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=a.tlbr}setUniform(a,h,f,y){const w=y==="u_pattern_to"?this.patternTo:y==="u_pattern_from"?this.patternFrom:y==="u_pixel_ratio_to"?this.pixelRatioTo:y==="u_pixel_ratio_from"?this.pixelRatioFrom:null;w&&a.set(w)}getBinding(a,h,f){return f.substr(0,9)==="u_pattern"?new Br(a,h):new Za(a,h)}}class ea{constructor(a,h,f,y){this.expression=a,this.type=f,this.maxValue=0,this.paintVertexAttributes=h.map(w=>({name:`a_${w}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new y}populatePaintArray(a,h,f,y,w){const k=this.paintVertexArray.length,D=this.expression.evaluate(new Fn(0),h,{},y,[],w);this.paintVertexArray.resize(a),this._setPaintValue(k,a,D)}updatePaintArray(a,h,f,y){const w=this.expression.evaluate({zoom:0},f,y);this._setPaintValue(a,h,w)}_setPaintValue(a,h,f){if(this.type==="color"){const y=Ws(f);for(let w=a;w<h;w++)this.paintVertexArray.emplace(w,y[0],y[1])}else{for(let y=a;y<h;y++)this.paintVertexArray.emplace(y,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class On{constructor(a,h,f,y,w,k){this.expression=a,this.uniformNames=h.map(D=>`u_${D}_t`),this.type=f,this.useIntegerZoom=y,this.zoom=w,this.maxValue=0,this.paintVertexAttributes=h.map(D=>({name:`a_${D}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new k}populatePaintArray(a,h,f,y,w){const k=this.expression.evaluate(new Fn(this.zoom),h,{},y,[],w),D=this.expression.evaluate(new Fn(this.zoom+1),h,{},y,[],w),P=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(P,a,k,D)}updatePaintArray(a,h,f,y){const w=this.expression.evaluate({zoom:this.zoom},f,y),k=this.expression.evaluate({zoom:this.zoom+1},f,y);this._setPaintValue(a,h,w,k)}_setPaintValue(a,h,f,y){if(this.type==="color"){const w=Ws(f),k=Ws(y);for(let D=a;D<h;D++)this.paintVertexArray.emplace(D,w[0],w[1],k[0],k[1])}else{for(let w=a;w<h;w++)this.paintVertexArray.emplace(w,f,y);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(y))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,h){const f=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,y=De(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);a.set(y)}getBinding(a,h,f){return new Za(a,h)}}class ra{constructor(a,h,f,y,w,k){this.expression=a,this.type=h,this.useIntegerZoom=f,this.zoom=y,this.layerId=k,this.zoomInPaintVertexArray=new w,this.zoomOutPaintVertexArray=new w}populatePaintArray(a,h,f){const y=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(a),this.zoomOutPaintVertexArray.resize(a),this._setPaintValues(y,a,h.patterns&&h.patterns[this.layerId],f)}updatePaintArray(a,h,f,y,w){this._setPaintValues(a,h,f.patterns&&f.patterns[this.layerId],w)}_setPaintValues(a,h,f,y){if(!y||!f)return;const{min:w,mid:k,max:D}=f,P=y[w],E=y[k],B=y[D];if(P&&E&&B)for(let H=a;H<h;H++)this.zoomInPaintVertexArray.emplace(H,E.tl[0],E.tl[1],E.br[0],E.br[1],P.tl[0],P.tl[1],P.br[0],P.br[1],E.pixelRatio,P.pixelRatio),this.zoomOutPaintVertexArray.emplace(H,E.tl[0],E.tl[1],E.br[0],E.br[1],B.tl[0],B.tl[1],B.br[0],B.br[1],E.pixelRatio,B.pixelRatio)}upload(a){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,Ri.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=a.createVertexBuffer(this.zoomOutPaintVertexArray,Ri.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class So{constructor(a,h,f){this.binders={},this._buffers=[];const y=[];for(const w in a.paint._values){if(!f(w))continue;const k=a.paint.get(w);if(!(k instanceof Fr&&uo(k.property.specification)))continue;const D=La(w,a.type),P=k.value,E=k.property.specification.type,B=k.property.useIntegerZoom,H=k.property.specification["property-type"],K=H==="cross-faded"||H==="cross-faded-data-driven";if(P.kind==="constant")this.binders[w]=K?new Nr(P.value,D):new ts(P.value,D,E),y.push(`/u_${w}`);else if(P.kind==="source"||K){const ee=kr(w,E,"source");this.binders[w]=K?new ra(P,E,B,h,ee,a.id):new ea(P,D,E,ee),y.push(`/a_${w}`)}else{const ee=kr(w,E,"composite");this.binders[w]=new On(P,D,E,B,h,ee),y.push(`/z_${w}`)}}this.cacheKey=y.sort().join("")}getMaxValue(a){const h=this.binders[a];return h instanceof ea||h instanceof On?h.maxValue:0}populatePaintArrays(a,h,f,y,w){for(const k in this.binders){const D=this.binders[k];(D instanceof ea||D instanceof On||D instanceof ra)&&D.populatePaintArray(a,h,f,y,w)}}setConstantPatternPositions(a,h){for(const f in this.binders){const y=this.binders[f];y instanceof Nr&&y.setConstantPatternPositions(a,h)}}updatePaintArrays(a,h,f,y,w){let k=!1;for(const D in a){const P=h.getPositions(D);for(const E of P){const B=f.feature(E.index);for(const H in this.binders){const K=this.binders[H];if((K instanceof ea||K instanceof On||K instanceof ra)&&K.expression.isStateDependent===!0){const ee=y.paint.get(H);K.expression=ee.value,K.updatePaintArray(E.start,E.end,B,a[D],w),k=!0}}}}return k}defines(){const a=[];for(const h in this.binders){const f=this.binders[h];(f instanceof ts||f instanceof Nr)&&a.push(...f.uniformNames.map(y=>`#define HAS_UNIFORM_${y}`))}return a}getBinderAttributes(){const a=[];for(const h in this.binders){const f=this.binders[h];if(f instanceof ea||f instanceof On)for(let y=0;y<f.paintVertexAttributes.length;y++)a.push(f.paintVertexAttributes[y].name);else if(f instanceof ra)for(let y=0;y<Ri.members.length;y++)a.push(Ri.members[y].name)}return a}getBinderUniforms(){const a=[];for(const h in this.binders){const f=this.binders[h];if(f instanceof ts||f instanceof Nr||f instanceof On)for(const y of f.uniformNames)a.push(y)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a,h){const f=[];for(const y in this.binders){const w=this.binders[y];if(w instanceof ts||w instanceof Nr||w instanceof On){for(const k of w.uniformNames)if(h[k]){const D=w.getBinding(a,h[k],k);f.push({name:k,property:y,binding:D})}}}return f}setUniforms(a,h,f,y){for(const{name:w,property:k,binding:D}of h)this.binders[k].setUniform(D,y,f.get(k),w)}updatePaintBuffers(a){this._buffers=[];for(const h in this.binders){const f=this.binders[h];if(a&&f instanceof ra){const y=a.fromScale===2?f.zoomInPaintVertexBuffer:f.zoomOutPaintVertexBuffer;y&&this._buffers.push(y)}else(f instanceof ea||f instanceof On)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}}upload(a){for(const h in this.binders){const f=this.binders[h];(f instanceof ea||f instanceof On||f instanceof ra)&&f.upload(a)}this.updatePaintBuffers()}destroy(){for(const a in this.binders){const h=this.binders[a];(h instanceof ea||h instanceof On||h instanceof ra)&&h.destroy()}}}class qn{constructor(a,h,f=()=>!0){this.programConfigurations={};for(const y of a)this.programConfigurations[y.id]=new So(y,h,f);this.needsUpload=!1,this._featureMap=new Yn,this._bufferOffset=0}populatePaintArrays(a,h,f,y,w,k){for(const D in this.programConfigurations)this.programConfigurations[D].populatePaintArrays(a,h,y,w,k);h.id!==void 0&&this._featureMap.add(h.id,f,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,h,f,y){for(const w of f)this.needsUpload=this.programConfigurations[w.id].updatePaintArrays(a,this._featureMap,h,w,y)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(a);this.needsUpload=!1}}destroy(){for(const a in this.programConfigurations)this.programConfigurations[a].destroy()}}function La(l,a){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[l]||[l.replace(`${a}-`,"").replace(/-/g,"_")]}function kr(l,a,h){const f={color:{source:Xo,composite:Wc},number:{source:Ds,composite:Xo}},y=function(w){return{"line-pattern":{source:le,composite:le},"fill-pattern":{source:le,composite:le},"fill-extrusion-pattern":{source:le,composite:le}}[w]}(l);return y&&y[h]||f[a][h]}Yt("ConstantBinder",ts),Yt("CrossFadedConstantBinder",Nr),Yt("SourceExpressionBinder",ea),Yt("CrossFadedCompositeBinder",ra),Yt("CompositeExpressionBinder",On),Yt("ProgramConfiguration",So,{omit:["_buffers"]}),Yt("ProgramConfigurationSet",qn);const Xi=8192,Zc=Math.pow(2,14)-1,Sh=-Zc-1;function qs(l){const a=Xi/l.extent,h=l.loadGeometry();for(let f=0;f<h.length;f++){const y=h[f];for(let w=0;w<y.length;w++){const k=y[w],D=Math.round(k.x*a),P=Math.round(k.y*a);k.x=De(D,Sh,Zc),k.y=De(P,Sh,Zc),(D<k.x||D>k.x+1||P<k.y||P>k.y+1)&&Xe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function Zs(l,a){return{type:l.type,id:l.id,properties:l.properties,geometry:a?qs(l):[]}}function Ol(l,a,h,f,y){l.emplaceBack(2*a+(f+1)/2,2*h+(y+1)/2)}class Gc{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new Z,this.indexArray=new Ze,this.segments=new dt,this.programConfigurations=new qn(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,f){const y=this.layers[0],w=[];let k=null,D=!1;y.type==="circle"&&(k=y.layout.get("circle-sort-key"),D=!k.isConstant());for(const{feature:P,id:E,index:B,sourceLayerIndex:H}of a){const K=this.layers[0]._featureFilter.needGeometry,ee=Zs(P,K);if(!this.layers[0]._featureFilter.filter(new Fn(this.zoom),ee,f))continue;const ne=D?k.evaluate(ee,{},f):void 0,ue={id:E,properties:P.properties,type:P.type,sourceLayerIndex:H,index:B,geometry:K?ee.geometry:qs(P),patterns:{},sortKey:ne};w.push(ue)}D&&w.sort((P,E)=>P.sortKey-E.sortKey);for(const P of w){const{geometry:E,index:B,sourceLayerIndex:H}=P,K=a[B].feature;this.addFeature(P,E,B,f),h.featureIndex.insert(K,E,B,H,this.index)}}update(a,h,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,ut),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,h,f,y){for(const w of h)for(const k of w){const D=k.x,P=k.y;if(D<0||D>=Xi||P<0||P>=Xi)continue;const E=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),B=E.vertexLength;Ol(this.layoutVertexArray,D,P,-1,-1),Ol(this.layoutVertexArray,D,P,1,-1),Ol(this.layoutVertexArray,D,P,1,1),Ol(this.layoutVertexArray,D,P,-1,1),this.indexArray.emplaceBack(B,B+1,B+2),this.indexArray.emplaceBack(B,B+3,B+2),E.vertexLength+=4,E.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,{},y)}}function Gs(l,a){for(let h=0;h<l.length;h++)if(Bl(a,l[h]))return!0;for(let h=0;h<a.length;h++)if(Bl(l,a[h]))return!0;return!!el(l,a)}function Mh(l,a,h){return!!Bl(l,a)||!!tl(a,l,h)}function $c(l,a){if(l.length===1)return Zm(a,l[0]);for(let h=0;h<a.length;h++){const f=a[h];for(let y=0;y<f.length;y++)if(Bl(l,f[y]))return!0}for(let h=0;h<l.length;h++)if(Zm(a,l[h]))return!0;for(let h=0;h<a.length;h++)if(el(l,a[h]))return!0;return!1}function Dh(l,a,h){if(l.length>1){if(el(l,a))return!0;for(let f=0;f<a.length;f++)if(tl(a[f],l,h))return!0}for(let f=0;f<l.length;f++)if(tl(l[f],a,h))return!0;return!1}function el(l,a){if(l.length===0||a.length===0)return!1;for(let h=0;h<l.length-1;h++){const f=l[h],y=l[h+1];for(let w=0;w<a.length-1;w++)if(Th(f,y,a[w],a[w+1]))return!0}return!1}function Th(l,a,h,f){return si(l,h,f)!==si(a,h,f)&&si(l,a,h)!==si(l,a,f)}function tl(l,a,h){const f=h*h;if(a.length===1)return l.distSqr(a[0])<f;for(let y=1;y<a.length;y++)if(qm(l,a[y-1],a[y])<f)return!0;return!1}function qm(l,a,h){const f=a.distSqr(h);if(f===0)return l.distSqr(a);const y=((l.x-a.x)*(h.x-a.x)+(l.y-a.y)*(h.y-a.y))/f;return l.distSqr(y<0?a:y>1?h:h.sub(a)._mult(y)._add(a))}function Zm(l,a){let h,f,y,w=!1;for(let k=0;k<l.length;k++){h=l[k];for(let D=0,P=h.length-1;D<h.length;P=D++)f=h[D],y=h[P],f.y>a.y!=y.y>a.y&&a.x<(y.x-f.x)*(a.y-f.y)/(y.y-f.y)+f.x&&(w=!w)}return w}function Bl(l,a){let h=!1;for(let f=0,y=l.length-1;f<l.length;y=f++){const w=l[f],k=l[y];w.y>a.y!=k.y>a.y&&a.x<(k.x-w.x)*(a.y-w.y)/(k.y-w.y)+w.x&&(h=!h)}return h}function Cb(l,a,h){const f=h[0],y=h[2];if(l.x<f.x&&a.x<f.x||l.x>y.x&&a.x>y.x||l.y<f.y&&a.y<f.y||l.y>y.y&&a.y>y.y)return!1;const w=si(l,a,h[0]);return w!==si(l,a,h[1])||w!==si(l,a,h[2])||w!==si(l,a,h[3])}function Kc(l,a,h){const f=a.paint.get(l).value;return f.kind==="constant"?f.value:h.programConfigurations.get(a.id).getMaxValue(l)}function Ch(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function Ph(l,a,h,f,y){if(!a[0]&&!a[1])return l;const w=M.convert(a)._mult(y);h==="viewport"&&w._rotate(-f);const k=[];for(let D=0;D<l.length;D++)k.push(l[D].sub(w));return k}let Gm,$m;Yt("CircleBucket",Gc,{omit:["layers"]});var Pb={get paint(){return $m=$m||new or({"circle-radius":new yi(je.paint_circle["circle-radius"]),"circle-color":new yi(je.paint_circle["circle-color"]),"circle-blur":new yi(je.paint_circle["circle-blur"]),"circle-opacity":new yi(je.paint_circle["circle-opacity"]),"circle-translate":new ri(je.paint_circle["circle-translate"]),"circle-translate-anchor":new ri(je.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ri(je.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ri(je.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new yi(je.paint_circle["circle-stroke-width"]),"circle-stroke-color":new yi(je.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new yi(je.paint_circle["circle-stroke-opacity"])})},get layout(){return Gm=Gm||new or({"circle-sort-key":new yi(je.layout_circle["circle-sort-key"])})}},cr=1e-6,Nl=typeof Float32Array<"u"?Float32Array:Array;function _f(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function Km(l,a,h){var f=a[0],y=a[1],w=a[2],k=a[3],D=a[4],P=a[5],E=a[6],B=a[7],H=a[8],K=a[9],ee=a[10],ne=a[11],ue=a[12],me=a[13],ke=a[14],Ve=a[15],Ce=h[0],Be=h[1],it=h[2],ot=h[3];return l[0]=Ce*f+Be*D+it*H+ot*ue,l[1]=Ce*y+Be*P+it*K+ot*me,l[2]=Ce*w+Be*E+it*ee+ot*ke,l[3]=Ce*k+Be*B+it*ne+ot*Ve,l[4]=(Ce=h[4])*f+(Be=h[5])*D+(it=h[6])*H+(ot=h[7])*ue,l[5]=Ce*y+Be*P+it*K+ot*me,l[6]=Ce*w+Be*E+it*ee+ot*ke,l[7]=Ce*k+Be*B+it*ne+ot*Ve,l[8]=(Ce=h[8])*f+(Be=h[9])*D+(it=h[10])*H+(ot=h[11])*ue,l[9]=Ce*y+Be*P+it*K+ot*me,l[10]=Ce*w+Be*E+it*ee+ot*ke,l[11]=Ce*k+Be*B+it*ne+ot*Ve,l[12]=(Ce=h[12])*f+(Be=h[13])*D+(it=h[14])*H+(ot=h[15])*ue,l[13]=Ce*y+Be*P+it*K+ot*me,l[14]=Ce*w+Be*E+it*ee+ot*ke,l[15]=Ce*k+Be*B+it*ne+ot*Ve,l}Math.hypot||(Math.hypot=function(){for(var l=0,a=arguments.length;a--;)l+=arguments[a]*arguments[a];return Math.sqrt(l)});var Yc,Ab=Km;function Ah(l,a,h){var f=a[0],y=a[1],w=a[2],k=a[3];return l[0]=h[0]*f+h[4]*y+h[8]*w+h[12]*k,l[1]=h[1]*f+h[5]*y+h[9]*w+h[13]*k,l[2]=h[2]*f+h[6]*y+h[10]*w+h[14]*k,l[3]=h[3]*f+h[7]*y+h[11]*w+h[15]*k,l}Yc=new Nl(4),Nl!=Float32Array&&(Yc[0]=0,Yc[1]=0,Yc[2]=0,Yc[3]=0);class Ib extends Or{constructor(a){super(a,Pb)}createBucket(a){return new Gc(a)}queryRadius(a){const h=a;return Kc("circle-radius",this,h)+Kc("circle-stroke-width",this,h)+Ch(this.paint.get("circle-translate"))}queryIntersectsFeature(a,h,f,y,w,k,D,P){const E=Ph(a,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),k.angle,D),B=this.paint.get("circle-radius").evaluate(h,f)+this.paint.get("circle-stroke-width").evaluate(h,f),H=this.paint.get("circle-pitch-alignment")==="map",K=H?E:function(ne,ue){return ne.map(me=>Ym(me,ue))}(E,P),ee=H?B*D:B;for(const ne of y)for(const ue of ne){const me=H?ue:Ym(ue,P);let ke=ee;const Ve=Ah([],[ue.x,ue.y,0,1],P);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ke*=Ve[3]/k.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ke*=k.cameraToCenterDistance/Ve[3]),Mh(K,me,ke))return!0}return!1}}function Ym(l,a){const h=Ah([],[l.x,l.y,0,1],a);return new M(h[0]/h[3],h[1]/h[3])}class Jm extends Gc{}let Xm;Yt("HeatmapBucket",Jm,{omit:["layers"]});var Eb={get paint(){return Xm=Xm||new or({"heatmap-radius":new yi(je.paint_heatmap["heatmap-radius"]),"heatmap-weight":new yi(je.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ri(je.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Yo(je.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ri(je.paint_heatmap["heatmap-opacity"])})}};function yf(l,{width:a,height:h},f,y){if(y){if(y instanceof Uint8ClampedArray)y=new Uint8Array(y.buffer);else if(y.length!==a*h*f)throw new RangeError(`mismatched image size. expected: ${y.length} but got: ${a*h*f}`)}else y=new Uint8Array(a*h*f);return l.width=a,l.height=h,l.data=y,l}function Qm(l,{width:a,height:h},f){if(a===l.width&&h===l.height)return;const y=yf({},{width:a,height:h},f);bf(l,y,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,a),height:Math.min(l.height,h)},f),l.width=a,l.height=h,l.data=y.data}function bf(l,a,h,f,y,w){if(y.width===0||y.height===0)return a;if(y.width>l.width||y.height>l.height||h.x>l.width-y.width||h.y>l.height-y.height)throw new RangeError("out of range source coordinates for image copy");if(y.width>a.width||y.height>a.height||f.x>a.width-y.width||f.y>a.height-y.height)throw new RangeError("out of range destination coordinates for image copy");const k=l.data,D=a.data;if(k===D)throw new Error("srcData equals dstData, so image is already copied");for(let P=0;P<y.height;P++){const E=((h.y+P)*l.width+h.x)*w,B=((f.y+P)*a.width+f.x)*w;for(let H=0;H<y.width*w;H++)D[B+H]=k[E+H]}return a}class Jc{constructor(a,h){yf(this,a,1,h)}resize(a){Qm(this,a,1)}clone(){return new Jc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,h,f,y,w){bf(a,h,f,y,w,1)}}class Vr{constructor(a,h){yf(this,a,4,h)}resize(a){Qm(this,a,4)}replace(a,h){h?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new Vr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,h,f,y,w){bf(a,h,f,y,w,4)}}function e1(l){const a={},h=l.resolution||256,f=l.clips?l.clips.length:1,y=l.image||new Vr({width:h,height:f});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);const w=(k,D,P)=>{a[l.evaluationKey]=P;const E=l.expression.evaluate(a);y.data[k+D+0]=Math.floor(255*E.r/E.a),y.data[k+D+1]=Math.floor(255*E.g/E.a),y.data[k+D+2]=Math.floor(255*E.b/E.a),y.data[k+D+3]=Math.floor(255*E.a)};if(l.clips)for(let k=0,D=0;k<f;++k,D+=4*h)for(let P=0,E=0;P<h;P++,E+=4){const B=P/(h-1),{start:H,end:K}=l.clips[k];w(D,E,H*(1-B)+K*B)}else for(let k=0,D=0;k<h;k++,D+=4)w(0,D,k/(h-1));return y}Yt("AlphaImage",Jc),Yt("RGBAImage",Vr);class Lb extends Or{createBucket(a){return new Jm(a)}constructor(a){super(a,Eb),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=e1({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let t1;var zb={get paint(){return t1=t1||new or({"hillshade-illumination-direction":new ri(je.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ri(je.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ri(je.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ri(je.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ri(je.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ri(je.paint_hillshade["hillshade-accent-color"])})}};class Rb extends Or{constructor(a){super(a,zb)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const Fb=ha([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ob}=Fb;var vf={exports:{}};function Ih(l,a,h){h=h||2;var f,y,w,k,D,P,E,B=a&&a.length,H=B?a[0]*h:l.length,K=i1(l,0,H,h,!0),ee=[];if(!K||K.next===K.prev)return ee;if(B&&(K=function(ue,me,ke,Ve){var Ce,Be,it,ot=[];for(Ce=0,Be=me.length;Ce<Be;Ce++)(it=i1(ue,me[Ce]*Ve,Ce<Be-1?me[Ce+1]*Ve:ue.length,Ve,!1))===it.next&&(it.steiner=!0),ot.push(qb(it));for(ot.sort(jb),Ce=0;Ce<ot.length;Ce++)ke=Ub(ot[Ce],ke);return ke}(l,a,K,h)),l.length>80*h){f=w=l[0],y=k=l[1];for(var ne=h;ne<H;ne+=h)(D=l[ne])<f&&(f=D),(P=l[ne+1])<y&&(y=P),D>w&&(w=D),P>k&&(k=P);E=(E=Math.max(w-f,k-y))!==0?32767/E:0}return Xc(K,ee,h,f,y,E,0),ee}function i1(l,a,h,f,y){var w,k;if(y===kf(l,a,h,f)>0)for(w=a;w<h;w+=f)k=r1(w,l[w],l[w+1],k);else for(w=h-f;w>=a;w-=f)k=r1(w,l[w],l[w+1],k);return k&&Eh(k,k.next)&&(eu(k),k=k.next),k}function il(l,a){if(!l)return l;a||(a=l);var h,f=l;do if(h=!1,f.steiner||!Eh(f,f.next)&&da(f.prev,f,f.next)!==0)f=f.next;else{if(eu(f),(f=a=f.prev)===f.next)break;h=!0}while(h||f!==a);return a}function Xc(l,a,h,f,y,w,k){if(l){!k&&w&&function(B,H,K,ee){var ne=B;do ne.z===0&&(ne.z=xf(ne.x,ne.y,H,K,ee)),ne.prevZ=ne.prev,ne.nextZ=ne.next,ne=ne.next;while(ne!==B);ne.prevZ.nextZ=null,ne.prevZ=null,function(ue){var me,ke,Ve,Ce,Be,it,ot,Ht,ti=1;do{for(ke=ue,ue=null,Be=null,it=0;ke;){for(it++,Ve=ke,ot=0,me=0;me<ti&&(ot++,Ve=Ve.nextZ);me++);for(Ht=ti;ot>0||Ht>0&&Ve;)ot!==0&&(Ht===0||!Ve||ke.z<=Ve.z)?(Ce=ke,ke=ke.nextZ,ot--):(Ce=Ve,Ve=Ve.nextZ,Ht--),Be?Be.nextZ=Ce:ue=Ce,Ce.prevZ=Be,Be=Ce;ke=Ve}Be.nextZ=null,ti*=2}while(it>1)}(ne)}(l,f,y,w);for(var D,P,E=l;l.prev!==l.next;)if(D=l.prev,P=l.next,w?Nb(l,f,y,w):Bb(l))a.push(D.i/h|0),a.push(l.i/h|0),a.push(P.i/h|0),eu(l),l=P.next,E=P.next;else if((l=P)===E){k?k===1?Xc(l=Vb(il(l),a,h),a,h,f,y,w,2):k===2&&Hb(l,a,h,f,y,w):Xc(il(l),a,h,f,y,w,1);break}}}function Bb(l){var a=l.prev,h=l,f=l.next;if(da(a,h,f)>=0)return!1;for(var y=a.x,w=h.x,k=f.x,D=a.y,P=h.y,E=f.y,B=y<w?y<k?y:k:w<k?w:k,H=D<P?D<E?D:E:P<E?P:E,K=y>w?y>k?y:k:w>k?w:k,ee=D>P?D>E?D:E:P>E?P:E,ne=f.next;ne!==a;){if(ne.x>=B&&ne.x<=K&&ne.y>=H&&ne.y<=ee&&Vl(y,D,w,P,k,E,ne.x,ne.y)&&da(ne.prev,ne,ne.next)>=0)return!1;ne=ne.next}return!0}function Nb(l,a,h,f){var y=l.prev,w=l,k=l.next;if(da(y,w,k)>=0)return!1;for(var D=y.x,P=w.x,E=k.x,B=y.y,H=w.y,K=k.y,ee=D<P?D<E?D:E:P<E?P:E,ne=B<H?B<K?B:K:H<K?H:K,ue=D>P?D>E?D:E:P>E?P:E,me=B>H?B>K?B:K:H>K?H:K,ke=xf(ee,ne,a,h,f),Ve=xf(ue,me,a,h,f),Ce=l.prevZ,Be=l.nextZ;Ce&&Ce.z>=ke&&Be&&Be.z<=Ve;){if(Ce.x>=ee&&Ce.x<=ue&&Ce.y>=ne&&Ce.y<=me&&Ce!==y&&Ce!==k&&Vl(D,B,P,H,E,K,Ce.x,Ce.y)&&da(Ce.prev,Ce,Ce.next)>=0||(Ce=Ce.prevZ,Be.x>=ee&&Be.x<=ue&&Be.y>=ne&&Be.y<=me&&Be!==y&&Be!==k&&Vl(D,B,P,H,E,K,Be.x,Be.y)&&da(Be.prev,Be,Be.next)>=0))return!1;Be=Be.nextZ}for(;Ce&&Ce.z>=ke;){if(Ce.x>=ee&&Ce.x<=ue&&Ce.y>=ne&&Ce.y<=me&&Ce!==y&&Ce!==k&&Vl(D,B,P,H,E,K,Ce.x,Ce.y)&&da(Ce.prev,Ce,Ce.next)>=0)return!1;Ce=Ce.prevZ}for(;Be&&Be.z<=Ve;){if(Be.x>=ee&&Be.x<=ue&&Be.y>=ne&&Be.y<=me&&Be!==y&&Be!==k&&Vl(D,B,P,H,E,K,Be.x,Be.y)&&da(Be.prev,Be,Be.next)>=0)return!1;Be=Be.nextZ}return!0}function Vb(l,a,h){var f=l;do{var y=f.prev,w=f.next.next;!Eh(y,w)&&n1(y,f,f.next,w)&&Qc(y,w)&&Qc(w,y)&&(a.push(y.i/h|0),a.push(f.i/h|0),a.push(w.i/h|0),eu(f),eu(f.next),f=l=w),f=f.next}while(f!==l);return il(f)}function Hb(l,a,h,f,y,w){var k=l;do{for(var D=k.next.next;D!==k.prev;){if(k.i!==D.i&&Zb(k,D)){var P=a1(k,D);return k=il(k,k.next),P=il(P,P.next),Xc(k,a,h,f,y,w,0),void Xc(P,a,h,f,y,w,0)}D=D.next}k=k.next}while(k!==l)}function jb(l,a){return l.x-a.x}function Ub(l,a){var h=function(y,w){var k,D=w,P=y.x,E=y.y,B=-1/0;do{if(E<=D.y&&E>=D.next.y&&D.next.y!==D.y){var H=D.x+(E-D.y)*(D.next.x-D.x)/(D.next.y-D.y);if(H<=P&&H>B&&(B=H,k=D.x<D.next.x?D:D.next,H===P))return k}D=D.next}while(D!==w);if(!k)return null;var K,ee=k,ne=k.x,ue=k.y,me=1/0;D=k;do P>=D.x&&D.x>=ne&&P!==D.x&&Vl(E<ue?P:B,E,ne,ue,E<ue?B:P,E,D.x,D.y)&&(K=Math.abs(E-D.y)/(P-D.x),Qc(D,y)&&(K<me||K===me&&(D.x>k.x||D.x===k.x&&Wb(k,D)))&&(k=D,me=K)),D=D.next;while(D!==ee);return k}(l,a);if(!h)return a;var f=a1(h,l);return il(f,f.next),il(h,h.next)}function Wb(l,a){return da(l.prev,l,a.prev)<0&&da(a.next,l,l.next)<0}function xf(l,a,h,f,y){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-h)*y|0)|l<<8))|l<<4))|l<<2))|l<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-f)*y|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function qb(l){var a=l,h=l;do(a.x<h.x||a.x===h.x&&a.y<h.y)&&(h=a),a=a.next;while(a!==l);return h}function Vl(l,a,h,f,y,w,k,D){return(y-k)*(a-D)>=(l-k)*(w-D)&&(l-k)*(f-D)>=(h-k)*(a-D)&&(h-k)*(w-D)>=(y-k)*(f-D)}function Zb(l,a){return l.next.i!==a.i&&l.prev.i!==a.i&&!function(h,f){var y=h;do{if(y.i!==h.i&&y.next.i!==h.i&&y.i!==f.i&&y.next.i!==f.i&&n1(y,y.next,h,f))return!0;y=y.next}while(y!==h);return!1}(l,a)&&(Qc(l,a)&&Qc(a,l)&&function(h,f){var y=h,w=!1,k=(h.x+f.x)/2,D=(h.y+f.y)/2;do y.y>D!=y.next.y>D&&y.next.y!==y.y&&k<(y.next.x-y.x)*(D-y.y)/(y.next.y-y.y)+y.x&&(w=!w),y=y.next;while(y!==h);return w}(l,a)&&(da(l.prev,l,a.prev)||da(l,a.prev,a))||Eh(l,a)&&da(l.prev,l,l.next)>0&&da(a.prev,a,a.next)>0)}function da(l,a,h){return(a.y-l.y)*(h.x-a.x)-(a.x-l.x)*(h.y-a.y)}function Eh(l,a){return l.x===a.x&&l.y===a.y}function n1(l,a,h,f){var y=zh(da(l,a,h)),w=zh(da(l,a,f)),k=zh(da(h,f,l)),D=zh(da(h,f,a));return y!==w&&k!==D||!(y!==0||!Lh(l,h,a))||!(w!==0||!Lh(l,f,a))||!(k!==0||!Lh(h,l,f))||!(D!==0||!Lh(h,a,f))}function Lh(l,a,h){return a.x<=Math.max(l.x,h.x)&&a.x>=Math.min(l.x,h.x)&&a.y<=Math.max(l.y,h.y)&&a.y>=Math.min(l.y,h.y)}function zh(l){return l>0?1:l<0?-1:0}function Qc(l,a){return da(l.prev,l,l.next)<0?da(l,a,l.next)>=0&&da(l,l.prev,a)>=0:da(l,a,l.prev)<0||da(l,l.next,a)<0}function a1(l,a){var h=new wf(l.i,l.x,l.y),f=new wf(a.i,a.x,a.y),y=l.next,w=a.prev;return l.next=a,a.prev=l,h.next=y,y.prev=h,f.next=h,h.prev=f,w.next=f,f.prev=w,f}function r1(l,a,h,f){var y=new wf(l,a,h);return f?(y.next=f.next,y.prev=f,f.next.prev=y,f.next=y):(y.prev=y,y.next=y),y}function eu(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function wf(l,a,h){this.i=l,this.x=a,this.y=h,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function kf(l,a,h,f){for(var y=0,w=a,k=h-f;w<h;w+=f)y+=(l[k]-l[w])*(l[w+1]+l[k+1]),k=w;return y}vf.exports=Ih,vf.exports.default=Ih,Ih.deviation=function(l,a,h,f){var y=a&&a.length,w=Math.abs(kf(l,0,y?a[0]*h:l.length,h));if(y)for(var k=0,D=a.length;k<D;k++)w-=Math.abs(kf(l,a[k]*h,k<D-1?a[k+1]*h:l.length,h));var P=0;for(k=0;k<f.length;k+=3){var E=f[k]*h,B=f[k+1]*h,H=f[k+2]*h;P+=Math.abs((l[E]-l[H])*(l[B+1]-l[E+1])-(l[E]-l[B])*(l[H+1]-l[E+1]))}return w===0&&P===0?0:Math.abs((P-w)/w)},Ih.flatten=function(l){for(var a=l[0][0].length,h={vertices:[],holes:[],dimensions:a},f=0,y=0;y<l.length;y++){for(var w=0;w<l[y].length;w++)for(var k=0;k<a;k++)h.vertices.push(l[y][w][k]);y>0&&h.holes.push(f+=l[y-1].length)}return h};var s1=p(vf.exports);function Gb(l,a,h,f,y){o1(l,a,h||0,f||l.length-1,y||$b)}function o1(l,a,h,f,y){for(;f>h;){if(f-h>600){var w=f-h+1,k=a-h+1,D=Math.log(w),P=.5*Math.exp(2*D/3),E=.5*Math.sqrt(D*P*(w-P)/w)*(k-w/2<0?-1:1);o1(l,a,Math.max(h,Math.floor(a-k*P/w+E)),Math.min(f,Math.floor(a+(w-k)*P/w+E)),y)}var B=l[a],H=h,K=f;for(tu(l,h,a),y(l[f],B)>0&&tu(l,h,f);H<K;){for(tu(l,H,K),H++,K--;y(l[H],B)<0;)H++;for(;y(l[K],B)>0;)K--}y(l[h],B)===0?tu(l,h,K):tu(l,++K,f),K<=a&&(h=K+1),a<=K&&(f=K-1)}}function tu(l,a,h){var f=l[a];l[a]=l[h],l[h]=f}function $b(l,a){return l<a?-1:l>a?1:0}function Sf(l,a){const h=l.length;if(h<=1)return[l];const f=[];let y,w;for(let k=0;k<h;k++){const D=Bt(l[k]);D!==0&&(l[k].area=Math.abs(D),w===void 0&&(w=D<0),w===D<0?(y&&f.push(y),y=[l[k]]):y.push(l[k]))}if(y&&f.push(y),a>1)for(let k=0;k<f.length;k++)f[k].length<=a||(Gb(f[k],a,1,f[k].length-1,Kb),f[k]=f[k].slice(0,a));return f}function Kb(l,a){return a.area-l.area}function Mf(l,a,h){const f=h.patternDependencies;let y=!1;for(const w of a){const k=w.paint.get(`${l}-pattern`);k.isConstant()||(y=!0);const D=k.constantOr(null);D&&(y=!0,f[D.to]=!0,f[D.from]=!0)}return y}function Df(l,a,h,f,y){const w=y.patternDependencies;for(const k of a){const D=k.paint.get(`${l}-pattern`).value;if(D.kind!=="constant"){let P=D.evaluate({zoom:f-1},h,{},y.availableImages),E=D.evaluate({zoom:f},h,{},y.availableImages),B=D.evaluate({zoom:f+1},h,{},y.availableImages);P=P&&P.name?P.name:P,E=E&&E.name?E.name:E,B=B&&B.name?B.name:B,w[P]=!0,w[E]=!0,w[B]=!0,h.patterns[k.id]={min:P,mid:E,max:B}}}return h}class Tf{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ie,this.indexArray=new Ze,this.indexArray2=new Je,this.programConfigurations=new qn(a.layers,a.zoom),this.segments=new dt,this.segments2=new dt,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,f){this.hasPattern=Mf("fill",this.layers,h);const y=this.layers[0].layout.get("fill-sort-key"),w=!y.isConstant(),k=[];for(const{feature:D,id:P,index:E,sourceLayerIndex:B}of a){const H=this.layers[0]._featureFilter.needGeometry,K=Zs(D,H);if(!this.layers[0]._featureFilter.filter(new Fn(this.zoom),K,f))continue;const ee=w?y.evaluate(K,{},f,h.availableImages):void 0,ne={id:P,properties:D.properties,type:D.type,sourceLayerIndex:B,index:E,geometry:H?K.geometry:qs(D),patterns:{},sortKey:ee};k.push(ne)}w&&k.sort((D,P)=>D.sortKey-P.sortKey);for(const D of k){const{geometry:P,index:E,sourceLayerIndex:B}=D;if(this.hasPattern){const H=Df("fill",this.layers,D,this.zoom,h);this.patternFeatures.push(H)}else this.addFeature(D,P,E,f,{});h.featureIndex.insert(a[E].feature,P,E,B,this.index)}}update(a,h,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,f)}addFeatures(a,h,f){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,h,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Ob),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(a,h,f,y,w){for(const k of Sf(h,500)){let D=0;for(const ee of k)D+=ee.length;const P=this.segments.prepareSegment(D,this.layoutVertexArray,this.indexArray),E=P.vertexLength,B=[],H=[];for(const ee of k){if(ee.length===0)continue;ee!==k[0]&&H.push(B.length/2);const ne=this.segments2.prepareSegment(ee.length,this.layoutVertexArray,this.indexArray2),ue=ne.vertexLength;this.layoutVertexArray.emplaceBack(ee[0].x,ee[0].y),this.indexArray2.emplaceBack(ue+ee.length-1,ue),B.push(ee[0].x),B.push(ee[0].y);for(let me=1;me<ee.length;me++)this.layoutVertexArray.emplaceBack(ee[me].x,ee[me].y),this.indexArray2.emplaceBack(ue+me-1,ue+me),B.push(ee[me].x),B.push(ee[me].y);ne.vertexLength+=ee.length,ne.primitiveLength+=ee.length}const K=s1(B,H);for(let ee=0;ee<K.length;ee+=3)this.indexArray.emplaceBack(E+K[ee],E+K[ee+1],E+K[ee+2]);P.vertexLength+=D,P.primitiveLength+=K.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,w,y)}}let l1,c1;Yt("FillBucket",Tf,{omit:["layers","patternFeatures"]});var Yb={get paint(){return c1=c1||new or({"fill-antialias":new ri(je.paint_fill["fill-antialias"]),"fill-opacity":new yi(je.paint_fill["fill-opacity"]),"fill-color":new yi(je.paint_fill["fill-color"]),"fill-outline-color":new yi(je.paint_fill["fill-outline-color"]),"fill-translate":new ri(je.paint_fill["fill-translate"]),"fill-translate-anchor":new ri(je.paint_fill["fill-translate-anchor"]),"fill-pattern":new Hs(je.paint_fill["fill-pattern"])})},get layout(){return l1=l1||new or({"fill-sort-key":new yi(je.layout_fill["fill-sort-key"])})}};class Jb extends Or{constructor(a){super(a,Yb)}recalculate(a,h){super.recalculate(a,h);const f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new Tf(a)}queryRadius(){return Ch(this.paint.get("fill-translate"))}queryIntersectsFeature(a,h,f,y,w,k,D){return $c(Ph(a,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),k.angle,D),y)}isTileClipped(){return!0}}const Xb=ha([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Qb=ha([{name:"a_centroid",components:2,type:"Int16"}],4),{members:ev}=Xb;var Mo={},tv=_,u1=Hl;function Hl(l,a,h,f,y){this.properties={},this.extent=h,this.type=0,this._pbf=l,this._geometry=-1,this._keys=f,this._values=y,l.readFields(iv,this,a)}function iv(l,a,h){l==1?a.id=h.readVarint():l==2?function(f,y){for(var w=f.readVarint()+f.pos;f.pos<w;){var k=y._keys[f.readVarint()],D=y._values[f.readVarint()];y.properties[k]=D}}(h,a):l==3?a.type=h.readVarint():l==4&&(a._geometry=h.pos)}function nv(l){for(var a,h,f=0,y=0,w=l.length,k=w-1;y<w;k=y++)f+=((h=l[k]).x-(a=l[y]).x)*(a.y+h.y);return f}Hl.types=["Unknown","Point","LineString","Polygon"],Hl.prototype.loadGeometry=function(){var l=this._pbf;l.pos=this._geometry;for(var a,h=l.readVarint()+l.pos,f=1,y=0,w=0,k=0,D=[];l.pos<h;){if(y<=0){var P=l.readVarint();f=7&P,y=P>>3}if(y--,f===1||f===2)w+=l.readSVarint(),k+=l.readSVarint(),f===1&&(a&&D.push(a),a=[]),a.push(new tv(w,k));else{if(f!==7)throw new Error("unknown command "+f);a&&a.push(a[0].clone())}}return a&&D.push(a),D},Hl.prototype.bbox=function(){var l=this._pbf;l.pos=this._geometry;for(var a=l.readVarint()+l.pos,h=1,f=0,y=0,w=0,k=1/0,D=-1/0,P=1/0,E=-1/0;l.pos<a;){if(f<=0){var B=l.readVarint();h=7&B,f=B>>3}if(f--,h===1||h===2)(y+=l.readSVarint())<k&&(k=y),y>D&&(D=y),(w+=l.readSVarint())<P&&(P=w),w>E&&(E=w);else if(h!==7)throw new Error("unknown command "+h)}return[k,P,D,E]},Hl.prototype.toGeoJSON=function(l,a,h){var f,y,w=this.extent*Math.pow(2,h),k=this.extent*l,D=this.extent*a,P=this.loadGeometry(),E=Hl.types[this.type];function B(ee){for(var ne=0;ne<ee.length;ne++){var ue=ee[ne];ee[ne]=[360*(ue.x+k)/w-180,360/Math.PI*Math.atan(Math.exp((180-360*(ue.y+D)/w)*Math.PI/180))-90]}}switch(this.type){case 1:var H=[];for(f=0;f<P.length;f++)H[f]=P[f][0];B(P=H);break;case 2:for(f=0;f<P.length;f++)B(P[f]);break;case 3:for(P=function(ee){var ne=ee.length;if(ne<=1)return[ee];for(var ue,me,ke=[],Ve=0;Ve<ne;Ve++){var Ce=nv(ee[Ve]);Ce!==0&&(me===void 0&&(me=Ce<0),me===Ce<0?(ue&&ke.push(ue),ue=[ee[Ve]]):ue.push(ee[Ve]))}return ue&&ke.push(ue),ke}(P),f=0;f<P.length;f++)for(y=0;y<P[f].length;y++)B(P[f][y])}P.length===1?P=P[0]:E="Multi"+E;var K={type:"Feature",geometry:{type:E,coordinates:P},properties:this.properties};return"id"in this&&(K.id=this.id),K};var av=u1,h1=d1;function d1(l,a){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(rv,this,a),this.length=this._features.length}function rv(l,a,h){l===15?a.version=h.readVarint():l===1?a.name=h.readString():l===5?a.extent=h.readVarint():l===2?a._features.push(h.pos):l===3?a._keys.push(h.readString()):l===4&&a._values.push(function(f){for(var y=null,w=f.readVarint()+f.pos;f.pos<w;){var k=f.readVarint()>>3;y=k===1?f.readString():k===2?f.readFloat():k===3?f.readDouble():k===4?f.readVarint64():k===5?f.readVarint():k===6?f.readSVarint():k===7?f.readBoolean():null}return y}(h))}d1.prototype.feature=function(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];var a=this._pbf.readVarint()+this._pbf.pos;return new av(this._pbf,a,this.extent,this._keys,this._values)};var sv=h1;function ov(l,a,h){if(l===3){var f=new sv(h,h.readVarint()+h.pos);f.length&&(a[f.name]=f)}}Mo.VectorTile=function(l,a){this.layers=l.readFields(ov,{},a)},Mo.VectorTileFeature=u1,Mo.VectorTileLayer=h1;const lv=Mo.VectorTileFeature.types,Cf=Math.pow(2,13);function iu(l,a,h,f,y,w,k,D){l.emplaceBack(a,h,2*Math.floor(f*Cf)+k,y*Cf*2,w*Cf*2,Math.round(D))}class Pf{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new pe,this.centroidVertexArray=new j,this.indexArray=new Ze,this.programConfigurations=new qn(a.layers,a.zoom),this.segments=new dt,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,f){this.features=[],this.hasPattern=Mf("fill-extrusion",this.layers,h);for(const{feature:y,id:w,index:k,sourceLayerIndex:D}of a){const P=this.layers[0]._featureFilter.needGeometry,E=Zs(y,P);if(!this.layers[0]._featureFilter.filter(new Fn(this.zoom),E,f))continue;const B={id:w,sourceLayerIndex:D,index:k,geometry:P?E.geometry:qs(y),properties:y.properties,type:y.type,patterns:{}};this.hasPattern?this.features.push(Df("fill-extrusion",this.layers,B,this.zoom,h)):this.addFeature(B,B.geometry,k,f,{}),h.featureIndex.insert(y,B.geometry,k,D,this.index,!0)}}addFeatures(a,h,f){for(const y of this.features){const{geometry:w}=y;this.addFeature(y,w,y.index,h,f)}}update(a,h,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,ev),this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,Qb.members,!0),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(a,h,f,y,w){const k={x:0,y:0,vertexCount:0};for(const D of Sf(h,500)){let P=0;for(const ne of D)P+=ne.length;let E=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const ne of D){if(ne.length===0||uv(ne))continue;let ue=0;for(let me=0;me<ne.length;me++){const ke=ne[me];if(me>=1){const Ve=ne[me-1];if(!cv(ke,Ve)){E.vertexLength+4>dt.MAX_VERTEX_ARRAY_LENGTH&&(E=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ce=ke.sub(Ve)._perp()._unit(),Be=Ve.dist(ke);ue+Be>32768&&(ue=0),iu(this.layoutVertexArray,ke.x,ke.y,Ce.x,Ce.y,0,0,ue),iu(this.layoutVertexArray,ke.x,ke.y,Ce.x,Ce.y,0,1,ue),k.x+=2*ke.x,k.y+=2*ke.y,k.vertexCount+=2,ue+=Be,iu(this.layoutVertexArray,Ve.x,Ve.y,Ce.x,Ce.y,0,0,ue),iu(this.layoutVertexArray,Ve.x,Ve.y,Ce.x,Ce.y,0,1,ue),k.x+=2*Ve.x,k.y+=2*Ve.y,k.vertexCount+=2;const it=E.vertexLength;this.indexArray.emplaceBack(it,it+2,it+1),this.indexArray.emplaceBack(it+1,it+2,it+3),E.vertexLength+=4,E.primitiveLength+=2}}}}if(E.vertexLength+P>dt.MAX_VERTEX_ARRAY_LENGTH&&(E=this.segments.prepareSegment(P,this.layoutVertexArray,this.indexArray)),lv[a.type]!=="Polygon")continue;const B=[],H=[],K=E.vertexLength;for(const ne of D)if(ne.length!==0){ne!==D[0]&&H.push(B.length/2);for(let ue=0;ue<ne.length;ue++){const me=ne[ue];iu(this.layoutVertexArray,me.x,me.y,0,0,1,1,0),k.x+=me.x,k.y+=me.y,k.vertexCount+=1,B.push(me.x),B.push(me.y)}}const ee=s1(B,H);for(let ne=0;ne<ee.length;ne+=3)this.indexArray.emplaceBack(K+ee[ne],K+ee[ne+2],K+ee[ne+1]);E.primitiveLength+=ee.length/3,E.vertexLength+=P}for(let D=0;D<k.vertexCount;D++)this.centroidVertexArray.emplaceBack(Math.floor(k.x/k.vertexCount),Math.floor(k.y/k.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,w,y)}}function cv(l,a){return l.x===a.x&&(l.x<0||l.x>Xi)||l.y===a.y&&(l.y<0||l.y>Xi)}function uv(l){return l.every(a=>a.x<0)||l.every(a=>a.x>Xi)||l.every(a=>a.y<0)||l.every(a=>a.y>Xi)}let f1;Yt("FillExtrusionBucket",Pf,{omit:["layers","features"]});var hv={get paint(){return f1=f1||new or({"fill-extrusion-opacity":new ri(je["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new yi(je["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ri(je["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ri(je["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Hs(je["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new yi(je["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new yi(je["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ri(je["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class dv extends Or{constructor(a){super(a,hv)}createBucket(a){return new Pf(a)}queryRadius(){return Ch(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(a,h,f,y,w,k,D,P){const E=Ph(a,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),k.angle,D),B=this.paint.get("fill-extrusion-height").evaluate(h,f),H=this.paint.get("fill-extrusion-base").evaluate(h,f),K=function(ne,ue,me,ke){const Ve=[];for(const Ce of ne){const Be=[Ce.x,Ce.y,0,1];Ah(Be,Be,ue),Ve.push(new M(Be[0]/Be[3],Be[1]/Be[3]))}return Ve}(E,P),ee=function(ne,ue,me,ke){const Ve=[],Ce=[],Be=ke[8]*ue,it=ke[9]*ue,ot=ke[10]*ue,Ht=ke[11]*ue,ti=ke[8]*me,Nt=ke[9]*me,Lt=ke[10]*me,kt=ke[11]*me;for(const Qt of ne){const At=[],yt=[];for(const hi of Qt){const ai=hi.x,qi=hi.y,Bn=ke[0]*ai+ke[4]*qi+ke[12],Zn=ke[1]*ai+ke[5]*qi+ke[13],Sa=ke[2]*ai+ke[6]*qi+ke[14],Ar=ke[3]*ai+ke[7]*qi+ke[15],ur=Sa+ot,_a=Ar+Ht,ja=Bn+ti,$a=Zn+Nt,hr=Sa+Lt,dr=Ar+kt,Ma=new M((Bn+Be)/_a,(Zn+it)/_a);Ma.z=ur/_a,At.push(Ma);const Da=new M(ja/dr,$a/dr);Da.z=hr/dr,yt.push(Da)}Ve.push(At),Ce.push(yt)}return[Ve,Ce]}(y,H,B,P);return function(ne,ue,me){let ke=1/0;$c(me,ue)&&(ke=p1(me,ue[0]));for(let Ve=0;Ve<ue.length;Ve++){const Ce=ue[Ve],Be=ne[Ve];for(let it=0;it<Ce.length-1;it++){const ot=Ce[it],Ht=[ot,Ce[it+1],Be[it+1],Be[it],ot];Gs(me,Ht)&&(ke=Math.min(ke,p1(me,Ht)))}}return ke!==1/0&&ke}(ee[0],ee[1],K)}}function nu(l,a){return l.x*a.x+l.y*a.y}function p1(l,a){if(l.length===1){let h=0;const f=a[h++];let y;for(;!y||f.equals(y);)if(y=a[h++],!y)return 1/0;for(;h<a.length;h++){const w=a[h],k=l[0],D=y.sub(f),P=w.sub(f),E=k.sub(f),B=nu(D,D),H=nu(D,P),K=nu(P,P),ee=nu(E,D),ne=nu(E,P),ue=B*K-H*H,me=(K*ee-H*ne)/ue,ke=(B*ne-H*ee)/ue,Ve=f.z*(1-me-ke)+y.z*me+w.z*ke;if(isFinite(Ve))return Ve}return 1/0}{let h=1/0;for(const f of a)h=Math.min(h,f.z);return h}}const fv=ha([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:pv}=fv,mv=ha([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:gv}=mv,_v=Mo.VectorTileFeature.types,yv=Math.cos(Math.PI/180*37.5),m1=Math.pow(2,14)/.5;class Af{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new fe,this.layoutVertexArray2=new ge,this.indexArray=new Ze,this.programConfigurations=new qn(a.layers,a.zoom),this.segments=new dt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,f){this.hasPattern=Mf("line",this.layers,h);const y=this.layers[0].layout.get("line-sort-key"),w=!y.isConstant(),k=[];for(const{feature:D,id:P,index:E,sourceLayerIndex:B}of a){const H=this.layers[0]._featureFilter.needGeometry,K=Zs(D,H);if(!this.layers[0]._featureFilter.filter(new Fn(this.zoom),K,f))continue;const ee=w?y.evaluate(K,{},f):void 0,ne={id:P,properties:D.properties,type:D.type,sourceLayerIndex:B,index:E,geometry:H?K.geometry:qs(D),patterns:{},sortKey:ee};k.push(ne)}w&&k.sort((D,P)=>D.sortKey-P.sortKey);for(const D of k){const{geometry:P,index:E,sourceLayerIndex:B}=D;if(this.hasPattern){const H=Df("line",this.layers,D,this.zoom,h);this.patternFeatures.push(H)}else this.addFeature(D,P,E,f,{});h.featureIndex.insert(a[E].feature,P,E,B,this.index)}}update(a,h,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,f)}addFeatures(a,h,f){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,h,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,gv)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,pv),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,h,f,y,w){const k=this.layers[0].layout,D=k.get("line-join").evaluate(a,{}),P=k.get("line-cap"),E=k.get("line-miter-limit"),B=k.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(const H of h)this.addLine(H,a,D,P,E,B);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,w,y)}addLine(a,h,f,y,w,k){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ke=0;ke<a.length-1;ke++)this.totalDistance+=a[ke].dist(a[ke+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const D=_v[h.type]==="Polygon";let P=a.length;for(;P>=2&&a[P-1].equals(a[P-2]);)P--;let E=0;for(;E<P-1&&a[E].equals(a[E+1]);)E++;if(P<(D?3:2))return;f==="bevel"&&(w=1.05);const B=this.overscaling<=16?15*Xi/(512*this.overscaling):0,H=this.segments.prepareSegment(10*P,this.layoutVertexArray,this.indexArray);let K,ee,ne,ue,me;this.e1=this.e2=-1,D&&(K=a[P-2],me=a[E].sub(K)._unit()._perp());for(let ke=E;ke<P;ke++){if(ne=ke===P-1?D?a[E+1]:void 0:a[ke+1],ne&&a[ke].equals(ne))continue;me&&(ue=me),K&&(ee=K),K=a[ke],me=ne?ne.sub(K)._unit()._perp():ue,ue=ue||me;let Ve=ue.add(me);Ve.x===0&&Ve.y===0||Ve._unit();const Ce=ue.x*me.x+ue.y*me.y,Be=Ve.x*me.x+Ve.y*me.y,it=Be!==0?1/Be:1/0,ot=2*Math.sqrt(2-2*Be),Ht=Be<yv&&ee&&ne,ti=ue.x*me.y-ue.y*me.x>0;if(Ht&&ke>E){const kt=K.dist(ee);if(kt>2*B){const Qt=K.sub(K.sub(ee)._mult(B/kt)._round());this.updateDistance(ee,Qt),this.addCurrentVertex(Qt,ue,0,0,H),ee=Qt}}const Nt=ee&&ne;let Lt=Nt?f:D?"butt":y;if(Nt&&Lt==="round"&&(it<k?Lt="miter":it<=2&&(Lt="fakeround")),Lt==="miter"&&it>w&&(Lt="bevel"),Lt==="bevel"&&(it>2&&(Lt="flipbevel"),it<w&&(Lt="miter")),ee&&this.updateDistance(ee,K),Lt==="miter")Ve._mult(it),this.addCurrentVertex(K,Ve,0,0,H);else if(Lt==="flipbevel"){if(it>100)Ve=me.mult(-1);else{const kt=it*ue.add(me).mag()/ue.sub(me).mag();Ve._perp()._mult(kt*(ti?-1:1))}this.addCurrentVertex(K,Ve,0,0,H),this.addCurrentVertex(K,Ve.mult(-1),0,0,H)}else if(Lt==="bevel"||Lt==="fakeround"){const kt=-Math.sqrt(it*it-1),Qt=ti?kt:0,At=ti?0:kt;if(ee&&this.addCurrentVertex(K,ue,Qt,At,H),Lt==="fakeround"){const yt=Math.round(180*ot/Math.PI/20);for(let hi=1;hi<yt;hi++){let ai=hi/yt;if(ai!==.5){const Bn=ai-.5;ai+=ai*Bn*(ai-1)*((1.0904+Ce*(Ce*(3.55645-1.43519*Ce)-3.2452))*Bn*Bn+(.848013+Ce*(.215638*Ce-1.06021)))}const qi=me.sub(ue)._mult(ai)._add(ue)._unit()._mult(ti?-1:1);this.addHalfVertex(K,qi.x,qi.y,!1,ti,0,H)}}ne&&this.addCurrentVertex(K,me,-Qt,-At,H)}else if(Lt==="butt")this.addCurrentVertex(K,Ve,0,0,H);else if(Lt==="square"){const kt=ee?1:-1;this.addCurrentVertex(K,Ve,kt,kt,H)}else Lt==="round"&&(ee&&(this.addCurrentVertex(K,ue,0,0,H),this.addCurrentVertex(K,ue,1,1,H,!0)),ne&&(this.addCurrentVertex(K,me,-1,-1,H,!0),this.addCurrentVertex(K,me,0,0,H)));if(Ht&&ke<P-1){const kt=K.dist(ne);if(kt>2*B){const Qt=K.add(ne.sub(K)._mult(B/kt)._round());this.updateDistance(K,Qt),this.addCurrentVertex(Qt,me,0,0,H),K=Qt}}}}addCurrentVertex(a,h,f,y,w,k=!1){const D=h.y*y-h.x,P=-h.y-h.x*y;this.addHalfVertex(a,h.x+h.y*f,h.y-h.x*f,k,!1,f,w),this.addHalfVertex(a,D,P,k,!0,-y,w),this.distance>m1/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(a,h,f,y,w,k))}addHalfVertex({x:a,y:h},f,y,w,k,D,P){const E=.5*(this.lineClips?this.scaledDistance*(m1-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((a<<1)+(w?1:0),(h<<1)+(k?1:0),Math.round(63*f)+128,Math.round(63*y)+128,1+(D===0?0:D<0?-1:1)|(63&E)<<2,E>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const B=P.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,B),P.primitiveLength++),k?this.e2=B:this.e1=B}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(a,h){this.distance+=a.dist(h),this.updateScaledDistance()}}let g1,_1;Yt("LineBucket",Af,{omit:["layers","patternFeatures"]});var y1={get paint(){return _1=_1||new or({"line-opacity":new yi(je.paint_line["line-opacity"]),"line-color":new yi(je.paint_line["line-color"]),"line-translate":new ri(je.paint_line["line-translate"]),"line-translate-anchor":new ri(je.paint_line["line-translate-anchor"]),"line-width":new yi(je.paint_line["line-width"]),"line-gap-width":new yi(je.paint_line["line-gap-width"]),"line-offset":new yi(je.paint_line["line-offset"]),"line-blur":new yi(je.paint_line["line-blur"]),"line-dasharray":new Rc(je.paint_line["line-dasharray"]),"line-pattern":new Hs(je.paint_line["line-pattern"]),"line-gradient":new Yo(je.paint_line["line-gradient"])})},get layout(){return g1=g1||new or({"line-cap":new ri(je.layout_line["line-cap"]),"line-join":new yi(je.layout_line["line-join"]),"line-miter-limit":new ri(je.layout_line["line-miter-limit"]),"line-round-limit":new ri(je.layout_line["line-round-limit"]),"line-sort-key":new yi(je.layout_line["line-sort-key"])})}};class bv extends yi{possiblyEvaluate(a,h){return h=new Fn(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,zoomHistory:h.zoomHistory,transition:h.transition}),super.possiblyEvaluate(a,h)}evaluate(a,h,f,y){return h=Pe({},h,{zoom:Math.floor(h.zoom)}),super.evaluate(a,h,f,y)}}let Rh;class vv extends Or{constructor(a){super(a,y1),this.gradientVersion=0,Rh||(Rh=new bv(y1.paint.properties["line-width"].specification),Rh.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(a){if(a==="line-gradient"){const h=this.gradientExpression();this.stepInterpolant=!!function(f){return f._styleExpression!==void 0}(h)&&h._styleExpression.expression instanceof Ui,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(a,h){super.recalculate(a,h),this.paint._values["line-floorwidth"]=Rh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new Af(a)}queryRadius(a){const h=a,f=b1(Kc("line-width",this,h),Kc("line-gap-width",this,h)),y=Kc("line-offset",this,h);return f/2+Math.abs(y)+Ch(this.paint.get("line-translate"))}queryIntersectsFeature(a,h,f,y,w,k,D){const P=Ph(a,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),k.angle,D),E=D/2*b1(this.paint.get("line-width").evaluate(h,f),this.paint.get("line-gap-width").evaluate(h,f)),B=this.paint.get("line-offset").evaluate(h,f);return B&&(y=function(H,K){const ee=[];for(let ne=0;ne<H.length;ne++){const ue=H[ne],me=[];for(let ke=0;ke<ue.length;ke++){const Ve=ue[ke-1],Ce=ue[ke],Be=ue[ke+1],it=ke===0?new M(0,0):Ce.sub(Ve)._unit()._perp(),ot=ke===ue.length-1?new M(0,0):Be.sub(Ce)._unit()._perp(),Ht=it._add(ot)._unit(),ti=Ht.x*ot.x+Ht.y*ot.y;ti!==0&&Ht._mult(1/ti),me.push(Ht._mult(K)._add(Ce))}ee.push(me)}return ee}(y,B*D)),function(H,K,ee){for(let ne=0;ne<K.length;ne++){const ue=K[ne];if(H.length>=3){for(let me=0;me<ue.length;me++)if(Bl(H,ue[me]))return!0}if(Dh(H,ue,ee))return!0}return!1}(P,y,E)}isTileClipped(){return!0}}function b1(l,a){return a>0?a+2*l:l}const xv=ha([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),wv=ha([{name:"a_projected_pos",components:3,type:"Float32"}],4);ha([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const kv=ha([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);ha([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const v1=ha([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Sv=ha([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Mv(l,a,h){return l.sections.forEach(f=>{f.text=function(y,w,k){const D=w.layout.get("text-transform").evaluate(k,{});return D==="uppercase"?y=y.toLocaleUpperCase():D==="lowercase"&&(y=y.toLocaleLowerCase()),Vs.applyArabicShaping&&(y=Vs.applyArabicShaping(y)),y}(f.text,a,h)}),l}ha([{name:"triangle",components:3,type:"Uint16"}]),ha([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ha([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),ha([{type:"Float32",name:"offsetX"}]),ha([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),ha([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const au={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var ka=24,x1=kn,w1=function(l,a,h,f,y){var w,k,D=8*y-f-1,P=(1<<D)-1,E=P>>1,B=-7,H=h?y-1:0,K=h?-1:1,ee=l[a+H];for(H+=K,w=ee&(1<<-B)-1,ee>>=-B,B+=D;B>0;w=256*w+l[a+H],H+=K,B-=8);for(k=w&(1<<-B)-1,w>>=-B,B+=f;B>0;k=256*k+l[a+H],H+=K,B-=8);if(w===0)w=1-E;else{if(w===P)return k?NaN:1/0*(ee?-1:1);k+=Math.pow(2,f),w-=E}return(ee?-1:1)*k*Math.pow(2,w-f)},k1=function(l,a,h,f,y,w){var k,D,P,E=8*w-y-1,B=(1<<E)-1,H=B>>1,K=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,ee=f?0:w-1,ne=f?1:-1,ue=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(D=isNaN(a)?1:0,k=B):(k=Math.floor(Math.log(a)/Math.LN2),a*(P=Math.pow(2,-k))<1&&(k--,P*=2),(a+=k+H>=1?K/P:K*Math.pow(2,1-H))*P>=2&&(k++,P/=2),k+H>=B?(D=0,k=B):k+H>=1?(D=(a*P-1)*Math.pow(2,y),k+=H):(D=a*Math.pow(2,H-1)*Math.pow(2,y),k=0));y>=8;l[h+ee]=255&D,ee+=ne,D/=256,y-=8);for(k=k<<y|D,E+=y;E>0;l[h+ee]=255&k,ee+=ne,k/=256,E-=8);l[h+ee-ne]|=128*ue};function kn(l){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(l)?l:new Uint8Array(l||0),this.pos=0,this.type=0,this.length=this.buf.length}kn.Varint=0,kn.Fixed64=1,kn.Bytes=2,kn.Fixed32=5;var If=4294967296,S1=1/If,M1=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function $s(l){return l.type===kn.Bytes?l.readVarint()+l.pos:l.pos+1}function jl(l,a,h){return h?4294967296*a+(l>>>0):4294967296*(a>>>0)+(l>>>0)}function D1(l,a,h){var f=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));h.realloc(f);for(var y=h.pos-1;y>=l;y--)h.buf[y+f]=h.buf[y]}function Dv(l,a){for(var h=0;h<l.length;h++)a.writeVarint(l[h])}function Tv(l,a){for(var h=0;h<l.length;h++)a.writeSVarint(l[h])}function Cv(l,a){for(var h=0;h<l.length;h++)a.writeFloat(l[h])}function Pv(l,a){for(var h=0;h<l.length;h++)a.writeDouble(l[h])}function Av(l,a){for(var h=0;h<l.length;h++)a.writeBoolean(l[h])}function Iv(l,a){for(var h=0;h<l.length;h++)a.writeFixed32(l[h])}function Ev(l,a){for(var h=0;h<l.length;h++)a.writeSFixed32(l[h])}function Lv(l,a){for(var h=0;h<l.length;h++)a.writeFixed64(l[h])}function zv(l,a){for(var h=0;h<l.length;h++)a.writeSFixed64(l[h])}function Fh(l,a){return(l[a]|l[a+1]<<8|l[a+2]<<16)+16777216*l[a+3]}function Ul(l,a,h){l[h]=a,l[h+1]=a>>>8,l[h+2]=a>>>16,l[h+3]=a>>>24}function T1(l,a){return(l[a]|l[a+1]<<8|l[a+2]<<16)+(l[a+3]<<24)}kn.prototype={destroy:function(){this.buf=null},readFields:function(l,a,h){for(h=h||this.length;this.pos<h;){var f=this.readVarint(),y=f>>3,w=this.pos;this.type=7&f,l(y,a,this),this.pos===w&&this.skip(f)}return a},readMessage:function(l,a){return this.readFields(l,a,this.readVarint()+this.pos)},readFixed32:function(){var l=Fh(this.buf,this.pos);return this.pos+=4,l},readSFixed32:function(){var l=T1(this.buf,this.pos);return this.pos+=4,l},readFixed64:function(){var l=Fh(this.buf,this.pos)+Fh(this.buf,this.pos+4)*If;return this.pos+=8,l},readSFixed64:function(){var l=Fh(this.buf,this.pos)+T1(this.buf,this.pos+4)*If;return this.pos+=8,l},readFloat:function(){var l=w1(this.buf,this.pos,!0,23,4);return this.pos+=4,l},readDouble:function(){var l=w1(this.buf,this.pos,!0,52,8);return this.pos+=8,l},readVarint:function(l){var a,h,f=this.buf;return a=127&(h=f[this.pos++]),h<128?a:(a|=(127&(h=f[this.pos++]))<<7,h<128?a:(a|=(127&(h=f[this.pos++]))<<14,h<128?a:(a|=(127&(h=f[this.pos++]))<<21,h<128?a:function(y,w,k){var D,P,E=k.buf;if(D=(112&(P=E[k.pos++]))>>4,P<128||(D|=(127&(P=E[k.pos++]))<<3,P<128)||(D|=(127&(P=E[k.pos++]))<<10,P<128)||(D|=(127&(P=E[k.pos++]))<<17,P<128)||(D|=(127&(P=E[k.pos++]))<<24,P<128)||(D|=(1&(P=E[k.pos++]))<<31,P<128))return jl(y,D,w);throw new Error("Expected varint not more than 10 bytes")}(a|=(15&(h=f[this.pos]))<<28,l,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var l=this.readVarint();return l%2==1?(l+1)/-2:l/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var l=this.readVarint()+this.pos,a=this.pos;return this.pos=l,l-a>=12&&M1?function(h,f,y){return M1.decode(h.subarray(f,y))}(this.buf,a,l):function(h,f,y){for(var w="",k=f;k<y;){var D,P,E,B=h[k],H=null,K=B>239?4:B>223?3:B>191?2:1;if(k+K>y)break;K===1?B<128&&(H=B):K===2?(192&(D=h[k+1]))==128&&(H=(31&B)<<6|63&D)<=127&&(H=null):K===3?(P=h[k+2],(192&(D=h[k+1]))==128&&(192&P)==128&&((H=(15&B)<<12|(63&D)<<6|63&P)<=2047||H>=55296&&H<=57343)&&(H=null)):K===4&&(P=h[k+2],E=h[k+3],(192&(D=h[k+1]))==128&&(192&P)==128&&(192&E)==128&&((H=(15&B)<<18|(63&D)<<12|(63&P)<<6|63&E)<=65535||H>=1114112)&&(H=null)),H===null?(H=65533,K=1):H>65535&&(H-=65536,w+=String.fromCharCode(H>>>10&1023|55296),H=56320|1023&H),w+=String.fromCharCode(H),k+=K}return w}(this.buf,a,l)},readBytes:function(){var l=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,l);return this.pos=l,a},readPackedVarint:function(l,a){if(this.type!==kn.Bytes)return l.push(this.readVarint(a));var h=$s(this);for(l=l||[];this.pos<h;)l.push(this.readVarint(a));return l},readPackedSVarint:function(l){if(this.type!==kn.Bytes)return l.push(this.readSVarint());var a=$s(this);for(l=l||[];this.pos<a;)l.push(this.readSVarint());return l},readPackedBoolean:function(l){if(this.type!==kn.Bytes)return l.push(this.readBoolean());var a=$s(this);for(l=l||[];this.pos<a;)l.push(this.readBoolean());return l},readPackedFloat:function(l){if(this.type!==kn.Bytes)return l.push(this.readFloat());var a=$s(this);for(l=l||[];this.pos<a;)l.push(this.readFloat());return l},readPackedDouble:function(l){if(this.type!==kn.Bytes)return l.push(this.readDouble());var a=$s(this);for(l=l||[];this.pos<a;)l.push(this.readDouble());return l},readPackedFixed32:function(l){if(this.type!==kn.Bytes)return l.push(this.readFixed32());var a=$s(this);for(l=l||[];this.pos<a;)l.push(this.readFixed32());return l},readPackedSFixed32:function(l){if(this.type!==kn.Bytes)return l.push(this.readSFixed32());var a=$s(this);for(l=l||[];this.pos<a;)l.push(this.readSFixed32());return l},readPackedFixed64:function(l){if(this.type!==kn.Bytes)return l.push(this.readFixed64());var a=$s(this);for(l=l||[];this.pos<a;)l.push(this.readFixed64());return l},readPackedSFixed64:function(l){if(this.type!==kn.Bytes)return l.push(this.readSFixed64());var a=$s(this);for(l=l||[];this.pos<a;)l.push(this.readSFixed64());return l},skip:function(l){var a=7&l;if(a===kn.Varint)for(;this.buf[this.pos++]>127;);else if(a===kn.Bytes)this.pos=this.readVarint()+this.pos;else if(a===kn.Fixed32)this.pos+=4;else{if(a!==kn.Fixed64)throw new Error("Unimplemented type: "+a);this.pos+=8}},writeTag:function(l,a){this.writeVarint(l<<3|a)},realloc:function(l){for(var a=this.length||16;a<this.pos+l;)a*=2;if(a!==this.length){var h=new Uint8Array(a);h.set(this.buf),this.buf=h,this.length=a}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(l){this.realloc(4),Ul(this.buf,l,this.pos),this.pos+=4},writeSFixed32:function(l){this.realloc(4),Ul(this.buf,l,this.pos),this.pos+=4},writeFixed64:function(l){this.realloc(8),Ul(this.buf,-1&l,this.pos),Ul(this.buf,Math.floor(l*S1),this.pos+4),this.pos+=8},writeSFixed64:function(l){this.realloc(8),Ul(this.buf,-1&l,this.pos),Ul(this.buf,Math.floor(l*S1),this.pos+4),this.pos+=8},writeVarint:function(l){(l=+l||0)>268435455||l<0?function(a,h){var f,y;if(a>=0?(f=a%4294967296|0,y=a/4294967296|0):(y=~(-a/4294967296),4294967295^(f=~(-a%4294967296))?f=f+1|0:(f=0,y=y+1|0)),a>=18446744073709552e3||a<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),function(w,k,D){D.buf[D.pos++]=127&w|128,w>>>=7,D.buf[D.pos++]=127&w|128,w>>>=7,D.buf[D.pos++]=127&w|128,w>>>=7,D.buf[D.pos++]=127&w|128,D.buf[D.pos]=127&(w>>>=7)}(f,0,h),function(w,k){var D=(7&w)<<4;k.buf[k.pos++]|=D|((w>>>=3)?128:0),w&&(k.buf[k.pos++]=127&w|((w>>>=7)?128:0),w&&(k.buf[k.pos++]=127&w|((w>>>=7)?128:0),w&&(k.buf[k.pos++]=127&w|((w>>>=7)?128:0),w&&(k.buf[k.pos++]=127&w|((w>>>=7)?128:0),w&&(k.buf[k.pos++]=127&w)))))}(y,h)}(l,this):(this.realloc(4),this.buf[this.pos++]=127&l|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=l>>>7&127))))},writeSVarint:function(l){this.writeVarint(l<0?2*-l-1:2*l)},writeBoolean:function(l){this.writeVarint(!!l)},writeString:function(l){l=String(l),this.realloc(4*l.length),this.pos++;var a=this.pos;this.pos=function(f,y,w){for(var k,D,P=0;P<y.length;P++){if((k=y.charCodeAt(P))>55295&&k<57344){if(!D){k>56319||P+1===y.length?(f[w++]=239,f[w++]=191,f[w++]=189):D=k;continue}if(k<56320){f[w++]=239,f[w++]=191,f[w++]=189,D=k;continue}k=D-55296<<10|k-56320|65536,D=null}else D&&(f[w++]=239,f[w++]=191,f[w++]=189,D=null);k<128?f[w++]=k:(k<2048?f[w++]=k>>6|192:(k<65536?f[w++]=k>>12|224:(f[w++]=k>>18|240,f[w++]=k>>12&63|128),f[w++]=k>>6&63|128),f[w++]=63&k|128)}return w}(this.buf,l,this.pos);var h=this.pos-a;h>=128&&D1(a,h,this),this.pos=a-1,this.writeVarint(h),this.pos+=h},writeFloat:function(l){this.realloc(4),k1(this.buf,l,this.pos,!0,23,4),this.pos+=4},writeDouble:function(l){this.realloc(8),k1(this.buf,l,this.pos,!0,52,8),this.pos+=8},writeBytes:function(l){var a=l.length;this.writeVarint(a),this.realloc(a);for(var h=0;h<a;h++)this.buf[this.pos++]=l[h]},writeRawMessage:function(l,a){this.pos++;var h=this.pos;l(a,this);var f=this.pos-h;f>=128&&D1(h,f,this),this.pos=h-1,this.writeVarint(f),this.pos+=f},writeMessage:function(l,a,h){this.writeTag(l,kn.Bytes),this.writeRawMessage(a,h)},writePackedVarint:function(l,a){a.length&&this.writeMessage(l,Dv,a)},writePackedSVarint:function(l,a){a.length&&this.writeMessage(l,Tv,a)},writePackedBoolean:function(l,a){a.length&&this.writeMessage(l,Av,a)},writePackedFloat:function(l,a){a.length&&this.writeMessage(l,Cv,a)},writePackedDouble:function(l,a){a.length&&this.writeMessage(l,Pv,a)},writePackedFixed32:function(l,a){a.length&&this.writeMessage(l,Iv,a)},writePackedSFixed32:function(l,a){a.length&&this.writeMessage(l,Ev,a)},writePackedFixed64:function(l,a){a.length&&this.writeMessage(l,Lv,a)},writePackedSFixed64:function(l,a){a.length&&this.writeMessage(l,zv,a)},writeBytesField:function(l,a){this.writeTag(l,kn.Bytes),this.writeBytes(a)},writeFixed32Field:function(l,a){this.writeTag(l,kn.Fixed32),this.writeFixed32(a)},writeSFixed32Field:function(l,a){this.writeTag(l,kn.Fixed32),this.writeSFixed32(a)},writeFixed64Field:function(l,a){this.writeTag(l,kn.Fixed64),this.writeFixed64(a)},writeSFixed64Field:function(l,a){this.writeTag(l,kn.Fixed64),this.writeSFixed64(a)},writeVarintField:function(l,a){this.writeTag(l,kn.Varint),this.writeVarint(a)},writeSVarintField:function(l,a){this.writeTag(l,kn.Varint),this.writeSVarint(a)},writeStringField:function(l,a){this.writeTag(l,kn.Bytes),this.writeString(a)},writeFloatField:function(l,a){this.writeTag(l,kn.Fixed32),this.writeFloat(a)},writeDoubleField:function(l,a){this.writeTag(l,kn.Fixed64),this.writeDouble(a)},writeBooleanField:function(l,a){this.writeVarintField(l,!!a)}};var Ef=p(x1);const Lf=3;function Rv(l,a,h){l===1&&h.readMessage(Fv,a)}function Fv(l,a,h){if(l===3){const{id:f,bitmap:y,width:w,height:k,left:D,top:P,advance:E}=h.readMessage(Ov,{});a.push({id:f,bitmap:new Jc({width:w+2*Lf,height:k+2*Lf},y),metrics:{width:w,height:k,left:D,top:P,advance:E}})}}function Ov(l,a,h){l===1?a.id=h.readVarint():l===2?a.bitmap=h.readBytes():l===3?a.width=h.readVarint():l===4?a.height=h.readVarint():l===5?a.left=h.readSVarint():l===6?a.top=h.readSVarint():l===7&&(a.advance=h.readVarint())}const C1=Lf;function P1(l){let a=0,h=0;for(const k of l)a+=k.w*k.h,h=Math.max(h,k.w);l.sort((k,D)=>D.h-k.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),h),h:1/0}];let y=0,w=0;for(const k of l)for(let D=f.length-1;D>=0;D--){const P=f[D];if(!(k.w>P.w||k.h>P.h)){if(k.x=P.x,k.y=P.y,w=Math.max(w,k.y+k.h),y=Math.max(y,k.x+k.w),k.w===P.w&&k.h===P.h){const E=f.pop();D<f.length&&(f[D]=E)}else k.h===P.h?(P.x+=k.w,P.w-=k.w):k.w===P.w?(P.y+=k.h,P.h-=k.h):(f.push({x:P.x+k.w,y:P.y,w:P.w-k.w,h:k.h}),P.y+=k.h,P.h-=k.h);break}}return{w:y,h:w,fill:a/(y*w)||0}}const Sr=1;class zf{constructor(a,{pixelRatio:h,version:f,stretchX:y,stretchY:w,content:k}){this.paddedRect=a,this.pixelRatio=h,this.stretchX=y,this.stretchY=w,this.content=k,this.version=f}get tl(){return[this.paddedRect.x+Sr,this.paddedRect.y+Sr]}get br(){return[this.paddedRect.x+this.paddedRect.w-Sr,this.paddedRect.y+this.paddedRect.h-Sr]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Sr)/this.pixelRatio,(this.paddedRect.h-2*Sr)/this.pixelRatio]}}class A1{constructor(a,h){const f={},y={};this.haveRenderCallbacks=[];const w=[];this.addImages(a,f,w),this.addImages(h,y,w);const{w:k,h:D}=P1(w),P=new Vr({width:k||1,height:D||1});for(const E in a){const B=a[E],H=f[E].paddedRect;Vr.copy(B.data,P,{x:0,y:0},{x:H.x+Sr,y:H.y+Sr},B.data)}for(const E in h){const B=h[E],H=y[E].paddedRect,K=H.x+Sr,ee=H.y+Sr,ne=B.data.width,ue=B.data.height;Vr.copy(B.data,P,{x:0,y:0},{x:K,y:ee},B.data),Vr.copy(B.data,P,{x:0,y:ue-1},{x:K,y:ee-1},{width:ne,height:1}),Vr.copy(B.data,P,{x:0,y:0},{x:K,y:ee+ue},{width:ne,height:1}),Vr.copy(B.data,P,{x:ne-1,y:0},{x:K-1,y:ee},{width:1,height:ue}),Vr.copy(B.data,P,{x:0,y:0},{x:K+ne,y:ee},{width:1,height:ue})}this.image=P,this.iconPositions=f,this.patternPositions=y}addImages(a,h,f){for(const y in a){const w=a[y],k={x:0,y:0,w:w.data.width+2*Sr,h:w.data.height+2*Sr};f.push(k),h[y]=new zf(k,w),w.hasRenderCallback&&this.haveRenderCallbacks.push(y)}}patchUpdatedImages(a,h){a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in a.updatedImages)this.patchUpdatedImage(this.iconPositions[f],a.getImage(f),h),this.patchUpdatedImage(this.patternPositions[f],a.getImage(f),h)}patchUpdatedImage(a,h,f){if(!a||!h||a.version===h.version)return;a.version=h.version;const[y,w]=a.tl;f.update(h.data,void 0,{x:y,y:w})}}var Do;Yt("ImagePosition",zf),Yt("ImageAtlas",A1),u.ah=void 0,(Do=u.ah||(u.ah={}))[Do.none=0]="none",Do[Do.horizontal=1]="horizontal",Do[Do.vertical=2]="vertical",Do[Do.horizontalOnly=3]="horizontalOnly";const ru=-17;class su{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(a,h){const f=new su;return f.scale=a||1,f.fontStack=h,f}static forImage(a){const h=new su;return h.imageName=a,h}}class Wl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,h){const f=new Wl;for(let y=0;y<a.sections.length;y++){const w=a.sections[y];w.image?f.addImageSection(w):f.addTextSection(w,h)}return f}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSectionIndex(a){return this.sectionIndex[a]}getCharCode(a){return this.text.charCodeAt(a)}verticalizePunctuation(){this.text=function(a){let h="";for(let f=0;f<a.length;f++){const y=a.charCodeAt(f+1)||null,w=a.charCodeAt(f-1)||null;h+=y&&Ac(y)&&!au[a[f+1]]||w&&Ac(w)&&!au[a[f-1]]||!au[a[f]]?a[f]:au[a[f]]}return h}(this.text)}trim(){let a=0;for(let f=0;f<this.text.length&&Bh[this.text.charCodeAt(f)];f++)a++;let h=this.text.length;for(let f=this.text.length-1;f>=0&&f>=a&&Bh[this.text.charCodeAt(f)];f--)h--;this.text=this.text.substring(a,h),this.sectionIndex=this.sectionIndex.slice(a,h)}substring(a,h){const f=new Wl;return f.text=this.text.substring(a,h),f.sectionIndex=this.sectionIndex.slice(a,h),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,h)=>Math.max(a,this.sections[h].scale),0)}addTextSection(a,h){this.text+=a.text,this.sections.push(su.forText(a.scale,a.fontStack||h));const f=this.sections.length-1;for(let y=0;y<a.text.length;++y)this.sectionIndex.push(f)}addImageSection(a){const h=a.image?a.image.name:"";if(h.length===0)return void Xe("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(su.forImage(h)),this.sectionIndex.push(this.sections.length-1)):Xe("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Oh(l,a,h,f,y,w,k,D,P,E,B,H,K,ee,ne,ue){const me=Wl.fromFeature(l,y);let ke;H===u.ah.vertical&&me.verticalizePunctuation();const{processBidirectionalText:Ve,processStyledBidirectionalText:Ce}=Vs;if(Ve&&me.sections.length===1){ke=[];const ot=Ve(me.toString(),Rf(me,E,w,a,f,ee,ne));for(const Ht of ot){const ti=new Wl;ti.text=Ht,ti.sections=me.sections;for(let Nt=0;Nt<Ht.length;Nt++)ti.sectionIndex.push(0);ke.push(ti)}}else if(Ce){ke=[];const ot=Ce(me.text,me.sectionIndex,Rf(me,E,w,a,f,ee,ne));for(const Ht of ot){const ti=new Wl;ti.text=Ht[0],ti.sectionIndex=Ht[1],ti.sections=me.sections,ke.push(ti)}}else ke=function(ot,Ht){const ti=[],Nt=ot.text;let Lt=0;for(const kt of Ht)ti.push(ot.substring(Lt,kt)),Lt=kt;return Lt<Nt.length&&ti.push(ot.substring(Lt,Nt.length)),ti}(me,Rf(me,E,w,a,f,ee,ne));const Be=[],it={positionedLines:Be,text:me.toString(),top:B[1],bottom:B[1],left:B[0],right:B[0],writingMode:H,iconsInText:!1,verticalizable:!1};return function(ot,Ht,ti,Nt,Lt,kt,Qt,At,yt,hi,ai,qi){let Bn=0,Zn=ru,Sa=0,Ar=0;const ur=At==="right"?1:At==="left"?0:.5;let _a=0;for(const Ma of Lt){Ma.trim();const Da=Ma.getMaxScale(),Qa=(Da-1)*ka,fr={positionedGlyphs:[],lineOffset:0};ot.positionedLines[_a]=fr;const er=fr.positionedGlyphs;let Mr=0;if(!Ma.length()){Zn+=kt,++_a;continue}for(let Ta=0;Ta<Ma.length();Ta++){const rn=Ma.getSection(Ta),tr=Ma.getSectionIndex(Ta),Ka=Ma.getCharCode(Ta);let Ca=0,is=null,hs=null,ds=null,Ks=ka;const ns=!(yt===u.ah.horizontal||!ai&&!Pl(Ka)||ai&&(Bh[Ka]||(ja=Ka,qt.Arabic(ja)||qt["Arabic Supplement"](ja)||qt["Arabic Extended-A"](ja)||qt["Arabic Presentation Forms-A"](ja)||qt["Arabic Presentation Forms-B"](ja))));if(rn.imageName){const jr=Nt[rn.imageName];if(!jr)continue;ds=rn.imageName,ot.iconsInText=ot.iconsInText||!0,hs=jr.paddedRect;const Tr=jr.displaySize;rn.scale=rn.scale*ka/qi,is={width:Tr[0],height:Tr[1],left:Sr,top:-C1,advance:ns?Tr[1]:Tr[0]},Ca=Qa+(ka-Tr[1]*rn.scale),Ks=is.advance;const Ys=ns?Tr[0]*rn.scale-ka*Da:Tr[1]*rn.scale-ka*Da;Ys>0&&Ys>Mr&&(Mr=Ys)}else{const jr=ti[rn.fontStack],Tr=jr&&jr[Ka];if(Tr&&Tr.rect)hs=Tr.rect,is=Tr.metrics;else{const Ys=Ht[rn.fontStack],hu=Ys&&Ys[Ka];if(!hu)continue;is=hu.metrics}Ca=(Da-rn.scale)*ka}ns?(ot.verticalizable=!0,er.push({glyph:Ka,imageName:ds,x:Bn,y:Zn+Ca,vertical:ns,scale:rn.scale,fontStack:rn.fontStack,sectionIndex:tr,metrics:is,rect:hs}),Bn+=Ks*rn.scale+hi):(er.push({glyph:Ka,imageName:ds,x:Bn,y:Zn+Ca,vertical:ns,scale:rn.scale,fontStack:rn.fontStack,sectionIndex:tr,metrics:is,rect:hs}),Bn+=is.advance*rn.scale+hi)}er.length!==0&&(Sa=Math.max(Bn-hi,Sa),Vv(er,0,er.length-1,ur,Mr)),Bn=0;const Dr=kt*Da+Mr;fr.lineOffset=Math.max(Mr,Qa),Zn+=Dr,Ar=Math.max(Dr,Ar),++_a}var ja;const $a=Zn-ru,{horizontalAlign:hr,verticalAlign:dr}=Ff(Qt);(function(Ma,Da,Qa,fr,er,Mr,Dr,Ta,rn){const tr=(Da-Qa)*er;let Ka=0;Ka=Mr!==Dr?-Ta*fr-ru:(-fr*rn+.5)*Dr;for(const Ca of Ma)for(const is of Ca.positionedGlyphs)is.x+=tr,is.y+=Ka})(ot.positionedLines,ur,hr,dr,Sa,Ar,kt,$a,Lt.length),ot.top+=-dr*$a,ot.bottom=ot.top+$a,ot.left+=-hr*Sa,ot.right=ot.left+Sa}(it,a,h,f,ke,k,D,P,H,E,K,ue),!function(ot){for(const Ht of ot)if(Ht.positionedGlyphs.length!==0)return!1;return!0}(Be)&&it}const Bh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Bv={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function I1(l,a,h,f,y,w){if(a.imageName){const k=f[a.imageName];return k?k.displaySize[0]*a.scale*ka/w+y:0}{const k=h[a.fontStack],D=k&&k[l];return D?D.metrics.advance*a.scale+y:0}}function E1(l,a,h,f){const y=Math.pow(l-a,2);return f?l<a?y/2:2*y:y+Math.abs(h)*h}function Nv(l,a,h){let f=0;return l===10&&(f-=1e4),h&&(f+=150),l!==40&&l!==65288||(f+=50),a!==41&&a!==65289||(f+=50),f}function L1(l,a,h,f,y,w){let k=null,D=E1(a,h,y,w);for(const P of f){const E=E1(a-P.x,h,y,w)+P.badness;E<=D&&(k=P,D=E)}return{index:l,x:a,priorBreak:k,badness:D}}function z1(l){return l?z1(l.priorBreak).concat(l.index):[]}function Rf(l,a,h,f,y,w,k){if(w!=="point")return[];if(!l)return[];const D=[],P=function(K,ee,ne,ue,me,ke){let Ve=0;for(let Ce=0;Ce<K.length();Ce++){const Be=K.getSection(Ce);Ve+=I1(K.getCharCode(Ce),Be,ue,me,ee,ke)}return Ve/Math.max(1,Math.ceil(Ve/ne))}(l,a,h,f,y,k),E=l.text.indexOf("​")>=0;let B=0;for(let K=0;K<l.length();K++){const ee=l.getSection(K),ne=l.getCharCode(K);if(Bh[ne]||(B+=I1(ne,ee,f,y,a,k)),K<l.length()-1){const ue=!((H=ne)<11904||!(qt["Bopomofo Extended"](H)||qt.Bopomofo(H)||qt["CJK Compatibility Forms"](H)||qt["CJK Compatibility Ideographs"](H)||qt["CJK Compatibility"](H)||qt["CJK Radicals Supplement"](H)||qt["CJK Strokes"](H)||qt["CJK Symbols and Punctuation"](H)||qt["CJK Unified Ideographs Extension A"](H)||qt["CJK Unified Ideographs"](H)||qt["Enclosed CJK Letters and Months"](H)||qt["Halfwidth and Fullwidth Forms"](H)||qt.Hiragana(H)||qt["Ideographic Description Characters"](H)||qt["Kangxi Radicals"](H)||qt["Katakana Phonetic Extensions"](H)||qt.Katakana(H)||qt["Vertical Forms"](H)||qt["Yi Radicals"](H)||qt["Yi Syllables"](H)));(Bv[ne]||ue||ee.imageName)&&D.push(L1(K+1,B,P,D,Nv(ne,l.getCharCode(K+1),ue&&E),!1))}}var H;return z1(L1(l.length(),B,P,D,0,!0))}function Ff(l){let a=.5,h=.5;switch(l){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:a,verticalAlign:h}}function Vv(l,a,h,f,y){if(!f&&!y)return;const w=l[h],k=(l[h].x+w.metrics.advance*w.scale)*f;for(let D=a;D<=h;D++)l[D].x-=k,l[D].y+=y}function Hv(l,a,h){const{horizontalAlign:f,verticalAlign:y}=Ff(h),w=a[0]-l.displaySize[0]*f,k=a[1]-l.displaySize[1]*y;return{image:l,top:k,bottom:k+l.displaySize[1],left:w,right:w+l.displaySize[0]}}function R1(l,a,h,f,y,w){const k=l.image;let D;if(k.content){const me=k.content,ke=k.pixelRatio||1;D=[me[0]/ke,me[1]/ke,k.displaySize[0]-me[2]/ke,k.displaySize[1]-me[3]/ke]}const P=a.left*w,E=a.right*w;let B,H,K,ee;h==="width"||h==="both"?(ee=y[0]+P-f[3],H=y[0]+E+f[1]):(ee=y[0]+(P+E-k.displaySize[0])/2,H=ee+k.displaySize[0]);const ne=a.top*w,ue=a.bottom*w;return h==="height"||h==="both"?(B=y[1]+ne-f[0],K=y[1]+ue+f[2]):(B=y[1]+(ne+ue-k.displaySize[1])/2,K=B+k.displaySize[1]),{image:k,top:B,right:H,bottom:K,left:ee,collisionPadding:D}}const ou=255,Ts=128,To=ou*Ts;function F1(l,a){const{expression:h}=a;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new Fn(l+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:y}=h;let w=0;for(;w<f.length&&f[w]<=l;)w++;w=Math.max(0,w-1);let k=w;for(;k<f.length&&f[k]<l+1;)k++;k=Math.min(f.length-1,k);const D=f[w],P=f[k];return h.kind==="composite"?{kind:"composite",minZoom:D,maxZoom:P,interpolationType:y}:{kind:"camera",minZoom:D,maxZoom:P,minSize:h.evaluate(new Fn(D)),maxSize:h.evaluate(new Fn(P)),interpolationType:y}}}function Of(l,a,h){let f="never";const y=l.get(a);return y?f=y:l.get(h)&&(f="always"),f}const jv=Mo.VectorTileFeature.types,Uv=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Nh(l,a,h,f,y,w,k,D,P,E,B,H,K){const ee=D?Math.min(To,Math.round(D[0])):0,ne=D?Math.min(To,Math.round(D[1])):0;l.emplaceBack(a,h,Math.round(32*f),Math.round(32*y),w,k,(ee<<1)+(P?1:0),ne,16*E,16*B,256*H,256*K)}function Bf(l,a,h){l.emplaceBack(a.x,a.y,h),l.emplaceBack(a.x,a.y,h),l.emplaceBack(a.x,a.y,h),l.emplaceBack(a.x,a.y,h)}function Wv(l){for(const a of l.sections)if(yh(a.text))return!0;return!1}class Nf{constructor(a){this.layoutVertexArray=new Le,this.indexArray=new Ze,this.programConfigurations=a,this.segments=new dt,this.dynamicLayoutVertexArray=new We,this.opacityVertexArray=new ye,this.hasVisibleVertices=!1,this.placedSymbolArray=new r}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(a,h,f,y){this.isEmpty()||(f&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,xv.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,wv.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,Uv,!0),this.opacityVertexBuffer.itemSize=1),(f||y)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Yt("SymbolBuffers",Nf);class Vf{constructor(a,h,f){this.layoutVertexArray=new a,this.layoutAttributes=h,this.indexArray=new f,this.segments=new dt,this.collisionVertexArray=new qe}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,kv.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Yt("CollisionBuffers",Vf);class ql{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(k=>k.id),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=_f([]),this.placementViewportMatrix=_f([]);const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=F1(this.zoom,h["text-size"]),this.iconSizeData=F1(this.zoom,h["icon-size"]);const f=this.layers[0].layout,y=f.get("symbol-sort-key"),w=f.get("symbol-z-order");this.canOverlap=Of(f,"text-overlap","text-allow-overlap")!=="never"||Of(f,"icon-overlap","icon-allow-overlap")!=="never"||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=w!=="viewport-y"&&!y.isConstant(),this.sortFeaturesByY=(w==="viewport-y"||w==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,f.get("symbol-placement")==="point"&&(this.writingModes=f.get("text-writing-mode").map(k=>u.ah[k])),this.stateDependentLayerIds=this.layers.filter(k=>k.isStateDependent()).map(k=>k.id),this.sourceID=a.sourceID}createArrays(){this.text=new Nf(new qn(this.layers,this.zoom,a=>/^text/.test(a))),this.icon=new Nf(new qn(this.layers,this.zoom,a=>/^icon/.test(a))),this.glyphOffsetArray=new g,this.lineVertexArray=new x,this.symbolInstances=new m,this.textAnchorOffsets=new C}calculateGlyphDependencies(a,h,f,y,w){for(let k=0;k<a.length;k++)if(h[a.charCodeAt(k)]=!0,(f||y)&&w){const D=au[a.charAt(k)];D&&(h[D.charCodeAt(0)]=!0)}}populate(a,h,f){const y=this.layers[0],w=y.layout,k=w.get("text-font"),D=w.get("text-field"),P=w.get("icon-image"),E=(D.value.kind!=="constant"||D.value.value instanceof In&&!D.value.value.isEmpty()||D.value.value.toString().length>0)&&(k.value.kind!=="constant"||k.value.value.length>0),B=P.value.kind!=="constant"||!!P.value.value||Object.keys(P.parameters).length>0,H=w.get("symbol-sort-key");if(this.features=[],!E&&!B)return;const K=h.iconDependencies,ee=h.glyphDependencies,ne=h.availableImages,ue=new Fn(this.zoom);for(const{feature:me,id:ke,index:Ve,sourceLayerIndex:Ce}of a){const Be=y._featureFilter.needGeometry,it=Zs(me,Be);if(!y._featureFilter.filter(ue,it,f))continue;let ot,Ht;if(Be||(it.geometry=qs(me)),E){const Nt=y.getValueAndResolveTokens("text-field",it,f,ne),Lt=In.factory(Nt),kt=this.hasRTLText=this.hasRTLText||Wv(Lt);(!kt||Vs.getRTLTextPluginStatus()==="unavailable"||kt&&Vs.isParsed())&&(ot=Mv(Lt,y,it))}if(B){const Nt=y.getValueAndResolveTokens("icon-image",it,f,ne);Ht=Nt instanceof na?Nt:na.fromString(Nt)}if(!ot&&!Ht)continue;const ti=this.sortFeaturesByKey?H.evaluate(it,{},f):void 0;if(this.features.push({id:ke,text:ot,icon:Ht,index:Ve,sourceLayerIndex:Ce,geometry:it.geometry,properties:me.properties,type:jv[me.type],sortKey:ti}),Ht&&(K[Ht.name]=!0),ot){const Nt=k.evaluate(it,{},f).join(","),Lt=w.get("text-rotation-alignment")!=="viewport"&&w.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(u.ah.vertical)>=0;for(const kt of ot.sections)if(kt.image)K[kt.image.name]=!0;else{const Qt=$o(ot.toString()),At=kt.fontStack||Nt,yt=ee[At]=ee[At]||{};this.calculateGlyphDependencies(kt.text,yt,Lt,this.allowVerticalPlacement,Qt)}}}w.get("symbol-placement")==="line"&&(this.features=function(me){const ke={},Ve={},Ce=[];let Be=0;function it(Nt){Ce.push(me[Nt]),Be++}function ot(Nt,Lt,kt){const Qt=Ve[Nt];return delete Ve[Nt],Ve[Lt]=Qt,Ce[Qt].geometry[0].pop(),Ce[Qt].geometry[0]=Ce[Qt].geometry[0].concat(kt[0]),Qt}function Ht(Nt,Lt,kt){const Qt=ke[Lt];return delete ke[Lt],ke[Nt]=Qt,Ce[Qt].geometry[0].shift(),Ce[Qt].geometry[0]=kt[0].concat(Ce[Qt].geometry[0]),Qt}function ti(Nt,Lt,kt){const Qt=kt?Lt[0][Lt[0].length-1]:Lt[0][0];return`${Nt}:${Qt.x}:${Qt.y}`}for(let Nt=0;Nt<me.length;Nt++){const Lt=me[Nt],kt=Lt.geometry,Qt=Lt.text?Lt.text.toString():null;if(!Qt){it(Nt);continue}const At=ti(Qt,kt),yt=ti(Qt,kt,!0);if(At in Ve&&yt in ke&&Ve[At]!==ke[yt]){const hi=Ht(At,yt,kt),ai=ot(At,yt,Ce[hi].geometry);delete ke[At],delete Ve[yt],Ve[ti(Qt,Ce[ai].geometry,!0)]=ai,Ce[hi].geometry=null}else At in Ve?ot(At,yt,kt):yt in ke?Ht(At,yt,kt):(it(Nt),ke[At]=Be-1,Ve[yt]=Be-1)}return Ce.filter(Nt=>Nt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((me,ke)=>me.sortKey-ke.sortKey)}update(a,h,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,h,this.layers,f),this.icon.programConfigurations.updatePaintArrays(a,h,this.layers,f))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,h){const f=this.lineVertexArray.length;if(a.segment!==void 0){let y=a.dist(h[a.segment+1]),w=a.dist(h[a.segment]);const k={};for(let D=a.segment+1;D<h.length;D++)k[D]={x:h[D].x,y:h[D].y,tileUnitDistanceFromAnchor:y},D<h.length-1&&(y+=h[D+1].dist(h[D]));for(let D=a.segment||0;D>=0;D--)k[D]={x:h[D].x,y:h[D].y,tileUnitDistanceFromAnchor:w},D>0&&(w+=h[D-1].dist(h[D]));for(let D=0;D<h.length;D++){const P=k[D];this.lineVertexArray.emplaceBack(P.x,P.y,P.tileUnitDistanceFromAnchor)}}return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(a,h,f,y,w,k,D,P,E,B,H,K){const ee=a.indexArray,ne=a.layoutVertexArray,ue=a.segments.prepareSegment(4*h.length,ne,ee,this.canOverlap?k.sortKey:void 0),me=this.glyphOffsetArray.length,ke=ue.vertexLength,Ve=this.allowVerticalPlacement&&D===u.ah.vertical?Math.PI/2:0,Ce=k.text&&k.text.sections;for(let Be=0;Be<h.length;Be++){const{tl:it,tr:ot,bl:Ht,br:ti,tex:Nt,pixelOffsetTL:Lt,pixelOffsetBR:kt,minFontScaleX:Qt,minFontScaleY:At,glyphOffset:yt,isSDF:hi,sectionIndex:ai}=h[Be],qi=ue.vertexLength,Bn=yt[1];Nh(ne,P.x,P.y,it.x,Bn+it.y,Nt.x,Nt.y,f,hi,Lt.x,Lt.y,Qt,At),Nh(ne,P.x,P.y,ot.x,Bn+ot.y,Nt.x+Nt.w,Nt.y,f,hi,kt.x,Lt.y,Qt,At),Nh(ne,P.x,P.y,Ht.x,Bn+Ht.y,Nt.x,Nt.y+Nt.h,f,hi,Lt.x,kt.y,Qt,At),Nh(ne,P.x,P.y,ti.x,Bn+ti.y,Nt.x+Nt.w,Nt.y+Nt.h,f,hi,kt.x,kt.y,Qt,At),Bf(a.dynamicLayoutVertexArray,P,Ve),ee.emplaceBack(qi,qi+1,qi+2),ee.emplaceBack(qi+1,qi+2,qi+3),ue.vertexLength+=4,ue.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(yt[0]),Be!==h.length-1&&ai===h[Be+1].sectionIndex||a.programConfigurations.populatePaintArrays(ne.length,k,k.index,{},K,Ce&&Ce[ai])}a.placedSymbolArray.emplaceBack(P.x,P.y,me,this.glyphOffsetArray.length-me,ke,E,B,P.segment,f?f[0]:0,f?f[1]:0,y[0],y[1],D,0,!1,0,H)}_addCollisionDebugVertex(a,h,f,y,w,k){return h.emplaceBack(0,0),a.emplaceBack(f.x,f.y,y,w,Math.round(k.x),Math.round(k.y))}addCollisionDebugVertices(a,h,f,y,w,k,D){const P=w.segments.prepareSegment(4,w.layoutVertexArray,w.indexArray),E=P.vertexLength,B=w.layoutVertexArray,H=w.collisionVertexArray,K=D.anchorX,ee=D.anchorY;this._addCollisionDebugVertex(B,H,k,K,ee,new M(a,h)),this._addCollisionDebugVertex(B,H,k,K,ee,new M(f,h)),this._addCollisionDebugVertex(B,H,k,K,ee,new M(f,y)),this._addCollisionDebugVertex(B,H,k,K,ee,new M(a,y)),P.vertexLength+=4;const ne=w.indexArray;ne.emplaceBack(E,E+1),ne.emplaceBack(E+1,E+2),ne.emplaceBack(E+2,E+3),ne.emplaceBack(E+3,E),P.primitiveLength+=4}addDebugCollisionBoxes(a,h,f,y){for(let w=a;w<h;w++){const k=this.collisionBoxArray.get(w);this.addCollisionDebugVertices(k.x1,k.y1,k.x2,k.y2,y?this.textCollisionBox:this.iconCollisionBox,k.anchorPoint,f)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Vf(Ne,v1.members,Je),this.iconCollisionBox=new Vf(Ne,v1.members,Je);for(let a=0;a<this.symbolInstances.length;a++){const h=this.symbolInstances.get(a);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(a,h,f,y,w,k,D,P,E){const B={};for(let H=h;H<f;H++){const K=a.get(H);B.textBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},B.textFeatureIndex=K.featureIndex;break}for(let H=y;H<w;H++){const K=a.get(H);B.verticalTextBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},B.verticalTextFeatureIndex=K.featureIndex;break}for(let H=k;H<D;H++){const K=a.get(H);B.iconBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},B.iconFeatureIndex=K.featureIndex;break}for(let H=P;H<E;H++){const K=a.get(H);B.verticalIconBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},B.verticalIconFeatureIndex=K.featureIndex;break}return B}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const f=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(a,h){const f=a.placedSymbolArray.get(h),y=f.vertexStartIndex+4*f.numGlyphs;for(let w=f.vertexStartIndex;w<y;w+=4)a.indexArray.emplaceBack(w,w+1,w+2),a.indexArray.emplaceBack(w+1,w+2,w+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(a),f=Math.cos(a),y=[],w=[],k=[];for(let D=0;D<this.symbolInstances.length;++D){k.push(D);const P=this.symbolInstances.get(D);y.push(0|Math.round(h*P.anchorX+f*P.anchorY)),w.push(P.featureIndex)}return k.sort((D,P)=>y[D]-y[P]||w[P]-w[D]),k}addToSortKeyRanges(a,h){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===h?f.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const f=this.symbolInstances.get(h);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach((y,w,k)=>{y>=0&&k.indexOf(y)===w&&this.addIndicesForPlacedSymbol(this.text,y)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let O1,B1;Yt("SymbolBucket",ql,{omit:["layers","collisionBoxArray","features","compareText"]}),ql.MAX_GLYPHS=65535,ql.addDynamicAttributes=Bf;var Hf={get paint(){return B1=B1||new or({"icon-opacity":new yi(je.paint_symbol["icon-opacity"]),"icon-color":new yi(je.paint_symbol["icon-color"]),"icon-halo-color":new yi(je.paint_symbol["icon-halo-color"]),"icon-halo-width":new yi(je.paint_symbol["icon-halo-width"]),"icon-halo-blur":new yi(je.paint_symbol["icon-halo-blur"]),"icon-translate":new ri(je.paint_symbol["icon-translate"]),"icon-translate-anchor":new ri(je.paint_symbol["icon-translate-anchor"]),"text-opacity":new yi(je.paint_symbol["text-opacity"]),"text-color":new yi(je.paint_symbol["text-color"],{runtimeType:on,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new yi(je.paint_symbol["text-halo-color"]),"text-halo-width":new yi(je.paint_symbol["text-halo-width"]),"text-halo-blur":new yi(je.paint_symbol["text-halo-blur"]),"text-translate":new ri(je.paint_symbol["text-translate"]),"text-translate-anchor":new ri(je.paint_symbol["text-translate-anchor"])})},get layout(){return O1=O1||new or({"symbol-placement":new ri(je.layout_symbol["symbol-placement"]),"symbol-spacing":new ri(je.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ri(je.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new yi(je.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ri(je.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ri(je.layout_symbol["icon-allow-overlap"]),"icon-overlap":new ri(je.layout_symbol["icon-overlap"]),"icon-ignore-placement":new ri(je.layout_symbol["icon-ignore-placement"]),"icon-optional":new ri(je.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ri(je.layout_symbol["icon-rotation-alignment"]),"icon-size":new yi(je.layout_symbol["icon-size"]),"icon-text-fit":new ri(je.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ri(je.layout_symbol["icon-text-fit-padding"]),"icon-image":new yi(je.layout_symbol["icon-image"]),"icon-rotate":new yi(je.layout_symbol["icon-rotate"]),"icon-padding":new yi(je.layout_symbol["icon-padding"]),"icon-keep-upright":new ri(je.layout_symbol["icon-keep-upright"]),"icon-offset":new yi(je.layout_symbol["icon-offset"]),"icon-anchor":new yi(je.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ri(je.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ri(je.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ri(je.layout_symbol["text-rotation-alignment"]),"text-field":new yi(je.layout_symbol["text-field"]),"text-font":new yi(je.layout_symbol["text-font"]),"text-size":new yi(je.layout_symbol["text-size"]),"text-max-width":new yi(je.layout_symbol["text-max-width"]),"text-line-height":new ri(je.layout_symbol["text-line-height"]),"text-letter-spacing":new yi(je.layout_symbol["text-letter-spacing"]),"text-justify":new yi(je.layout_symbol["text-justify"]),"text-radial-offset":new yi(je.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ri(je.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new yi(je.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new yi(je.layout_symbol["text-anchor"]),"text-max-angle":new ri(je.layout_symbol["text-max-angle"]),"text-writing-mode":new ri(je.layout_symbol["text-writing-mode"]),"text-rotate":new yi(je.layout_symbol["text-rotate"]),"text-padding":new ri(je.layout_symbol["text-padding"]),"text-keep-upright":new ri(je.layout_symbol["text-keep-upright"]),"text-transform":new yi(je.layout_symbol["text-transform"]),"text-offset":new yi(je.layout_symbol["text-offset"]),"text-allow-overlap":new ri(je.layout_symbol["text-allow-overlap"]),"text-overlap":new ri(je.layout_symbol["text-overlap"]),"text-ignore-placement":new ri(je.layout_symbol["text-ignore-placement"]),"text-optional":new ri(je.layout_symbol["text-optional"])})}};class N1{constructor(a){if(a.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=a.property.overrides?a.property.overrides.runtimeType:Ii,this.defaultValue=a}evaluate(a){if(a.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(a.formattedSection))return h.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Yt("FormatSectionOverride",N1,{omit:["defaultValue"]});class Vh extends Or{constructor(a){super(a,Hf)}recalculate(a,h){if(super.recalculate(a,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const f=this.layout.get("text-writing-mode");if(f){const y=[];for(const w of f)y.indexOf(w)<0&&y.push(w);this.layout._values["text-writing-mode"]=y}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(a,h,f,y){const w=this.layout.get(a).evaluate(h,{},f,y),k=this._unevaluatedLayout._values[a];return k.isDataDriven()||En(k.value)||!w?w:function(D,P){return P.replace(/{([^{}]+)}/g,(E,B)=>D&&B in D?String(D[B]):"")}(h.properties,w)}createBucket(a){return new ql(a)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const a of Hf.paint.overridableProperties){if(!Vh.hasPaintOverride(this.layout,a))continue;const h=this.paint.get(a),f=new N1(h),y=new Wo(f,h.property.specification);let w=null;w=h.value.kind==="constant"||h.value.kind==="source"?new fo("source",y):new wl("composite",y,h.value.zoomStops),this.paint._values[a]=new Fr(h.property,w,h.parameters)}}_handleOverridablePaintPropertyUpdate(a,h,f){return!(!this.layout||h.isDataDriven()||f.isDataDriven())&&Vh.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,h){const f=a.get("text-field"),y=Hf.paint.properties[h];let w=!1;const k=D=>{for(const P of D)if(y.overrides&&y.overrides.hasOverride(P))return void(w=!0)};if(f.value.kind==="constant"&&f.value.value instanceof In)k(f.value.value.sections);else if(f.value.kind==="source"){const D=E=>{w||(E instanceof xr&&Tn(E.value)===ji?k(E.value.sections):E instanceof xl?k(E.sections):E.eachChild(D))},P=f.value;P._styleExpression&&D(P._styleExpression.expression)}return w}}let V1;var qv={get paint(){return V1=V1||new or({"background-color":new ri(je.paint_background["background-color"]),"background-pattern":new Rc(je.paint_background["background-pattern"]),"background-opacity":new ri(je.paint_background["background-opacity"])})}};class Zv extends Or{constructor(a){super(a,qv)}}let H1;var Gv={get paint(){return H1=H1||new or({"raster-opacity":new ri(je.paint_raster["raster-opacity"]),"raster-hue-rotate":new ri(je.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ri(je.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ri(je.paint_raster["raster-brightness-max"]),"raster-saturation":new ri(je.paint_raster["raster-saturation"]),"raster-contrast":new ri(je.paint_raster["raster-contrast"]),"raster-resampling":new ri(je.paint_raster["raster-resampling"]),"raster-fade-duration":new ri(je.paint_raster["raster-fade-duration"])})}};class $v extends Or{constructor(a){super(a,Gv)}}class Kv extends Or{constructor(a){super(a,{}),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=a}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Yv{constructor(a){this._methodToThrottle=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const jf=63710088e-1;class Co{constructor(a,h){if(isNaN(a)||isNaN(h))throw new Error(`Invalid LngLat object: (${a}, ${h})`);if(this.lng=+a,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Co(Oe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){const h=Math.PI/180,f=this.lat*h,y=a.lat*h,w=Math.sin(f)*Math.sin(y)+Math.cos(f)*Math.cos(y)*Math.cos((a.lng-this.lng)*h);return jf*Math.acos(Math.min(w,1))}static convert(a){if(a instanceof Co)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new Co(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new Co(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const j1=2*Math.PI*jf;function U1(l){return j1*Math.cos(l*Math.PI/180)}function W1(l){return(180+l)/360}function q1(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function Z1(l,a){return l/U1(a)}function Uf(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}class Hh{constructor(a,h,f=0){this.x=+a,this.y=+h,this.z=+f}static fromLngLat(a,h=0){const f=Co.convert(a);return new Hh(W1(f.lng),q1(f.lat),Z1(h,f.lat))}toLngLat(){return new Co(360*this.x-180,Uf(this.y))}toAltitude(){return this.z*U1(Uf(this.y))}meterInMercatorCoordinateUnits(){return 1/j1*(a=Uf(this.y),1/Math.cos(a*Math.PI/180));var a}}function G1(l,a,h){var f=2*Math.PI*6378137/256/Math.pow(2,h);return[l*f-2*Math.PI*6378137/2,a*f-2*Math.PI*6378137/2]}class Wf{constructor(a,h,f){if(a<0||a>25||f<0||f>=Math.pow(2,a)||h<0||h>=Math.pow(2,a))throw new Error(`x=${h}, y=${f}, z=${a} outside of bounds. 0<=x<${Math.pow(2,a)}, 0<=y<${Math.pow(2,a)} 0<=z<=25 `);this.z=a,this.x=h,this.y=f,this.key=lu(0,a,a,h,f)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,h,f){const y=(k=this.y,D=this.z,P=G1(256*(w=this.x),256*(k=Math.pow(2,D)-k-1),D),E=G1(256*(w+1),256*(k+1),D),P[0]+","+P[1]+","+E[0]+","+E[1]);var w,k,D,P,E;const B=function(H,K,ee){let ne,ue="";for(let me=H;me>0;me--)ne=1<<me-1,ue+=(K&ne?1:0)+(ee&ne?2:0);return ue}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(f==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,B).replace(/{bbox-epsg-3857}/g,y)}isChildOf(a){const h=this.z-a.z;return h>0&&a.x===this.x>>h&&a.y===this.y>>h}getTilePoint(a){const h=Math.pow(2,this.z);return new M((a.x*h-this.x)*Xi,(a.y*h-this.y)*Xi)}toString(){return`${this.z}/${this.x}/${this.y}`}}class $1{constructor(a,h){this.wrap=a,this.canonical=h,this.key=lu(a,h.z,h.z,h.x,h.y)}}class Hr{constructor(a,h,f,y,w){if(a<f)throw new Error(`overscaledZ should be >= z; overscaledZ = ${a}; z = ${f}`);this.overscaledZ=a,this.wrap=h,this.canonical=new Wf(f,+y,+w),this.key=lu(h,a,f,y,w)}clone(){return new Hr(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-a;return a>this.canonical.z?new Hr(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Hr(a,this.wrap,a,this.canonical.x>>h,this.canonical.y>>h)}calculateScaledKey(a,h){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-a;return a>this.canonical.z?lu(this.wrap*+h,a,this.canonical.z,this.canonical.x,this.canonical.y):lu(this.wrap*+h,a,a,this.canonical.x>>f,this.canonical.y>>f)}isChildOf(a){if(a.wrap!==this.wrap)return!1;const h=this.canonical.z-a.canonical.z;return a.overscaledZ===0||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>h&&a.canonical.y===this.canonical.y>>h}children(a){if(this.overscaledZ>=a)return[new Hr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,f=2*this.canonical.x,y=2*this.canonical.y;return[new Hr(h,this.wrap,h,f,y),new Hr(h,this.wrap,h,f+1,y),new Hr(h,this.wrap,h,f,y+1),new Hr(h,this.wrap,h,f+1,y+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new Hr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new Hr(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new $1(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(a){return this.canonical.getTilePoint(new Hh(a.x-this.wrap,a.y))}}function lu(l,a,h,f,y){(l*=2)<0&&(l=-1*l-1);const w=1<<h;return(w*w*l+w*y+f).toString(36)+h.toString(36)+a.toString(36)}Yt("CanonicalTileID",Wf),Yt("OverscaledTileID",Hr,{omit:["posMatrix"]});class K1{constructor(a,h,f,y=1,w=1,k=1,D=0){if(this.uid=a,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(f&&!["mapbox","terrarium","custom"].includes(f))return void Xe(`"${f}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=h.height;const P=this.dim=h.height-2;switch(this.data=new Uint32Array(h.data.buffer),f){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=y,this.greenFactor=w,this.blueFactor=k,this.baseShift=D;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let E=0;E<P;E++)this.data[this._idx(-1,E)]=this.data[this._idx(0,E)],this.data[this._idx(P,E)]=this.data[this._idx(P-1,E)],this.data[this._idx(E,-1)]=this.data[this._idx(E,0)],this.data[this._idx(E,P)]=this.data[this._idx(E,P-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(P,-1)]=this.data[this._idx(P-1,0)],this.data[this._idx(-1,P)]=this.data[this._idx(0,P-1)],this.data[this._idx(P,P)]=this.data[this._idx(P-1,P-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let E=0;E<P;E++)for(let B=0;B<P;B++){const H=this.get(E,B);H>this.max&&(this.max=H),H<this.min&&(this.min=H)}}get(a,h){const f=new Uint8Array(this.data.buffer),y=4*this._idx(a,h);return this.unpack(f[y],f[y+1],f[y+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(a,h){if(a<-1||a>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(a+1)}unpack(a,h,f){return a*this.redFactor+h*this.greenFactor+f*this.blueFactor-this.baseShift}getPixels(){return new Vr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(a,h,f){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let y=h*this.dim,w=h*this.dim+this.dim,k=f*this.dim,D=f*this.dim+this.dim;switch(h){case-1:y=w-1;break;case 1:w=y+1}switch(f){case-1:k=D-1;break;case 1:D=k+1}const P=-h*this.dim,E=-f*this.dim;for(let B=k;B<D;B++)for(let H=y;H<w;H++)this.data[this._idx(H,B)]=a.data[this._idx(H+P,B+E)]}}Yt("DEMData",K1);class Y1{constructor(a){this._stringToNumber={},this._numberToString=[];for(let h=0;h<a.length;h++){const f=a[h];this._stringToNumber[f]=h,this._numberToString[h]=f}}encode(a){return this._stringToNumber[a]}decode(a){if(a>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${a} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[a]}}class J1{constructor(a,h,f,y,w){this.type="Feature",this._vectorTileFeature=a,a._z=h,a._x=f,a._y=y,this.properties=a.properties,this.id=w}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){const a={geometry:this.geometry};for(const h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&(a[h]=this[h]);return a}}class X1{constructor(a,h){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new cs(Xi,16,0),this.grid3D=new cs(Xi,16,0),this.featureIndexArray=new F,this.promoteId=h}insert(a,h,f,y,w,k){const D=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,y,w);const P=k?this.grid3D:this.grid;for(let E=0;E<h.length;E++){const B=h[E],H=[1/0,1/0,-1/0,-1/0];for(let K=0;K<B.length;K++){const ee=B[K];H[0]=Math.min(H[0],ee.x),H[1]=Math.min(H[1],ee.y),H[2]=Math.max(H[2],ee.x),H[3]=Math.max(H[3],ee.y)}H[0]<Xi&&H[1]<Xi&&H[2]>=0&&H[3]>=0&&P.insert(D,H[0],H[1],H[2],H[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Mo.VectorTile(new Ef(this.rawTileData)).layers,this.sourceLayerCoder=new Y1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(a,h,f,y){this.loadVTLayers();const w=a.params||{},k=Xi/a.tileSize/a.scale,D=Ml(w.filter),P=a.queryGeometry,E=a.queryPadding*k,B=eg(P),H=this.grid.query(B.minX-E,B.minY-E,B.maxX+E,B.maxY+E),K=eg(a.cameraQueryGeometry),ee=this.grid3D.query(K.minX-E,K.minY-E,K.maxX+E,K.maxY+E,(me,ke,Ve,Ce)=>function(Be,it,ot,Ht,ti){for(const Lt of Be)if(it<=Lt.x&&ot<=Lt.y&&Ht>=Lt.x&&ti>=Lt.y)return!0;const Nt=[new M(it,ot),new M(it,ti),new M(Ht,ti),new M(Ht,ot)];if(Be.length>2){for(const Lt of Nt)if(Bl(Be,Lt))return!0}for(let Lt=0;Lt<Be.length-1;Lt++)if(Cb(Be[Lt],Be[Lt+1],Nt))return!0;return!1}(a.cameraQueryGeometry,me-E,ke-E,Ve+E,Ce+E));for(const me of ee)H.push(me);H.sort(Jv);const ne={};let ue;for(let me=0;me<H.length;me++){const ke=H[me];if(ke===ue)continue;ue=ke;const Ve=this.featureIndexArray.get(ke);let Ce=null;this.loadMatchingFeature(ne,Ve.bucketIndex,Ve.sourceLayerIndex,Ve.featureIndex,D,w.layers,w.availableImages,h,f,y,(Be,it,ot)=>(Ce||(Ce=qs(Be)),it.queryIntersectsFeature(P,Be,ot,Ce,this.z,a.transform,k,a.pixelPosMatrix)))}return ne}loadMatchingFeature(a,h,f,y,w,k,D,P,E,B,H){const K=this.bucketLayerIDs[h];if(k&&!function(me,ke){for(let Ve=0;Ve<me.length;Ve++)if(ke.indexOf(me[Ve])>=0)return!0;return!1}(k,K))return;const ee=this.sourceLayerCoder.decode(f),ne=this.vtLayers[ee].feature(y);if(w.needGeometry){const me=Zs(ne,!0);if(!w.filter(new Fn(this.tileID.overscaledZ),me,this.tileID.canonical))return}else if(!w.filter(new Fn(this.tileID.overscaledZ),ne))return;const ue=this.getId(ne,ee);for(let me=0;me<K.length;me++){const ke=K[me];if(k&&k.indexOf(ke)<0)continue;const Ve=P[ke];if(!Ve)continue;let Ce={};ue&&B&&(Ce=B.getState(Ve.sourceLayer||"_geojsonTileLayer",ue));const Be=Pe({},E[ke]);Be.paint=Q1(Be.paint,Ve.paint,ne,Ce,D),Be.layout=Q1(Be.layout,Ve.layout,ne,Ce,D);const it=!H||H(ne,Ve,Ce);if(!it)continue;const ot=new J1(ne,this.z,this.x,this.y,ue);ot.layer=Be;let Ht=a[ke];Ht===void 0&&(Ht=a[ke]=[]),Ht.push({featureIndex:y,feature:ot,intersectionZ:it})}}lookupSymbolFeatures(a,h,f,y,w,k,D,P){const E={};this.loadVTLayers();const B=Ml(w);for(const H of a)this.loadMatchingFeature(E,f,y,H,B,k,D,P,h);return E}hasLayer(a){for(const h of this.bucketLayerIDs)for(const f of h)if(a===f)return!0;return!1}getId(a,h){let f=a.id;return this.promoteId&&(f=a.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof f=="boolean"&&(f=Number(f))),f}}function Q1(l,a,h,f,y){return _e(l,(w,k)=>{const D=a instanceof Ko?a.get(k):null;return D&&D.evaluate?D.evaluate(h,f,y):D})}function eg(l){let a=1/0,h=1/0,f=-1/0,y=-1/0;for(const w of l)a=Math.min(a,w.x),h=Math.min(h,w.y),f=Math.max(f,w.x),y=Math.max(y,w.y);return{minX:a,minY:h,maxX:f,maxY:y}}function Jv(l,a){return a-l}function tg(l,a,h,f,y){const w=[];for(let k=0;k<l.length;k++){const D=l[k];let P;for(let E=0;E<D.length-1;E++){let B=D[E],H=D[E+1];B.x<a&&H.x<a||(B.x<a?B=new M(a,B.y+(a-B.x)/(H.x-B.x)*(H.y-B.y))._round():H.x<a&&(H=new M(a,B.y+(a-B.x)/(H.x-B.x)*(H.y-B.y))._round()),B.y<h&&H.y<h||(B.y<h?B=new M(B.x+(h-B.y)/(H.y-B.y)*(H.x-B.x),h)._round():H.y<h&&(H=new M(B.x+(h-B.y)/(H.y-B.y)*(H.x-B.x),h)._round()),B.x>=f&&H.x>=f||(B.x>=f?B=new M(f,B.y+(f-B.x)/(H.x-B.x)*(H.y-B.y))._round():H.x>=f&&(H=new M(f,B.y+(f-B.x)/(H.x-B.x)*(H.y-B.y))._round()),B.y>=y&&H.y>=y||(B.y>=y?B=new M(B.x+(y-B.y)/(H.y-B.y)*(H.x-B.x),y)._round():H.y>=y&&(H=new M(B.x+(y-B.y)/(H.y-B.y)*(H.x-B.x),y)._round()),P&&B.equals(P[P.length-1])||(P=[B],w.push(P)),P.push(H)))))}}return w}Yt("FeatureIndex",X1,{omit:["rawTileData","sourceLayerCoder"]});class Po extends M{constructor(a,h,f,y){super(a,h),this.angle=f,y!==void 0&&(this.segment=y)}clone(){return new Po(this.x,this.y,this.angle,this.segment)}}function ig(l,a,h,f,y){if(a.segment===void 0||h===0)return!0;let w=a,k=a.segment+1,D=0;for(;D>-h/2;){if(k--,k<0)return!1;D-=l[k].dist(w),w=l[k]}D+=l[k].dist(l[k+1]),k++;const P=[];let E=0;for(;D<h/2;){const B=l[k],H=l[k+1];if(!H)return!1;let K=l[k-1].angleTo(B)-B.angleTo(H);for(K=Math.abs((K+3*Math.PI)%(2*Math.PI)-Math.PI),P.push({distance:D,angleDelta:K}),E+=K;D-P[0].distance>f;)E-=P.shift().angleDelta;if(E>y)return!1;k++,D+=B.dist(H)}return!0}function ng(l){let a=0;for(let h=0;h<l.length-1;h++)a+=l[h].dist(l[h+1]);return a}function ag(l,a,h){return l?.6*a*h:0}function rg(l,a){return Math.max(l?l.right-l.left:0,a?a.right-a.left:0)}function Xv(l,a,h,f,y,w){const k=ag(h,y,w),D=rg(h,f)*w;let P=0;const E=ng(l)/2;for(let B=0;B<l.length-1;B++){const H=l[B],K=l[B+1],ee=H.dist(K);if(P+ee>E){const ne=(E-P)/ee,ue=Xa.number(H.x,K.x,ne),me=Xa.number(H.y,K.y,ne),ke=new Po(ue,me,K.angleTo(H),B);return ke._round(),!k||ig(l,ke,D,k,a)?ke:void 0}P+=ee}}function Qv(l,a,h,f,y,w,k,D,P){const E=ag(f,w,k),B=rg(f,y),H=B*k,K=l[0].x===0||l[0].x===P||l[0].y===0||l[0].y===P;return a-H<a/4&&(a=H+a/4),sg(l,K?a/2*D%a:(B/2+2*w)*k*D%a,a,E,h,H,K,!1,P)}function sg(l,a,h,f,y,w,k,D,P){const E=w/2,B=ng(l);let H=0,K=a-h,ee=[];for(let ne=0;ne<l.length-1;ne++){const ue=l[ne],me=l[ne+1],ke=ue.dist(me),Ve=me.angleTo(ue);for(;K+h<H+ke;){K+=h;const Ce=(K-H)/ke,Be=Xa.number(ue.x,me.x,Ce),it=Xa.number(ue.y,me.y,Ce);if(Be>=0&&Be<P&&it>=0&&it<P&&K-E>=0&&K+E<=B){const ot=new Po(Be,it,Ve,ne);ot._round(),f&&!ig(l,ot,w,f,y)||ee.push(ot)}}H+=ke}return D||ee.length||k||(ee=sg(l,H/2,h,f,y,w,k,!0,P)),ee}Yt("Anchor",Po);const Zl=Sr;function og(l,a,h,f){const y=[],w=l.image,k=w.pixelRatio,D=w.paddedRect.w-2*Zl,P=w.paddedRect.h-2*Zl,E=l.right-l.left,B=l.bottom-l.top,H=w.stretchX||[[0,D]],K=w.stretchY||[[0,P]],ee=(kt,Qt)=>kt+Qt[1]-Qt[0],ne=H.reduce(ee,0),ue=K.reduce(ee,0),me=D-ne,ke=P-ue;let Ve=0,Ce=ne,Be=0,it=ue,ot=0,Ht=me,ti=0,Nt=ke;if(w.content&&f){const kt=w.content;Ve=jh(H,0,kt[0]),Be=jh(K,0,kt[1]),Ce=jh(H,kt[0],kt[2]),it=jh(K,kt[1],kt[3]),ot=kt[0]-Ve,ti=kt[1]-Be,Ht=kt[2]-kt[0]-Ce,Nt=kt[3]-kt[1]-it}const Lt=(kt,Qt,At,yt)=>{const hi=Uh(kt.stretch-Ve,Ce,E,l.left),ai=Wh(kt.fixed-ot,Ht,kt.stretch,ne),qi=Uh(Qt.stretch-Be,it,B,l.top),Bn=Wh(Qt.fixed-ti,Nt,Qt.stretch,ue),Zn=Uh(At.stretch-Ve,Ce,E,l.left),Sa=Wh(At.fixed-ot,Ht,At.stretch,ne),Ar=Uh(yt.stretch-Be,it,B,l.top),ur=Wh(yt.fixed-ti,Nt,yt.stretch,ue),_a=new M(hi,qi),ja=new M(Zn,qi),$a=new M(Zn,Ar),hr=new M(hi,Ar),dr=new M(ai/k,Bn/k),Ma=new M(Sa/k,ur/k),Da=a*Math.PI/180;if(Da){const er=Math.sin(Da),Mr=Math.cos(Da),Dr=[Mr,-er,er,Mr];_a._matMult(Dr),ja._matMult(Dr),hr._matMult(Dr),$a._matMult(Dr)}const Qa=kt.stretch+kt.fixed,fr=Qt.stretch+Qt.fixed;return{tl:_a,tr:ja,bl:hr,br:$a,tex:{x:w.paddedRect.x+Zl+Qa,y:w.paddedRect.y+Zl+fr,w:At.stretch+At.fixed-Qa,h:yt.stretch+yt.fixed-fr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:dr,pixelOffsetBR:Ma,minFontScaleX:Ht/k/E,minFontScaleY:Nt/k/B,isSDF:h}};if(f&&(w.stretchX||w.stretchY)){const kt=lg(H,me,ne),Qt=lg(K,ke,ue);for(let At=0;At<kt.length-1;At++){const yt=kt[At],hi=kt[At+1];for(let ai=0;ai<Qt.length-1;ai++)y.push(Lt(yt,Qt[ai],hi,Qt[ai+1]))}}else y.push(Lt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:D+1},{fixed:0,stretch:P+1}));return y}function jh(l,a,h){let f=0;for(const y of l)f+=Math.max(a,Math.min(h,y[1]))-Math.max(a,Math.min(h,y[0]));return f}function lg(l,a,h){const f=[{fixed:-Zl,stretch:0}];for(const[y,w]of l){const k=f[f.length-1];f.push({fixed:y-k.stretch,stretch:k.stretch}),f.push({fixed:y-k.stretch,stretch:k.stretch+(w-y)})}return f.push({fixed:a+Zl,stretch:h}),f}function Uh(l,a,h,f){return l/a*h+f}function Wh(l,a,h,f){return l-a*h/f}class qh{constructor(a,h,f,y,w,k,D,P,E,B){if(this.boxStartIndex=a.length,E){let H=k.top,K=k.bottom;const ee=k.collisionPadding;ee&&(H-=ee[1],K+=ee[3]);let ne=K-H;ne>0&&(ne=Math.max(10,ne),this.circleDiameter=ne)}else{let H=k.top*D-P[0],K=k.bottom*D+P[2],ee=k.left*D-P[3],ne=k.right*D+P[1];const ue=k.collisionPadding;if(ue&&(ee-=ue[0]*D,H-=ue[1]*D,ne+=ue[2]*D,K+=ue[3]*D),B){const me=new M(ee,H),ke=new M(ne,H),Ve=new M(ee,K),Ce=new M(ne,K),Be=B*Math.PI/180;me._rotate(Be),ke._rotate(Be),Ve._rotate(Be),Ce._rotate(Be),ee=Math.min(me.x,ke.x,Ve.x,Ce.x),ne=Math.max(me.x,ke.x,Ve.x,Ce.x),H=Math.min(me.y,ke.y,Ve.y,Ce.y),K=Math.max(me.y,ke.y,Ve.y,Ce.y)}a.emplaceBack(h.x,h.y,ee,H,ne,K,f,y,w)}this.boxEndIndex=a.length}}class ex{constructor(a=[],h=tx){if(this.data=a,this.length=this.data.length,this.compare=h,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(a){this.data.push(a),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const a=this.data[0],h=this.data.pop();return this.length--,this.length>0&&(this.data[0]=h,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:h,compare:f}=this,y=h[a];for(;a>0;){const w=a-1>>1,k=h[w];if(f(y,k)>=0)break;h[a]=k,a=w}h[a]=y}_down(a){const{data:h,compare:f}=this,y=this.length>>1,w=h[a];for(;a<y;){let k=1+(a<<1),D=h[k];const P=k+1;if(P<this.length&&f(h[P],D)<0&&(k=P,D=h[P]),f(D,w)>=0)break;h[a]=D,a=k}h[a]=w}}function tx(l,a){return l<a?-1:l>a?1:0}function ix(l,a=1,h=!1){let f=1/0,y=1/0,w=-1/0,k=-1/0;const D=l[0];for(let ee=0;ee<D.length;ee++){const ne=D[ee];(!ee||ne.x<f)&&(f=ne.x),(!ee||ne.y<y)&&(y=ne.y),(!ee||ne.x>w)&&(w=ne.x),(!ee||ne.y>k)&&(k=ne.y)}const P=Math.min(w-f,k-y);let E=P/2;const B=new ex([],nx);if(P===0)return new M(f,y);for(let ee=f;ee<w;ee+=P)for(let ne=y;ne<k;ne+=P)B.push(new Gl(ee+E,ne+E,E,l));let H=function(ee){let ne=0,ue=0,me=0;const ke=ee[0];for(let Ve=0,Ce=ke.length,Be=Ce-1;Ve<Ce;Be=Ve++){const it=ke[Ve],ot=ke[Be],Ht=it.x*ot.y-ot.x*it.y;ue+=(it.x+ot.x)*Ht,me+=(it.y+ot.y)*Ht,ne+=3*Ht}return new Gl(ue/ne,me/ne,0,ee)}(l),K=B.length;for(;B.length;){const ee=B.pop();(ee.d>H.d||!H.d)&&(H=ee,h&&console.log("found best %d after %d probes",Math.round(1e4*ee.d)/1e4,K)),ee.max-H.d<=a||(E=ee.h/2,B.push(new Gl(ee.p.x-E,ee.p.y-E,E,l)),B.push(new Gl(ee.p.x+E,ee.p.y-E,E,l)),B.push(new Gl(ee.p.x-E,ee.p.y+E,E,l)),B.push(new Gl(ee.p.x+E,ee.p.y+E,E,l)),K+=4)}return h&&(console.log(`num probes: ${K}`),console.log(`best distance: ${H.d}`)),H.p}function nx(l,a){return a.max-l.max}function Gl(l,a,h,f){this.p=new M(l,a),this.h=h,this.d=function(y,w){let k=!1,D=1/0;for(let P=0;P<w.length;P++){const E=w[P];for(let B=0,H=E.length,K=H-1;B<H;K=B++){const ee=E[B],ne=E[K];ee.y>y.y!=ne.y>y.y&&y.x<(ne.x-ee.x)*(y.y-ee.y)/(ne.y-ee.y)+ee.x&&(k=!k),D=Math.min(D,qm(y,ee,ne))}}return(k?1:-1)*Math.sqrt(D)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}var Ga;u.ap=void 0,(Ga=u.ap||(u.ap={}))[Ga.center=1]="center",Ga[Ga.left=2]="left",Ga[Ga.right=3]="right",Ga[Ga.top=4]="top",Ga[Ga.bottom=5]="bottom",Ga[Ga["top-left"]=6]="top-left",Ga[Ga["top-right"]=7]="top-right",Ga[Ga["bottom-left"]=8]="bottom-left",Ga[Ga["bottom-right"]=9]="bottom-right";const Ao=7,qf=Number.POSITIVE_INFINITY;function cg(l,a){return a[1]!==qf?function(h,f,y){let w=0,k=0;switch(f=Math.abs(f),y=Math.abs(y),h){case"top-right":case"top-left":case"top":k=y-Ao;break;case"bottom-right":case"bottom-left":case"bottom":k=-y+Ao}switch(h){case"top-right":case"bottom-right":case"right":w=-f;break;case"top-left":case"bottom-left":case"left":w=f}return[w,k]}(l,a[0],a[1]):function(h,f){let y=0,w=0;f<0&&(f=0);const k=f/Math.SQRT2;switch(h){case"top-right":case"top-left":w=k-Ao;break;case"bottom-right":case"bottom-left":w=-k+Ao;break;case"bottom":w=-f+Ao;break;case"top":w=f-Ao}switch(h){case"top-right":case"bottom-right":y=-k;break;case"top-left":case"bottom-left":y=k;break;case"left":y=f;break;case"right":y=-f}return[y,w]}(l,a[0])}function ug(l,a,h){var f;const y=l.layout,w=(f=y.get("text-variable-anchor-offset"))===null||f===void 0?void 0:f.evaluate(a,{},h);if(w){const D=w.values,P=[];for(let E=0;E<D.length;E+=2){const B=P[E]=D[E],H=D[E+1].map(K=>K*ka);B.startsWith("top")?H[1]-=Ao:B.startsWith("bottom")&&(H[1]+=Ao),P[E+1]=H}return new la(P)}const k=y.get("text-variable-anchor");if(k){let D;D=l._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[y.get("text-radial-offset").evaluate(a,{},h)*ka,qf]:y.get("text-offset").evaluate(a,{},h).map(E=>E*ka);const P=[];for(const E of k)P.push(E,cg(E,D));return new la(P)}return null}function Zf(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ax(l,a,h,f,y,w,k,D,P,E,B){let H=w.textMaxSize.evaluate(a,{});H===void 0&&(H=k);const K=l.layers[0].layout,ee=K.get("icon-offset").evaluate(a,{},B),ne=dg(h.horizontal),ue=k/24,me=l.tilePixelRatio*ue,ke=l.tilePixelRatio*H/24,Ve=l.tilePixelRatio*D,Ce=l.tilePixelRatio*K.get("symbol-spacing"),Be=K.get("text-padding")*l.tilePixelRatio,it=function(yt,hi,ai,qi=1){const Bn=yt.get("icon-padding").evaluate(hi,{},ai),Zn=Bn&&Bn.values;return[Zn[0]*qi,Zn[1]*qi,Zn[2]*qi,Zn[3]*qi]}(K,a,B,l.tilePixelRatio),ot=K.get("text-max-angle")/180*Math.PI,Ht=K.get("text-rotation-alignment")!=="viewport"&&K.get("symbol-placement")!=="point",ti=K.get("icon-rotation-alignment")==="map"&&K.get("symbol-placement")!=="point",Nt=K.get("symbol-placement"),Lt=Ce/2,kt=K.get("icon-text-fit");let Qt;f&&kt!=="none"&&(l.allowVerticalPlacement&&h.vertical&&(Qt=R1(f,h.vertical,kt,K.get("icon-text-fit-padding"),ee,ue)),ne&&(f=R1(f,ne,kt,K.get("icon-text-fit-padding"),ee,ue)));const At=(yt,hi)=>{hi.x<0||hi.x>=Xi||hi.y<0||hi.y>=Xi||function(ai,qi,Bn,Zn,Sa,Ar,ur,_a,ja,$a,hr,dr,Ma,Da,Qa,fr,er,Mr,Dr,Ta,rn,tr,Ka,Ca,is){const hs=ai.addToLineVertexArray(qi,Bn);let ds,Ks,ns,jr,Tr=0,Ys=0,hu=0,gg=0,ep=-1,tp=-1;const Js={};let _g=Hi("");if(ai.allowVerticalPlacement&&Zn.vertical){const ir=_a.layout.get("text-rotate").evaluate(rn,{},Ca)+90;ns=new qh(ja,qi,$a,hr,dr,Zn.vertical,Ma,Da,Qa,ir),ur&&(jr=new qh(ja,qi,$a,hr,dr,ur,er,Mr,Qa,ir))}if(Sa){const ir=_a.layout.get("icon-rotate").evaluate(rn,{}),Ur=_a.layout.get("icon-text-fit")!=="none",nl=og(Sa,ir,Ka,Ur),ps=ur?og(ur,ir,Ka,Ur):void 0;Ks=new qh(ja,qi,$a,hr,dr,Sa,er,Mr,!1,ir),Tr=4*nl.length;const al=ai.iconSizeData;let Cs=null;al.kind==="source"?(Cs=[Ts*_a.layout.get("icon-size").evaluate(rn,{})],Cs[0]>To&&Xe(`${ai.layerIds[0]}: Value for "icon-size" is >= ${ou}. Reduce your "icon-size".`)):al.kind==="composite"&&(Cs=[Ts*tr.compositeIconSizes[0].evaluate(rn,{},Ca),Ts*tr.compositeIconSizes[1].evaluate(rn,{},Ca)],(Cs[0]>To||Cs[1]>To)&&Xe(`${ai.layerIds[0]}: Value for "icon-size" is >= ${ou}. Reduce your "icon-size".`)),ai.addSymbols(ai.icon,nl,Cs,Ta,Dr,rn,u.ah.none,qi,hs.lineStartIndex,hs.lineLength,-1,Ca),ep=ai.icon.placedSymbolArray.length-1,ps&&(Ys=4*ps.length,ai.addSymbols(ai.icon,ps,Cs,Ta,Dr,rn,u.ah.vertical,qi,hs.lineStartIndex,hs.lineLength,-1,Ca),tp=ai.icon.placedSymbolArray.length-1)}const yg=Object.keys(Zn.horizontal);for(const ir of yg){const Ur=Zn.horizontal[ir];if(!ds){_g=Hi(Ur.text);const ps=_a.layout.get("text-rotate").evaluate(rn,{},Ca);ds=new qh(ja,qi,$a,hr,dr,Ur,Ma,Da,Qa,ps)}const nl=Ur.positionedLines.length===1;if(hu+=hg(ai,qi,Ur,Ar,_a,Qa,rn,fr,hs,Zn.vertical?u.ah.horizontal:u.ah.horizontalOnly,nl?yg:[ir],Js,ep,tr,Ca),nl)break}Zn.vertical&&(gg+=hg(ai,qi,Zn.vertical,Ar,_a,Qa,rn,fr,hs,u.ah.vertical,["vertical"],Js,tp,tr,Ca));const ox=ds?ds.boxStartIndex:ai.collisionBoxArray.length,lx=ds?ds.boxEndIndex:ai.collisionBoxArray.length,cx=ns?ns.boxStartIndex:ai.collisionBoxArray.length,ux=ns?ns.boxEndIndex:ai.collisionBoxArray.length,hx=Ks?Ks.boxStartIndex:ai.collisionBoxArray.length,dx=Ks?Ks.boxEndIndex:ai.collisionBoxArray.length,fx=jr?jr.boxStartIndex:ai.collisionBoxArray.length,px=jr?jr.boxEndIndex:ai.collisionBoxArray.length;let fs=-1;const Gh=(ir,Ur)=>ir&&ir.circleDiameter?Math.max(ir.circleDiameter,Ur):Ur;fs=Gh(ds,fs),fs=Gh(ns,fs),fs=Gh(Ks,fs),fs=Gh(jr,fs);const bg=fs>-1?1:0;bg&&(fs*=is/ka),ai.glyphOffsetArray.length>=ql.MAX_GLYPHS&&Xe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),rn.sortKey!==void 0&&ai.addToSortKeyRanges(ai.symbolInstances.length,rn.sortKey);const mx=ug(_a,rn,Ca),[gx,_x]=function(ir,Ur){const nl=ir.length,ps=Ur==null?void 0:Ur.values;if((ps==null?void 0:ps.length)>0)for(let al=0;al<ps.length;al+=2){const Cs=ps[al+1];ir.emplaceBack(u.ap[ps[al]],Cs[0],Cs[1])}return[nl,ir.length]}(ai.textAnchorOffsets,mx);ai.symbolInstances.emplaceBack(qi.x,qi.y,Js.right>=0?Js.right:-1,Js.center>=0?Js.center:-1,Js.left>=0?Js.left:-1,Js.vertical||-1,ep,tp,_g,ox,lx,cx,ux,hx,dx,fx,px,$a,hu,gg,Tr,Ys,bg,0,Ma,fs,gx,_x)}(l,hi,yt,h,f,y,Qt,l.layers[0],l.collisionBoxArray,a.index,a.sourceLayerIndex,l.index,me,[Be,Be,Be,Be],Ht,P,Ve,it,ti,ee,a,w,E,B,k)};if(Nt==="line")for(const yt of tg(a.geometry,0,0,Xi,Xi)){const hi=Qv(yt,Ce,ot,h.vertical||ne,f,24,ke,l.overscaling,Xi);for(const ai of hi)ne&&rx(l,ne.text,Lt,ai)||At(yt,ai)}else if(Nt==="line-center"){for(const yt of a.geometry)if(yt.length>1){const hi=Xv(yt,ot,h.vertical||ne,f,24,ke);hi&&At(yt,hi)}}else if(a.type==="Polygon")for(const yt of Sf(a.geometry,0)){const hi=ix(yt,16);At(yt[0],new Po(hi.x,hi.y,0))}else if(a.type==="LineString")for(const yt of a.geometry)At(yt,new Po(yt[0].x,yt[0].y,0));else if(a.type==="Point")for(const yt of a.geometry)for(const hi of yt)At([hi],new Po(hi.x,hi.y,0))}function hg(l,a,h,f,y,w,k,D,P,E,B,H,K,ee,ne){const ue=function(Ve,Ce,Be,it,ot,Ht,ti,Nt){const Lt=it.layout.get("text-rotate").evaluate(Ht,{})*Math.PI/180,kt=[];for(const Qt of Ce.positionedLines)for(const At of Qt.positionedGlyphs){if(!At.rect)continue;const yt=At.rect||{};let hi=C1+1,ai=!0,qi=1,Bn=0;const Zn=(ot||Nt)&&At.vertical,Sa=At.metrics.advance*At.scale/2;if(Nt&&Ce.verticalizable&&(Bn=Qt.lineOffset/2-(At.imageName?-(ka-At.metrics.width*At.scale)/2:(At.scale-1)*ka)),At.imageName){const Ta=ti[At.imageName];ai=Ta.sdf,qi=Ta.pixelRatio,hi=Sr/qi}const Ar=ot?[At.x+Sa,At.y]:[0,0];let ur=ot?[0,0]:[At.x+Sa+Be[0],At.y+Be[1]-Bn],_a=[0,0];Zn&&(_a=ur,ur=[0,0]);const ja=At.metrics.isDoubleResolution?2:1,$a=(At.metrics.left-hi)*At.scale-Sa+ur[0],hr=(-At.metrics.top-hi)*At.scale+ur[1],dr=$a+yt.w/ja*At.scale/qi,Ma=hr+yt.h/ja*At.scale/qi,Da=new M($a,hr),Qa=new M(dr,hr),fr=new M($a,Ma),er=new M(dr,Ma);if(Zn){const Ta=new M(-Sa,Sa-ru),rn=-Math.PI/2,tr=ka/2-Sa,Ka=new M(5-ru-tr,-(At.imageName?tr:0)),Ca=new M(..._a);Da._rotateAround(rn,Ta)._add(Ka)._add(Ca),Qa._rotateAround(rn,Ta)._add(Ka)._add(Ca),fr._rotateAround(rn,Ta)._add(Ka)._add(Ca),er._rotateAround(rn,Ta)._add(Ka)._add(Ca)}if(Lt){const Ta=Math.sin(Lt),rn=Math.cos(Lt),tr=[rn,-Ta,Ta,rn];Da._matMult(tr),Qa._matMult(tr),fr._matMult(tr),er._matMult(tr)}const Mr=new M(0,0),Dr=new M(0,0);kt.push({tl:Da,tr:Qa,bl:fr,br:er,tex:yt,writingMode:Ce.writingMode,glyphOffset:Ar,sectionIndex:At.sectionIndex,isSDF:ai,pixelOffsetTL:Mr,pixelOffsetBR:Dr,minFontScaleX:0,minFontScaleY:0})}return kt}(0,h,D,y,w,k,f,l.allowVerticalPlacement),me=l.textSizeData;let ke=null;me.kind==="source"?(ke=[Ts*y.layout.get("text-size").evaluate(k,{})],ke[0]>To&&Xe(`${l.layerIds[0]}: Value for "text-size" is >= ${ou}. Reduce your "text-size".`)):me.kind==="composite"&&(ke=[Ts*ee.compositeTextSizes[0].evaluate(k,{},ne),Ts*ee.compositeTextSizes[1].evaluate(k,{},ne)],(ke[0]>To||ke[1]>To)&&Xe(`${l.layerIds[0]}: Value for "text-size" is >= ${ou}. Reduce your "text-size".`)),l.addSymbols(l.text,ue,ke,D,w,k,E,a,P.lineStartIndex,P.lineLength,K,ne);for(const Ve of B)H[Ve]=l.text.placedSymbolArray.length-1;return 4*ue.length}function dg(l){for(const a in l)return l[a];return null}function rx(l,a,h,f){const y=l.compareText;if(a in y){const w=y[a];for(let k=w.length-1;k>=0;k--)if(f.dist(w[k])<h)return!0}else y[a]=[];return y[a].push(f),!1}const fg=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Gf{static from(a){if(!(a instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[h,f]=new Uint8Array(a,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");const y=f>>4;if(y!==1)throw new Error(`Got v${y} data when expected v1.`);const w=fg[15&f];if(!w)throw new Error("Unrecognized array type.");const[k]=new Uint16Array(a,2,1),[D]=new Uint32Array(a,4,1);return new Gf(D,k,w,a)}constructor(a,h=64,f=Float64Array,y){if(isNaN(a)||a<0)throw new Error(`Unpexpected numItems value: ${a}.`);this.numItems=+a,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=f,this.IndexArrayType=a<65536?Uint16Array:Uint32Array;const w=fg.indexOf(this.ArrayType),k=2*a*this.ArrayType.BYTES_PER_ELEMENT,D=a*this.IndexArrayType.BYTES_PER_ELEMENT,P=(8-D%8)%8;if(w<0)throw new Error(`Unexpected typed array class: ${f}.`);y&&y instanceof ArrayBuffer?(this.data=y,this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+D+P,2*a),this._pos=2*a,this._finished=!0):(this.data=new ArrayBuffer(8+k+D+P),this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+D+P,2*a),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+w]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=a)}add(a,h){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=a,this.coords[this._pos++]=h,f}finish(){const a=this._pos>>1;if(a!==this.numItems)throw new Error(`Added ${a} items when expected ${this.numItems}.`);return $f(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(a,h,f,y){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:w,coords:k,nodeSize:D}=this,P=[0,w.length-1,0],E=[];for(;P.length;){const B=P.pop()||0,H=P.pop()||0,K=P.pop()||0;if(H-K<=D){for(let me=K;me<=H;me++){const ke=k[2*me],Ve=k[2*me+1];ke>=a&&ke<=f&&Ve>=h&&Ve<=y&&E.push(w[me])}continue}const ee=K+H>>1,ne=k[2*ee],ue=k[2*ee+1];ne>=a&&ne<=f&&ue>=h&&ue<=y&&E.push(w[ee]),(B===0?a<=ne:h<=ue)&&(P.push(K),P.push(ee-1),P.push(1-B)),(B===0?f>=ne:y>=ue)&&(P.push(ee+1),P.push(H),P.push(1-B))}return E}within(a,h,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:w,nodeSize:k}=this,D=[0,y.length-1,0],P=[],E=f*f;for(;D.length;){const B=D.pop()||0,H=D.pop()||0,K=D.pop()||0;if(H-K<=k){for(let me=K;me<=H;me++)mg(w[2*me],w[2*me+1],a,h)<=E&&P.push(y[me]);continue}const ee=K+H>>1,ne=w[2*ee],ue=w[2*ee+1];mg(ne,ue,a,h)<=E&&P.push(y[ee]),(B===0?a-f<=ne:h-f<=ue)&&(D.push(K),D.push(ee-1),D.push(1-B)),(B===0?a+f>=ne:h+f>=ue)&&(D.push(ee+1),D.push(H),D.push(1-B))}return P}}function $f(l,a,h,f,y,w){if(y-f<=h)return;const k=f+y>>1;pg(l,a,k,f,y,w),$f(l,a,h,f,k-1,1-w),$f(l,a,h,k+1,y,1-w)}function pg(l,a,h,f,y,w){for(;y>f;){if(y-f>600){const E=y-f+1,B=h-f+1,H=Math.log(E),K=.5*Math.exp(2*H/3),ee=.5*Math.sqrt(H*K*(E-K)/E)*(B-E/2<0?-1:1);pg(l,a,h,Math.max(f,Math.floor(h-B*K/E+ee)),Math.min(y,Math.floor(h+(E-B)*K/E+ee)),w)}const k=a[2*h+w];let D=f,P=y;for(cu(l,a,f,h),a[2*y+w]>k&&cu(l,a,f,y);D<P;){for(cu(l,a,D,P),D++,P--;a[2*D+w]<k;)D++;for(;a[2*P+w]>k;)P--}a[2*f+w]===k?cu(l,a,f,P):(P++,cu(l,a,P,y)),P<=h&&(f=P+1),h<=P&&(y=P-1)}}function cu(l,a,h,f){Kf(l,h,f),Kf(a,2*h,2*f),Kf(a,2*h+1,2*f+1)}function Kf(l,a,h){const f=l[a];l[a]=l[h],l[h]=f}function mg(l,a,h,f){const y=l-h,w=a-f;return y*y+w*w}var Yf;u.bd=void 0,(Yf=u.bd||(u.bd={})).create="create",Yf.load="load",Yf.fullLoad="fullLoad";let Zh=null,uu=[];const Jf=1e3/60,Xf="loadTime",Qf="fullLoadTime",sx={mark(l){performance.mark(l)},frame(l){const a=l;Zh!=null&&uu.push(a-Zh),Zh=a},clearMetrics(){Zh=null,uu=[],performance.clearMeasures(Xf),performance.clearMeasures(Qf);for(const l in u.bd)performance.clearMarks(u.bd[l])},getPerformanceMetrics(){performance.measure(Xf,u.bd.create,u.bd.load),performance.measure(Qf,u.bd.create,u.bd.fullLoad);const l=performance.getEntriesByName(Xf)[0].duration,a=performance.getEntriesByName(Qf)[0].duration,h=uu.length,f=1/(uu.reduce((w,k)=>w+k,0)/h/1e3),y=uu.filter(w=>w>Jf).reduce((w,k)=>w+(k-Jf)/Jf,0);return{loadTime:l,fullLoadTime:a,fps:f,percentDroppedFrames:y/(h+y)*100,totalFrames:h}}};u.$=dt,u.A=Nl,u.B=function(l){if(Et==null){const a=l.navigator?l.navigator.userAgent:null;Et=!!l.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return Et},u.C=class{constructor(l,a){this.target=l,this.mapId=a,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Yv(()=>this.process()),this.subscription=function(h,f,y,w){return h.addEventListener(f,y,!1),{unsubscribe:()=>{h.removeEventListener(f,y,!1)}}}(this.target,"message",h=>this.receive(h)),this.globalScope=bi(self)?l:window}registerMessageHandler(l,a){this.messageHandlers[l]=a}sendAsync(l,a){return new Promise((h,f)=>{const y=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[y]={resolve:h,reject:f},a&&a.signal.addEventListener("abort",()=>{delete this.resolveRejects[y];const D={id:y,type:"<cancel>",origin:location.origin,targetMapId:l.targetMapId,sourceMapId:this.mapId};this.target.postMessage(D)},{once:!0});const w=[],k=Object.assign(Object.assign({},l),{id:y,sourceMapId:this.mapId,origin:location.origin,data:Ns(l.data,w)});this.target.postMessage(k,{transfer:w})})}receive(l){const a=l.data,h=a.id;if(!(a.origin!=="file://"&&location.origin!=="file://"&&a.origin!==location.origin||a.targetMapId&&this.mapId!==a.targetMapId)){if(a.type==="<cancel>"){delete this.tasks[h];const f=this.abortControllers[h];return delete this.abortControllers[h],void(f&&f.abort())}if(bi(self)||a.mustQueue)return this.tasks[h]=a,this.taskQueue.push(h),void this.invoker.trigger();this.processTask(h,a)}}process(){if(this.taskQueue.length===0)return;const l=this.taskQueue.shift(),a=this.tasks[l];delete this.tasks[l],this.taskQueue.length>0&&this.invoker.trigger(),a&&this.processTask(l,a)}processTask(l,a){return o(this,void 0,void 0,function*(){if(a.type==="<response>"){const y=this.resolveRejects[l];return delete this.resolveRejects[l],y?void(a.error?y.reject(vo(a.error)):y.resolve(vo(a.data))):void 0}if(!this.messageHandlers[a.type])return void this.completeTask(l,new Error(`Could not find a registered handler for ${a.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const h=vo(a.data),f=new AbortController;this.abortControllers[l]=f;try{const y=yield this.messageHandlers[a.type](a.sourceMapId,h,f);this.completeTask(l,null,y)}catch(y){this.completeTask(l,y)}})}completeTask(l,a,h){const f=[];delete this.abortControllers[l];const y={id:l,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:a?Ns(a):null,data:Ns(h,f)};this.target.postMessage(y,{transfer:f})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},u.D=ri,u.E=Kn,u.F=function(){var l=new Nl(16);return Nl!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l},u.G=Ti,u.H=function(l,a,h){var f,y,w,k,D,P,E,B,H,K,ee,ne,ue=h[0],me=h[1],ke=h[2];return a===l?(l[12]=a[0]*ue+a[4]*me+a[8]*ke+a[12],l[13]=a[1]*ue+a[5]*me+a[9]*ke+a[13],l[14]=a[2]*ue+a[6]*me+a[10]*ke+a[14],l[15]=a[3]*ue+a[7]*me+a[11]*ke+a[15]):(y=a[1],w=a[2],k=a[3],D=a[4],P=a[5],E=a[6],B=a[7],H=a[8],K=a[9],ee=a[10],ne=a[11],l[0]=f=a[0],l[1]=y,l[2]=w,l[3]=k,l[4]=D,l[5]=P,l[6]=E,l[7]=B,l[8]=H,l[9]=K,l[10]=ee,l[11]=ne,l[12]=f*ue+D*me+H*ke+a[12],l[13]=y*ue+P*me+K*ke+a[13],l[14]=w*ue+E*me+ee*ke+a[14],l[15]=k*ue+B*me+ne*ke+a[15]),l},u.I=zf,u.J=function(l,a,h){var f=h[0],y=h[1],w=h[2];return l[0]=a[0]*f,l[1]=a[1]*f,l[2]=a[2]*f,l[3]=a[3]*f,l[4]=a[4]*y,l[5]=a[5]*y,l[6]=a[6]*y,l[7]=a[7]*y,l[8]=a[8]*w,l[9]=a[9]*w,l[10]=a[10]*w,l[11]=a[11]*w,l[12]=a[12],l[13]=a[13],l[14]=a[14],l[15]=a[15],l},u.K=Km,u.L=function(l,a){const h={};for(let f=0;f<a.length;f++){const y=a[f];y in l&&(h[y]=l[y])}return h},u.M=Co,u.N=W1,u.O=q1,u.P=M,u.Q=Hr,u.R=Vr,u.S=X,u.T=Lc,u.U=oe,u.V=zt,u.W=Xi,u.X=ha,u.Y=Hh,u.Z=class extends Ms{},u._=o,u.a=pi,u.a$=function(l,a,h){return l[0]=a[0]*h[0],l[1]=a[1]*h[1],l[2]=a[2]*h[2],l[3]=a[3]*h[3],l},u.a0=Wf,u.a1=rt,u.a2=l=>{const a=window.document.createElement("video");return a.muted=!0,new Promise(h=>{a.onloadstart=()=>{h(a)};for(const f of l){const y=window.document.createElement("source");Ni(f)||(a.crossOrigin="Anonymous"),y.src=f,a.appendChild(y)}})},u.a3=function(){return Se++},u.a4=kh,u.a5=ql,u.a6=Ml,u.a7=Zs,u.a8=Fn,u.a9=J1,u.aA=Re,u.aB=function(l,a){if(!l)return[{command:"setStyle",args:[a]}];let h=[];try{if(!xi(l.version,a.version))return[{command:"setStyle",args:[a]}];xi(l.center,a.center)||h.push({command:"setCenter",args:[a.center]}),xi(l.zoom,a.zoom)||h.push({command:"setZoom",args:[a.zoom]}),xi(l.bearing,a.bearing)||h.push({command:"setBearing",args:[a.bearing]}),xi(l.pitch,a.pitch)||h.push({command:"setPitch",args:[a.pitch]}),xi(l.sprite,a.sprite)||h.push({command:"setSprite",args:[a.sprite]}),xi(l.glyphs,a.glyphs)||h.push({command:"setGlyphs",args:[a.glyphs]}),xi(l.transition,a.transition)||h.push({command:"setTransition",args:[a.transition]}),xi(l.light,a.light)||h.push({command:"setLight",args:[a.light]}),xi(l.terrain,a.terrain)||h.push({command:"setTerrain",args:[a.terrain]}),xi(l.sky,a.sky)||h.push({command:"setSky",args:[a.sky]});const f={},y=[];(function(k,D,P,E){let B;for(B in D=D||{},k=k||{})Object.prototype.hasOwnProperty.call(k,B)&&(Object.prototype.hasOwnProperty.call(D,B)||tt(B,P,E));for(B in D)Object.prototype.hasOwnProperty.call(D,B)&&(Object.prototype.hasOwnProperty.call(k,B)?xi(k[B],D[B])||(k[B].type==="geojson"&&D[B].type==="geojson"&&_n(k,D,B)?tn(P,{command:"setGeoJSONSourceData",args:[B,D[B].data]}):bn(B,D,P,E)):xn(B,D,P))})(l.sources,a.sources,y,f);const w=[];l.layers&&l.layers.forEach(k=>{"source"in k&&f[k.source]?h.push({command:"removeLayer",args:[k.id]}):w.push(k)}),h=h.concat(y),function(k,D,P){D=D||[];const E=(k=k||[]).map(ta),B=D.map(ta),H=k.reduce(pa,{}),K=D.reduce(pa,{}),ee=E.slice(),ne=Object.create(null);let ue,me,ke,Ve,Ce;for(let Be=0,it=0;Be<E.length;Be++)ue=E[Be],Object.prototype.hasOwnProperty.call(K,ue)?it++:(tn(P,{command:"removeLayer",args:[ue]}),ee.splice(ee.indexOf(ue,it),1));for(let Be=0,it=0;Be<B.length;Be++)ue=B[B.length-1-Be],ee[ee.length-1-Be]!==ue&&(Object.prototype.hasOwnProperty.call(H,ue)?(tn(P,{command:"removeLayer",args:[ue]}),ee.splice(ee.lastIndexOf(ue,ee.length-it),1)):it++,Ve=ee[ee.length-Be],tn(P,{command:"addLayer",args:[K[ue],Ve]}),ee.splice(ee.length-Be,0,ue),ne[ue]=!0);for(let Be=0;Be<B.length;Be++)if(ue=B[Be],me=H[ue],ke=K[ue],!ne[ue]&&!xi(me,ke))if(xi(me.source,ke.source)&&xi(me["source-layer"],ke["source-layer"])&&xi(me.type,ke.type)){for(Ce in cn(me.layout,ke.layout,P,ue,null,"setLayoutProperty"),cn(me.paint,ke.paint,P,ue,null,"setPaintProperty"),xi(me.filter,ke.filter)||tn(P,{command:"setFilter",args:[ue,ke.filter]}),xi(me.minzoom,ke.minzoom)&&xi(me.maxzoom,ke.maxzoom)||tn(P,{command:"setLayerZoomRange",args:[ue,ke.minzoom,ke.maxzoom]}),me)Object.prototype.hasOwnProperty.call(me,Ce)&&Ce!=="layout"&&Ce!=="paint"&&Ce!=="filter"&&Ce!=="metadata"&&Ce!=="minzoom"&&Ce!=="maxzoom"&&(Ce.indexOf("paint.")===0?cn(me[Ce],ke[Ce],P,ue,Ce.slice(6),"setPaintProperty"):xi(me[Ce],ke[Ce])||tn(P,{command:"setLayerProperty",args:[ue,Ce,ke[Ce]]}));for(Ce in ke)Object.prototype.hasOwnProperty.call(ke,Ce)&&!Object.prototype.hasOwnProperty.call(me,Ce)&&Ce!=="layout"&&Ce!=="paint"&&Ce!=="filter"&&Ce!=="metadata"&&Ce!=="minzoom"&&Ce!=="maxzoom"&&(Ce.indexOf("paint.")===0?cn(me[Ce],ke[Ce],P,ue,Ce.slice(6),"setPaintProperty"):xi(me[Ce],ke[Ce])||tn(P,{command:"setLayerProperty",args:[ue,Ce,ke[Ce]]}))}else tn(P,{command:"removeLayer",args:[ue]}),Ve=ee[ee.lastIndexOf(ue)+1],tn(P,{command:"addLayer",args:[ke,Ve]})}(w,a.layers,h)}catch(f){console.warn("Unable to compute style diff:",f),h=[{command:"setStyle",args:[a]}]}return h},u.aC=function(l){const a=[],h=l.id;return h===void 0&&a.push({message:`layers.${h}: missing required property "id"`}),l.render===void 0&&a.push({message:`layers.${h}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&a.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),a},u.aD=function l(a,h){if(Array.isArray(a)){if(!Array.isArray(h)||a.length!==h.length)return!1;for(let f=0;f<a.length;f++)if(!l(a[f],h[f]))return!1;return!0}if(typeof a=="object"&&a!==null&&h!==null){if(typeof h!="object"||Object.keys(a).length!==Object.keys(h).length)return!1;for(const f in a)if(!l(a[f],h[f]))return!1;return!0}return a===h},u.aE=_e,u.aF=ze,u.aG=class extends Ln{constructor(l,a){super(l,a),this.current=0}set(l){this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}},u.aH=Za,u.aI=class extends Ln{constructor(l,a){super(l,a),this.current=Us}set(l){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let a=1;a<16;a++)if(l[a]!==this.current[a]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}},u.aJ=Br,u.aK=class extends Ln{constructor(l,a){super(l,a),this.current=[0,0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2]))}},u.aL=class extends Ln{constructor(l,a){super(l,a),this.current=[0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1]))}},u.aM=es,u.aN=function(l,a,h,f,y,w,k){var D=1/(a-h),P=1/(f-y),E=1/(w-k);return l[0]=-2*D,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*P,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*E,l[11]=0,l[12]=(a+h)*D,l[13]=(y+f)*P,l[14]=(k+w)*E,l[15]=1,l},u.aO=Fi,u.aP=Ab,u.aQ=class extends Qo{},u.aR=Sv,u.aS=class extends wo{},u.aT=function(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))},u.aU=e1,u.aV=j,u.aW=class extends Uc{},u.aX=Ze,u.aY=function(l,a){return l[0]===a[0]&&l[1]===a[1]&&l[2]===a[2]&&l[3]===a[3]&&l[4]===a[4]&&l[5]===a[5]&&l[6]===a[6]&&l[7]===a[7]&&l[8]===a[8]&&l[9]===a[9]&&l[10]===a[10]&&l[11]===a[11]&&l[12]===a[12]&&l[13]===a[13]&&l[14]===a[14]&&l[15]===a[15]},u.aZ=function(l,a){var h=l[0],f=l[1],y=l[2],w=l[3],k=l[4],D=l[5],P=l[6],E=l[7],B=l[8],H=l[9],K=l[10],ee=l[11],ne=l[12],ue=l[13],me=l[14],ke=l[15],Ve=a[0],Ce=a[1],Be=a[2],it=a[3],ot=a[4],Ht=a[5],ti=a[6],Nt=a[7],Lt=a[8],kt=a[9],Qt=a[10],At=a[11],yt=a[12],hi=a[13],ai=a[14],qi=a[15];return Math.abs(h-Ve)<=cr*Math.max(1,Math.abs(h),Math.abs(Ve))&&Math.abs(f-Ce)<=cr*Math.max(1,Math.abs(f),Math.abs(Ce))&&Math.abs(y-Be)<=cr*Math.max(1,Math.abs(y),Math.abs(Be))&&Math.abs(w-it)<=cr*Math.max(1,Math.abs(w),Math.abs(it))&&Math.abs(k-ot)<=cr*Math.max(1,Math.abs(k),Math.abs(ot))&&Math.abs(D-Ht)<=cr*Math.max(1,Math.abs(D),Math.abs(Ht))&&Math.abs(P-ti)<=cr*Math.max(1,Math.abs(P),Math.abs(ti))&&Math.abs(E-Nt)<=cr*Math.max(1,Math.abs(E),Math.abs(Nt))&&Math.abs(B-Lt)<=cr*Math.max(1,Math.abs(B),Math.abs(Lt))&&Math.abs(H-kt)<=cr*Math.max(1,Math.abs(H),Math.abs(kt))&&Math.abs(K-Qt)<=cr*Math.max(1,Math.abs(K),Math.abs(Qt))&&Math.abs(ee-At)<=cr*Math.max(1,Math.abs(ee),Math.abs(At))&&Math.abs(ne-yt)<=cr*Math.max(1,Math.abs(ne),Math.abs(yt))&&Math.abs(ue-hi)<=cr*Math.max(1,Math.abs(ue),Math.abs(hi))&&Math.abs(me-ai)<=cr*Math.max(1,Math.abs(me),Math.abs(ai))&&Math.abs(ke-qi)<=cr*Math.max(1,Math.abs(ke),Math.abs(qi))},u.a_=function(l,a){return l[0]=a[0],l[1]=a[1],l[2]=a[2],l[3]=a[3],l[4]=a[4],l[5]=a[5],l[6]=a[6],l[7]=a[7],l[8]=a[8],l[9]=a[9],l[10]=a[10],l[11]=a[11],l[12]=a[12],l[13]=a[13],l[14]=a[14],l[15]=a[15],l},u.aa=function(l){const a={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,f,y,w)=>{const k=y||w;return a[f]=!k||k.toLowerCase(),""}),a["max-age"]){const h=parseInt(a["max-age"],10);isNaN(h)?delete a["max-age"]:a["max-age"]=h}return a},u.ab=function(l,a){const h=[];for(const f in l)f in a||h.push(f);return h},u.ac=De,u.ad=function(l,a,h){var f=Math.sin(h),y=Math.cos(h),w=a[0],k=a[1],D=a[2],P=a[3],E=a[4],B=a[5],H=a[6],K=a[7];return a!==l&&(l[8]=a[8],l[9]=a[9],l[10]=a[10],l[11]=a[11],l[12]=a[12],l[13]=a[13],l[14]=a[14],l[15]=a[15]),l[0]=w*y+E*f,l[1]=k*y+B*f,l[2]=D*y+H*f,l[3]=P*y+K*f,l[4]=E*y-w*f,l[5]=B*y-k*f,l[6]=H*y-D*f,l[7]=K*y-P*f,l},u.ae=function(l){var a=new Nl(16);return a[0]=l[0],a[1]=l[1],a[2]=l[2],a[3]=l[3],a[4]=l[4],a[5]=l[5],a[6]=l[6],a[7]=l[7],a[8]=l[8],a[9]=l[9],a[10]=l[10],a[11]=l[11],a[12]=l[12],a[13]=l[13],a[14]=l[14],a[15]=l[15],a},u.af=Ah,u.ag=function(l,a){let h=0,f=0;if(l.kind==="constant")f=l.layoutSize;else if(l.kind!=="source"){const{interpolationType:y,minZoom:w,maxZoom:k}=l,D=y?De(ca.interpolationFactor(y,a,w,k),0,1):0;l.kind==="camera"?f=Xa.number(l.minSize,l.maxSize,D):h=D}return{uSizeT:h,uSize:f}},u.ai=function(l,{uSize:a,uSizeT:h},{lowerSize:f,upperSize:y}){return l.kind==="source"?f/Ts:l.kind==="composite"?Xa.number(f/Ts,y/Ts,h):a},u.aj=Bf,u.ak=function(l,a,h,f){const y=a.y-l.y,w=a.x-l.x,k=f.y-h.y,D=f.x-h.x,P=k*w-D*y;if(P===0)return null;const E=(D*(l.y-h.y)-k*(l.x-h.x))/P;return new M(l.x+E*w,l.y+E*y)},u.al=tg,u.am=Gs,u.an=_f,u.ao=ka,u.aq=Of,u.ar=function(l,a){var h=a[0],f=a[1],y=a[2],w=a[3],k=a[4],D=a[5],P=a[6],E=a[7],B=a[8],H=a[9],K=a[10],ee=a[11],ne=a[12],ue=a[13],me=a[14],ke=a[15],Ve=h*D-f*k,Ce=h*P-y*k,Be=h*E-w*k,it=f*P-y*D,ot=f*E-w*D,Ht=y*E-w*P,ti=B*ue-H*ne,Nt=B*me-K*ne,Lt=B*ke-ee*ne,kt=H*me-K*ue,Qt=H*ke-ee*ue,At=K*ke-ee*me,yt=Ve*At-Ce*Qt+Be*kt+it*Lt-ot*Nt+Ht*ti;return yt?(l[0]=(D*At-P*Qt+E*kt)*(yt=1/yt),l[1]=(y*Qt-f*At-w*kt)*yt,l[2]=(ue*Ht-me*ot+ke*it)*yt,l[3]=(K*ot-H*Ht-ee*it)*yt,l[4]=(P*Lt-k*At-E*Nt)*yt,l[5]=(h*At-y*Lt+w*Nt)*yt,l[6]=(me*Be-ne*Ht-ke*Ce)*yt,l[7]=(B*Ht-K*Be+ee*Ce)*yt,l[8]=(k*Qt-D*Lt+E*ti)*yt,l[9]=(f*Lt-h*Qt-w*ti)*yt,l[10]=(ne*ot-ue*Be+ke*Ve)*yt,l[11]=(H*Be-B*ot-ee*Ve)*yt,l[12]=(D*Nt-k*kt-P*ti)*yt,l[13]=(h*kt-f*Nt+y*ti)*yt,l[14]=(ue*Ce-ne*it-me*Ve)*yt,l[15]=(B*it-H*Ce+K*Ve)*yt,l):null},u.as=Zf,u.at=Ff,u.au=Gf,u.av=function(){const l={},a=je.$version;for(const h in je.$root){const f=je.$root[h];if(f.required){let y=null;y=h==="version"?a:f.type==="array"?[]:{},y!=null&&(l[h]=y)}}return l},u.aw=Pc,u.ax=mi,u.ay=function(l){l=l.slice();const a=Object.create(null);for(let h=0;h<l.length;h++)a[l[h].id]=l[h];for(let h=0;h<l.length;h++)"ref"in l[h]&&(l[h]=Dn(l[h],a[l[h].ref]));return l},u.az=function(l){if(l.type==="custom")return new Kv(l);switch(l.type){case"background":return new Zv(l);case"circle":return new Ib(l);case"fill":return new Jb(l);case"fill-extrusion":return new dv(l);case"heatmap":return new Lb(l);case"hillshade":return new Rb(l);case"line":return new vv(l);case"raster":return new $v(l);case"symbol":return new Vh(l)}},u.b=Vt,u.b0=function(l,a){return l[0]*a[0]+l[1]*a[1]+l[2]*a[2]+l[3]*a[3]},u.b1=Oe,u.b2=$1,u.b3=Z1,u.b4=function(l,a,h,f,y){var w,k=1/Math.tan(a/2);return l[0]=k/h,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=k,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,y!=null&&y!==1/0?(l[10]=(y+f)*(w=1/(f-y)),l[14]=2*y*f*w):(l[10]=-1,l[14]=-2*f),l},u.b5=function(l,a,h){var f=Math.sin(h),y=Math.cos(h),w=a[4],k=a[5],D=a[6],P=a[7],E=a[8],B=a[9],H=a[10],K=a[11];return a!==l&&(l[0]=a[0],l[1]=a[1],l[2]=a[2],l[3]=a[3],l[12]=a[12],l[13]=a[13],l[14]=a[14],l[15]=a[15]),l[4]=w*y+E*f,l[5]=k*y+B*f,l[6]=D*y+H*f,l[7]=P*y+K*f,l[8]=E*y-w*f,l[9]=B*y-k*f,l[10]=H*y-D*f,l[11]=K*y-P*f,l},u.b6=Q,u.b7=ce,u.b8=function(l){return l*Math.PI/180},u.b9=function(l,a){return l[0]=a[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=a[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=a[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l},u.bA=Vs,u.ba=class extends El{},u.bb=jf,u.bc=sx,u.be=ht,u.bf=function(l,a){pi.REGISTERED_PROTOCOLS[l]=a},u.bg=function(l){delete pi.REGISTERED_PROTOCOLS[l]},u.bh=function(l,a){const h={};for(let y=0;y<l.length;y++){const w=a&&a[l[y].id]||pf(l[y]);a&&(a[l[y].id]=w);let k=h[w];k||(k=h[w]=[]),k.push(l[y])}const f=[];for(const y in h)f.push(h[y]);return f},u.bi=Yt,u.bj=Y1,u.bk=X1,u.bl=A1,u.bm=function(l){l.bucket.createArrays(),l.bucket.tilePixelRatio=Xi/(512*l.bucket.overscaling),l.bucket.compareText={},l.bucket.iconsNeedLinear=!1;const a=l.bucket.layers[0],h=a.layout,f=a._unevaluatedLayout._values,y={layoutIconSize:f["icon-size"].possiblyEvaluate(new Fn(l.bucket.zoom+1),l.canonical),layoutTextSize:f["text-size"].possiblyEvaluate(new Fn(l.bucket.zoom+1),l.canonical),textMaxSize:f["text-size"].possiblyEvaluate(new Fn(18))};if(l.bucket.textSizeData.kind==="composite"){const{minZoom:E,maxZoom:B}=l.bucket.textSizeData;y.compositeTextSizes=[f["text-size"].possiblyEvaluate(new Fn(E),l.canonical),f["text-size"].possiblyEvaluate(new Fn(B),l.canonical)]}if(l.bucket.iconSizeData.kind==="composite"){const{minZoom:E,maxZoom:B}=l.bucket.iconSizeData;y.compositeIconSizes=[f["icon-size"].possiblyEvaluate(new Fn(E),l.canonical),f["icon-size"].possiblyEvaluate(new Fn(B),l.canonical)]}const w=h.get("text-line-height")*ka,k=h.get("text-rotation-alignment")!=="viewport"&&h.get("symbol-placement")!=="point",D=h.get("text-keep-upright"),P=h.get("text-size");for(const E of l.bucket.features){const B=h.get("text-font").evaluate(E,{},l.canonical).join(","),H=P.evaluate(E,{},l.canonical),K=y.layoutTextSize.evaluate(E,{},l.canonical),ee=y.layoutIconSize.evaluate(E,{},l.canonical),ne={horizontal:{},vertical:void 0},ue=E.text;let me,ke=[0,0];if(ue){const Be=ue.toString(),it=h.get("text-letter-spacing").evaluate(E,{},l.canonical)*ka,ot=Cl(Be)?it:0,Ht=h.get("text-anchor").evaluate(E,{},l.canonical),ti=ug(a,E,l.canonical);if(!ti){const At=h.get("text-radial-offset").evaluate(E,{},l.canonical);ke=At?cg(Ht,[At*ka,qf]):h.get("text-offset").evaluate(E,{},l.canonical).map(yt=>yt*ka)}let Nt=k?"center":h.get("text-justify").evaluate(E,{},l.canonical);const Lt=h.get("symbol-placement"),kt=Lt==="point"?h.get("text-max-width").evaluate(E,{},l.canonical)*ka:0,Qt=()=>{l.bucket.allowVerticalPlacement&&$o(Be)&&(ne.vertical=Oh(ue,l.glyphMap,l.glyphPositions,l.imagePositions,B,kt,w,Ht,"left",ot,ke,u.ah.vertical,!0,Lt,K,H))};if(!k&&ti){const At=new Set;if(Nt==="auto")for(let hi=0;hi<ti.values.length;hi+=2)At.add(Zf(ti.values[hi]));else At.add(Nt);let yt=!1;for(const hi of At)if(!ne.horizontal[hi])if(yt)ne.horizontal[hi]=ne.horizontal[0];else{const ai=Oh(ue,l.glyphMap,l.glyphPositions,l.imagePositions,B,kt,w,"center",hi,ot,ke,u.ah.horizontal,!1,Lt,K,H);ai&&(ne.horizontal[hi]=ai,yt=ai.positionedLines.length===1)}Qt()}else{Nt==="auto"&&(Nt=Zf(Ht));const At=Oh(ue,l.glyphMap,l.glyphPositions,l.imagePositions,B,kt,w,Ht,Nt,ot,ke,u.ah.horizontal,!1,Lt,K,H);At&&(ne.horizontal[Nt]=At),Qt(),$o(Be)&&k&&D&&(ne.vertical=Oh(ue,l.glyphMap,l.glyphPositions,l.imagePositions,B,kt,w,Ht,Nt,ot,ke,u.ah.vertical,!1,Lt,K,H))}}let Ve=!1;if(E.icon&&E.icon.name){const Be=l.imageMap[E.icon.name];Be&&(me=Hv(l.imagePositions[E.icon.name],h.get("icon-offset").evaluate(E,{},l.canonical),h.get("icon-anchor").evaluate(E,{},l.canonical)),Ve=!!Be.sdf,l.bucket.sdfIcons===void 0?l.bucket.sdfIcons=Ve:l.bucket.sdfIcons!==Ve&&Xe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Be.pixelRatio!==l.bucket.pixelRatio||h.get("icon-rotate").constantOr(1)!==0)&&(l.bucket.iconsNeedLinear=!0))}const Ce=dg(ne.horizontal)||ne.vertical;l.bucket.iconsInText=!!Ce&&Ce.iconsInText,(Ce||me)&&ax(l.bucket,E,ne,me,l.imageMap,y,K,ee,ke,Ve,l.canonical)}l.showCollisionBoxes&&l.bucket.generateCollisionDebugBuffers()},u.bn=Af,u.bo=Tf,u.bp=Pf,u.bq=Mo,u.br=Ef,u.bs=class{constructor(l){this._marks={start:[l.url,"start"].join("#"),end:[l.url,"end"].join("#"),measure:l.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let l=performance.getEntriesByName(this._marks.measure);return l.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),l=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),l}},u.bt=function(l,a,h,f,y){return o(this,void 0,void 0,function*(){if(oe())try{return yield zt(l,a,h,f,y)}catch{}return function(w,k,D,P,E){const B=w.width,H=w.height;_t&&Dt||(_t=new OffscreenCanvas(B,H),Dt=_t.getContext("2d",{willReadFrequently:!0})),_t.width=B,_t.height=H,Dt.drawImage(w,0,0,B,H);const K=Dt.getImageData(k,D,P,E);return Dt.clearRect(0,0,B,H),K.data}(l,a,h,f,y)})},u.bu=K1,u.bv=p,u.bw=_,u.bx=x1,u.by=Cn,u.bz=function(l){return l.message===Ft},u.c=oi,u.d=l=>o(void 0,void 0,void 0,function*(){if(l.byteLength===0)return createImageBitmap(new ImageData(1,1));const a=new Blob([new Uint8Array(l)],{type:"image/png"});try{return createImageBitmap(a)}catch(h){throw new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),u.e=Pe,u.f=l=>new Promise((a,h)=>{const f=new Image;f.onload=()=>{a(f),URL.revokeObjectURL(f.src),f.onload=null,window.requestAnimationFrame(()=>{f.src=Ki})},f.onerror=()=>h(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const y=new Blob([new Uint8Array(l)],{type:"image/png"});f.src=l.byteLength?URL.createObjectURL(y):Ki}),u.g=vi,u.h=(l,a)=>Pi(Pe(l,{type:"json"}),a),u.i=bi,u.j=Yi,u.k=vn,u.l=(l,a)=>Pi(Pe(l,{type:"arrayBuffer"}),a),u.m=Pi,u.n=function(l){return new Ef(l).readFields(Rv,[])},u.o=Jc,u.p=P1,u.q=or,u.r=Dc,u.s=Ni,u.t=gh,u.u=qt,u.v=je,u.w=Xe,u.x=bo,u.y=function([l,a,h]){return a+=90,a*=Math.PI/180,h*=Math.PI/180,{x:l*Math.cos(a)*Math.sin(h),y:l*Math.sin(a)*Math.sin(h),z:l*Math.cos(h)}},u.z=Xa}),s("worker",["./shared"],function(u){class o{constructor(U){this.keyCache={},U&&this.replace(U)}replace(U){this._layerConfigs={},this._layers={},this.update(U,[])}update(U,J){for(const se of U){this._layerConfigs[se.id]=se;const Ae=this._layers[se.id]=u.az(se);Ae._featureFilter=u.a6(Ae.filter),this.keyCache[se.id]&&delete this.keyCache[se.id]}for(const se of J)delete this.keyCache[se],delete this._layerConfigs[se],delete this._layers[se];this.familiesBySource={};const te=u.bh(Object.values(this._layerConfigs),this.keyCache);for(const se of te){const Ae=se.map(L=>this._layers[L.id]),Ee=Ae[0];if(Ee.visibility==="none")continue;const $=Ee.source||"";let O=this.familiesBySource[$];O||(O=this.familiesBySource[$]={});const V=Ee.sourceLayer||"_geojsonTileLayer";let q=O[V];q||(q=O[V]=[]),q.push(Ae)}}}class p{constructor(U){const J={},te=[];for(const $ in U){const O=U[$],V=J[$]={};for(const q in O){const L=O[+q];if(!L||L.bitmap.width===0||L.bitmap.height===0)continue;const W={x:0,y:0,w:L.bitmap.width+2,h:L.bitmap.height+2};te.push(W),V[q]={rect:W,metrics:L.metrics}}}const{w:se,h:Ae}=u.p(te),Ee=new u.o({width:se||1,height:Ae||1});for(const $ in U){const O=U[$];for(const V in O){const q=O[+V];if(!q||q.bitmap.width===0||q.bitmap.height===0)continue;const L=J[$][V].rect;u.o.copy(q.bitmap,Ee,{x:0,y:0},{x:L.x+1,y:L.y+1},q.bitmap)}}this.image=Ee,this.positions=J}}u.bi("GlyphAtlas",p);class _{constructor(U){this.tileID=new u.Q(U.tileID.overscaledZ,U.tileID.wrap,U.tileID.canonical.z,U.tileID.canonical.x,U.tileID.canonical.y),this.uid=U.uid,this.zoom=U.zoom,this.pixelRatio=U.pixelRatio,this.tileSize=U.tileSize,this.source=U.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=U.showCollisionBoxes,this.collectResourceTiming=!!U.collectResourceTiming,this.returnDependencies=!!U.returnDependencies,this.promoteId=U.promoteId,this.inFlightDependencies=[]}parse(U,J,te,se){return u._(this,void 0,void 0,function*(){this.status="parsing",this.data=U,this.collisionBoxArray=new u.a4;const Ae=new u.bj(Object.keys(U.layers).sort()),Ee=new u.bk(this.tileID,this.promoteId);Ee.bucketLayerIDs=[];const $={},O={featureIndex:Ee,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:te},V=J.familiesBySource[this.source];for(const wt in V){const St=U.layers[wt];if(!St)continue;St.version===1&&u.w(`Vector tile source "${this.source}" layer "${wt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const $t=Ae.encode(wt),Tt=[];for(let Ct=0;Ct<St.length;Ct++){const Si=St.feature(Ct),Ai=Ee.getId(Si,wt);Tt.push({feature:Si,id:Ai,index:Ct,sourceLayerIndex:$t})}for(const Ct of V[wt]){const Si=Ct[0];Si.source!==this.source&&u.w(`layer.source = ${Si.source} does not equal this.source = ${this.source}`),Si.minzoom&&this.zoom<Math.floor(Si.minzoom)||Si.maxzoom&&this.zoom>=Si.maxzoom||Si.visibility!=="none"&&(v(Ct,this.zoom,te),($[Si.id]=Si.createBucket({index:Ee.bucketLayerIDs.length,layers:Ct,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:$t,sourceID:this.source})).populate(Tt,O,this.tileID.canonical),Ee.bucketLayerIDs.push(Ct.map(Ai=>Ai.id)))}}const q=u.aE(O.glyphDependencies,wt=>Object.keys(wt).map(Number));this.inFlightDependencies.forEach(wt=>wt==null?void 0:wt.abort()),this.inFlightDependencies=[];let L=Promise.resolve({});if(Object.keys(q).length){const wt=new AbortController;this.inFlightDependencies.push(wt),L=se.sendAsync({type:"getGlyphs",data:{stacks:q,source:this.source,tileID:this.tileID,type:"glyphs"}},wt)}const W=Object.keys(O.iconDependencies);let ae=Promise.resolve({});if(W.length){const wt=new AbortController;this.inFlightDependencies.push(wt),ae=se.sendAsync({type:"getImages",data:{icons:W,source:this.source,tileID:this.tileID,type:"icons"}},wt)}const Me=Object.keys(O.patternDependencies);let Ie=Promise.resolve({});if(Me.length){const wt=new AbortController;this.inFlightDependencies.push(wt),Ie=se.sendAsync({type:"getImages",data:{icons:Me,source:this.source,tileID:this.tileID,type:"patterns"}},wt)}const[Qe,Ge,$e]=yield Promise.all([L,ae,Ie]),Te=new p(Qe),gt=new u.bl(Ge,$e);for(const wt in $){const St=$[wt];St instanceof u.a5?(v(St.layers,this.zoom,te),u.bm({bucket:St,glyphMap:Qe,glyphPositions:Te.positions,imageMap:Ge,imagePositions:gt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):St.hasPattern&&(St instanceof u.bn||St instanceof u.bo||St instanceof u.bp)&&(v(St.layers,this.zoom,te),St.addFeatures(O,this.tileID.canonical,gt.patternPositions))}return this.status="done",{buckets:Object.values($).filter(wt=>!wt.isEmpty()),featureIndex:Ee,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Te.image,imageAtlas:gt,glyphMap:this.returnDependencies?Qe:null,iconMap:this.returnDependencies?Ge:null,glyphPositions:this.returnDependencies?Te.positions:null}})}}function v(re,U,J){const te=new u.a8(U);for(const se of re)se.recalculate(te,J)}class M{constructor(U,J,te){this.actor=U,this.layerIndex=J,this.availableImages=te,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(U,J){return u._(this,void 0,void 0,function*(){const te=yield u.l(U.request,J);try{return{vectorTile:new u.bq.VectorTile(new u.br(te.data)),rawData:te.data,cacheControl:te.cacheControl,expires:te.expires}}catch(se){const Ae=new Uint8Array(te.data);let Ee=`Unable to parse the tile at ${U.request.url}, `;throw Ee+=Ae[0]===31&&Ae[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${se.messge}`,new Error(Ee)}})}loadTile(U){return u._(this,void 0,void 0,function*(){const J=U.uid,te=!!(U&&U.request&&U.request.collectResourceTiming)&&new u.bs(U.request),se=new _(U);this.loading[J]=se;const Ae=new AbortController;se.abort=Ae;try{const Ee=yield this.loadVectorTile(U,Ae);if(delete this.loading[J],!Ee)return null;const $=Ee.rawData,O={};Ee.expires&&(O.expires=Ee.expires),Ee.cacheControl&&(O.cacheControl=Ee.cacheControl);const V={};if(te){const L=te.finish();L&&(V.resourceTiming=JSON.parse(JSON.stringify(L)))}se.vectorTile=Ee.vectorTile;const q=se.parse(Ee.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[J]=se,this.fetching[J]={rawTileData:$,cacheControl:O,resourceTiming:V};try{const L=yield q;return u.e({rawTileData:$.slice(0)},L,O,V)}finally{delete this.fetching[J]}}catch(Ee){throw delete this.loading[J],se.status="done",this.loaded[J]=se,Ee}})}reloadTile(U){return u._(this,void 0,void 0,function*(){const J=U.uid;if(!this.loaded||!this.loaded[J])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const te=this.loaded[J];if(te.showCollisionBoxes=U.showCollisionBoxes,te.status==="parsing"){const se=yield te.parse(te.vectorTile,this.layerIndex,this.availableImages,this.actor);let Ae;if(this.fetching[J]){const{rawTileData:Ee,cacheControl:$,resourceTiming:O}=this.fetching[J];delete this.fetching[J],Ae=u.e({rawTileData:Ee.slice(0)},se,$,O)}else Ae=se;return Ae}if(te.status==="done"&&te.vectorTile)return te.parse(te.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(U){return u._(this,void 0,void 0,function*(){const J=this.loading,te=U.uid;J&&J[te]&&J[te].abort&&(J[te].abort.abort(),delete J[te])})}removeTile(U){return u._(this,void 0,void 0,function*(){this.loaded&&this.loaded[U.uid]&&delete this.loaded[U.uid]})}}class S{constructor(){this.loaded={}}loadTile(U){return u._(this,void 0,void 0,function*(){const{uid:J,encoding:te,rawImageData:se,redFactor:Ae,greenFactor:Ee,blueFactor:$,baseShift:O}=U,V=se.width+2,q=se.height+2,L=u.b(se)?new u.R({width:V,height:q},yield u.bt(se,-1,-1,V,q)):se,W=new u.bu(J,L,te,Ae,Ee,$,O);return this.loaded=this.loaded||{},this.loaded[J]=W,W})}removeTile(U){const J=this.loaded,te=U.uid;J&&J[te]&&delete J[te]}}function I(re,U){if(re.length!==0){R(re[0],U);for(var J=1;J<re.length;J++)R(re[J],!U)}}function R(re,U){for(var J=0,te=0,se=0,Ae=re.length,Ee=Ae-1;se<Ae;Ee=se++){var $=(re[se][0]-re[Ee][0])*(re[Ee][1]+re[se][1]),O=J+$;te+=Math.abs(J)>=Math.abs($)?J-O+$:$-O+J,J=O}J+te>=0!=!!U&&re.reverse()}var G=u.bv(function re(U,J){var te,se=U&&U.type;if(se==="FeatureCollection")for(te=0;te<U.features.length;te++)re(U.features[te],J);else if(se==="GeometryCollection")for(te=0;te<U.geometries.length;te++)re(U.geometries[te],J);else if(se==="Feature")re(U.geometry,J);else if(se==="Polygon")I(U.coordinates,J);else if(se==="MultiPolygon")for(te=0;te<U.coordinates.length;te++)I(U.coordinates[te],J);return U});const Y=u.bq.VectorTileFeature.prototype.toGeoJSON;var X={exports:{}},oe=u.bw,Q=u.bq.VectorTileFeature,ce=De;function De(re,U){this.options=U||{},this.features=re,this.length=re.length}function Oe(re,U){this.id=typeof re.id=="number"?re.id:void 0,this.type=re.type,this.rawGeometry=re.type===1?[re.geometry]:re.geometry,this.properties=re.tags,this.extent=U||4096}De.prototype.feature=function(re){return new Oe(this.features[re],this.options.extent)},Oe.prototype.loadGeometry=function(){var re=this.rawGeometry;this.geometry=[];for(var U=0;U<re.length;U++){for(var J=re[U],te=[],se=0;se<J.length;se++)te.push(new oe(J[se][0],J[se][1]));this.geometry.push(te)}return this.geometry},Oe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var re=this.geometry,U=1/0,J=-1/0,te=1/0,se=-1/0,Ae=0;Ae<re.length;Ae++)for(var Ee=re[Ae],$=0;$<Ee.length;$++){var O=Ee[$];U=Math.min(U,O.x),J=Math.max(J,O.x),te=Math.min(te,O.y),se=Math.max(se,O.y)}return[U,te,J,se]},Oe.prototype.toGeoJSON=Q.prototype.toGeoJSON;var Pe=u.bx,Se=ce;function _e(re){var U=new Pe;return function(J,te){for(var se in J.layers)te.writeMessage(3,ze,J.layers[se])}(re,U),U.finish()}function ze(re,U){var J;U.writeVarintField(15,re.version||1),U.writeStringField(1,re.name||""),U.writeVarintField(5,re.extent||4096);var te={keys:[],values:[],keycache:{},valuecache:{}};for(J=0;J<re.length;J++)te.feature=re.feature(J),U.writeMessage(2,Re,te);var se=te.keys;for(J=0;J<se.length;J++)U.writeStringField(3,se[J]);var Ae=te.values;for(J=0;J<Ae.length;J++)U.writeMessage(4,bi,Ae[J])}function Re(re,U){var J=re.feature;J.id!==void 0&&U.writeVarintField(1,J.id),U.writeMessage(2,Ye,re),U.writeVarintField(3,J.type),U.writeMessage(4,Bt,J)}function Ye(re,U){var J=re.feature,te=re.keys,se=re.values,Ae=re.keycache,Ee=re.valuecache;for(var $ in J.properties){var O=J.properties[$],V=Ae[$];if(O!==null){V===void 0&&(te.push($),Ae[$]=V=te.length-1),U.writeVarint(V);var q=typeof O;q!=="string"&&q!=="boolean"&&q!=="number"&&(O=JSON.stringify(O));var L=q+":"+O,W=Ee[L];W===void 0&&(se.push(O),Ee[L]=W=se.length-1),U.writeVarint(W)}}}function Xe(re,U){return(U<<3)+(7&re)}function si(re){return re<<1^re>>31}function Bt(re,U){for(var J=re.loadGeometry(),te=re.type,se=0,Ae=0,Ee=J.length,$=0;$<Ee;$++){var O=J[$],V=1;te===1&&(V=O.length),U.writeVarint(Xe(1,V));for(var q=te===3?O.length-1:O.length,L=0;L<q;L++){L===1&&te!==1&&U.writeVarint(Xe(2,q-1));var W=O[L].x-se,ae=O[L].y-Ae;U.writeVarint(si(W)),U.writeVarint(si(ae)),se+=W,Ae+=ae}te===3&&U.writeVarint(Xe(7,1))}}function bi(re,U){var J=typeof re;J==="string"?U.writeStringField(1,re):J==="boolean"?U.writeBooleanField(7,re):J==="number"&&(re%1!=0?U.writeDoubleField(3,re):re<0?U.writeSVarintField(6,re):U.writeVarintField(5,re))}X.exports=_e,X.exports.fromVectorTileJs=_e,X.exports.fromGeojsonVt=function(re,U){U=U||{};var J={};for(var te in re)J[te]=new Se(re[te].features,U),J[te].name=te,J[te].version=U.version,J[te].extent=U.extent;return _e({layers:J})},X.exports.GeoJSONWrapper=Se;var Et=u.bv(X.exports);const Vt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:re=>re},Ki=Math.fround||(zt=new Float32Array(1),re=>(zt[0]=+re,zt[0]));var zt;const _t=3,Dt=5,Ft=6;class oi{constructor(U){this.options=Object.assign(Object.create(Vt),U),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(U){const{log:J,minZoom:te,maxZoom:se}=this.options;J&&console.time("total time");const Ae=`prepare ${U.length} points`;J&&console.time(Ae),this.points=U;const Ee=[];for(let O=0;O<U.length;O++){const V=U[O];if(!V.geometry)continue;const[q,L]=V.geometry.coordinates,W=Ki(Ti(q)),ae=Ki(ht(L));Ee.push(W,ae,1/0,O,-1,1),this.options.reduce&&Ee.push(0)}let $=this.trees[se+1]=this._createTree(Ee);J&&console.timeEnd(Ae);for(let O=se;O>=te;O--){const V=+Date.now();$=this.trees[O]=this._createTree(this._cluster($,O)),J&&console.log("z%d: %d clusters in %dms",O,$.numItems,+Date.now()-V)}return J&&console.timeEnd("total time"),this}getClusters(U,J){let te=((U[0]+180)%360+360)%360-180;const se=Math.max(-90,Math.min(90,U[1]));let Ae=U[2]===180?180:((U[2]+180)%360+360)%360-180;const Ee=Math.max(-90,Math.min(90,U[3]));if(U[2]-U[0]>=360)te=-180,Ae=180;else if(te>Ae){const L=this.getClusters([te,se,180,Ee],J),W=this.getClusters([-180,se,Ae,Ee],J);return L.concat(W)}const $=this.trees[this._limitZoom(J)],O=$.range(Ti(te),ht(Ee),Ti(Ae),ht(se)),V=$.data,q=[];for(const L of O){const W=this.stride*L;q.push(V[W+Dt]>1?pi(V,W,this.clusterProps):this.points[V[W+_t]])}return q}getChildren(U){const J=this._getOriginId(U),te=this._getOriginZoom(U),se="No cluster with the specified id.",Ae=this.trees[te];if(!Ae)throw new Error(se);const Ee=Ae.data;if(J*this.stride>=Ee.length)throw new Error(se);const $=this.options.radius/(this.options.extent*Math.pow(2,te-1)),O=Ae.within(Ee[J*this.stride],Ee[J*this.stride+1],$),V=[];for(const q of O){const L=q*this.stride;Ee[L+4]===U&&V.push(Ee[L+Dt]>1?pi(Ee,L,this.clusterProps):this.points[Ee[L+_t]])}if(V.length===0)throw new Error(se);return V}getLeaves(U,J,te){const se=[];return this._appendLeaves(se,U,J=J||10,te=te||0,0),se}getTile(U,J,te){const se=this.trees[this._limitZoom(U)],Ae=Math.pow(2,U),{extent:Ee,radius:$}=this.options,O=$/Ee,V=(te-O)/Ae,q=(te+1+O)/Ae,L={features:[]};return this._addTileFeatures(se.range((J-O)/Ae,V,(J+1+O)/Ae,q),se.data,J,te,Ae,L),J===0&&this._addTileFeatures(se.range(1-O/Ae,V,1,q),se.data,Ae,te,Ae,L),J===Ae-1&&this._addTileFeatures(se.range(0,V,O/Ae,q),se.data,-1,te,Ae,L),L.features.length?L:null}getClusterExpansionZoom(U){let J=this._getOriginZoom(U)-1;for(;J<=this.options.maxZoom;){const te=this.getChildren(U);if(J++,te.length!==1)break;U=te[0].properties.cluster_id}return J}_appendLeaves(U,J,te,se,Ae){const Ee=this.getChildren(J);for(const $ of Ee){const O=$.properties;if(O&&O.cluster?Ae+O.point_count<=se?Ae+=O.point_count:Ae=this._appendLeaves(U,O.cluster_id,te,se,Ae):Ae<se?Ae++:U.push($),U.length===te)break}return Ae}_createTree(U){const J=new u.au(U.length/this.stride|0,this.options.nodeSize,Float32Array);for(let te=0;te<U.length;te+=this.stride)J.add(U[te],U[te+1]);return J.finish(),J.data=U,J}_addTileFeatures(U,J,te,se,Ae,Ee){for(const $ of U){const O=$*this.stride,V=J[O+Dt]>1;let q,L,W;if(V)q=vi(J,O,this.clusterProps),L=J[O],W=J[O+1];else{const Ie=this.points[J[O+_t]];q=Ie.properties;const[Qe,Ge]=Ie.geometry.coordinates;L=Ti(Qe),W=ht(Ge)}const ae={type:1,geometry:[[Math.round(this.options.extent*(L*Ae-te)),Math.round(this.options.extent*(W*Ae-se))]],tags:q};let Me;Me=V||this.options.generateId?J[O+_t]:this.points[J[O+_t]].id,Me!==void 0&&(ae.id=Me),Ee.features.push(ae)}}_limitZoom(U){return Math.max(this.options.minZoom,Math.min(Math.floor(+U),this.options.maxZoom+1))}_cluster(U,J){const{radius:te,extent:se,reduce:Ae,minPoints:Ee}=this.options,$=te/(se*Math.pow(2,J)),O=U.data,V=[],q=this.stride;for(let L=0;L<O.length;L+=q){if(O[L+2]<=J)continue;O[L+2]=J;const W=O[L],ae=O[L+1],Me=U.within(O[L],O[L+1],$),Ie=O[L+Dt];let Qe=Ie;for(const Ge of Me){const $e=Ge*q;O[$e+2]>J&&(Qe+=O[$e+Dt])}if(Qe>Ie&&Qe>=Ee){let Ge,$e=W*Ie,Te=ae*Ie,gt=-1;const wt=((L/q|0)<<5)+(J+1)+this.points.length;for(const St of Me){const $t=St*q;if(O[$t+2]<=J)continue;O[$t+2]=J;const Tt=O[$t+Dt];$e+=O[$t]*Tt,Te+=O[$t+1]*Tt,O[$t+4]=wt,Ae&&(Ge||(Ge=this._map(O,L,!0),gt=this.clusterProps.length,this.clusterProps.push(Ge)),Ae(Ge,this._map(O,$t)))}O[L+4]=wt,V.push($e/Qe,Te/Qe,1/0,wt,-1,Qe),Ae&&V.push(gt)}else{for(let Ge=0;Ge<q;Ge++)V.push(O[L+Ge]);if(Qe>1)for(const Ge of Me){const $e=Ge*q;if(!(O[$e+2]<=J)){O[$e+2]=J;for(let Te=0;Te<q;Te++)V.push(O[$e+Te])}}}}return V}_getOriginId(U){return U-this.points.length>>5}_getOriginZoom(U){return(U-this.points.length)%32}_map(U,J,te){if(U[J+Dt]>1){const Ee=this.clusterProps[U[J+Ft]];return te?Object.assign({},Ee):Ee}const se=this.points[U[J+_t]].properties,Ae=this.options.map(se);return te&&Ae===se?Object.assign({},Ae):Ae}}function pi(re,U,J){return{type:"Feature",id:re[U+_t],properties:vi(re,U,J),geometry:{type:"Point",coordinates:[(te=re[U],360*(te-.5)),mi(re[U+1])]}};var te}function vi(re,U,J){const te=re[U+Dt],se=te>=1e4?`${Math.round(te/1e3)}k`:te>=1e3?Math.round(te/100)/10+"k":te,Ae=re[U+Ft],Ee=Ae===-1?{}:Object.assign({},J[Ae]);return Object.assign(Ee,{cluster:!0,cluster_id:re[U+_t],point_count:te,point_count_abbreviated:se})}function Ti(re){return re/360+.5}function ht(re){const U=Math.sin(re*Math.PI/180),J=.5-.25*Math.log((1+U)/(1-U))/Math.PI;return J<0?0:J>1?1:J}function mi(re){const U=(180-360*re)*Math.PI/180;return 360*Math.atan(Math.exp(U))/Math.PI-90}function Pi(re,U,J,te){for(var se,Ae=te,Ee=J-U>>1,$=J-U,O=re[U],V=re[U+1],q=re[J],L=re[J+1],W=U+3;W<J;W+=3){var ae=Ni(re[W],re[W+1],O,V,q,L);if(ae>Ae)se=W,Ae=ae;else if(ae===Ae){var Me=Math.abs(W-Ee);Me<$&&(se=W,$=Me)}}Ae>te&&(se-U>3&&Pi(re,U,se,te),re[se+2]=Ae,J-se>3&&Pi(re,se,J,te))}function Ni(re,U,J,te,se,Ae){var Ee=se-J,$=Ae-te;if(Ee!==0||$!==0){var O=((re-J)*Ee+(U-te)*$)/(Ee*Ee+$*$);O>1?(J=se,te=Ae):O>0&&(J+=Ee*O,te+=$*O)}return(Ee=re-J)*Ee+($=U-te)*$}function Oi(re,U,J,te){var se={id:re===void 0?null:re,type:U,geometry:J,tags:te,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ae){var Ee=Ae.geometry,$=Ae.type;if($==="Point"||$==="MultiPoint"||$==="LineString")mn(Ae,Ee);else if($==="Polygon"||$==="MultiLineString")for(var O=0;O<Ee.length;O++)mn(Ae,Ee[O]);else if($==="MultiPolygon")for(O=0;O<Ee.length;O++)for(var V=0;V<Ee[O].length;V++)mn(Ae,Ee[O][V])}(se),se}function mn(re,U){for(var J=0;J<U.length;J+=3)re.minX=Math.min(re.minX,U[J]),re.minY=Math.min(re.minY,U[J+1]),re.maxX=Math.max(re.maxX,U[J]),re.maxY=Math.max(re.maxY,U[J+1])}function vn(re,U,J,te){if(U.geometry){var se=U.geometry.coordinates,Ae=U.geometry.type,Ee=Math.pow(J.tolerance/((1<<J.maxZoom)*J.extent),2),$=[],O=U.id;if(J.promoteId?O=U.properties[J.promoteId]:J.generateId&&(O=te||0),Ae==="Point")Yi(se,$);else if(Ae==="MultiPoint")for(var V=0;V<se.length;V++)Yi(se[V],$);else if(Ae==="LineString")Kn(se,$,Ee,!1);else if(Ae==="MultiLineString"){if(J.lineMetrics){for(V=0;V<se.length;V++)Kn(se[V],$=[],Ee,!1),re.push(Oi(O,"LineString",$,U.properties));return}je(se,$,Ee,!1)}else if(Ae==="Polygon")je(se,$,Ee,!0);else{if(Ae!=="MultiPolygon"){if(Ae==="GeometryCollection"){for(V=0;V<U.geometry.geometries.length;V++)vn(re,{id:O,geometry:U.geometry.geometries[V],properties:U.properties},J,te);return}throw new Error("Input data is not a valid GeoJSON object.")}for(V=0;V<se.length;V++){var q=[];je(se[V],q,Ee,!0),$.push(q)}}re.push(Oi(O,Ae,$,U.properties))}}function Yi(re,U){U.push(Ci(re[0])),U.push(Dn(re[1])),U.push(0)}function Kn(re,U,J,te){for(var se,Ae,Ee=0,$=0;$<re.length;$++){var O=Ci(re[$][0]),V=Dn(re[$][1]);U.push(O),U.push(V),U.push(0),$>0&&(Ee+=te?(se*V-O*Ae)/2:Math.sqrt(Math.pow(O-se,2)+Math.pow(V-Ae,2))),se=O,Ae=V}var q=U.length-3;U[2]=1,Pi(U,0,q,J),U[q+2]=1,U.size=Math.abs(Ee),U.start=0,U.end=U.size}function je(re,U,J,te){for(var se=0;se<re.length;se++){var Ae=[];Kn(re[se],Ae,J,te),U.push(Ae)}}function Ci(re){return re/360+.5}function Dn(re){var U=Math.sin(re*Math.PI/180),J=.5-.25*Math.log((1+U)/(1-U))/Math.PI;return J<0?0:J>1?1:J}function xi(re,U,J,te,se,Ae,Ee,$){if(te/=U,Ae>=(J/=U)&&Ee<te)return re;if(Ee<J||Ae>=te)return null;for(var O=[],V=0;V<re.length;V++){var q=re[V],L=q.geometry,W=q.type,ae=se===0?q.minX:q.minY,Me=se===0?q.maxX:q.maxY;if(ae>=J&&Me<te)O.push(q);else if(!(Me<J||ae>=te)){var Ie=[];if(W==="Point"||W==="MultiPoint")tn(L,Ie,J,te,se);else if(W==="LineString")xn(L,Ie,J,te,se,!1,$.lineMetrics);else if(W==="MultiLineString")bn(L,Ie,J,te,se,!1);else if(W==="Polygon")bn(L,Ie,J,te,se,!0);else if(W==="MultiPolygon")for(var Qe=0;Qe<L.length;Qe++){var Ge=[];bn(L[Qe],Ge,J,te,se,!0),Ge.length&&Ie.push(Ge)}if(Ie.length){if($.lineMetrics&&W==="LineString"){for(Qe=0;Qe<Ie.length;Qe++)O.push(Oi(q.id,W,Ie[Qe],q.tags));continue}W!=="LineString"&&W!=="MultiLineString"||(Ie.length===1?(W="LineString",Ie=Ie[0]):W="MultiLineString"),W!=="Point"&&W!=="MultiPoint"||(W=Ie.length===3?"Point":"MultiPoint"),O.push(Oi(q.id,W,Ie,q.tags))}}}return O.length?O:null}function tn(re,U,J,te,se){for(var Ae=0;Ae<re.length;Ae+=3){var Ee=re[Ae+se];Ee>=J&&Ee<=te&&(U.push(re[Ae]),U.push(re[Ae+1]),U.push(re[Ae+2]))}}function xn(re,U,J,te,se,Ae,Ee){for(var $,O,V=tt(re),q=se===0?cn:ta,L=re.start,W=0;W<re.length-3;W+=3){var ae=re[W],Me=re[W+1],Ie=re[W+2],Qe=re[W+3],Ge=re[W+4],$e=se===0?ae:Me,Te=se===0?Qe:Ge,gt=!1;Ee&&($=Math.sqrt(Math.pow(ae-Qe,2)+Math.pow(Me-Ge,2))),$e<J?Te>J&&(O=q(V,ae,Me,Qe,Ge,J),Ee&&(V.start=L+$*O)):$e>te?Te<te&&(O=q(V,ae,Me,Qe,Ge,te),Ee&&(V.start=L+$*O)):_n(V,ae,Me,Ie),Te<J&&$e>=J&&(O=q(V,ae,Me,Qe,Ge,J),gt=!0),Te>te&&$e<=te&&(O=q(V,ae,Me,Qe,Ge,te),gt=!0),!Ae&&gt&&(Ee&&(V.end=L+$*O),U.push(V),V=tt(re)),Ee&&(L+=$)}var wt=re.length-3;ae=re[wt],Me=re[wt+1],Ie=re[wt+2],($e=se===0?ae:Me)>=J&&$e<=te&&_n(V,ae,Me,Ie),wt=V.length-3,Ae&&wt>=3&&(V[wt]!==V[0]||V[wt+1]!==V[1])&&_n(V,V[0],V[1],V[2]),V.length&&U.push(V)}function tt(re){var U=[];return U.size=re.size,U.start=re.start,U.end=re.end,U}function bn(re,U,J,te,se,Ae){for(var Ee=0;Ee<re.length;Ee++)xn(re[Ee],U,J,te,se,Ae,!1)}function _n(re,U,J,te){re.push(U),re.push(J),re.push(te)}function cn(re,U,J,te,se,Ae){var Ee=(Ae-U)/(te-U);return re.push(Ae),re.push(J+(se-J)*Ee),re.push(1),Ee}function ta(re,U,J,te,se,Ae){var Ee=(Ae-J)/(se-J);return re.push(U+(te-U)*Ee),re.push(Ae),re.push(1),Ee}function pa(re,U){for(var J=[],te=0;te<re.length;te++){var se,Ae=re[te],Ee=Ae.type;if(Ee==="Point"||Ee==="MultiPoint"||Ee==="LineString")se=rt(Ae.geometry,U);else if(Ee==="MultiLineString"||Ee==="Polygon"){se=[];for(var $=0;$<Ae.geometry.length;$++)se.push(rt(Ae.geometry[$],U))}else if(Ee==="MultiPolygon")for(se=[],$=0;$<Ae.geometry.length;$++){for(var O=[],V=0;V<Ae.geometry[$].length;V++)O.push(rt(Ae.geometry[$][V],U));se.push(O)}J.push(Oi(Ae.id,Ee,se,Ae.tags))}return J}function rt(re,U){var J=[];J.size=re.size,re.start!==void 0&&(J.start=re.start,J.end=re.end);for(var te=0;te<re.length;te+=3)J.push(re[te]+U,re[te+1],re[te+2]);return J}function jn(re,U){if(re.transformed)return re;var J,te,se,Ae=1<<re.z,Ee=re.x,$=re.y;for(J=0;J<re.features.length;J++){var O=re.features[J],V=O.geometry,q=O.type;if(O.geometry=[],q===1)for(te=0;te<V.length;te+=2)O.geometry.push(hn(V[te],V[te+1],U,Ae,Ee,$));else for(te=0;te<V.length;te++){var L=[];for(se=0;se<V[te].length;se+=2)L.push(hn(V[te][se],V[te][se+1],U,Ae,Ee,$));O.geometry.push(L)}}return re.transformed=!0,re}function hn(re,U,J,te,se,Ae){return[Math.round(J*(re*te-se)),Math.round(J*(U*te-Ae))]}function Un(re,U,J,te,se){for(var Ae=U===se.maxZoom?0:se.tolerance/((1<<U)*se.extent),Ee={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:J,y:te,z:U,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},$=0;$<re.length;$++){Ee.numFeatures++,Ii(Ee,re[$],Ae,se);var O=re[$].minX,V=re[$].minY,q=re[$].maxX,L=re[$].maxY;O<Ee.minX&&(Ee.minX=O),V<Ee.minY&&(Ee.minY=V),q>Ee.maxX&&(Ee.maxX=q),L>Ee.maxY&&(Ee.maxY=L)}return Ee}function Ii(re,U,J,te){var se=U.geometry,Ae=U.type,Ee=[];if(Ae==="Point"||Ae==="MultiPoint")for(var $=0;$<se.length;$+=3)Ee.push(se[$]),Ee.push(se[$+1]),re.numPoints++,re.numSimplified++;else if(Ae==="LineString")lt(Ee,se,re,J,!1,!1);else if(Ae==="MultiLineString"||Ae==="Polygon")for($=0;$<se.length;$++)lt(Ee,se[$],re,J,Ae==="Polygon",$===0);else if(Ae==="MultiPolygon")for(var O=0;O<se.length;O++){var V=se[O];for($=0;$<V.length;$++)lt(Ee,V[$],re,J,!0,$===0)}if(Ee.length){var q=U.tags||null;if(Ae==="LineString"&&te.lineMetrics){for(var L in q={},U.tags)q[L]=U.tags[L];q.mapbox_clip_start=se.start/se.size,q.mapbox_clip_end=se.end/se.size}var W={geometry:Ee,type:Ae==="Polygon"||Ae==="MultiPolygon"?3:Ae==="LineString"||Ae==="MultiLineString"?2:1,tags:q};U.id!==null&&(W.id=U.id),re.features.push(W)}}function lt(re,U,J,te,se,Ae){var Ee=te*te;if(te>0&&U.size<(se?Ee:te))J.numPoints+=U.length/3;else{for(var $=[],O=0;O<U.length;O+=3)(te===0||U[O+2]>Ee)&&(J.numSimplified++,$.push(U[O]),$.push(U[O+1])),J.numPoints++;se&&function(V,q){for(var L=0,W=0,ae=V.length,Me=ae-2;W<ae;Me=W,W+=2)L+=(V[W]-V[Me])*(V[W+1]+V[Me+1]);if(L>0===q)for(W=0,ae=V.length;W<ae/2;W+=2){var Ie=V[W],Qe=V[W+1];V[W]=V[ae-2-W],V[W+1]=V[ae-1-W],V[ae-2-W]=Ie,V[ae-1-W]=Qe}}($,Ae),re.push($)}}function gi(re,U){var J=(U=this.options=function(se,Ae){for(var Ee in Ae)se[Ee]=Ae[Ee];return se}(Object.create(this.options),U)).debug;if(J&&console.time("preprocess data"),U.maxZoom<0||U.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(U.promoteId&&U.generateId)throw new Error("promoteId and generateId cannot be used together.");var te=function(se,Ae){var Ee=[];if(se.type==="FeatureCollection")for(var $=0;$<se.features.length;$++)vn(Ee,se.features[$],Ae,$);else vn(Ee,se.type==="Feature"?se:{geometry:se},Ae);return Ee}(re,U);this.tiles={},this.tileCoords=[],J&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",U.indexMaxZoom,U.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),te=function(se,Ae){var Ee=Ae.buffer/Ae.extent,$=se,O=xi(se,1,-1-Ee,Ee,0,-1,2,Ae),V=xi(se,1,1-Ee,2+Ee,0,-1,2,Ae);return(O||V)&&($=xi(se,1,-Ee,1+Ee,0,-1,2,Ae)||[],O&&($=pa(O,1).concat($)),V&&($=$.concat(pa(V,-1)))),$}(te,U),te.length&&this.splitTile(te,0,0,0),J&&(te.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function _i(re,U,J){return 32*((1<<re)*J+U)+re}function on(re,U){return U?re.properties[U]:re.id}function wn(re,U){if(re==null)return!0;if(re.type==="Feature")return on(re,U)!=null;if(re.type==="FeatureCollection"){const J=new Set;for(const te of re.features){const se=on(te,U);if(se==null||J.has(se))return!1;J.add(se)}return!0}return!1}function ni(re,U){const J=new Map;if(re!=null)if(re.type==="Feature")J.set(on(re,U),re);else for(const te of re.features)J.set(on(te,U),te);return J}gi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},gi.prototype.splitTile=function(re,U,J,te,se,Ae,Ee){for(var $=[re,U,J,te],O=this.options,V=O.debug;$.length;){te=$.pop(),J=$.pop(),U=$.pop(),re=$.pop();var q=1<<U,L=_i(U,J,te),W=this.tiles[L];if(!W&&(V>1&&console.time("creation"),W=this.tiles[L]=Un(re,U,J,te,O),this.tileCoords.push({z:U,x:J,y:te}),V)){V>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",U,J,te,W.numFeatures,W.numPoints,W.numSimplified),console.timeEnd("creation"));var ae="z"+U;this.stats[ae]=(this.stats[ae]||0)+1,this.total++}if(W.source=re,se){if(U===O.maxZoom||U===se)continue;var Me=1<<se-U;if(J!==Math.floor(Ae/Me)||te!==Math.floor(Ee/Me))continue}else if(U===O.indexMaxZoom||W.numPoints<=O.indexMaxPoints)continue;if(W.source=null,re.length!==0){V>1&&console.time("clipping");var Ie,Qe,Ge,$e,Te,gt,wt=.5*O.buffer/O.extent,St=.5-wt,$t=.5+wt,Tt=1+wt;Ie=Qe=Ge=$e=null,Te=xi(re,q,J-wt,J+$t,0,W.minX,W.maxX,O),gt=xi(re,q,J+St,J+Tt,0,W.minX,W.maxX,O),re=null,Te&&(Ie=xi(Te,q,te-wt,te+$t,1,W.minY,W.maxY,O),Qe=xi(Te,q,te+St,te+Tt,1,W.minY,W.maxY,O),Te=null),gt&&(Ge=xi(gt,q,te-wt,te+$t,1,W.minY,W.maxY,O),$e=xi(gt,q,te+St,te+Tt,1,W.minY,W.maxY,O),gt=null),V>1&&console.timeEnd("clipping"),$.push(Ie||[],U+1,2*J,2*te),$.push(Qe||[],U+1,2*J,2*te+1),$.push(Ge||[],U+1,2*J+1,2*te),$.push($e||[],U+1,2*J+1,2*te+1)}}},gi.prototype.getTile=function(re,U,J){var te=this.options,se=te.extent,Ae=te.debug;if(re<0||re>24)return null;var Ee=1<<re,$=_i(re,U=(U%Ee+Ee)%Ee,J);if(this.tiles[$])return jn(this.tiles[$],se);Ae>1&&console.log("drilling down to z%d-%d-%d",re,U,J);for(var O,V=re,q=U,L=J;!O&&V>0;)V--,q=Math.floor(q/2),L=Math.floor(L/2),O=this.tiles[_i(V,q,L)];return O&&O.source?(Ae>1&&console.log("found parent tile z%d-%d-%d",V,q,L),Ae>1&&console.time("drilling down"),this.splitTile(O.source,V,q,L,re,U,J),Ae>1&&console.timeEnd("drilling down"),this.tiles[$]?jn(this.tiles[$],se):null):null};class Ei extends M{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(U,J){return u._(this,void 0,void 0,function*(){const te=U.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const se=this._geoJSONIndex.getTile(te.z,te.x,te.y);if(!se)return null;const Ae=new class{constructor($){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=u.W,this.length=$.length,this._features=$}feature($){return new class{constructor(O){this._feature=O,this.extent=u.W,this.type=O.type,this.properties=O.tags,"id"in O&&!isNaN(O.id)&&(this.id=parseInt(O.id,10))}loadGeometry(){if(this._feature.type===1){const O=[];for(const V of this._feature.geometry)O.push([new u.P(V[0],V[1])]);return O}{const O=[];for(const V of this._feature.geometry){const q=[];for(const L of V)q.push(new u.P(L[0],L[1]));O.push(q)}return O}}toGeoJSON(O,V,q){return Y.call(this,O,V,q)}}(this._features[$])}}(se.features);let Ee=Et(Ae);return Ee.byteOffset===0&&Ee.byteLength===Ee.buffer.byteLength||(Ee=new Uint8Array(Ee)),{vectorTile:Ae,rawData:Ee.buffer}})}loadData(U){return u._(this,void 0,void 0,function*(){var J;(J=this._pendingRequest)===null||J===void 0||J.abort();const te=!!(U&&U.request&&U.request.collectResourceTiming)&&new u.bs(U.request);this._pendingRequest=new AbortController;try{let se=yield this.loadGeoJSON(U,this._pendingRequest);if(delete this._pendingRequest,typeof se!="object")throw new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`);if(G(se,!0),U.filter){const Ee=u.by(U.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ee.result==="error")throw new Error(Ee.value.map(O=>`${O.key}: ${O.message}`).join(", "));se={type:"FeatureCollection",features:se.features.filter(O=>Ee.value.evaluate({zoom:0},O))}}this._geoJSONIndex=U.cluster?new oi(function({superclusterOptions:Ee,clusterProperties:$}){if(!$||!Ee)return Ee;const O={},V={},q={accumulated:null,zoom:0},L={properties:null},W=Object.keys($);for(const ae of W){const[Me,Ie]=$[ae],Qe=u.by(Ie),Ge=u.by(typeof Me=="string"?[Me,["accumulated"],["get",ae]]:Me);O[ae]=Qe.value,V[ae]=Ge.value}return Ee.map=ae=>{L.properties=ae;const Me={};for(const Ie of W)Me[Ie]=O[Ie].evaluate(q,L);return Me},Ee.reduce=(ae,Me)=>{L.properties=Me;for(const Ie of W)q.accumulated=ae[Ie],ae[Ie]=V[Ie].evaluate(q,L)},Ee}(U)).load(se.features):function(Ee,$){return new gi(Ee,$)}(se,U.geojsonVtOptions),this.loaded={};const Ae={};if(te){const Ee=te.finish();Ee&&(Ae.resourceTiming={},Ae.resourceTiming[U.source]=JSON.parse(JSON.stringify(Ee)))}return Ae}catch(se){if(delete this._pendingRequest,u.bz(se))return{abandoned:!0};throw se}})}reloadTile(U){const J=this.loaded;return J&&J[U.uid]?super.reloadTile(U):this.loadTile(U)}loadGeoJSON(U,J){return u._(this,void 0,void 0,function*(){const{promoteId:te}=U;if(U.request){const se=yield u.h(U.request,J);return this._dataUpdateable=wn(se.data,te)?ni(se.data,te):void 0,se.data}if(typeof U.data=="string")try{const se=JSON.parse(U.data);return this._dataUpdateable=wn(se,te)?ni(se,te):void 0,se}catch{throw new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`)}if(!U.dataDiff)throw new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${U.source}`);return function(se,Ae,Ee){var $,O,V,q;if(Ae.removeAll&&se.clear(),Ae.remove)for(const L of Ae.remove)se.delete(L);if(Ae.add)for(const L of Ae.add){const W=on(L,Ee);W!=null&&se.set(W,L)}if(Ae.update)for(const L of Ae.update){let W=se.get(L.id);if(W==null)continue;const ae=!L.removeAllProperties&&((($=L.removeProperties)===null||$===void 0?void 0:$.length)>0||((O=L.addOrUpdateProperties)===null||O===void 0?void 0:O.length)>0);if((L.newGeometry||L.removeAllProperties||ae)&&(W=Object.assign({},W),se.set(L.id,W),ae&&(W.properties=Object.assign({},W.properties))),L.newGeometry&&(W.geometry=L.newGeometry),L.removeAllProperties)W.properties={};else if(((V=L.removeProperties)===null||V===void 0?void 0:V.length)>0)for(const Me of L.removeProperties)Object.prototype.hasOwnProperty.call(W.properties,Me)&&delete W.properties[Me];if(((q=L.addOrUpdateProperties)===null||q===void 0?void 0:q.length)>0)for(const{key:Me,value:Ie}of L.addOrUpdateProperties)W.properties[Me]=Ie}}(this._dataUpdateable,U.dataDiff,te),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(U){return u._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(U){return this._geoJSONIndex.getClusterExpansionZoom(U.clusterId)}getClusterChildren(U){return this._geoJSONIndex.getChildren(U.clusterId)}getClusterLeaves(U){return this._geoJSONIndex.getLeaves(U.clusterId,U.limit,U.offset)}}class ji{constructor(U){this.self=U,this.actor=new u.C(U),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(J,te)=>{if(this.externalWorkerSourceTypes[J])throw new Error(`Worker source with name "${J}" already registered.`);this.externalWorkerSourceTypes[J]=te},this.self.addProtocol=u.bf,this.self.removeProtocol=u.bg,this.self.registerRTLTextPlugin=J=>{if(u.bA.isParsed())throw new Error("RTL text plugin already registered.");u.bA.setMethods(J)},this.actor.registerMessageHandler("loadDEMTile",(J,te)=>this._getDEMWorkerSource(J,te.source).loadTile(te)),this.actor.registerMessageHandler("removeDEMTile",(J,te)=>u._(this,void 0,void 0,function*(){this._getDEMWorkerSource(J,te.source).removeTile(te)})),this.actor.registerMessageHandler("getClusterExpansionZoom",(J,te)=>u._(this,void 0,void 0,function*(){return this._getWorkerSource(J,te.type,te.source).getClusterExpansionZoom(te)})),this.actor.registerMessageHandler("getClusterChildren",(J,te)=>u._(this,void 0,void 0,function*(){return this._getWorkerSource(J,te.type,te.source).getClusterChildren(te)})),this.actor.registerMessageHandler("getClusterLeaves",(J,te)=>u._(this,void 0,void 0,function*(){return this._getWorkerSource(J,te.type,te.source).getClusterLeaves(te)})),this.actor.registerMessageHandler("loadData",(J,te)=>this._getWorkerSource(J,te.type,te.source).loadData(te)),this.actor.registerMessageHandler("loadTile",(J,te)=>this._getWorkerSource(J,te.type,te.source).loadTile(te)),this.actor.registerMessageHandler("reloadTile",(J,te)=>this._getWorkerSource(J,te.type,te.source).reloadTile(te)),this.actor.registerMessageHandler("abortTile",(J,te)=>this._getWorkerSource(J,te.type,te.source).abortTile(te)),this.actor.registerMessageHandler("removeTile",(J,te)=>this._getWorkerSource(J,te.type,te.source).removeTile(te)),this.actor.registerMessageHandler("removeSource",(J,te)=>u._(this,void 0,void 0,function*(){if(!this.workerSources[J]||!this.workerSources[J][te.type]||!this.workerSources[J][te.type][te.source])return;const se=this.workerSources[J][te.type][te.source];delete this.workerSources[J][te.type][te.source],se.removeSource!==void 0&&se.removeSource(te)})),this.actor.registerMessageHandler("removeMap",J=>u._(this,void 0,void 0,function*(){delete this.layerIndexes[J],delete this.availableImages[J],delete this.workerSources[J],delete this.demWorkerSources[J]})),this.actor.registerMessageHandler("setReferrer",(J,te)=>u._(this,void 0,void 0,function*(){this.referrer=te})),this.actor.registerMessageHandler("syncRTLPluginState",(J,te)=>this._syncRTLPluginState(J,te)),this.actor.registerMessageHandler("importScript",(J,te)=>u._(this,void 0,void 0,function*(){this.self.importScripts(te)})),this.actor.registerMessageHandler("setImages",(J,te)=>this._setImages(J,te)),this.actor.registerMessageHandler("updateLayers",(J,te)=>u._(this,void 0,void 0,function*(){this._getLayerIndex(J).update(te.layers,te.removedIds)})),this.actor.registerMessageHandler("setLayers",(J,te)=>u._(this,void 0,void 0,function*(){this._getLayerIndex(J).replace(te)}))}_setImages(U,J){return u._(this,void 0,void 0,function*(){this.availableImages[U]=J;for(const te in this.workerSources[U]){const se=this.workerSources[U][te];for(const Ae in se)se[Ae].availableImages=J}})}_syncRTLPluginState(U,J){return u._(this,void 0,void 0,function*(){if(u.bA.isParsed())return u.bA.getState();if(J.pluginStatus!=="loading")return u.bA.setState(J),J;const te=J.pluginURL;if(this.self.importScripts(te),u.bA.isParsed()){const se={pluginStatus:"loaded",pluginURL:te};return u.bA.setState(se),se}throw u.bA.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${te}`)})}_getAvailableImages(U){let J=this.availableImages[U];return J||(J=[]),J}_getLayerIndex(U){let J=this.layerIndexes[U];return J||(J=this.layerIndexes[U]=new o),J}_getWorkerSource(U,J,te){if(this.workerSources[U]||(this.workerSources[U]={}),this.workerSources[U][J]||(this.workerSources[U][J]={}),!this.workerSources[U][J][te]){const se={sendAsync:(Ae,Ee)=>(Ae.targetMapId=U,this.actor.sendAsync(Ae,Ee))};switch(J){case"vector":this.workerSources[U][J][te]=new M(se,this._getLayerIndex(U),this._getAvailableImages(U));break;case"geojson":this.workerSources[U][J][te]=new Ei(se,this._getLayerIndex(U),this._getAvailableImages(U));break;default:this.workerSources[U][J][te]=new this.externalWorkerSourceTypes[J](se,this._getLayerIndex(U),this._getAvailableImages(U))}}return this.workerSources[U][J][te]}_getDEMWorkerSource(U,J){return this.demWorkerSources[U]||(this.demWorkerSources[U]={}),this.demWorkerSources[U][J]||(this.demWorkerSources[U][J]=new S),this.demWorkerSources[U][J]}}return u.i(self)&&(self.worker=new ji(self)),ji}),s("index",["exports","./shared"],function(u,o){var p="4.1.2";let _,v;const M={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:b=>new Promise((r,d)=>{const m=requestAnimationFrame(r);b.signal.addEventListener("abort",()=>{cancelAnimationFrame(m),d(o.c())})}),getImageData(b,r=0){return this.getImageCanvasContext(b).getImageData(-r,-r,b.width+2*r,b.height+2*r)},getImageCanvasContext(b){const r=window.document.createElement("canvas"),d=r.getContext("2d",{willReadFrequently:!0});if(!d)throw new Error("failed to create canvas 2d context");return r.width=b.width,r.height=b.height,d.drawImage(b,0,0,b.width,b.height),d},resolveURL:b=>(_||(_=document.createElement("a")),_.href=b,_.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(v==null&&(v=matchMedia("(prefers-reduced-motion: reduce)")),v.matches)}};class S{static testProp(r){if(!S.docStyle)return r[0];for(let d=0;d<r.length;d++)if(r[d]in S.docStyle)return r[d];return r[0]}static create(r,d,m){const g=window.document.createElement(r);return d!==void 0&&(g.className=d),m&&m.appendChild(g),g}static createNS(r,d){return window.document.createElementNS(r,d)}static disableDrag(){S.docStyle&&S.selectProp&&(S.userSelect=S.docStyle[S.selectProp],S.docStyle[S.selectProp]="none")}static enableDrag(){S.docStyle&&S.selectProp&&(S.docStyle[S.selectProp]=S.userSelect)}static setTransform(r,d){r.style[S.transformProp]=d}static addEventListener(r,d,m,g={}){r.addEventListener(d,m,"passive"in g?g:g.capture)}static removeEventListener(r,d,m,g={}){r.removeEventListener(d,m,"passive"in g?g:g.capture)}static suppressClickInternal(r){r.preventDefault(),r.stopPropagation(),window.removeEventListener("click",S.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",S.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",S.suppressClickInternal,!0)},0)}static getScale(r){const d=r.getBoundingClientRect();return{x:d.width/r.offsetWidth||1,y:d.height/r.offsetHeight||1,boundingClientRect:d}}static getPoint(r,d,m){const g=d.boundingClientRect;return new o.P((m.clientX-g.left)/d.x-r.clientLeft,(m.clientY-g.top)/d.y-r.clientTop)}static mousePos(r,d){const m=S.getScale(r);return S.getPoint(r,m,d)}static touchPos(r,d){const m=[],g=S.getScale(r);for(let x=0;x<d.length;x++)m.push(S.getPoint(r,g,d[x]));return m}static mouseButton(r){return r.button}static remove(r){r.parentNode&&r.parentNode.removeChild(r)}}S.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,S.selectProp=S.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),S.transformProp=S.testProp(["transform","WebkitTransform"]);const I={supported:!1,testSupport:function(b){!Y&&G&&(X?oe(b):R=b)}};let R,G,Y=!1,X=!1;function oe(b){const r=b.createTexture();b.bindTexture(b.TEXTURE_2D,r);try{if(b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,G),b.isContextLost())return;I.supported=!0}catch{}b.deleteTexture(r),Y=!0}var Q,ce;typeof document<"u"&&(G=document.createElement("img"),G.onload=function(){R&&oe(R),R=null,X=!0},G.onerror=function(){Y=!0,R=null},G.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(b){let r,d,m,g;b.resetRequestQueue=()=>{r=[],d=0,m=0,g={}},b.addThrottleControl=A=>{const F=m++;return g[F]=A,F},b.removeThrottleControl=A=>{delete g[A],T()},b.getImage=(A,F,j=!0)=>new Promise((Z,ie)=>{I.supported&&(A.headers||(A.headers={}),A.headers.accept="image/webp,*/*"),o.e(A,{type:"image"}),r.push({abortController:F,requestParameters:A,supportImageRefresh:j,state:"queued",onError:pe=>{ie(pe)},onSuccess:pe=>{Z(pe)}}),T()});const x=A=>o._(this,void 0,void 0,function*(){A.state="running";const{requestParameters:F,supportImageRefresh:j,onError:Z,onSuccess:ie,abortController:pe}=A,fe=j===!1&&!o.i(self)&&!o.g(F.url)&&(!F.headers||Object.keys(F.headers).reduce((Le,We)=>Le&&We==="accept",!0));d++;const ge=fe?C(F,pe):o.m(F,pe);try{const Le=yield ge;delete A.abortController,A.state="completed",Le.data instanceof HTMLImageElement||o.b(Le.data)?ie(Le):Le.data&&ie({data:yield(le=Le.data,typeof createImageBitmap=="function"?o.d(le):o.f(le)),cacheControl:Le.cacheControl,expires:Le.expires})}catch(Le){delete A.abortController,Z(Le)}finally{d--,T()}var le}),T=()=>{const A=(()=>{for(const F of Object.keys(g))if(g[F]())return!0;return!1})()?o.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let F=d;F<A&&r.length>0;F++){const j=r.shift();j.abortController.signal.aborted?F--:x(j)}},C=(A,F)=>new Promise((j,Z)=>{const ie=new Image,pe=A.url,fe=A.credentials;fe&&fe==="include"?ie.crossOrigin="use-credentials":(fe&&fe==="same-origin"||!o.s(pe))&&(ie.crossOrigin="anonymous"),F.signal.addEventListener("abort",()=>{ie.src="",Z(o.c())}),ie.fetchPriority="high",ie.onload=()=>{ie.onerror=ie.onload=null,j({data:ie})},ie.onerror=()=>{ie.onerror=ie.onload=null,F.signal.aborted||Z(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},ie.src=pe})}(Q||(Q={})),Q.resetRequestQueue(),function(b){b.Glyphs="Glyphs",b.Image="Image",b.Source="Source",b.SpriteImage="SpriteImage",b.SpriteJSON="SpriteJSON",b.Style="Style",b.Tile="Tile",b.Unknown="Unknown"}(ce||(ce={}));class De{constructor(r){this._transformRequestFn=r}transformRequest(r,d){return this._transformRequestFn&&this._transformRequestFn(r,d)||{url:r}}normalizeSpriteURL(r,d,m){const g=function(x){const T=x.match(Oe);if(!T)throw new Error(`Unable to parse URL "${x}"`);return{protocol:T[1],authority:T[2],path:T[3]||"/",params:T[4]?T[4].split("&"):[]}}(r);return g.path+=`${d}${m}`,function(x){const T=x.params.length?`?${x.params.join("&")}`:"";return`${x.protocol}://${x.authority}${x.path}${T}`}(g)}setTransformRequest(r){this._transformRequestFn=r}}const Oe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Pe(b){var r=new o.A(3);return r[0]=b[0],r[1]=b[1],r[2]=b[2],r}var Se,_e=function(b,r,d){return b[0]=r[0]-d[0],b[1]=r[1]-d[1],b[2]=r[2]-d[2],b};Se=new o.A(3),o.A!=Float32Array&&(Se[0]=0,Se[1]=0,Se[2]=0);var ze=function(b){var r=b[0],d=b[1];return r*r+d*d};function Re(b){const r=[];if(typeof b=="string")r.push({id:"default",url:b});else if(b&&b.length>0){const d=[];for(const{id:m,url:g}of b){const x=`${m}${g}`;d.indexOf(x)===-1&&(d.push(x),r.push({id:m,url:g}))}}return r}(function(){var b=new o.A(2);o.A!=Float32Array&&(b[0]=0,b[1]=0)})();class Ye{constructor(r,d,m,g){this.context=r,this.format=m,this.texture=r.gl.createTexture(),this.update(d,g)}update(r,d,m){const{width:g,height:x}=r,T=!(this.size&&this.size[0]===g&&this.size[1]===x||m),{context:C}=this,{gl:A}=C;if(this.useMipmap=!!(d&&d.useMipmap),A.bindTexture(A.TEXTURE_2D,this.texture),C.pixelStoreUnpackFlipY.set(!1),C.pixelStoreUnpack.set(1),C.pixelStoreUnpackPremultiplyAlpha.set(this.format===A.RGBA&&(!d||d.premultiply!==!1)),T)this.size=[g,x],r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||o.b(r)?A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,A.UNSIGNED_BYTE,r):A.texImage2D(A.TEXTURE_2D,0,this.format,g,x,0,this.format,A.UNSIGNED_BYTE,r.data);else{const{x:F,y:j}=m||{x:0,y:0};r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||o.b(r)?A.texSubImage2D(A.TEXTURE_2D,0,F,j,A.RGBA,A.UNSIGNED_BYTE,r):A.texSubImage2D(A.TEXTURE_2D,0,F,j,g,x,A.RGBA,A.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&A.generateMipmap(A.TEXTURE_2D)}bind(r,d,m){const{context:g}=this,{gl:x}=g;x.bindTexture(x.TEXTURE_2D,this.texture),m!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(m=x.LINEAR),r!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,r),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,m||r),this.filter=r),d!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,d),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,d),this.wrap=d)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}function Xe(b){const{userImage:r}=b;return!!(r&&r.render&&r.render())&&(b.data.replace(new Uint8Array(r.data.buffer)),!0)}class si extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:d,promiseResolve:m}of this.requestors)m(this._getImagesForIds(d));this.requestors=[]}}getImage(r){const d=this.images[r];if(d&&!d.data&&d.spriteData){const m=d.spriteData;d.data=new o.R({width:m.width,height:m.height},m.context.getImageData(m.x,m.y,m.width,m.height).data),d.spriteData=null}return d}addImage(r,d){if(this.images[r])throw new Error(`Image id ${r} already exist, use updateImage instead`);this._validate(r,d)&&(this.images[r]=d)}_validate(r,d){let m=!0;const g=d.data||d.spriteData;return this._validateStretch(d.stretchX,g&&g.width)||(this.fire(new o.j(new Error(`Image "${r}" has invalid "stretchX" value`))),m=!1),this._validateStretch(d.stretchY,g&&g.height)||(this.fire(new o.j(new Error(`Image "${r}" has invalid "stretchY" value`))),m=!1),this._validateContent(d.content,d)||(this.fire(new o.j(new Error(`Image "${r}" has invalid "content" value`))),m=!1),m}_validateStretch(r,d){if(!r)return!0;let m=0;for(const g of r){if(g[0]<m||g[1]<g[0]||d<g[1])return!1;m=g[1]}return!0}_validateContent(r,d){if(!r)return!0;if(r.length!==4)return!1;const m=d.spriteData,g=m&&m.width||d.data.width,x=m&&m.height||d.data.height;return!(r[0]<0||g<r[0]||r[1]<0||x<r[1]||r[2]<0||g<r[2]||r[3]<0||x<r[3]||r[2]<r[0]||r[3]<r[1])}updateImage(r,d,m=!0){const g=this.getImage(r);if(m&&(g.data.width!==d.data.width||g.data.height!==d.data.height))throw new Error(`size mismatch between old image (${g.data.width}x${g.data.height}) and new image (${d.data.width}x${d.data.height}).`);d.version=g.version+1,this.images[r]=d,this.updatedImages[r]=!0}removeImage(r){const d=this.images[r];delete this.images[r],delete this.patterns[r],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r){return new Promise((d,m)=>{let g=!0;if(!this.isLoaded())for(const x of r)this.images[x]||(g=!1);this.isLoaded()||g?d(this._getImagesForIds(r)):this.requestors.push({ids:r,promiseResolve:d})})}_getImagesForIds(r){const d={};for(const m of r){let g=this.getImage(m);g||(this.fire(new o.k("styleimagemissing",{id:m})),g=this.getImage(m)),g?d[m]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,hasRenderCallback:!!(g.userImage&&g.userImage.render)}:o.w(`Image "${m}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return d}getPixelSize(){const{width:r,height:d}=this.atlasImage;return{width:r,height:d}}getPattern(r){const d=this.patterns[r],m=this.getImage(r);if(!m)return null;if(d&&d.position.version===m.version)return d.position;if(d)d.position.version=m.version;else{const g={w:m.data.width+2,h:m.data.height+2,x:0,y:0},x=new o.I(g,m);this.patterns[r]={bin:g,position:x}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const d=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Ye(r,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const x in this.patterns)r.push(this.patterns[x].bin);const{w:d,h:m}=o.p(r),g=this.atlasImage;g.resize({width:d||1,height:m||1});for(const x in this.patterns){const{bin:T}=this.patterns[x],C=T.x+1,A=T.y+1,F=this.getImage(x).data,j=F.width,Z=F.height;o.R.copy(F,g,{x:0,y:0},{x:C,y:A},{width:j,height:Z}),o.R.copy(F,g,{x:0,y:Z-1},{x:C,y:A-1},{width:j,height:1}),o.R.copy(F,g,{x:0,y:0},{x:C,y:A+Z},{width:j,height:1}),o.R.copy(F,g,{x:j-1,y:0},{x:C-1,y:A},{width:1,height:Z}),o.R.copy(F,g,{x:0,y:0},{x:C+j,y:A},{width:1,height:Z})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const d of r){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const m=this.getImage(d);m||o.w(`Image with ID: "${d}" was not found`),Xe(m)&&this.updateImage(d,m)}}}const Bt=1e20;function bi(b,r,d,m,g,x,T,C,A){for(let F=r;F<r+m;F++)Et(b,d*x+F,x,g,T,C,A);for(let F=d;F<d+g;F++)Et(b,F*x+r,1,m,T,C,A)}function Et(b,r,d,m,g,x,T){x[0]=0,T[0]=-Bt,T[1]=Bt,g[0]=b[r];for(let C=1,A=0,F=0;C<m;C++){g[C]=b[r+C*d];const j=C*C;do{const Z=x[A];F=(g[C]-g[Z]+j-Z*Z)/(C-Z)/2}while(F<=T[A]&&--A>-1);A++,x[A]=C,T[A]=F,T[A+1]=Bt}for(let C=0,A=0;C<m;C++){for(;T[A+1]<C;)A++;const F=x[A],j=C-F;b[r+C*d]=g[F]+j*j}}class Vt{constructor(r,d){this.requestManager=r,this.localIdeographFontFamily=d,this.entries={}}setURL(r){this.url=r}getGlyphs(r){return o._(this,void 0,void 0,function*(){const d=[];for(const x in r)for(const T of r[x])d.push(this._getAndCacheGlyphsPromise(x,T));const m=yield Promise.all(d),g={};for(const{stack:x,id:T,glyph:C}of m)g[x]||(g[x]={}),g[x][T]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics};return g})}_getAndCacheGlyphsPromise(r,d){return o._(this,void 0,void 0,function*(){let m=this.entries[r];m||(m=this.entries[r]={glyphs:{},requests:{},ranges:{}});let g=m.glyphs[d];if(g!==void 0)return{stack:r,id:d,glyph:g};if(g=this._tinySDF(m,r,d),g)return m.glyphs[d]=g,{stack:r,id:d,glyph:g};const x=Math.floor(d/256);if(256*x>65535)throw new Error("glyphs > 65535 not supported");if(m.ranges[x])return{stack:r,id:d,glyph:g};if(!this.url)throw new Error("glyphsUrl is not set");if(!m.requests[x]){const C=Vt.loadGlyphRange(r,x,this.url,this.requestManager);m.requests[x]=C}const T=yield m.requests[x];for(const C in T)this._doesCharSupportLocalGlyph(+C)||(m.glyphs[+C]=T[+C]);return m.ranges[x]=!0,{stack:r,id:d,glyph:T[d]||null}})}_doesCharSupportLocalGlyph(r){return!!this.localIdeographFontFamily&&(o.u["CJK Unified Ideographs"](r)||o.u["Hangul Syllables"](r)||o.u.Hiragana(r)||o.u.Katakana(r))}_tinySDF(r,d,m){const g=this.localIdeographFontFamily;if(!g||!this._doesCharSupportLocalGlyph(m))return;let x=r.tinySDF;if(!x){let C="400";/bold/i.test(d)?C="900":/medium/i.test(d)?C="500":/light/i.test(d)&&(C="200"),x=r.tinySDF=new Vt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:g,fontWeight:C})}const T=x.draw(String.fromCharCode(m));return{id:m,bitmap:new o.o({width:T.width||60,height:T.height||60},T.data),metrics:{width:T.glyphWidth/2||24,height:T.glyphHeight/2||24,left:T.glyphLeft/2+.5||0,top:T.glyphTop/2-27.5||-8,advance:T.glyphAdvance/2||24,isDoubleResolution:!0}}}}Vt.loadGlyphRange=function(b,r,d,m){return o._(this,void 0,void 0,function*(){const g=256*r,x=g+255,T=m.transformRequest(d.replace("{fontstack}",b).replace("{range}",`${g}-${x}`),ce.Glyphs),C=yield o.l(T,new AbortController);if(!C||!C.data)throw new Error(`Could not load glyph range. range: ${r}, ${g}-${x}`);const A={};for(const F of o.n(C.data))A[F.id]=F;return A})},Vt.TinySDF=class{constructor({fontSize:b=24,buffer:r=3,radius:d=8,cutoff:m=.25,fontFamily:g="sans-serif",fontWeight:x="normal",fontStyle:T="normal"}={}){this.buffer=r,this.cutoff=m,this.radius=d;const C=this.size=b+4*r,A=this._createCanvas(C),F=this.ctx=A.getContext("2d",{willReadFrequently:!0});F.font=`${T} ${x} ${b}px ${g}`,F.textBaseline="alphabetic",F.textAlign="left",F.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(b){const r=document.createElement("canvas");return r.width=r.height=b,r}draw(b){const{width:r,actualBoundingBoxAscent:d,actualBoundingBoxDescent:m,actualBoundingBoxLeft:g,actualBoundingBoxRight:x}=this.ctx.measureText(b),T=Math.ceil(d),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-g))),A=Math.min(this.size-this.buffer,T+Math.ceil(m)),F=C+2*this.buffer,j=A+2*this.buffer,Z=Math.max(F*j,0),ie=new Uint8ClampedArray(Z),pe={data:ie,width:F,height:j,glyphWidth:C,glyphHeight:A,glyphTop:T,glyphLeft:0,glyphAdvance:r};if(C===0||A===0)return pe;const{ctx:fe,buffer:ge,gridInner:le,gridOuter:Le}=this;fe.clearRect(ge,ge,C,A),fe.fillText(b,ge,ge+T);const We=fe.getImageData(ge,ge,C,A);Le.fill(Bt,0,Z),le.fill(0,0,Z);for(let ye=0;ye<A;ye++)for(let Ne=0;Ne<C;Ne++){const qe=We.data[4*(ye*C+Ne)+3]/255;if(qe===0)continue;const Ze=(ye+ge)*F+Ne+ge;if(qe===1)Le[Ze]=0,le[Ze]=Bt;else{const Je=.5-qe;Le[Ze]=Je>0?Je*Je:0,le[Ze]=Je<0?Je*Je:0}}bi(Le,0,0,F,j,F,this.f,this.v,this.z),bi(le,ge,ge,C,A,F,this.f,this.v,this.z);for(let ye=0;ye<Z;ye++){const Ne=Math.sqrt(Le[ye])-Math.sqrt(le[ye]);ie[ye]=Math.round(255-255*(Ne/this.radius+this.cutoff))}return pe}};class Ki{constructor(){this.specification=o.v.light.position}possiblyEvaluate(r,d){return o.y(r.expression.evaluate(d))}interpolate(r,d,m){return{x:o.z.number(r.x,d.x,m),y:o.z.number(r.y,d.y,m),z:o.z.number(r.z,d.z,m)}}}let zt;class _t extends o.E{constructor(r){super(),zt=zt||new o.q({anchor:new o.D(o.v.light.anchor),position:new Ki,color:new o.D(o.v.light.color),intensity:new o.D(o.v.light.intensity)}),this._transitionable=new o.T(zt),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,d={}){if(!this._validate(o.r,r,d))for(const m in r){const g=r[m];m.endsWith("-transition")?this._transitionable.setTransition(m.slice(0,-11),g):this._transitionable.setValue(m,g)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,d,m){return(!m||m.validate!==!1)&&o.t(this,r.call(o.x,{value:d,style:{glyphs:!0,sprite:!0},styleSpec:o.v}))}}class Dt{constructor(r,d){this.width=r,this.height=d,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(r,d){const m=r.join(",")+String(d);return this.dashEntry[m]||(this.dashEntry[m]=this.addDash(r,d)),this.dashEntry[m]}getDashRanges(r,d,m){const g=[];let x=r.length%2==1?-r[r.length-1]*m:0,T=r[0]*m,C=!0;g.push({left:x,right:T,isDash:C,zeroLength:r[0]===0});let A=r[0];for(let F=1;F<r.length;F++){C=!C;const j=r[F];x=A*m,A+=j,T=A*m,g.push({left:x,right:T,isDash:C,zeroLength:j===0})}return g}addRoundDash(r,d,m){const g=d/2;for(let x=-m;x<=m;x++){const T=this.width*(this.nextRow+m+x);let C=0,A=r[C];for(let F=0;F<this.width;F++){F/A.right>1&&(A=r[++C]);const j=Math.abs(F-A.left),Z=Math.abs(F-A.right),ie=Math.min(j,Z);let pe;const fe=x/m*(g+1);if(A.isDash){const ge=g-Math.abs(fe);pe=Math.sqrt(ie*ie+ge*ge)}else pe=g-Math.sqrt(ie*ie+fe*fe);this.data[T+F]=Math.max(0,Math.min(255,pe+128))}}}addRegularDash(r){for(let C=r.length-1;C>=0;--C){const A=r[C],F=r[C+1];A.zeroLength?r.splice(C,1):F&&F.isDash===A.isDash&&(F.left=A.left,r.splice(C,1))}const d=r[0],m=r[r.length-1];d.isDash===m.isDash&&(d.left=m.left-this.width,m.right=d.right+this.width);const g=this.width*this.nextRow;let x=0,T=r[x];for(let C=0;C<this.width;C++){C/T.right>1&&(T=r[++x]);const A=Math.abs(C-T.left),F=Math.abs(C-T.right),j=Math.min(A,F);this.data[g+C]=Math.max(0,Math.min(255,(T.isDash?j:-j)+128))}}addDash(r,d){const m=d?7:0,g=2*m+1;if(this.nextRow+g>this.height)return o.w("LineAtlas out of space"),null;let x=0;for(let C=0;C<r.length;C++)x+=r[C];if(x!==0){const C=this.width/x,A=this.getDashRanges(r,this.width,C);d?this.addRoundDash(A,C,m):this.addRegularDash(A)}const T={y:(this.nextRow+m+.5)/this.height,height:2*m/this.height,width:x};return this.nextRow+=g,this.dirty=!0,T}bind(r){const d=r.gl;this.texture?(d.bindTexture(d.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,d.texSubImage2D(d.TEXTURE_2D,0,0,0,this.width,this.height,d.ALPHA,d.UNSIGNED_BYTE,this.data))):(this.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.ALPHA,this.width,this.height,0,d.ALPHA,d.UNSIGNED_BYTE,this.data))}}const Ft="maplibre_preloaded_worker_pool";class oi{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<oi.workerCount;)this.workers.push(new Worker(o.a.WORKER_URL));return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ft]}numActive(){return Object.keys(this.active).length}}const pi=Math.floor(M.hardwareConcurrency/2);let vi,Ti;function ht(){return vi||(vi=new oi),vi}oi.workerCount=o.B(globalThis)?Math.max(Math.min(pi,3),1):1;class mi{constructor(r,d){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=d;const m=this.workerPool.acquire(d);for(let g=0;g<m.length;g++){const x=new o.C(m[g],d);x.name=`Worker ${g}`,this.actors.push(x)}if(!this.actors.length)throw new Error("No actors found")}broadcast(r,d){const m=[];for(const g of this.actors)m.push(g.sendAsync({type:r,data:d}));return Promise.all(m)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(r=!0){this.actors.forEach(d=>{d.remove()}),this.actors=[],r&&this.workerPool.release(this.id)}registerMessageHandler(r,d){for(const m of this.actors)m.registerMessageHandler(r,d)}}function Pi(){return Ti||(Ti=new mi(ht(),o.G),Ti.registerMessageHandler("getResource",(b,r,d)=>o.m(r,d))),Ti}function Ni(b,r){const d=o.F();return o.H(d,d,[1,1,0]),o.J(d,d,[.5*b.width,.5*b.height,1]),o.K(d,d,b.calculatePosMatrix(r.toUnwrapped()))}function Oi(b,r,d,m,g,x){const T=function(Z,ie,pe){if(Z)for(const fe of Z){const ge=ie[fe];if(ge&&ge.source===pe&&ge.type==="fill-extrusion")return!0}else for(const fe in ie){const ge=ie[fe];if(ge.source===pe&&ge.type==="fill-extrusion")return!0}return!1}(g&&g.layers,r,b.id),C=x.maxPitchScaleFactor(),A=b.tilesIn(m,C,T);A.sort(mn);const F=[];for(const Z of A)F.push({wrappedTileID:Z.tileID.wrapped().key,queryResults:Z.tile.queryRenderedFeatures(r,d,b._state,Z.queryGeometry,Z.cameraQueryGeometry,Z.scale,g,x,C,Ni(b.transform,Z.tileID))});const j=function(Z){const ie={},pe={};for(const fe of Z){const ge=fe.queryResults,le=fe.wrappedTileID,Le=pe[le]=pe[le]||{};for(const We in ge){const ye=ge[We],Ne=Le[We]=Le[We]||{},qe=ie[We]=ie[We]||[];for(const Ze of ye)Ne[Ze.featureIndex]||(Ne[Ze.featureIndex]=!0,qe.push(Ze))}}return ie}(F);for(const Z in j)j[Z].forEach(ie=>{const pe=ie.feature,fe=b.getFeatureState(pe.layer["source-layer"],pe.id);pe.source=pe.layer.source,pe.layer["source-layer"]&&(pe.sourceLayer=pe.layer["source-layer"]),pe.state=fe});return j}function mn(b,r){const d=b.tileID,m=r.tileID;return d.overscaledZ-m.overscaledZ||d.canonical.y-m.canonical.y||d.wrap-m.wrap||d.canonical.x-m.canonical.x}function vn(b,r,d){return o._(this,void 0,void 0,function*(){let m=b;if(b.url?m=(yield o.h(r.transformRequest(b.url,ce.Source),d)).data:yield M.frameAsync(d),!m)return null;const g=o.L(o.e(m,b),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in m&&m.vector_layers&&(g.vectorLayerIds=m.vector_layers.map(x=>x.id)),g})}class Yi{constructor(r,d){r&&(d?this.setSouthWest(r).setNorthEast(d):Array.isArray(r)&&(r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1])))}setNorthEast(r){return this._ne=r instanceof o.M?new o.M(r.lng,r.lat):o.M.convert(r),this}setSouthWest(r){return this._sw=r instanceof o.M?new o.M(r.lng,r.lat):o.M.convert(r),this}extend(r){const d=this._sw,m=this._ne;let g,x;if(r instanceof o.M)g=r,x=r;else{if(!(r instanceof Yi))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend(Yi.convert(r)):this.extend(o.M.convert(r)):r&&("lng"in r||"lon"in r)&&"lat"in r?this.extend(o.M.convert(r)):this;if(g=r._sw,x=r._ne,!g||!x)return this}return d||m?(d.lng=Math.min(g.lng,d.lng),d.lat=Math.min(g.lat,d.lat),m.lng=Math.max(x.lng,m.lng),m.lat=Math.max(x.lat,m.lat)):(this._sw=new o.M(g.lng,g.lat),this._ne=new o.M(x.lng,x.lat)),this}getCenter(){return new o.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.M(this.getWest(),this.getNorth())}getSouthEast(){return new o.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:d,lat:m}=o.M.convert(r);let g=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=m&&m<=this._ne.lat&&g}static convert(r){return r instanceof Yi?r:r&&new Yi(r)}static fromLngLat(r,d=0){const m=360*d/40075017,g=m/Math.cos(Math.PI/180*r.lat);return new Yi(new o.M(r.lng-g,r.lat-m),new o.M(r.lng+g,r.lat+m))}}class Kn{constructor(r,d,m){this.bounds=Yi.convert(this.validateBounds(r)),this.minzoom=d||0,this.maxzoom=m||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const d=Math.pow(2,r.z),m=Math.floor(o.N(this.bounds.getWest())*d),g=Math.floor(o.O(this.bounds.getNorth())*d),x=Math.ceil(o.N(this.bounds.getEast())*d),T=Math.ceil(o.O(this.bounds.getSouth())*d);return r.x>=m&&r.x<x&&r.y>=g&&r.y<T}}class je extends o.E{constructor(r,d,m,g){if(super(),this.id=r,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.L(d,["url","scheme","tileSize","promoteId"])),this._options=o.e({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(g)}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield vn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),r&&(o.e(this,r),r.bounds&&(this.tileBounds=new Kn(r.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})))}catch(r){this._tileJSONRequest=null,this.fire(new o.j(r))}})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}setSourceProperty(r){this._tileJSONRequest&&this._tileJSONRequest.abort(),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(r){return o._(this,void 0,void 0,function*(){const d=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),m={request:this.map._requestManager.transformRequest(d,ce.Tile),uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};m.request.collectResourceTiming=this._collectResourceTiming;let g="reloadTile";if(r.actor&&r.state!=="expired"){if(r.state==="loading")return new Promise((x,T)=>{r.reloadPromise={resolve:x,reject:T}})}else r.actor=this.dispatcher.getActor(),g="loadTile";r.abortController=new AbortController;try{const x=yield r.actor.sendAsync({type:g,data:m},r.abortController);if(delete r.abortController,r.aborted)return;this._afterTileLoadWorkerResponse(r,x)}catch(x){if(delete r.abortController,r.aborted)return;if(x&&x.status!==404)throw x;this._afterTileLoadWorkerResponse(r,null)}})}_afterTileLoadWorkerResponse(r,d){if(d&&d.resourceTiming&&(r.resourceTiming=d.resourceTiming),d&&this.map._refreshExpiredTiles&&r.setExpiryData(d),r.loadVectorData(d,this.map.painter),r.reloadPromise){const m=r.reloadPromise;r.reloadPromise=null,this.loadTile(r).then(m.resolve).catch(m.reject)}}abortTile(r){return o._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController),r.actor&&(yield r.actor.sendAsync({type:"abortTile",data:{uid:r.uid,type:this.type,source:this.id}}))})}unloadTile(r){return o._(this,void 0,void 0,function*(){r.unloadVectorData(),r.actor&&(yield r.actor.sendAsync({type:"removeTile",data:{uid:r.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ci extends o.E{constructor(r,d,m,g){super(),this.id=r,this.dispatcher=m,this.setEventedParent(g),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},d),o.e(this,o.L(d,["url","scheme","tileSize"]))}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield vn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,r&&(o.e(this,r),r.bounds&&(this.tileBounds=new Kn(r.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})))}catch(r){this._tileJSONRequest=null,this.fire(new o.j(r))}})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(r){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}serialize(){return o.e({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r){return o._(this,void 0,void 0,function*(){const d=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);r.abortController=new AbortController;try{const m=yield Q.getImage(this.map._requestManager.transformRequest(d,ce.Tile),r.abortController,this.map._refreshExpiredTiles);if(delete r.abortController,r.aborted)return void(r.state="unloaded");if(m&&m.data){this.map._refreshExpiredTiles&&m.cacheControl&&m.expires&&r.setExpiryData({cacheControl:m.cacheControl,expires:m.expires});const g=this.map.painter.context,x=g.gl,T=m.data;r.texture=this.map.painter.getTileTexture(T.width),r.texture?r.texture.update(T,{useMipmap:!0}):(r.texture=new Ye(g,T,x.RGBA,{useMipmap:!0}),r.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST),g.extTextureFilterAnisotropic&&x.texParameterf(x.TEXTURE_2D,g.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,g.extTextureFilterAnisotropicMax)),r.state="loaded"}}catch(m){if(delete r.abortController,r.aborted)r.state="unloaded";else if(m)throw r.state="errored",m}})}abortTile(r){return o._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController)})}unloadTile(r){return o._(this,void 0,void 0,function*(){r.texture&&this.map.painter.saveTileTexture(r.texture)})}hasTransition(){return!1}}class Dn extends Ci{constructor(r,d,m,g){super(r,d,m,g),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox",this.redFactor=d.redFactor,this.greenFactor=d.greenFactor,this.blueFactor=d.blueFactor,this.baseShift=d.baseShift}loadTile(r){return o._(this,void 0,void 0,function*(){const d=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),m=this.map._requestManager.transformRequest(d,ce.Tile);r.neighboringTiles=this._getNeighboringTiles(r.tileID),r.abortController=new AbortController;try{const g=yield Q.getImage(m,r.abortController,this.map._refreshExpiredTiles);if(delete r.abortController,r.aborted)return void(r.state="unloaded");if(g&&g.data){const x=g.data;this.map._refreshExpiredTiles&&g.cacheControl&&g.expires&&r.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const T=o.b(x)&&o.S()?x:yield this.readImageNow(x),C={type:this.type,uid:r.uid,source:this.id,rawImageData:T,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!r.actor||r.state==="expired"){r.actor=this.dispatcher.getActor();const A=yield r.actor.sendAsync({type:"loadDEMTile",data:C});r.dem=A,r.needsHillshadePrepare=!0,r.needsTerrainPrepare=!0,r.state="loaded"}}}catch(g){if(delete r.abortController,r.aborted)r.state="unloaded";else if(g)throw r.state="errored",g}})}readImageNow(r){return o._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&o.U()){const d=r.width+2,m=r.height+2;try{return new o.R({width:d,height:m},yield o.V(r,-1,-1,d,m))}catch{}}return M.getImageData(r,1)})}_getNeighboringTiles(r){const d=r.canonical,m=Math.pow(2,d.z),g=(d.x-1+m)%m,x=d.x===0?r.wrap-1:r.wrap,T=(d.x+1+m)%m,C=d.x+1===m?r.wrap+1:r.wrap,A={};return A[new o.Q(r.overscaledZ,x,d.z,g,d.y).key]={backfilled:!1},A[new o.Q(r.overscaledZ,C,d.z,T,d.y).key]={backfilled:!1},d.y>0&&(A[new o.Q(r.overscaledZ,x,d.z,g,d.y-1).key]={backfilled:!1},A[new o.Q(r.overscaledZ,r.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},A[new o.Q(r.overscaledZ,C,d.z,T,d.y-1).key]={backfilled:!1}),d.y+1<m&&(A[new o.Q(r.overscaledZ,x,d.z,g,d.y+1).key]={backfilled:!1},A[new o.Q(r.overscaledZ,r.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},A[new o.Q(r.overscaledZ,C,d.z,T,d.y+1).key]={backfilled:!1}),A}unloadTile(r){return o._(this,void 0,void 0,function*(){r.demTexture&&this.map.painter.saveTileTexture(r.demTexture),r.fbo&&(r.fbo.destroy(),delete r.fbo),r.dem&&delete r.dem,delete r.neighboringTiles,r.state="unloaded",r.actor&&(yield r.actor.sendAsync({type:"removeDEMTile",data:{type:this.type,uid:r.uid,source:this.id}}))})}}class xi extends o.E{constructor(r,d,m,g){super(),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=m.getActor(),this.setEventedParent(g),this._data=d.data,this._options=o.e({},d),this._collectResourceTiming=d.collectResourceTiming,d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const x=o.W/this.tileSize;this.workerOptions=o.e({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(d.buffer!==void 0?d.buffer:128)*x,tolerance:(d.tolerance!==void 0?d.tolerance:.375)*x,extent:o.W,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:d.clusterMaxZoom!==void 0?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:o.W,radius:(d.clusterRadius||50)*x,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return o._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(r){this.map=r,this.load()}setData(r){return this._data=r,this._updateWorkerData(),this}updateData(r){return this._updateWorkerData(r),this}setClusterOptions(r){return this.workerOptions.cluster=r.cluster,r&&(r.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=r.clusterRadius),r.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=r.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(r){return this.actor.sendAsync({type:"getClusterExpansionZoom",data:{type:this.type,clusterId:r,source:this.id}})}getClusterChildren(r){return this.actor.sendAsync({type:"getClusterChildren",data:{type:this.type,clusterId:r,source:this.id}})}getClusterLeaves(r,d,m){return this.actor.sendAsync({type:"getClusterLeaves",data:{type:this.type,source:this.id,clusterId:r,limit:d,offset:m}})}_updateWorkerData(r){return o._(this,void 0,void 0,function*(){const d=o.e({type:this.type},this.workerOptions);r?d.dataDiff=r:typeof this._data=="string"?(d.request=this.map._requestManager.transformRequest(M.resolveURL(this._data),ce.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new o.k("dataloading",{dataType:"source"}));try{const m=yield this.actor.sendAsync({type:"loadData",data:d});if(this._pendingLoads--,this._removed||m.abandoned)return void this.fire(new o.k("dataabort",{dataType:"source"}));let g=null;m.resourceTiming&&m.resourceTiming[this.id]&&(g=m.resourceTiming[this.id].slice(0));const x={dataType:"source"};this._collectResourceTiming&&g&&g.length>0&&o.e(x,{resourceTiming:g}),this.fire(new o.k("data",Object.assign(Object.assign({},x),{sourceDataType:"metadata"}))),this.fire(new o.k("data",Object.assign(Object.assign({},x),{sourceDataType:"content"})))}catch(m){if(this._pendingLoads--,this._removed)return void this.fire(new o.k("dataabort",{dataType:"source"}));this.fire(new o.j(m))}})}loaded(){return this._pendingLoads===0}loadTile(r){return o._(this,void 0,void 0,function*(){const d=r.actor?"reloadTile":"loadTile";r.actor=this.actor;const m={type:this.type,uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.abortController=new AbortController;const g=yield this.actor.sendAsync({type:d,data:m},r.abortController);delete r.abortController,r.unloadVectorData(),r.aborted||r.loadVectorData(g,this.map.painter,d==="reloadTile")})}abortTile(r){return o._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController),r.aborted=!0})}unloadTile(r){return o._(this,void 0,void 0,function*(){r.unloadVectorData(),yield this.actor.sendAsync({type:"removeTile",data:{uid:r.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"removeSource",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var tn=o.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class xn extends o.E{constructor(r,d,m,g){super(),this.id=r,this.dispatcher=m,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(g),this.options=d}load(r){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const d=yield Q.getImage(this.map._requestManager.transformRequest(this.url,ce.Image),this._request);this._request=null,this._loaded=!0,d&&d.data&&(this.image=d.data,r&&(this.coordinates=r),this._finishLoading())}catch(d){this._request=null,this.fire(new o.j(d))}})}loaded(){return this._loaded}updateImage(r){return r.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=r.url,this.load(r.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(r){this.coordinates=r;const d=r.map(o.Y.fromLngLat);this.tileID=function(g){let x=1/0,T=1/0,C=-1/0,A=-1/0;for(const ie of g)x=Math.min(x,ie.x),T=Math.min(T,ie.y),C=Math.max(C,ie.x),A=Math.max(A,ie.y);const F=Math.max(C-x,A-T),j=Math.max(0,Math.floor(-Math.log(F)/Math.LN2)),Z=Math.pow(2,j);return new o.a0(j,Math.floor((x+C)/2*Z),Math.floor((T+A)/2*Z))}(d),this.minzoom=this.maxzoom=this.tileID.z;const m=d.map(g=>this.tileID.getTilePoint(g)._round());return this._boundsArray=new o.Z,this._boundsArray.emplaceBack(m[0].x,m[0].y,0,0),this._boundsArray.emplaceBack(m[1].x,m[1].y,o.W,0),this._boundsArray.emplaceBack(m[3].x,m[3].y,0,o.W),this._boundsArray.emplaceBack(m[2].x,m[2].y,o.W,o.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,d=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,tn.members)),this.boundsSegments||(this.boundsSegments=o.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Ye(r,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let m=!1;for(const g in this.tiles){const x=this.tiles[g];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,m=!0)}m&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(r){return o._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={}):r.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class tt extends xn{constructor(r,d,m,g){super(r,d,m,g),this.roundZoom=!0,this.type="video",this.options=d}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1;const r=this.options;this.urls=[];for(const d of r.urls)this.urls.push(this.map._requestManager.transformRequest(d,ce.Source).url);try{const d=yield o.a2(this.urls);if(this._loaded=!0,!d)return;this.video=d,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(d){this.fire(new o.j(d))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(r){if(this.video){const d=this.video.seekable;r<d.start(0)||r>d.end(0)?this.fire(new o.j(new o.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=r}}getVideo(){return this.video}onAdd(r){this.map||(this.map=r,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const r=this.map.painter.context,d=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,tn.members)),this.boundsSegments||(this.boundsSegments=o.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new Ye(r,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let m=!1;for(const g in this.tiles){const x=this.tiles[g];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,m=!0)}m&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class bn extends xn{constructor(r,d,m,g){super(r,d,m,g),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(T=>typeof T!="number"))||this.fire(new o.j(new o.a1(`sources.${r}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.j(new o.a1(`sources.${r}`,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new o.j(new o.a1(`sources.${r}`,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof HTMLCanvasElement||this.fire(new o.j(new o.a1(`sources.${r}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.j(new o.a1(`sources.${r}`,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}load(){return o._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(r){this.map=r,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let r=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,r=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,r=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const d=this.map.painter.context,m=d.gl;this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,tn.members)),this.boundsSegments||(this.boundsSegments=o.$.simpleSegment(0,0,4,2)),this.texture?(r||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Ye(d,this.canvas,m.RGBA,{premultiply:!0});let g=!1;for(const x in this.tiles){const T=this.tiles[x];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,g=!0)}g&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const r of[this.canvas.width,this.canvas.height])if(isNaN(r)||r<=0)return!0;return!1}}const _n={},cn=b=>{switch(b){case"geojson":return xi;case"image":return xn;case"raster":return Ci;case"raster-dem":return Dn;case"vector":return je;case"video":return tt;case"canvas":return bn}return _n[b]},ta="RTLPluginLoaded";class pa extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Pi()}_syncState(r){return this.status=r,this.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:r,pluginURL:this.url}).catch(d=>{throw this.status="error",d})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(r){return o._(this,arguments,void 0,function*(d,m=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=M.resolveURL(d),!this.url)throw new Error(`requested url ${d} is invalid`);if(this.status==="unavailable"){if(!m)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return o._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.k(ta))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let rt=null;function jn(){return rt||(rt=new pa),rt}class hn{constructor(r,d){this.timeAdded=0,this.fadeEndTime=0,this.tileID=r,this.uid=o.a3(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(r){const d=r+this.timeAdded;d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(r){this.demTexture&&r.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(r,d,m){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(g,x){const T={};if(!x)return T;for(const C of g){const A=C.layerIds.map(F=>x.getLayer(F)).filter(Boolean);if(A.length!==0){C.layers=A,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(F=>A.filter(j=>j.id===F)[0]));for(const F of A)T[F.id]=C}}return T}(r.buckets,d.style),this.hasSymbolBuckets=!1;for(const g in this.buckets){const x=this.buckets[g];if(x instanceof o.a5){if(this.hasSymbolBuckets=!0,!m)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const g in this.buckets){const x=this.buckets[g];if(x instanceof o.a5&&x.hasRTLText){this.hasRTLText=!0,jn().lazyLoad();break}}this.queryPadding=0;for(const g in this.buckets){const x=this.buckets[g];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(g).queryRadius(x))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage)}else this.collisionBoxArray=new o.a4}unloadVectorData(){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(r){return this.buckets[r.id]}upload(r){for(const m in this.buckets){const g=this.buckets[m];g.uploadPending()&&g.upload(r)}const d=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ye(r,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ye(r,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,d,m,g,x,T,C,A,F,j){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:g,cameraQueryGeometry:x,scale:T,tileSize:this.tileSize,pixelPosMatrix:j,transform:A,params:C,queryPadding:this.queryPadding*F},r,d,m):{}}querySourceFeatures(r,d){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const g=m.loadVTLayers(),x=d&&d.sourceLayer?d.sourceLayer:"",T=g._geojsonTileLayer||g[x];if(!T)return;const C=o.a6(d&&d.filter),{z:A,x:F,y:j}=this.tileID.canonical,Z={z:A,x:F,y:j};for(let ie=0;ie<T.length;ie++){const pe=T.feature(ie);if(C.needGeometry){const le=o.a7(pe,!0);if(!C.filter(new o.a8(this.tileID.overscaledZ),le,this.tileID.canonical))continue}else if(!C.filter(new o.a8(this.tileID.overscaledZ),pe))continue;const fe=m.getId(pe,x),ge=new o.a9(pe,A,F,j,fe);ge.tile=Z,r.push(ge)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const d=this.expirationTime;if(r.cacheControl){const m=o.aa(r.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const m=Date.now();let g=!1;if(this.expirationTime>m)g=!1;else if(d)if(this.expirationTime<d)g=!0;else{const x=this.expirationTime-d;x?this.expirationTime=m+Math.max(x,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,d){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(r).length===0)return;const m=this.latestFeatureIndex.loadVTLayers();for(const g in this.buckets){if(!d.style.hasLayer(g))continue;const x=this.buckets[g],T=x.layers[0].sourceLayer||"_geojsonTileLayer",C=m[T],A=r[T];if(!C||!A||Object.keys(A).length===0)continue;x.update(A,C,this.imageAtlas&&this.imageAtlas.patternPositions||{});const F=d&&d.style&&d.style.getLayer(g);F&&(this.queryPadding=Math.max(this.queryPadding,F.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<M.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=M.now()+r}setDependencies(r,d){const m={};for(const g of d)m[g]=!0;this.dependencies[r]=m}hasDependency(r,d){for(const m of r){const g=this.dependencies[m];if(g){for(const x of d)if(g[x])return!0}}return!1}}class Un{constructor(r,d){this.max=r,this.onRemove=d,this.reset()}reset(){for(const r in this.data)for(const d of this.data[r])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(r,d,m){const g=r.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);const x={value:d,timeout:void 0};if(m!==void 0&&(x.timeout=setTimeout(()=>{this.remove(r,x)},m)),this.data[g].push(x),this.order.push(g),this.order.length>this.max){const T=this._getAndRemoveByKey(this.order[0]);T&&this.onRemove(T)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const d=this.data[r].shift();return d.timeout&&clearTimeout(d.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),d.value}getByKey(r){const d=this.data[r];return d?d[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,d){if(!this.has(r))return this;const m=r.wrapped().key,g=d===void 0?0:this.data[m].indexOf(d),x=this.data[m][g];return this.data[m].splice(g,1),x.timeout&&clearTimeout(x.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(x.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(r){const d=[];for(const m in this.data)for(const g of this.data[m])r(g.value)||d.push(g);for(const m of d)this.remove(m.value.tileID,m)}}class Ii{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,d,m){const g=String(d);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][g]=this.stateChanges[r][g]||{},o.e(this.stateChanges[r][g],m),this.deletedStates[r]===null){this.deletedStates[r]={};for(const x in this.state[r])x!==g&&(this.deletedStates[r][x]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][g]===null){this.deletedStates[r][g]={};for(const x in this.state[r][g])m[x]||(this.deletedStates[r][g][x]=null)}else for(const x in m)this.deletedStates[r]&&this.deletedStates[r][g]&&this.deletedStates[r][g][x]===null&&delete this.deletedStates[r][g][x]}removeFeatureState(r,d,m){if(this.deletedStates[r]===null)return;const g=String(d);if(this.deletedStates[r]=this.deletedStates[r]||{},m&&d!==void 0)this.deletedStates[r][g]!==null&&(this.deletedStates[r][g]=this.deletedStates[r][g]||{},this.deletedStates[r][g][m]=null);else if(d!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][g])for(m in this.deletedStates[r][g]={},this.stateChanges[r][g])this.deletedStates[r][g][m]=null;else this.deletedStates[r][g]=null;else this.deletedStates[r]=null}getState(r,d){const m=String(d),g=o.e({},(this.state[r]||{})[m],(this.stateChanges[r]||{})[m]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){const x=this.deletedStates[r][d];if(x===null)return{};for(const T in x)delete g[T]}return g}initializeTileState(r,d){r.setFeatureState(this.state,d)}coalesceChanges(r,d){const m={};for(const g in this.stateChanges){this.state[g]=this.state[g]||{};const x={};for(const T in this.stateChanges[g])this.state[g][T]||(this.state[g][T]={}),o.e(this.state[g][T],this.stateChanges[g][T]),x[T]=this.state[g][T];m[g]=x}for(const g in this.deletedStates){this.state[g]=this.state[g]||{};const x={};if(this.deletedStates[g]===null)for(const T in this.state[g])x[T]={},this.state[g][T]={};else for(const T in this.deletedStates[g]){if(this.deletedStates[g][T]===null)this.state[g][T]={};else for(const C of Object.keys(this.deletedStates[g][T]))delete this.state[g][T][C];x[T]=this.state[g][T]}m[g]=m[g]||{},o.e(m[g],x)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(const g in r)r[g].setFeatureState(m,d)}}class lt extends o.E{constructor(r,d,m){super(),this.id=r,this.dispatcher=m,this.on("data",g=>{g.dataType==="source"&&g.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&g.dataType==="source"&&g.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((g,x,T,C)=>{const A=new(cn(x.type))(g,x,T,C);if(A.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${A.id}`);return A})(r,d,m,this),this._tiles={},this._cache=new Un(0,g=>this._unloadTile(g)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ii,this._didEmitContent=!1,this._updated=!1}onAdd(r){this.map=r,this._maxTileCacheSize=r?r._maxTileCacheSize:null,this._maxTileCacheZoomLevels=r?r._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(r)}onRemove(r){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(r)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const r in this._tiles){const d=this._tiles[r];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(r,d,m){return o._(this,void 0,void 0,function*(){try{yield this._source.loadTile(r),this._tileLoaded(r,d,m)}catch(g){r.state="errored",g.status!==404?this._source.fire(new o.j(g,{tile:r})):this.update(this.transform,this.terrain)}})}_unloadTile(r){this._source.unloadTile&&this._source.unloadTile(r)}_abortTile(r){this._source.abortTile&&this._source.abortTile(r),this._source.fire(new o.k("dataabort",{tile:r,coord:r.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const m=this._tiles[d];m.upload(r),m.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(r=>r.tileID).sort(gi).map(r=>r.key)}getRenderableIds(r){const d=[];for(const m in this._tiles)this._isIdRenderable(m,r)&&d.push(this._tiles[m]);return r?d.sort((m,g)=>{const x=m.tileID,T=g.tileID,C=new o.P(x.canonical.x,x.canonical.y)._rotate(this.transform.angle),A=new o.P(T.canonical.x,T.canonical.y)._rotate(this.transform.angle);return x.overscaledZ-T.overscaledZ||A.y-C.y||A.x-C.x}).map(m=>m.tileID.key):d.map(m=>m.tileID).sort(gi).map(m=>m.key)}hasRenderableParent(r){const d=this.findLoadedParent(r,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(r,d){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(d||!this._tiles[r].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(r,"reloading")}}_reloadTile(r,d){return o._(this,void 0,void 0,function*(){const m=this._tiles[r];m&&(m.state!=="loading"&&(m.state=d),yield this._loadTile(m,r,d))})}_tileLoaded(r,d,m){r.timeAdded=M.now(),m==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(d,r),this.getSource().type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),r.aborted||this._source.fire(new o.k("data",{dataType:"source",tile:r,coord:r.tileID}))}_backfillDEM(r){const d=this.getRenderableIds();for(let g=0;g<d.length;g++){const x=d[g];if(r.neighboringTiles&&r.neighboringTiles[x]){const T=this.getTileByID(x);m(r,T),m(T,r)}}function m(g,x){g.needsHillshadePrepare=!0,g.needsTerrainPrepare=!0;let T=x.tileID.canonical.x-g.tileID.canonical.x;const C=x.tileID.canonical.y-g.tileID.canonical.y,A=Math.pow(2,g.tileID.canonical.z),F=x.tileID.key;T===0&&C===0||Math.abs(C)>1||(Math.abs(T)>1&&(Math.abs(T+A)===1?T+=A:Math.abs(T-A)===1&&(T-=A)),x.dem&&g.dem&&(g.dem.backfillBorder(x.dem,T,C),g.neighboringTiles&&g.neighboringTiles[F]&&(g.neighboringTiles[F].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,d,m,g){for(const x in this._tiles){let T=this._tiles[x];if(g[x]||!T.hasData()||T.tileID.overscaledZ<=d||T.tileID.overscaledZ>m)continue;let C=T.tileID;for(;T&&T.tileID.overscaledZ>d+1;){const F=T.tileID.scaledTo(T.tileID.overscaledZ-1);T=this._tiles[F.key],T&&T.hasData()&&(C=F)}let A=C;for(;A.overscaledZ>d;)if(A=A.scaledTo(A.overscaledZ-1),r[A.key]){g[C.key]=C;break}}}findLoadedParent(r,d){if(r.key in this._loadedParentTiles){const m=this._loadedParentTiles[r.key];return m&&m.tileID.overscaledZ>=d?m:null}for(let m=r.overscaledZ-1;m>=d;m--){const g=r.scaledTo(m),x=this._getLoadedTile(g);if(x)return x}}_getLoadedTile(r){const d=this._tiles[r.key];return d&&d.hasData()?d:this._cache.getByKey(r.wrapped().key)}updateCacheSize(r){const d=Math.ceil(r.width/this._source.tileSize)+1,m=Math.ceil(r.height/this._source.tileSize)+1,g=Math.floor(d*m*(this._maxTileCacheZoomLevels===null?o.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(x)}handleWrapJump(r){const d=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,d){const m={};for(const g in this._tiles){const x=this._tiles[g];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+d),m[x.tileID.key]=x}this._tiles=m;for(const g in this._timers)clearTimeout(this._timers[g]),delete this._timers[g];for(const g in this._tiles)this._setTileReloadTimer(g,this._tiles[g])}}update(r,d){if(this.transform=r,this.terrain=d,!this._sourceLoaded||this._paused)return;let m;this.updateCacheSize(r),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?m=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(j=>new o.Q(j.canonical.z,j.wrap,j.canonical.z,j.canonical.x,j.canonical.y)):(m=r.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:d}),this._source.hasTile&&(m=m.filter(j=>this._source.hasTile(j)))):m=[];const g=r.coveringZoomLevel(this._source),x=Math.max(g-lt.maxOverzooming,this._source.minzoom),T=Math.max(g+lt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const j={};for(const Z of m)if(Z.canonical.z>this._source.minzoom){const ie=Z.scaledTo(Z.canonical.z-1);j[ie.key]=ie;const pe=Z.scaledTo(Math.max(this._source.minzoom,Math.min(Z.canonical.z,5)));j[pe.key]=pe}m=m.concat(Object.values(j))}const C=m.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,C&&this.fire(new o.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const A=this._updateRetainedTiles(m,g);if(_i(this._source.type)){const j={},Z={},ie=Object.keys(A),pe=M.now();for(const fe of ie){const ge=A[fe],le=this._tiles[fe];if(!le||le.fadeEndTime!==0&&le.fadeEndTime<=pe)continue;const Le=this.findLoadedParent(ge,x);Le&&(this._addTile(Le.tileID),j[Le.tileID.key]=Le.tileID),Z[fe]=ge}this._retainLoadedChildren(Z,g,T,A);for(const fe in j)A[fe]||(this._coveredTiles[fe]=!0,A[fe]=j[fe]);if(d){const fe={},ge={};for(const le of m)this._tiles[le.key].hasData()?fe[le.key]=le:ge[le.key]=le;for(const le in ge){const Le=ge[le].children(this._source.maxzoom);this._tiles[Le[0].key]&&this._tiles[Le[1].key]&&this._tiles[Le[2].key]&&this._tiles[Le[3].key]&&(fe[Le[0].key]=A[Le[0].key]=Le[0],fe[Le[1].key]=A[Le[1].key]=Le[1],fe[Le[2].key]=A[Le[2].key]=Le[2],fe[Le[3].key]=A[Le[3].key]=Le[3],delete ge[le])}for(const le in ge){const Le=this.findLoadedParent(ge[le],this._source.minzoom);if(Le){fe[Le.tileID.key]=A[Le.tileID.key]=Le.tileID;for(const We in fe)fe[We].isChildOf(Le.tileID)&&delete fe[We]}}for(const le in this._tiles)fe[le]||(this._coveredTiles[le]=!0)}}for(const j in A)this._tiles[j].clearFadeHold();const F=o.ab(this._tiles,A);for(const j of F){const Z=this._tiles[j];Z.hasSymbolBuckets&&!Z.holdingForFade()?Z.setHoldDuration(this.map._fadeDuration):Z.hasSymbolBuckets&&!Z.symbolFadeFinished()||this._removeTile(j)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(r)}_updateRetainedTiles(r,d){const m={},g={},x=Math.max(d-lt.maxOverzooming,this._source.minzoom),T=Math.max(d+lt.maxUnderzooming,this._source.minzoom),C={};for(const A of r){const F=this._addTile(A);m[A.key]=A,F.hasData()||d<this._source.maxzoom&&(C[A.key]=A)}this._retainLoadedChildren(C,d,T,m);for(const A of r){let F=this._tiles[A.key];if(F.hasData())continue;if(d+1>this._source.maxzoom){const Z=A.children(this._source.maxzoom)[0],ie=this.getTile(Z);if(ie&&ie.hasData()){m[Z.key]=Z;continue}}else{const Z=A.children(this._source.maxzoom);if(m[Z[0].key]&&m[Z[1].key]&&m[Z[2].key]&&m[Z[3].key])continue}let j=F.wasRequested();for(let Z=A.overscaledZ-1;Z>=x;--Z){const ie=A.scaledTo(Z);if(g[ie.key])break;if(g[ie.key]=!0,F=this.getTile(ie),!F&&j&&(F=this._addTile(ie)),F){const pe=F.hasData();if((j||pe)&&(m[ie.key]=ie),j=F.wasRequested(),pe)break}}}return m}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const d=[];let m,g=this._tiles[r].tileID;for(;g.overscaledZ>0;){if(g.key in this._loadedParentTiles){m=this._loadedParentTiles[g.key];break}d.push(g.key);const x=g.scaledTo(g.overscaledZ-1);if(m=this._getLoadedTile(x),m)break;g=x}for(const x of d)this._loadedParentTiles[x]=m}}_addTile(r){let d=this._tiles[r.key];if(d)return d;d=this._cache.getAndRemove(r),d&&(this._setTileReloadTimer(r.key,d),d.tileID=r,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,d)));const m=d;return d||(d=new hn(r,this._source.tileSize*r.overscaleFactor()),this._loadTile(d,r.key,d.state)),d.uses++,this._tiles[r.key]=d,m||this._source.fire(new o.k("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d}_setTileReloadTimer(r,d){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const m=d.getExpiryTimeout();m&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},m))}_removeTile(r){const d=this._tiles[r];d&&(d.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),d.uses>0||(d.hasData()&&d.state!=="reloading"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(r);this._cache.reset()}tilesIn(r,d,m){const g=[],x=this.transform;if(!x)return g;const T=m?x.getCameraQueryGeometry(r):r,C=r.map(fe=>x.pointCoordinate(fe,this.terrain)),A=T.map(fe=>x.pointCoordinate(fe,this.terrain)),F=this.getIds();let j=1/0,Z=1/0,ie=-1/0,pe=-1/0;for(const fe of A)j=Math.min(j,fe.x),Z=Math.min(Z,fe.y),ie=Math.max(ie,fe.x),pe=Math.max(pe,fe.y);for(let fe=0;fe<F.length;fe++){const ge=this._tiles[F[fe]];if(ge.holdingForFade())continue;const le=ge.tileID,Le=Math.pow(2,x.zoom-ge.tileID.overscaledZ),We=d*ge.queryPadding*o.W/ge.tileSize/Le,ye=[le.getTilePoint(new o.Y(j,Z)),le.getTilePoint(new o.Y(ie,pe))];if(ye[0].x-We<o.W&&ye[0].y-We<o.W&&ye[1].x+We>=0&&ye[1].y+We>=0){const Ne=C.map(Ze=>le.getTilePoint(Ze)),qe=A.map(Ze=>le.getTilePoint(Ze));g.push({tile:ge,tileID:le,queryGeometry:Ne,cameraQueryGeometry:qe,scale:Le})}}return g}getVisibleCoordinates(r){const d=this.getRenderableIds(r).map(m=>this._tiles[m].tileID);for(const m of d)m.posMatrix=this.transform.calculatePosMatrix(m.toUnwrapped());return d}hasTransition(){if(this._source.hasTransition())return!0;if(_i(this._source.type)){const r=M.now();for(const d in this._tiles)if(this._tiles[d].fadeEndTime>=r)return!0}return!1}setFeatureState(r,d,m){this._state.updateState(r=r||"_geojsonTileLayer",d,m)}removeFeatureState(r,d,m){this._state.removeFeatureState(r=r||"_geojsonTileLayer",d,m)}getFeatureState(r,d){return this._state.getState(r=r||"_geojsonTileLayer",d)}setDependencies(r,d,m){const g=this._tiles[r];g&&g.setDependencies(d,m)}reloadTilesForDependencies(r,d){for(const m in this._tiles)this._tiles[m].hasDependency(r,d)&&this._reloadTile(m,"reloading");this._cache.filter(m=>!m.hasDependency(r,d))}}function gi(b,r){const d=Math.abs(2*b.wrap)-+(b.wrap<0),m=Math.abs(2*r.wrap)-+(r.wrap<0);return b.overscaledZ-r.overscaledZ||m-d||r.canonical.y-b.canonical.y||r.canonical.x-b.canonical.x}function _i(b){return b==="raster"||b==="image"||b==="video"}lt.maxOverzooming=10,lt.maxUnderzooming=3;class on{constructor(r,d){this.reset(r,d)}reset(r,d){this.points=r||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=o.ac(r,0,1);let d=1,m=this._distances[d];const g=r*this.paddedLength+this.padding;for(;m<g&&d<this._distances.length;)m=this._distances[++d];const x=d-1,T=this._distances[x],C=m-T,A=C>0?(g-T)/C:0;return this.points[x].mult(1-A).add(this.points[d].mult(A))}}function wn(b,r){let d=!0;return b==="always"||b!=="never"&&r!=="never"||(d=!1),d}class ni{constructor(r,d,m){const g=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(r/m),this.yCellCount=Math.ceil(d/m);for(let T=0;T<this.xCellCount*this.yCellCount;T++)g.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=d,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,d,m,g,x){this._forEachCell(d,m,g,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(d),this.bboxes.push(m),this.bboxes.push(g),this.bboxes.push(x)}insertCircle(r,d,m,g){this._forEachCell(d-g,m-g,d+g,m+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(d),this.circles.push(m),this.circles.push(g)}_insertBoxCell(r,d,m,g,x,T){this.boxCells[x].push(T)}_insertCircleCell(r,d,m,g,x,T){this.circleCells[x].push(T)}_query(r,d,m,g,x,T,C){if(m<0||r>this.width||g<0||d>this.height)return[];const A=[];if(r<=0&&d<=0&&this.width<=m&&this.height<=g){if(x)return[{key:null,x1:r,y1:d,x2:m,y2:g}];for(let F=0;F<this.boxKeys.length;F++)A.push({key:this.boxKeys[F],x1:this.bboxes[4*F],y1:this.bboxes[4*F+1],x2:this.bboxes[4*F+2],y2:this.bboxes[4*F+3]});for(let F=0;F<this.circleKeys.length;F++){const j=this.circles[3*F],Z=this.circles[3*F+1],ie=this.circles[3*F+2];A.push({key:this.circleKeys[F],x1:j-ie,y1:Z-ie,x2:j+ie,y2:Z+ie})}}else this._forEachCell(r,d,m,g,this._queryCell,A,{hitTest:x,overlapMode:T,seenUids:{box:{},circle:{}}},C);return A}query(r,d,m,g){return this._query(r,d,m,g,!1,null)}hitTest(r,d,m,g,x,T){return this._query(r,d,m,g,!0,x,T).length>0}hitTestCircle(r,d,m,g,x){const T=r-m,C=r+m,A=d-m,F=d+m;if(C<0||T>this.width||F<0||A>this.height)return!1;const j=[];return this._forEachCell(T,A,C,F,this._queryCellCircle,j,{hitTest:!0,overlapMode:g,circle:{x:r,y:d,radius:m},seenUids:{box:{},circle:{}}},x),j.length>0}_queryCell(r,d,m,g,x,T,C,A){const{seenUids:F,hitTest:j,overlapMode:Z}=C,ie=this.boxCells[x];if(ie!==null){const fe=this.bboxes;for(const ge of ie)if(!F.box[ge]){F.box[ge]=!0;const le=4*ge,Le=this.boxKeys[ge];if(r<=fe[le+2]&&d<=fe[le+3]&&m>=fe[le+0]&&g>=fe[le+1]&&(!A||A(Le))&&(!j||!wn(Z,Le.overlapMode))&&(T.push({key:Le,x1:fe[le],y1:fe[le+1],x2:fe[le+2],y2:fe[le+3]}),j))return!0}}const pe=this.circleCells[x];if(pe!==null){const fe=this.circles;for(const ge of pe)if(!F.circle[ge]){F.circle[ge]=!0;const le=3*ge,Le=this.circleKeys[ge];if(this._circleAndRectCollide(fe[le],fe[le+1],fe[le+2],r,d,m,g)&&(!A||A(Le))&&(!j||!wn(Z,Le.overlapMode))){const We=fe[le],ye=fe[le+1],Ne=fe[le+2];if(T.push({key:Le,x1:We-Ne,y1:ye-Ne,x2:We+Ne,y2:ye+Ne}),j)return!0}}}return!1}_queryCellCircle(r,d,m,g,x,T,C,A){const{circle:F,seenUids:j,overlapMode:Z}=C,ie=this.boxCells[x];if(ie!==null){const fe=this.bboxes;for(const ge of ie)if(!j.box[ge]){j.box[ge]=!0;const le=4*ge,Le=this.boxKeys[ge];if(this._circleAndRectCollide(F.x,F.y,F.radius,fe[le+0],fe[le+1],fe[le+2],fe[le+3])&&(!A||A(Le))&&!wn(Z,Le.overlapMode))return T.push(!0),!0}}const pe=this.circleCells[x];if(pe!==null){const fe=this.circles;for(const ge of pe)if(!j.circle[ge]){j.circle[ge]=!0;const le=3*ge,Le=this.circleKeys[ge];if(this._circlesCollide(fe[le],fe[le+1],fe[le+2],F.x,F.y,F.radius)&&(!A||A(Le))&&!wn(Z,Le.overlapMode))return T.push(!0),!0}}}_forEachCell(r,d,m,g,x,T,C,A){const F=this._convertToXCellCoord(r),j=this._convertToYCellCoord(d),Z=this._convertToXCellCoord(m),ie=this._convertToYCellCoord(g);for(let pe=F;pe<=Z;pe++)for(let fe=j;fe<=ie;fe++)if(x.call(this,r,d,m,g,this.xCellCount*fe+pe,T,C,A))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,d,m,g,x,T){const C=g-r,A=x-d,F=m+T;return F*F>C*C+A*A}_circleAndRectCollide(r,d,m,g,x,T,C){const A=(T-g)/2,F=Math.abs(r-(g+A));if(F>A+m)return!1;const j=(C-x)/2,Z=Math.abs(d-(x+j));if(Z>j+m)return!1;if(F<=A||Z<=j)return!0;const ie=F-A,pe=Z-j;return ie*ie+pe*pe<=m*m}}function Ei(b,r,d,m,g){const x=o.F();return r?(o.J(x,x,[1/g,1/g,1]),d||o.ad(x,x,m.angle)):o.K(x,m.labelPlaneMatrix,b),x}function ji(b,r,d,m,g){if(r){const x=o.ae(b);return o.J(x,x,[g,g,1]),d||o.ad(x,x,-m.angle),x}return m.glCoordMatrix}function re(b,r,d){let m;d?(m=[b.x,b.y,d(b.x,b.y),1],o.af(m,m,r)):(m=[b.x,b.y,0,1],Me(m,m,r));const g=m[3];return{point:new o.P(m[0]/g,m[1]/g),signedDistanceFromCamera:g}}function U(b,r){return .5+b/r*.5}function J(b,r){const d=b[0]/b[3],m=b[1]/b[3];return d>=-r[0]&&d<=r[0]&&m>=-r[1]&&m<=r[1]}function te(b,r,d,m,g,x,T,C,A,F){const j=m?b.textSizeData:b.iconSizeData,Z=o.ag(j,d.transform.zoom),ie=[256/d.width*2+1,256/d.height*2+1],pe=m?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;pe.clear();const fe=b.lineVertexArray,ge=m?b.text.placedSymbolArray:b.icon.placedSymbolArray,le=d.transform.width/d.transform.height;let Le=!1;for(let We=0;We<ge.length;We++){const ye=ge.get(We);if(ye.hidden||ye.writingMode===o.ah.vertical&&!Le){ae(ye.numGlyphs,pe);continue}let Ne;if(Le=!1,F?(Ne=[ye.anchorX,ye.anchorY,F(ye.anchorX,ye.anchorY),1],o.af(Ne,Ne,r)):(Ne=[ye.anchorX,ye.anchorY,0,1],Me(Ne,Ne,r)),!J(Ne,ie)){ae(ye.numGlyphs,pe);continue}const qe=U(d.transform.cameraToCenterDistance,Ne[3]),Ze=o.ai(j,Z,ye),Je=T?Ze/qe:Ze*qe,pt=new o.P(ye.anchorX,ye.anchorY),ut=re(pt,g,F).point,dt={projections:{},offsets:{}},Gt=Ee(ye,Je,!1,C,r,g,x,b.glyphOffsetArray,fe,pe,ut,pt,dt,le,A,F);Le=Gt.useVertical,(Gt.notEnoughRoom||Le||Gt.needsFlipping&&Ee(ye,Je,!0,C,r,g,x,b.glyphOffsetArray,fe,pe,ut,pt,dt,le,A,F).notEnoughRoom)&&ae(ye.numGlyphs,pe)}m?b.text.dynamicLayoutVertexBuffer.updateData(pe):b.icon.dynamicLayoutVertexBuffer.updateData(pe)}function se(b,r,d,m,g,x,T,C,A,F,j,Z,ie){const pe=C.glyphStartIndex+C.numGlyphs,fe=C.lineStartIndex,ge=C.lineStartIndex+C.lineLength,le=r.getoffsetX(C.glyphStartIndex),Le=r.getoffsetX(pe-1),We=L(b*le,d,m,g,x,T,C.segment,fe,ge,A,F,j,Z,ie);if(!We)return null;const ye=L(b*Le,d,m,g,x,T,C.segment,fe,ge,A,F,j,Z,ie);return ye?{first:We,last:ye}:null}function Ae(b,r,d,m){return b===o.ah.horizontal&&Math.abs(d.y-r.y)>Math.abs(d.x-r.x)*m?{useVertical:!0}:(b===o.ah.vertical?r.y<d.y:r.x>d.x)?{needsFlipping:!0}:null}function Ee(b,r,d,m,g,x,T,C,A,F,j,Z,ie,pe,fe,ge){const le=r/24,Le=b.lineOffsetX*le,We=b.lineOffsetY*le;let ye;if(b.numGlyphs>1){const Ne=b.glyphStartIndex+b.numGlyphs,qe=b.lineStartIndex,Ze=b.lineStartIndex+b.lineLength,Je=se(le,C,Le,We,d,j,Z,b,A,x,ie,fe,ge);if(!Je)return{notEnoughRoom:!0};const pt=re(Je.first.point,T,ge).point,ut=re(Je.last.point,T,ge).point;if(m&&!d){const dt=Ae(b.writingMode,pt,ut,pe);if(dt)return dt}ye=[Je.first];for(let dt=b.glyphStartIndex+1;dt<Ne-1;dt++)ye.push(L(le*C.getoffsetX(dt),Le,We,d,j,Z,b.segment,qe,Ze,A,x,ie,fe,ge));ye.push(Je.last)}else{if(m&&!d){const qe=re(Z,g,ge).point,Ze=b.lineStartIndex+b.segment+1,Je=new o.P(A.getx(Ze),A.gety(Ze)),pt=re(Je,g,ge),ut=pt.signedDistanceFromCamera>0?pt.point:$(Z,Je,qe,1,g,ge),dt=Ae(b.writingMode,qe,ut,pe);if(dt)return dt}const Ne=L(le*C.getoffsetX(b.glyphStartIndex),Le,We,d,j,Z,b.segment,b.lineStartIndex,b.lineStartIndex+b.lineLength,A,x,ie,fe,ge);if(!Ne)return{notEnoughRoom:!0};ye=[Ne]}for(const Ne of ye)o.aj(F,Ne.point,Ne.angle);return{}}function $(b,r,d,m,g,x){const T=re(b.add(b.sub(r)._unit()),g,x).point,C=d.sub(T);return d.add(C._mult(m/C.mag()))}function O(b,r){const{projectionCache:d,lineVertexArray:m,labelPlaneMatrix:g,tileAnchorPoint:x,distanceFromAnchor:T,getElevation:C,previousVertex:A,direction:F,absOffsetX:j}=r;if(d.projections[b])return d.projections[b];const Z=new o.P(m.getx(b),m.gety(b)),ie=re(Z,g,C);if(ie.signedDistanceFromCamera>0)return d.projections[b]=ie.point,ie.point;const pe=b-F;return $(T===0?x:new o.P(m.getx(pe),m.gety(pe)),Z,A,j-T+1,g,C)}function V(b,r,d){return b._unit()._perp()._mult(r*d)}function q(b,r,d,m,g,x,T,C){const{projectionCache:A,direction:F}=C;if(A.offsets[b])return A.offsets[b];const j=d.add(r);if(b+F<m||b+F>=g)return A.offsets[b]=j,j;const Z=O(b+F,C),ie=V(Z.sub(d),T,F),pe=d.add(ie),fe=Z.add(ie);return A.offsets[b]=o.ak(x,j,pe,fe)||j,A.offsets[b]}function L(b,r,d,m,g,x,T,C,A,F,j,Z,ie,pe){const fe=m?b-r:b+r;let ge=fe>0?1:-1,le=0;m&&(ge*=-1,le=Math.PI),ge<0&&(le+=Math.PI);let Le,We,ye=ge>0?C+T:C+T+1,Ne=g,qe=g,Ze=0,Je=0;const pt=Math.abs(fe),ut=[];let dt;for(;Ze+Je<=pt;){if(ye+=ge,ye<C||ye>=A)return null;Ze+=Je,qe=Ne,We=Le;const Pt={projectionCache:Z,lineVertexArray:F,labelPlaneMatrix:j,tileAnchorPoint:x,distanceFromAnchor:Ze,getElevation:pe,previousVertex:qe,direction:ge,absOffsetX:pt};if(Ne=O(ye,Pt),d===0)ut.push(qe),dt=Ne.sub(qe);else{let wi;const Bi=Ne.sub(qe);wi=Bi.mag()===0?V(O(ye+ge,Pt).sub(Ne),d,ge):V(Bi,d,ge),We||(We=qe.add(wi)),Le=q(ye,wi,Ne,C,A,We,d,Pt),ut.push(We),dt=Le.sub(We)}Je=dt.mag()}const Gt=dt._mult((pt-Ze)/Je)._add(We||qe),Ri=le+Math.atan2(Ne.y-qe.y,Ne.x-qe.x);return ut.push(Gt),{point:Gt,angle:ie?Ri:0,path:ut}}const W=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ae(b,r){for(let d=0;d<b;d++){const m=r.length;r.resize(m+4),r.float32.set(W,3*m)}}function Me(b,r,d){const m=r[0],g=r[1];return b[0]=d[0]*m+d[4]*g+d[12],b[1]=d[1]*m+d[5]*g+d[13],b[3]=d[3]*m+d[7]*g+d[15],b}const Ie=100;class Qe{constructor(r,d=new ni(r.width+200,r.height+200,25),m=new ni(r.width+200,r.height+200,25)){this.transform=r,this.grid=d,this.ignoredGrid=m,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+Ie,this.screenBottomBoundary=r.height+Ie,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(r,d,m,g,x,T){const C=this.projectAndGetPerspectiveRatio(g,r.anchorPointX,r.anchorPointY,T),A=m*C.perspectiveRatio,F=r.x1*A+C.point.x,j=r.y1*A+C.point.y,Z=r.x2*A+C.point.x,ie=r.y2*A+C.point.y;return!this.isInsideGrid(F,j,Z,ie)||d!=="always"&&this.grid.hitTest(F,j,Z,ie,d,x)||C.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[F,j,Z,ie],offscreen:this.isOffscreen(F,j,Z,ie)}}placeCollisionCircles(r,d,m,g,x,T,C,A,F,j,Z,ie,pe,fe){const ge=[],le=new o.P(d.anchorX,d.anchorY),Le=re(le,T,fe),We=U(this.transform.cameraToCenterDistance,Le.signedDistanceFromCamera),ye=(j?x/We:x*We)/o.ao,Ne=re(le,C,fe).point,qe=se(ye,g,d.lineOffsetX*ye,d.lineOffsetY*ye,!1,Ne,le,d,m,C,{projections:{},offsets:{}},!1,fe);let Ze=!1,Je=!1,pt=!0;if(qe){const ut=.5*ie*We+pe,dt=new o.P(-100,-100),Gt=new o.P(this.screenRightBoundary,this.screenBottomBoundary),Ri=new on,Pt=qe.first,wi=qe.last;let Bi=[];for(let Vi=Pt.path.length-1;Vi>=1;Vi--)Bi.push(Pt.path[Vi]);for(let Vi=1;Vi<wi.path.length;Vi++)Bi.push(wi.path[Vi]);const an=2.5*ut;if(A){const Vi=Bi.map(Hi=>re(Hi,A,fe));Bi=Vi.some(Hi=>Hi.signedDistanceFromCamera<=0)?[]:Vi.map(Hi=>Hi.point)}let Di=[];if(Bi.length>0){const Vi=Bi[0].clone(),Hi=Bi[0].clone();for(let Yn=1;Yn<Bi.length;Yn++)Vi.x=Math.min(Vi.x,Bi[Yn].x),Vi.y=Math.min(Vi.y,Bi[Yn].y),Hi.x=Math.max(Hi.x,Bi[Yn].x),Hi.y=Math.max(Hi.y,Bi[Yn].y);Di=Vi.x>=dt.x&&Hi.x<=Gt.x&&Vi.y>=dt.y&&Hi.y<=Gt.y?[Bi]:Hi.x<dt.x||Vi.x>Gt.x||Hi.y<dt.y||Vi.y>Gt.y?[]:o.al([Bi],dt.x,dt.y,Gt.x,Gt.y)}for(const Vi of Di){Ri.reset(Vi,.25*ut);let Hi=0;Hi=Ri.length<=.5*ut?1:Math.ceil(Ri.paddedLength/an)+1;for(let Yn=0;Yn<Hi;Yn++){const Pn=Yn/Math.max(Hi-1,1),lr=Ri.lerp(Pn),ga=lr.x+Ie,Ln=lr.y+Ie;ge.push(ga,Ln,ut,0);const Za=ga-ut,Br=Ln-ut,es=ga+ut,Us=Ln+ut;if(pt=pt&&this.isOffscreen(Za,Br,es,Us),Je=Je||this.isInsideGrid(Za,Br,es,Us),r!=="always"&&this.grid.hitTestCircle(ga,Ln,ut,r,Z)&&(Ze=!0,!F))return{circles:[],offscreen:!1,collisionDetected:Ze}}}}return{circles:!F&&Ze||!Je||We<this.perspectiveRatioCutoff?[]:ge,offscreen:pt,collisionDetected:Ze}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let m=1/0,g=1/0,x=-1/0,T=-1/0;for(const j of r){const Z=new o.P(j.x+Ie,j.y+Ie);m=Math.min(m,Z.x),g=Math.min(g,Z.y),x=Math.max(x,Z.x),T=Math.max(T,Z.y),d.push(Z)}const C=this.grid.query(m,g,x,T).concat(this.ignoredGrid.query(m,g,x,T)),A={},F={};for(const j of C){const Z=j.key;if(A[Z.bucketInstanceId]===void 0&&(A[Z.bucketInstanceId]={}),A[Z.bucketInstanceId][Z.featureIndex])continue;const ie=[new o.P(j.x1,j.y1),new o.P(j.x2,j.y1),new o.P(j.x2,j.y2),new o.P(j.x1,j.y2)];o.am(d,ie)&&(A[Z.bucketInstanceId][Z.featureIndex]=!0,F[Z.bucketInstanceId]===void 0&&(F[Z.bucketInstanceId]=[]),F[Z.bucketInstanceId].push(Z.featureIndex))}return F}insertCollisionBox(r,d,m,g,x,T){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:x,collisionGroupID:T,overlapMode:d},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,d,m,g,x,T){const C=m?this.ignoredGrid:this.grid,A={bucketInstanceId:g,featureIndex:x,collisionGroupID:T,overlapMode:d};for(let F=0;F<r.length;F+=4)C.insertCircle(A,r[F],r[F+1],r[F+2])}projectAndGetPerspectiveRatio(r,d,m,g){let x;return g?(x=[d,m,g(d,m),1],o.af(x,x,r)):(x=[d,m,0,1],Me(x,x,r)),{point:new o.P((x[0]/x[3]+1)/2*this.transform.width+Ie,(-x[1]/x[3]+1)/2*this.transform.height+Ie),perspectiveRatio:.5+this.transform.cameraToCenterDistance/x[3]*.5}}isOffscreen(r,d,m,g){return m<Ie||r>=this.screenRightBoundary||g<Ie||d>this.screenBottomBoundary}isInsideGrid(r,d,m,g){return m>=0&&r<this.gridRightBoundary&&g>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const r=o.an([]);return o.H(r,r,[-100,-100,0]),r}}function Ge(b,r,d){return r*(o.W/(b.tileSize*Math.pow(2,d-b.tileID.overscaledZ)))}class $e{constructor(r,d,m,g){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?d:-d))):g&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class Te{constructor(r,d,m,g,x){this.text=new $e(r?r.text:null,d,m,x),this.icon=new $e(r?r.icon:null,d,g,x)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class gt{constructor(r,d,m){this.text=r,this.icon=d,this.skipFade=m}}class wt{constructor(){this.invProjMatrix=o.F(),this.viewportMatrix=o.F(),this.circles=[]}}class St{constructor(r,d,m,g,x){this.bucketInstanceId=r,this.featureIndex=d,this.sourceLayerIndex=m,this.bucketIndex=g,this.tileID=x}}class $t{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const d=++this.maxGroupID;this.collisionGroups[r]={ID:d,predicate:m=>m.collisionGroupID===d}}return this.collisionGroups[r]}}function Tt(b,r,d,m,g){const{horizontalAlign:x,verticalAlign:T}=o.at(b);return new o.P(-(x-.5)*r+m[0]*g,-(T-.5)*d+m[1]*g)}function Ct(b,r,d,m,g,x){const{x1:T,x2:C,y1:A,y2:F,anchorPointX:j,anchorPointY:Z}=b,ie=new o.P(r,d);return m&&ie._rotate(g?x:-x),{x1:T+ie.x,y1:A+ie.y,x2:C+ie.x,y2:F+ie.y,anchorPointX:j,anchorPointY:Z}}class Si{constructor(r,d,m,g,x){this.transform=r.clone(),this.terrain=d,this.collisionIndex=new Qe(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new $t(g),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,d,m,g){const x=m.getBucket(d),T=m.latestFeatureIndex;if(!x||!T||d.id!==x.layerIds[0])return;const C=m.collisionBoxArray,A=x.layers[0].layout,F=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),j=m.tileSize/o.W,Z=this.transform.calculatePosMatrix(m.tileID.toUnwrapped()),ie=A.get("text-pitch-alignment")==="map",pe=A.get("text-rotation-alignment")==="map",fe=Ge(m,1,this.transform.zoom),ge=Ei(Z,ie,pe,this.transform,fe);let le=null;if(ie){const We=ji(Z,ie,pe,this.transform,fe);le=o.K([],this.transform.labelPlaneMatrix,We)}this.retainedQueryData[x.bucketInstanceId]=new St(x.bucketInstanceId,T,x.sourceLayerIndex,x.index,m.tileID);const Le={bucket:x,layout:A,posMatrix:Z,textLabelPlaneMatrix:ge,labelToScreenMatrix:le,scale:F,textPixelRatio:j,holdingForFade:m.holdingForFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:o.ag(x.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(g)for(const We of x.sortKeyRanges){const{sortKey:ye,symbolInstanceStart:Ne,symbolInstanceEnd:qe}=We;r.push({sortKey:ye,symbolInstanceStart:Ne,symbolInstanceEnd:qe,parameters:Le})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:Le})}attemptAnchorPlacement(r,d,m,g,x,T,C,A,F,j,Z,ie,pe,fe,ge,le){const Le=o.ap[r.textAnchor],We=[r.textOffset0,r.textOffset1],ye=Tt(Le,m,g,We,x),Ne=this.collisionIndex.placeCollisionBox(Ct(d,ye.x,ye.y,T,C,this.transform.angle),Z,A,F,j.predicate,le);if((!ge||this.collisionIndex.placeCollisionBox(Ct(ge,ye.x,ye.y,T,C,this.transform.angle),Z,A,F,j.predicate,le).box.length!==0)&&Ne.box.length>0){let qe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ie.crossTileID]&&this.prevPlacement.placements[ie.crossTileID]&&this.prevPlacement.placements[ie.crossTileID].text&&(qe=this.prevPlacement.variableOffsets[ie.crossTileID].anchor),ie.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ie.crossTileID]={textOffset:We,width:m,height:g,anchor:Le,textBoxScale:x,prevAnchor:qe},this.markUsedJustification(pe,Le,ie,fe),pe.allowVerticalPlacement&&(this.markUsedOrientation(pe,fe,ie),this.placedOrientations[ie.crossTileID]=fe),{shift:ye,placedGlyphBoxes:Ne}}}placeLayerBucketPart(r,d,m){const{bucket:g,layout:x,posMatrix:T,textLabelPlaneMatrix:C,labelToScreenMatrix:A,textPixelRatio:F,holdingForFade:j,collisionBoxArray:Z,partiallyEvaluatedTextSize:ie,collisionGroup:pe}=r.parameters,fe=x.get("text-optional"),ge=x.get("icon-optional"),le=o.aq(x,"text-overlap","text-allow-overlap"),Le=le==="always",We=o.aq(x,"icon-overlap","icon-allow-overlap"),ye=We==="always",Ne=x.get("text-rotation-alignment")==="map",qe=x.get("text-pitch-alignment")==="map",Ze=x.get("icon-text-fit")!=="none",Je=x.get("symbol-z-order")==="viewport-y",pt=Le&&(ye||!g.hasIconData()||ge),ut=ye&&(Le||!g.hasTextData()||fe);!g.collisionArrays&&Z&&g.deserializeCollisionBoxes(Z);const dt=this.retainedQueryData[g.bucketInstanceId].tileID,Gt=this.terrain?(Pt,wi)=>this.terrain.getElevation(dt,Pt,wi):null,Ri=(Pt,wi)=>{var Bi,an;if(d[Pt.crossTileID])return;if(j)return void(this.placements[Pt.crossTileID]=new gt(!1,!1,!1));let Di=!1,Vi=!1,Hi=!0,Yn=null,Pn={box:null,offscreen:null},lr={box:null,offscreen:null},ga=null,Ln=null,Za=null,Br=0,es=0,Us=0;wi.textFeatureIndex?Br=wi.textFeatureIndex:Pt.useRuntimeCollisionCircles&&(Br=Pt.featureIndex),wi.verticalTextFeatureIndex&&(es=wi.verticalTextFeatureIndex);const Ws=wi.textBox;if(Ws){const ea=qn=>{let La=o.ah.horizontal;if(g.allowVerticalPlacement&&!qn&&this.prevPlacement){const kr=this.prevPlacement.placedOrientations[Pt.crossTileID];kr&&(this.placedOrientations[Pt.crossTileID]=kr,La=kr,this.markUsedOrientation(g,La,Pt))}return La},On=(qn,La)=>{if(g.allowVerticalPlacement&&Pt.numVerticalGlyphVertices>0&&wi.verticalTextBox){for(const kr of g.writingModes)if(kr===o.ah.vertical?(Pn=La(),lr=Pn):Pn=qn(),Pn&&Pn.box&&Pn.box.length)break}else Pn=qn()},ra=Pt.textAnchorOffsetStartIndex,So=Pt.textAnchorOffsetEndIndex;if(So===ra){const qn=(La,kr)=>{const Xi=this.collisionIndex.placeCollisionBox(La,le,F,T,pe.predicate,Gt);return Xi&&Xi.box&&Xi.box.length&&(this.markUsedOrientation(g,kr,Pt),this.placedOrientations[Pt.crossTileID]=kr),Xi};On(()=>qn(Ws,o.ah.horizontal),()=>{const La=wi.verticalTextBox;return g.allowVerticalPlacement&&Pt.numVerticalGlyphVertices>0&&La?qn(La,o.ah.vertical):{box:null,offscreen:null}}),ea(Pn&&Pn.box&&Pn.box.length)}else{let qn=o.ap[(an=(Bi=this.prevPlacement)===null||Bi===void 0?void 0:Bi.variableOffsets[Pt.crossTileID])===null||an===void 0?void 0:an.anchor];const La=(Xi,Zc,Sh)=>{const qs=Xi.x2-Xi.x1,Zs=Xi.y2-Xi.y1,Ol=Pt.textBoxScale,Gc=Ze&&We==="never"?Zc:null;let Gs={box:[],offscreen:!1},Mh=le==="never"?1:2,$c="never";qn&&Mh++;for(let Dh=0;Dh<Mh;Dh++){for(let el=ra;el<So;el++){const Th=g.textAnchorOffsets.get(el);if(qn&&Th.textAnchor!==qn)continue;const tl=this.attemptAnchorPlacement(Th,Xi,qs,Zs,Ol,Ne,qe,F,T,pe,$c,Pt,g,Sh,Gc,Gt);if(tl&&(Gs=tl.placedGlyphBoxes,Gs&&Gs.box&&Gs.box.length))return Di=!0,Yn=tl.shift,Gs}qn?qn=null:$c=le}return Gs};On(()=>La(Ws,wi.iconBox,o.ah.horizontal),()=>{const Xi=wi.verticalTextBox;return g.allowVerticalPlacement&&!(Pn&&Pn.box&&Pn.box.length)&&Pt.numVerticalGlyphVertices>0&&Xi?La(Xi,wi.verticalIconBox,o.ah.vertical):{box:null,offscreen:null}}),Pn&&(Di=Pn.box,Hi=Pn.offscreen);const kr=ea(Pn&&Pn.box);if(!Di&&this.prevPlacement){const Xi=this.prevPlacement.variableOffsets[Pt.crossTileID];Xi&&(this.variableOffsets[Pt.crossTileID]=Xi,this.markUsedJustification(g,Xi.anchor,Pt,kr))}}}if(ga=Pn,Di=ga&&ga.box&&ga.box.length>0,Hi=ga&&ga.offscreen,Pt.useRuntimeCollisionCircles){const ea=g.text.placedSymbolArray.get(Pt.centerJustifiedTextSymbolIndex),On=o.ai(g.textSizeData,ie,ea),ra=x.get("text-padding");Ln=this.collisionIndex.placeCollisionCircles(le,ea,g.lineVertexArray,g.glyphOffsetArray,On,T,C,A,m,qe,pe.predicate,Pt.collisionCircleDiameter,ra,Gt),Ln.circles.length&&Ln.collisionDetected&&!m&&o.w("Collisions detected, but collision boxes are not shown"),Di=Le||Ln.circles.length>0&&!Ln.collisionDetected,Hi=Hi&&Ln.offscreen}if(wi.iconFeatureIndex&&(Us=wi.iconFeatureIndex),wi.iconBox){const ea=On=>{const ra=Ze&&Yn?Ct(On,Yn.x,Yn.y,Ne,qe,this.transform.angle):On;return this.collisionIndex.placeCollisionBox(ra,We,F,T,pe.predicate,Gt)};lr&&lr.box&&lr.box.length&&wi.verticalIconBox?(Za=ea(wi.verticalIconBox),Vi=Za.box.length>0):(Za=ea(wi.iconBox),Vi=Za.box.length>0),Hi=Hi&&Za.offscreen}const ts=fe||Pt.numHorizontalGlyphVertices===0&&Pt.numVerticalGlyphVertices===0,Nr=ge||Pt.numIconVertices===0;if(ts||Nr?Nr?ts||(Vi=Vi&&Di):Di=Vi&&Di:Vi=Di=Vi&&Di,Di&&ga&&ga.box&&this.collisionIndex.insertCollisionBox(ga.box,le,x.get("text-ignore-placement"),g.bucketInstanceId,lr&&lr.box&&es?es:Br,pe.ID),Vi&&Za&&this.collisionIndex.insertCollisionBox(Za.box,We,x.get("icon-ignore-placement"),g.bucketInstanceId,Us,pe.ID),Ln&&(Di&&this.collisionIndex.insertCollisionCircles(Ln.circles,le,x.get("text-ignore-placement"),g.bucketInstanceId,Br,pe.ID),m)){const ea=g.bucketInstanceId;let On=this.collisionCircleArrays[ea];On===void 0&&(On=this.collisionCircleArrays[ea]=new wt);for(let ra=0;ra<Ln.circles.length;ra+=4)On.circles.push(Ln.circles[ra+0]),On.circles.push(Ln.circles[ra+1]),On.circles.push(Ln.circles[ra+2]),On.circles.push(Ln.collisionDetected?1:0)}if(Pt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(g.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Pt.crossTileID]=new gt(Di||pt,Vi||ut,Hi||g.justReloaded),d[Pt.crossTileID]=!0};if(Je){if(r.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Pt=g.getSortedSymbolIndexes(this.transform.angle);for(let wi=Pt.length-1;wi>=0;--wi){const Bi=Pt[wi];Ri(g.symbolInstances.get(Bi),g.collisionArrays[Bi])}}else for(let Pt=r.symbolInstanceStart;Pt<r.symbolInstanceEnd;Pt++)Ri(g.symbolInstances.get(Pt),g.collisionArrays[Pt]);if(m&&g.bucketInstanceId in this.collisionCircleArrays){const Pt=this.collisionCircleArrays[g.bucketInstanceId];o.ar(Pt.invProjMatrix,T),Pt.viewportMatrix=this.collisionIndex.getViewportMatrix()}g.justReloaded=!1}markUsedJustification(r,d,m,g){let x;x=g===o.ah.vertical?m.verticalPlacedTextSymbolIndex:{left:m.leftJustifiedTextSymbolIndex,center:m.centerJustifiedTextSymbolIndex,right:m.rightJustifiedTextSymbolIndex}[o.as(d)];const T=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex,m.verticalPlacedTextSymbolIndex];for(const C of T)C>=0&&(r.text.placedSymbolArray.get(C).crossTileID=x>=0&&C!==x?0:m.crossTileID)}markUsedOrientation(r,d,m){const g=d===o.ah.horizontal||d===o.ah.horizontalOnly?d:0,x=d===o.ah.vertical?d:0,T=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex];for(const C of T)r.text.placedSymbolArray.get(C).placedOrientation=g;m.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(m.verticalPlacedTextSymbolIndex).placedOrientation=x)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let m=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const g=d?d.symbolFadeChange(r):1,x=d?d.opacities:{},T=d?d.variableOffsets:{},C=d?d.placedOrientations:{};for(const A in this.placements){const F=this.placements[A],j=x[A];j?(this.opacities[A]=new Te(j,g,F.text,F.icon),m=m||F.text!==j.text.placed||F.icon!==j.icon.placed):(this.opacities[A]=new Te(null,g,F.text,F.icon,F.skipFade),m=m||F.text||F.icon)}for(const A in x){const F=x[A];if(!this.opacities[A]){const j=new Te(F,g,!1,!1);j.isHidden()||(this.opacities[A]=j,m=m||F.text.placed||F.icon.placed)}}for(const A in T)this.variableOffsets[A]||!this.opacities[A]||this.opacities[A].isHidden()||(this.variableOffsets[A]=T[A]);for(const A in C)this.placedOrientations[A]||!this.opacities[A]||this.opacities[A].isHidden()||(this.placedOrientations[A]=C[A]);if(d&&d.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");m?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:r)}updateLayerOpacities(r,d){const m={};for(const g of d){const x=g.getBucket(r);x&&g.latestFeatureIndex&&r.id===x.layerIds[0]&&this.updateBucketOpacities(x,m,g.collisionBoxArray)}}updateBucketOpacities(r,d,m){r.hasTextData()&&(r.text.opacityVertexArray.clear(),r.text.hasVisibleVertices=!1),r.hasIconData()&&(r.icon.opacityVertexArray.clear(),r.icon.hasVisibleVertices=!1),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const g=r.layers[0],x=g.layout,T=new Te(null,0,!1,!1,!0),C=x.get("text-allow-overlap"),A=x.get("icon-allow-overlap"),F=g._unevaluatedLayout.hasValue("text-variable-anchor")||g._unevaluatedLayout.hasValue("text-variable-anchor-offset"),j=x.get("text-rotation-alignment")==="map",Z=x.get("text-pitch-alignment")==="map",ie=x.get("icon-text-fit")!=="none",pe=new Te(null,0,C&&(A||!r.hasIconData()||x.get("icon-optional")),A&&(C||!r.hasTextData()||x.get("text-optional")),!0);!r.collisionArrays&&m&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(m);const fe=(ge,le,Le)=>{for(let We=0;We<le/4;We++)ge.opacityVertexArray.emplaceBack(Le);ge.hasVisibleVertices=ge.hasVisibleVertices||Le!==la};for(let ge=0;ge<r.symbolInstances.length;ge++){const le=r.symbolInstances.get(ge),{numHorizontalGlyphVertices:Le,numVerticalGlyphVertices:We,crossTileID:ye}=le;let Ne=this.opacities[ye];d[ye]?Ne=T:Ne||(Ne=pe,this.opacities[ye]=Ne),d[ye]=!0;const qe=le.numIconVertices>0,Ze=this.placedOrientations[le.crossTileID],Je=Ze===o.ah.vertical,pt=Ze===o.ah.horizontal||Ze===o.ah.horizontalOnly;if(Le>0||We>0){const ut=Na(Ne.text);fe(r.text,Le,Je?la:ut),fe(r.text,We,pt?la:ut);const dt=Ne.text.isHidden();[le.rightJustifiedTextSymbolIndex,le.centerJustifiedTextSymbolIndex,le.leftJustifiedTextSymbolIndex].forEach(Pt=>{Pt>=0&&(r.text.placedSymbolArray.get(Pt).hidden=dt||Je?1:0)}),le.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(le.verticalPlacedTextSymbolIndex).hidden=dt||pt?1:0);const Gt=this.variableOffsets[le.crossTileID];Gt&&this.markUsedJustification(r,Gt.anchor,le,Ze);const Ri=this.placedOrientations[le.crossTileID];Ri&&(this.markUsedJustification(r,"left",le,Ri),this.markUsedOrientation(r,Ri,le))}if(qe){const ut=Na(Ne.icon),dt=!(ie&&le.verticalPlacedIconSymbolIndex&&Je);le.placedIconSymbolIndex>=0&&(fe(r.icon,le.numIconVertices,dt?ut:la),r.icon.placedSymbolArray.get(le.placedIconSymbolIndex).hidden=Ne.icon.isHidden()),le.verticalPlacedIconSymbolIndex>=0&&(fe(r.icon,le.numVerticalIconVertices,dt?la:ut),r.icon.placedSymbolArray.get(le.verticalPlacedIconSymbolIndex).hidden=Ne.icon.isHidden())}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const ut=r.collisionArrays[ge];if(ut){let dt=new o.P(0,0);if(ut.textBox||ut.verticalTextBox){let Ri=!0;if(F){const Pt=this.variableOffsets[ye];Pt?(dt=Tt(Pt.anchor,Pt.width,Pt.height,Pt.textOffset,Pt.textBoxScale),j&&dt._rotate(Z?this.transform.angle:-this.transform.angle)):Ri=!1}ut.textBox&&Ai(r.textCollisionBox.collisionVertexArray,Ne.text.placed,!Ri||Je,dt.x,dt.y),ut.verticalTextBox&&Ai(r.textCollisionBox.collisionVertexArray,Ne.text.placed,!Ri||pt,dt.x,dt.y)}const Gt=!!(!pt&&ut.verticalIconBox);ut.iconBox&&Ai(r.iconCollisionBox.collisionVertexArray,Ne.icon.placed,Gt,ie?dt.x:0,ie?dt.y:0),ut.verticalIconBox&&Ai(r.iconCollisionBox.collisionVertexArray,Ne.icon.placed,!Gt,ie?dt.x:0,ie?dt.y:0)}}}if(r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.text.opacityVertexArray.length!==r.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${r.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${r.text.layoutVertexArray.length}) / 4`);if(r.icon.opacityVertexArray.length!==r.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${r.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${r.icon.layoutVertexArray.length}) / 4`);if(r.bucketInstanceId in this.collisionCircleArrays){const ge=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=ge.invProjMatrix,r.placementViewportMatrix=ge.viewportMatrix,r.collisionCircleArray=ge.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,d){const m=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*m>r}setStale(){this.stale=!0}}function Ai(b,r,d,m,g){b.emplaceBack(r?1:0,d?1:0,m||0,g||0),b.emplaceBack(r?1:0,d?1:0,m||0,g||0),b.emplaceBack(r?1:0,d?1:0,m||0,g||0),b.emplaceBack(r?1:0,d?1:0,m||0,g||0)}const Wn=Math.pow(2,25),Aa=Math.pow(2,24),Fi=Math.pow(2,17),ia=Math.pow(2,16),Wa=Math.pow(2,9),In=Math.pow(2,8),ma=Math.pow(2,1);function Na(b){if(b.opacity===0&&!b.placed)return 0;if(b.opacity===1&&b.placed)return 4294967295;const r=b.placed?1:0,d=Math.floor(127*b.opacity);return d*Wn+r*Aa+d*Fi+r*ia+d*Wa+r*In+d*ma+r}const la=0;class na{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&!r.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,d,m,g,x){const T=this._bucketParts;for(;this._currentTileIndex<r.length;)if(d.getBucketParts(T,g,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,T.sort((C,A)=>C.sortKey-A.sortKey));this._currentPartIndex<T.length;)if(d.placeLayerBucketPart(T[this._currentPartIndex],this._seenCrossTileIDs,m),this._currentPartIndex++,x())return!0;return!1}}class Yr{constructor(r,d,m,g,x,T,C,A){this.placement=new Si(r,d,T,C,A),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(r,d,m){const g=M.now(),x=()=>!this._forceFullPlacement&&M.now()-g>2;for(;this._currentPlacementIndex>=0;){const T=d[r[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(T.type==="symbol"&&(!T.minzoom||T.minzoom<=C)&&(!T.maxzoom||T.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new na(T)),this._inProgressLayer.continuePlacement(m[T.source],this.placement,this._showCollisionBoxes,T,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const Va=512/o.W/2;class Tn{constructor(r,d,m){this.tileID=r,this.bucketInstanceId=m,this._symbolsByKey={};const g=new Map;for(let x=0;x<d.length;x++){const T=d.get(x),C=T.key,A=g.get(C);A?A.push(T):g.set(C,[T])}for(const[x,T]of g){const C={positions:T.map(A=>({x:Math.floor(A.anchorX*Va),y:Math.floor(A.anchorY*Va)})),crossTileIDs:T.map(A=>A.crossTileID)};if(C.positions.length>128){const A=new o.au(C.positions.length,16,Uint16Array);for(const{x:F,y:j}of C.positions)A.add(F,j);A.finish(),delete C.positions,C.index=A}this._symbolsByKey[x]=C}}getScaledCoordinates(r,d){const{x:m,y:g,z:x}=this.tileID.canonical,{x:T,y:C,z:A}=d.canonical,F=Va/Math.pow(2,A-x),j=(C*o.W+r.anchorY)*F,Z=g*o.W*Va;return{x:Math.floor((T*o.W+r.anchorX)*F-m*o.W*Va),y:Math.floor(j-Z)}}findMatches(r,d,m){const g=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let x=0;x<r.length;x++){const T=r.get(x);if(T.crossTileID)continue;const C=this._symbolsByKey[T.key];if(!C)continue;const A=this.getScaledCoordinates(T,d);if(C.index){const F=C.index.range(A.x-g,A.y-g,A.x+g,A.y+g).sort();for(const j of F){const Z=C.crossTileIDs[j];if(!m[Z]){m[Z]=!0,T.crossTileID=Z;break}}}else if(C.positions)for(let F=0;F<C.positions.length;F++){const j=C.positions[F],Z=C.crossTileIDs[F];if(Math.abs(j.x-A.x)<=g&&Math.abs(j.y-A.y)<=g&&!m[Z]){m[Z]=!0,T.crossTileID=Z;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:r})=>r)}}class Jr{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class xr{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const d=Math.round((r-this.lng)/360);if(d!==0)for(const m in this.indexes){const g=this.indexes[m],x={};for(const T in g){const C=g[T];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+d),x[C.tileID.key]=C}this.indexes[m]=x}this.lng=r}addBucket(r,d,m){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let x=0;x<d.symbolInstances.length;x++)d.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const g=this.usedCrossTileIDs[r.overscaledZ];for(const x in this.indexes){const T=this.indexes[x];if(Number(x)>r.overscaledZ)for(const C in T){const A=T[C];A.tileID.isChildOf(r)&&A.findMatches(d.symbolInstances,r,g)}else{const C=T[r.scaledTo(Number(x)).key];C&&C.findMatches(d.symbolInstances,r,g)}}for(let x=0;x<d.symbolInstances.length;x++){const T=d.symbolInstances.get(x);T.crossTileID||(T.crossTileID=m.generate(),g[T.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Tn(r,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(r,d){for(const m of d.getCrossTileIDsLists())for(const g of m)delete this.usedCrossTileIDs[r][g]}removeStaleBuckets(r){let d=!1;for(const m in this.indexes){const g=this.indexes[m];for(const x in g)r[g[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,g[x]),delete g[x],d=!0)}return d}}class Rn{constructor(){this.layerIndexes={},this.crossTileIDs=new Jr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,d,m){let g=this.layerIndexes[r.id];g===void 0&&(g=this.layerIndexes[r.id]=new xr);let x=!1;const T={};g.handleWrapJump(m);for(const C of d){const A=C.getBucket(r);A&&r.id===A.layerIds[0]&&(A.bucketInstanceId||(A.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket(C.tileID,A,this.crossTileIDs)&&(x=!0),T[A.bucketInstanceId]=!0)}return g.removeStaleBuckets(T)&&(x=!0),x}pruneUnusedLayers(r){const d={};r.forEach(m=>{d[m]=!0});for(const m in this.layerIndexes)d[m]||delete this.layerIndexes[m]}}const xa=(b,r)=>o.t(b,r&&r.filter(d=>d.identifier!=="source.canvas")),Ia=o.av();class ls extends o.E{constructor(r,d={}){super(),this._rtlPluginLoaded=()=>{for(const m in this.sourceCaches){const g=this.sourceCaches[m].getSource().type;g!=="vector"&&g!=="geojson"||this.sourceCaches[m].reload()}},this.map=r,this.dispatcher=new mi(ht(),r._getMapId()),this.dispatcher.registerMessageHandler("getGlyphs",(m,g)=>this.getGlyphs(m,g)),this.dispatcher.registerMessageHandler("getImages",(m,g)=>this.getImages(m,g)),this.imageManager=new si,this.imageManager.setEventedParent(this),this.glyphManager=new Vt(r._requestManager,d.localIdeographFontFamily),this.lineAtlas=new Dt(256,512),this.crossTileSymbolIndex=new Rn,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.aw,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.ax()),jn().on(ta,this._rtlPluginLoaded),this.on("data",m=>{if(m.dataType!=="source"||m.sourceDataType!=="metadata")return;const g=this.sourceCaches[m.sourceId];if(!g)return;const x=g.getSource();if(x&&x.vectorLayerIds)for(const T in this._layers){const C=this._layers[T];C.source===x.id&&this._validateLayer(C)}})}loadURL(r,d={},m){this.fire(new o.k("dataloading",{dataType:"style"})),d.validate=typeof d.validate!="boolean"||d.validate;const g=this.map._requestManager.transformRequest(r,ce.Style);this._loadStyleRequest=new AbortController,o.h(g,this._loadStyleRequest).then(x=>{this._loadStyleRequest=null,this._load(x.data,d,m)}).catch(x=>{this._loadStyleRequest=null,x&&this.fire(new o.j(x))})}loadJSON(r,d={},m){this.fire(new o.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,M.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,d.validate=d.validate!==!1,this._load(r,d,m)}).catch(()=>{})}loadEmpty(){this.fire(new o.k("dataloading",{dataType:"style"})),this._load(Ia,{validate:!1})}_load(r,d,m){var g;const x=d.transformStyle?d.transformStyle(m,r):r;if(!d.validate||!xa(this,o.x(x))){this._loaded=!0,this.stylesheet=x;for(const T in x.sources)this.addSource(T,x.sources[T],{validate:!1});x.sprite?this._loadSprite(x.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(x.glyphs),this._createLayers(),this.light=new _t(this.stylesheet.light),this.map.setTerrain((g=this.stylesheet.terrain)!==null&&g!==void 0?g:null),this.fire(new o.k("data",{dataType:"style"})),this.fire(new o.k("style.load"))}}_createLayers(){const r=o.ay(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",r),this._order=r.map(d=>d.id),this._layers={},this._serializedLayers=null;for(const d of r){const m=o.az(d);m.setEventedParent(this,{layer:{id:d.id}}),this._layers[d.id]=m}}_loadSprite(r,d=!1,m=void 0){let g;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(x,T,C,A){return o._(this,void 0,void 0,function*(){const F=Re(x),j=C>1?"@2x":"",Z={},ie={};for(const{id:pe,url:fe}of F){const ge=T.transformRequest(T.normalizeSpriteURL(fe,j,".json"),ce.SpriteJSON);Z[pe]=o.h(ge,A);const le=T.transformRequest(T.normalizeSpriteURL(fe,j,".png"),ce.SpriteImage);ie[pe]=Q.getImage(le,A)}return yield Promise.all([...Object.values(Z),...Object.values(ie)]),function(pe,fe){return o._(this,void 0,void 0,function*(){const ge={};for(const le in pe){ge[le]={};const Le=M.getImageCanvasContext((yield fe[le]).data),We=(yield pe[le]).data;for(const ye in We){const{width:Ne,height:qe,x:Ze,y:Je,sdf:pt,pixelRatio:ut,stretchX:dt,stretchY:Gt,content:Ri}=We[ye];ge[le][ye]={data:null,pixelRatio:ut,sdf:pt,stretchX:dt,stretchY:Gt,content:Ri,spriteData:{width:Ne,height:qe,x:Ze,y:Je,context:Le}}}}return ge})}(Z,ie)})}(r,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(x=>{if(this._spriteRequest=null,x)for(const T in x){this._spritesImagesIds[T]=[];const C=this._spritesImagesIds[T]?this._spritesImagesIds[T].filter(A=>!(A in x)):[];for(const A of C)this.imageManager.removeImage(A),this._changedImages[A]=!0;for(const A in x[T]){const F=T==="default"?A:`${T}:${A}`;this._spritesImagesIds[T].push(F),F in this.imageManager.images?this.imageManager.updateImage(F,x[T][A],!1):this.imageManager.addImage(F,x[T][A]),d&&(this._changedImages[F]=!0)}}}).catch(x=>{this._spriteRequest=null,g=x,this.fire(new o.j(g))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),d&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.k("data",{dataType:"style"})),m&&m(g)})}_unloadSprite(){for(const r of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(r),this._changedImages[r]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}_validateLayer(r){const d=this.sourceCaches[r.source];if(!d)return;const m=r.sourceLayer;if(!m)return;const g=d.getSource();(g.type==="geojson"||g.vectorLayerIds&&g.vectorLayerIds.indexOf(m)===-1)&&this.fire(new o.j(new Error(`Source layer "${m}" does not exist on source "${g.id}" as specified by style layer "${r.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this.sourceCaches)if(!this.sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(r){const d=this._serializedAllLayers();if(!r||r.length===0)return Object.values(d);const m=[];for(const g of r)d[g]&&m.push(d[g]);return m}_serializedAllLayers(){let r=this._serializedLayers;if(r)return r;r=this._serializedLayers={};const d=Object.keys(this._layers);for(const m of d){const g=this._layers[m];g.type!=="custom"&&(r[m]=g.serialize())}return r}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const r in this.sourceCaches)if(this.sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(r){if(!this._loaded)return;const d=this._changed;if(this._changed){const g=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(g.length||x.length)&&this._updateWorkerLayers(g,x);for(const T in this._updatedSources){const C=this._updatedSources[T];if(C==="reload")this._reloadSource(T);else{if(C!=="clear")throw new Error(`Invalid action ${C}`);this._clearSource(T)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const T in this._updatedPaintProps)this._layers[T].updateTransitions(r);this.light.updateTransitions(r),this._resetUpdates()}const m={};for(const g in this.sourceCaches){const x=this.sourceCaches[g];m[g]=x.used,x.used=!1}for(const g of this._order){const x=this._layers[g];x.recalculate(r,this._availableImages),!x.isHidden(r.zoom)&&x.source&&(this.sourceCaches[x.source].used=!0)}for(const g in m){const x=this.sourceCaches[g];m[g]!==x.used&&x.fire(new o.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:g}))}this.light.recalculate(r),this.z=r.zoom,d&&this.fire(new o.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(r,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(r),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(r,d={}){var m;this._checkLoaded();const g=this.serialize();if(r=d.transformStyle?d.transformStyle(g,r):r,((m=d.validate)===null||m===void 0||m)&&xa(this,o.x(r)))return!1;(r=o.aA(r)).layers=o.ay(r.layers);const x=o.aB(g,r),T=this._getOperationsToPerform(x);if(T.unimplemented.length>0)throw new Error(`Unimplemented: ${T.unimplemented.join(", ")}.`);if(T.operations.length===0)return!1;for(const C of T.operations)C();return this.stylesheet=r,this._serializedLayers=null,!0}_getOperationsToPerform(r){const d=[],m=[];for(const g of r)switch(g.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":d.push(()=>this.addLayer.apply(this,g.args));break;case"removeLayer":d.push(()=>this.removeLayer.apply(this,g.args));break;case"setPaintProperty":d.push(()=>this.setPaintProperty.apply(this,g.args));break;case"setLayoutProperty":d.push(()=>this.setLayoutProperty.apply(this,g.args));break;case"setFilter":d.push(()=>this.setFilter.apply(this,g.args));break;case"addSource":d.push(()=>this.addSource.apply(this,g.args));break;case"removeSource":d.push(()=>this.removeSource.apply(this,g.args));break;case"setLayerZoomRange":d.push(()=>this.setLayerZoomRange.apply(this,g.args));break;case"setLight":d.push(()=>this.setLight.apply(this,g.args));break;case"setGeoJSONSourceData":d.push(()=>this.setGeoJSONSourceData.apply(this,g.args));break;case"setGlyphs":d.push(()=>this.setGlyphs.apply(this,g.args));break;case"setSprite":d.push(()=>this.setSprite.apply(this,g.args));break;case"setTerrain":d.push(()=>this.map.setTerrain.apply(this,g.args));break;case"setTransition":d.push(()=>{});break;default:m.push(g.command)}return{operations:d,unimplemented:m}}addImage(r,d){if(this.getImage(r))return this.fire(new o.j(new Error(`An image named "${r}" already exists.`)));this.imageManager.addImage(r,d),this._afterImageUpdated(r)}updateImage(r,d){this.imageManager.updateImage(r,d)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){if(!this.getImage(r))return this.fire(new o.j(new Error(`An image named "${r}" does not exist.`)));this.imageManager.removeImage(r),this._afterImageUpdated(r)}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(r,d,m={}){if(this._checkLoaded(),this.sourceCaches[r]!==void 0)throw new Error(`Source "${r}" already exists.`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(o.x.source,`sources.${r}`,d,null,m))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const g=this.sourceCaches[r]=new lt(r,d,this.dispatcher);g.style=this,g.setEventedParent(this,()=>({isSourceLoaded:g.loaded(),source:g.serialize(),sourceId:r})),g.onAdd(this.map),this._changed=!0}removeSource(r){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error("There is no source with this ID");for(const m in this._layers)if(this._layers[m].source===r)return this.fire(new o.j(new Error(`Source "${r}" cannot be removed while layer "${m}" is using it.`)));const d=this.sourceCaches[r];delete this.sourceCaches[r],delete this._updatedSources[r],d.fire(new o.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:r})),d.setEventedParent(null),d.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(r,d){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error(`There is no source with this ID=${r}`);const m=this.sourceCaches[r].getSource();if(m.type!=="geojson")throw new Error(`geojsonSource.type is ${m.type}, which is !== 'geojson`);m.setData(d),this._changed=!0}getSource(r){return this.sourceCaches[r]&&this.sourceCaches[r].getSource()}addLayer(r,d,m={}){this._checkLoaded();const g=r.id;if(this.getLayer(g))return void this.fire(new o.j(new Error(`Layer "${g}" already exists on this map.`)));let x;if(r.type==="custom"){if(xa(this,o.aC(r)))return;x=o.az(r)}else{if("source"in r&&typeof r.source=="object"&&(this.addSource(g,r.source),r=o.aA(r),r=o.e(r,{source:g})),this._validate(o.x.layer,`layers.${g}`,r,{arrayIndex:-1},m))return;x=o.az(r),this._validateLayer(x),x.setEventedParent(this,{layer:{id:g}})}const T=d?this._order.indexOf(d):this._order.length;if(d&&T===-1)this.fire(new o.j(new Error(`Cannot add layer "${g}" before non-existing layer "${d}".`)));else{if(this._order.splice(T,0,g),this._layerOrderChanged=!0,this._layers[g]=x,this._removedLayers[g]&&x.source&&x.type!=="custom"){const C=this._removedLayers[g];delete this._removedLayers[g],C.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",this.sourceCaches[x.source].pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map)}}moveLayer(r,d){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new o.j(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===d)return;const m=this._order.indexOf(r);this._order.splice(m,1);const g=d?this._order.indexOf(d):this._order.length;d&&g===-1?this.fire(new o.j(new Error(`Cannot move layer "${r}" before non-existing layer "${d}".`))):(this._order.splice(g,0,r),this._layerOrderChanged=!0)}removeLayer(r){this._checkLoaded();const d=this._layers[r];if(!d)return void this.fire(new o.j(new Error(`Cannot remove non-existing layer "${r}".`)));d.setEventedParent(null);const m=this._order.indexOf(r);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=d,delete this._layers[r],this._serializedLayers&&delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],d.onRemove&&d.onRemove(this.map)}getLayer(r){return this._layers[r]}getLayersOrder(){return[...this._order]}hasLayer(r){return r in this._layers}setLayerZoomRange(r,d,m){this._checkLoaded();const g=this.getLayer(r);g?g.minzoom===d&&g.maxzoom===m||(d!=null&&(g.minzoom=d),m!=null&&(g.maxzoom=m),this._updateLayer(g)):this.fire(new o.j(new Error(`Cannot set the zoom range of non-existing layer "${r}".`)))}setFilter(r,d,m={}){this._checkLoaded();const g=this.getLayer(r);if(g){if(!o.aD(g.filter,d))return d==null?(g.filter=void 0,void this._updateLayer(g)):void(this._validate(o.x.filter,`layers.${g.id}.filter`,d,null,m)||(g.filter=o.aA(d),this._updateLayer(g)))}else this.fire(new o.j(new Error(`Cannot filter non-existing layer "${r}".`)))}getFilter(r){return o.aA(this.getLayer(r).filter)}setLayoutProperty(r,d,m,g={}){this._checkLoaded();const x=this.getLayer(r);x?o.aD(x.getLayoutProperty(d),m)||(x.setLayoutProperty(d,m,g),this._updateLayer(x)):this.fire(new o.j(new Error(`Cannot style non-existing layer "${r}".`)))}getLayoutProperty(r,d){const m=this.getLayer(r);if(m)return m.getLayoutProperty(d);this.fire(new o.j(new Error(`Cannot get style of non-existing layer "${r}".`)))}setPaintProperty(r,d,m,g={}){this._checkLoaded();const x=this.getLayer(r);x?o.aD(x.getPaintProperty(d),m)||(x.setPaintProperty(d,m,g)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new o.j(new Error(`Cannot style non-existing layer "${r}".`)))}getPaintProperty(r,d){return this.getLayer(r).getPaintProperty(d)}setFeatureState(r,d){this._checkLoaded();const m=r.source,g=r.sourceLayer,x=this.sourceCaches[m];if(x===void 0)return void this.fire(new o.j(new Error(`The source '${m}' does not exist in the map's style.`)));const T=x.getSource().type;T==="geojson"&&g?this.fire(new o.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):T!=="vector"||g?(r.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),x.setFeatureState(g,r.id,d)):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(r,d){this._checkLoaded();const m=r.source,g=this.sourceCaches[m];if(g===void 0)return void this.fire(new o.j(new Error(`The source '${m}' does not exist in the map's style.`)));const x=g.getSource().type,T=x==="vector"?r.sourceLayer:void 0;x!=="vector"||T?d&&typeof r.id!="string"&&typeof r.id!="number"?this.fire(new o.j(new Error("A feature id is required to remove its specific state property."))):g.removeFeatureState(T,r.id,d):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(r){this._checkLoaded();const d=r.source,m=r.sourceLayer,g=this.sourceCaches[d];if(g!==void 0)return g.getSource().type!=="vector"||m?(r.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),g.getFeatureState(m,r.id)):void this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.j(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const r=o.aE(this.sourceCaches,x=>x.serialize()),d=this._serializeByIds(this._order),m=this.map.getTerrain()||void 0,g=this.stylesheet;return o.aF({version:g.version,name:g.name,metadata:g.metadata,light:g.light,center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch,sprite:g.sprite,glyphs:g.glyphs,transition:g.transition,sources:r,layers:d,terrain:m},x=>x!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0,r.source&&!this._updatedSources[r.source]&&this.sourceCaches[r.source].getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",this.sourceCaches[r.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(r){const d=T=>this._layers[T].type==="fill-extrusion",m={},g=[];for(let T=this._order.length-1;T>=0;T--){const C=this._order[T];if(d(C)){m[C]=T;for(const A of r){const F=A[C];if(F)for(const j of F)g.push(j)}}}g.sort((T,C)=>C.intersectionZ-T.intersectionZ);const x=[];for(let T=this._order.length-1;T>=0;T--){const C=this._order[T];if(d(C))for(let A=g.length-1;A>=0;A--){const F=g[A].feature;if(m[F.layer.id]<T)break;x.push(F),g.pop()}else for(const A of r){const F=A[C];if(F)for(const j of F)x.push(j.feature)}}return x}queryRenderedFeatures(r,d,m){d&&d.filter&&this._validate(o.x.filter,"queryRenderedFeatures.filter",d.filter,null,d);const g={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new o.j(new Error("parameters.layers must be an Array."))),[];for(const C of d.layers){const A=this._layers[C];if(!A)return this.fire(new o.j(new Error(`The layer '${C}' does not exist in the map's style and cannot be queried for features.`))),[];g[A.source]=!0}}const x=[];d.availableImages=this._availableImages;const T=this._serializedAllLayers();for(const C in this.sourceCaches)d.layers&&!g[C]||x.push(Oi(this.sourceCaches[C],this._layers,T,r,d,m));return this.placement&&x.push(function(C,A,F,j,Z,ie,pe){const fe={},ge=ie.queryRenderedSymbols(j),le=[];for(const Le of Object.keys(ge).map(Number))le.push(pe[Le]);le.sort(mn);for(const Le of le){const We=Le.featureIndex.lookupSymbolFeatures(ge[Le.bucketInstanceId],A,Le.bucketIndex,Le.sourceLayerIndex,Z.filter,Z.layers,Z.availableImages,C);for(const ye in We){const Ne=fe[ye]=fe[ye]||[],qe=We[ye];qe.sort((Ze,Je)=>{const pt=Le.featureSortOrder;if(pt){const ut=pt.indexOf(Ze.featureIndex);return pt.indexOf(Je.featureIndex)-ut}return Je.featureIndex-Ze.featureIndex});for(const Ze of qe)Ne.push(Ze)}}for(const Le in fe)fe[Le].forEach(We=>{const ye=We.feature,Ne=F[C[Le].source].getFeatureState(ye.layer["source-layer"],ye.id);ye.source=ye.layer.source,ye.layer["source-layer"]&&(ye.sourceLayer=ye.layer["source-layer"]),ye.state=Ne});return fe}(this._layers,T,this.sourceCaches,r,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(r,d){d&&d.filter&&this._validate(o.x.filter,"querySourceFeatures.filter",d.filter,null,d);const m=this.sourceCaches[r];return m?function(g,x){const T=g.getRenderableIds().map(F=>g.getTileByID(F)),C=[],A={};for(let F=0;F<T.length;F++){const j=T[F],Z=j.tileID.canonical.key;A[Z]||(A[Z]=!0,j.querySourceFeatures(C,x))}return C}(m,d):[]}getLight(){return this.light.getLight()}setLight(r,d={}){this._checkLoaded();const m=this.light.getLight();let g=!1;for(const T in r)if(!o.aD(r[T],m[T])){g=!0;break}if(!g)return;const x={now:M.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r,d),this.light.updateTransitions(x)}_validate(r,d,m,g,x={}){return(!x||x.validate!==!1)&&xa(this,r.call(o.x,o.e({key:d,style:this.serialize(),value:m,styleSpec:o.v},g)))}_remove(r=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),jn().off(ta,this._rtlPluginLoaded);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this.sourceCaches){const m=this.sourceCaches[d];m.setEventedParent(null),m.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),r&&this.dispatcher.broadcast("removeMap",void 0),this.dispatcher.remove(r)}_clearSource(r){this.sourceCaches[r].clearTiles()}_reloadSource(r){this.sourceCaches[r].resume(),this.sourceCaches[r].reload()}_updateSources(r){for(const d in this.sourceCaches)this.sourceCaches[d].update(r,this.map.terrain)}_generateCollisionBoxes(){for(const r in this.sourceCaches)this._reloadSource(r)}_updatePlacement(r,d,m,g,x=!1){let T=!1,C=!1;const A={};for(const F of this._order){const j=this._layers[F];if(j.type!=="symbol")continue;if(!A[j.source]){const ie=this.sourceCaches[j.source];A[j.source]=ie.getRenderableIds(!0).map(pe=>ie.getTileByID(pe)).sort((pe,fe)=>fe.tileID.overscaledZ-pe.tileID.overscaledZ||(pe.tileID.isLessThan(fe.tileID)?-1:1))}const Z=this.crossTileSymbolIndex.addLayer(j,A[j.source],r.center.lng);T=T||Z}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((x=x||this._layerOrderChanged||m===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(M.now(),r.zoom))&&(this.pauseablePlacement=new Yr(r,this.map.terrain,this._order,x,d,m,g,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,A),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(M.now()),C=!0),T&&this.pauseablePlacement.placement.setStale()),C||T)for(const F of this._order){const j=this._layers[F];j.type==="symbol"&&this.placement.updateLayerOpacities(j,A[j.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(M.now())}_releaseSymbolFadeTiles(){for(const r in this.sourceCaches)this.sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,d){return o._(this,void 0,void 0,function*(){const m=yield this.imageManager.getImages(d.icons);this._updateTilesForChangedImages();const g=this.sourceCaches[d.source];return g&&g.setDependencies(d.tileID.key,d.type,d.icons),m})}getGlyphs(r,d){return o._(this,void 0,void 0,function*(){const m=yield this.glyphManager.getGlyphs(d.stacks),g=this.sourceCaches[d.source];return g&&g.setDependencies(d.tileID.key,d.type,[""]),m})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(r,d={}){this._checkLoaded(),r&&this._validate(o.x.glyphs,"glyphs",r,null,d)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=r,this.glyphManager.entries={},this.glyphManager.setURL(r))}addSprite(r,d,m={},g){this._checkLoaded();const x=[{id:r,url:d}],T=[...Re(this.stylesheet.sprite),...x];this._validate(o.x.sprite,"sprite",T,null,m)||(this.stylesheet.sprite=T,this._loadSprite(x,!0,g))}removeSprite(r){this._checkLoaded();const d=Re(this.stylesheet.sprite);if(d.find(m=>m.id===r)){if(this._spritesImagesIds[r])for(const m of this._spritesImagesIds[r])this.imageManager.removeImage(m),this._changedImages[m]=!0;d.splice(d.findIndex(m=>m.id===r),1),this.stylesheet.sprite=d.length>0?d:void 0,delete this._spritesImagesIds[r],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}else this.fire(new o.j(new Error(`Sprite "${r}" doesn't exists on this map.`)))}getSprite(){return Re(this.stylesheet.sprite)}setSprite(r,d={},m){this._checkLoaded(),r&&this._validate(o.x.sprite,"sprite",r,null,d)||(this.stylesheet.sprite=r,r?this._loadSprite(r,!0,m):(this._unloadSprite(),m&&m(null)))}}var wa=o.X([{name:"a_pos",type:"Int16",components:2}]),xs="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const z={prelude:N(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:N(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:N(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:N(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:N("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:N(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:N(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:N("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:N("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:N("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:N(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:N(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:N(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:N(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:N(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:N(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:N(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:N(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:N(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:N(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:N(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:N(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:N(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:N(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:N(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:N(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:N("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",xs),terrainDepth:N("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",xs),terrainCoords:N("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",xs)};function N(b,r){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=r.match(/attribute ([\w]+) ([\w]+)/g),g=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=r.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=x?x.concat(g):g,C={};return{fragmentSource:b=b.replace(d,(A,F,j,Z,ie)=>(C[ie]=!0,F==="define"?`
#ifndef HAS_UNIFORM_u_${ie}
varying ${j} ${Z} ${ie};
#else
uniform ${j} ${Z} u_${ie};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ie}
    ${j} ${Z} ${ie} = u_${ie};
#endif
`)),vertexSource:r=r.replace(d,(A,F,j,Z,ie)=>{const pe=Z==="float"?"vec2":"vec4",fe=ie.match(/color/)?"color":pe;return C[ie]?F==="define"?`
#ifndef HAS_UNIFORM_u_${ie}
uniform lowp float u_${ie}_t;
attribute ${j} ${pe} a_${ie};
varying ${j} ${Z} ${ie};
#else
uniform ${j} ${Z} u_${ie};
#endif
`:fe==="vec4"?`
#ifndef HAS_UNIFORM_u_${ie}
    ${ie} = a_${ie};
#else
    ${j} ${Z} ${ie} = u_${ie};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ie}
    ${ie} = unpack_mix_${fe}(a_${ie}, u_${ie}_t);
#else
    ${j} ${Z} ${ie} = u_${ie};
#endif
`:F==="define"?`
#ifndef HAS_UNIFORM_u_${ie}
uniform lowp float u_${ie}_t;
attribute ${j} ${pe} a_${ie};
#else
uniform ${j} ${Z} u_${ie};
#endif
`:fe==="vec4"?`
#ifndef HAS_UNIFORM_u_${ie}
    ${j} ${Z} ${ie} = a_${ie};
#else
    ${j} ${Z} ${ie} = u_${ie};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ie}
    ${j} ${Z} ${ie} = unpack_mix_${fe}(a_${ie}, u_${ie}_t);
#else
    ${j} ${Z} ${ie} = u_${ie};
#endif
`}),staticAttributes:m,staticUniforms:T}}class be{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(r,d,m,g,x,T,C,A,F){this.context=r;let j=this.boundPaintVertexBuffers.length!==g.length;for(let Z=0;!j&&Z<g.length;Z++)this.boundPaintVertexBuffers[Z]!==g[Z]&&(j=!0);!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==m||j||this.boundIndexBuffer!==x||this.boundVertexOffset!==T||this.boundDynamicVertexBuffer!==C||this.boundDynamicVertexBuffer2!==A||this.boundDynamicVertexBuffer3!==F?this.freshBind(d,m,g,x,T,C,A,F):(r.bindVertexArray.set(this.vao),C&&C.bind(),x&&x.dynamicDraw&&x.bind(),A&&A.bind(),F&&F.bind())}freshBind(r,d,m,g,x,T,C,A){const F=r.numAttributes,j=this.context,Z=j.gl;this.vao&&this.destroy(),this.vao=j.createVertexArray(),j.bindVertexArray.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=g,this.boundVertexOffset=x,this.boundDynamicVertexBuffer=T,this.boundDynamicVertexBuffer2=C,this.boundDynamicVertexBuffer3=A,d.enableAttributes(Z,r);for(const ie of m)ie.enableAttributes(Z,r);T&&T.enableAttributes(Z,r),C&&C.enableAttributes(Z,r),A&&A.enableAttributes(Z,r),d.bind(),d.setVertexAttribPointers(Z,r,x);for(const ie of m)ie.bind(),ie.setVertexAttribPointers(Z,r,x);T&&(T.bind(),T.setVertexAttribPointers(Z,r,x)),g&&g.bind(),C&&(C.bind(),C.setVertexAttribPointers(Z,r,x)),A&&(A.bind(),A.setVertexAttribPointers(Z,r,x)),j.currentNumAttributes=F}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function we(b){const r=[];for(let d=0;d<b.length;d++){if(b[d]===null)continue;const m=b[d].split(" ");r.push(m.pop())}return r}class de{constructor(r,d,m,g,x,T){const C=r.gl;this.program=C.createProgram();const A=we(d.staticAttributes),F=m?m.getBinderAttributes():[],j=A.concat(F),Z=z.prelude.staticUniforms?we(z.prelude.staticUniforms):[],ie=d.staticUniforms?we(d.staticUniforms):[],pe=m?m.getBinderUniforms():[],fe=Z.concat(ie).concat(pe),ge=[];for(const Ze of fe)ge.indexOf(Ze)<0&&ge.push(Ze);const le=m?m.defines():[];x&&le.push("#define OVERDRAW_INSPECTOR;"),T&&le.push("#define TERRAIN3D;");const Le=le.concat(z.prelude.fragmentSource,d.fragmentSource).join(`
`),We=le.concat(z.prelude.vertexSource,d.vertexSource).join(`
`),ye=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);if(C.shaderSource(ye,Le),C.compileShader(ye),!C.getShaderParameter(ye,C.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${C.getShaderInfoLog(ye)}`);C.attachShader(this.program,ye);const Ne=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);if(C.shaderSource(Ne,We),C.compileShader(Ne),!C.getShaderParameter(Ne,C.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${C.getShaderInfoLog(Ne)}`);C.attachShader(this.program,Ne),this.attributes={};const qe={};this.numAttributes=j.length;for(let Ze=0;Ze<this.numAttributes;Ze++)j[Ze]&&(C.bindAttribLocation(this.program,Ze,j[Ze]),this.attributes[j[Ze]]=Ze);if(C.linkProgram(this.program),!C.getProgramParameter(this.program,C.LINK_STATUS))throw new Error(`Program failed to link: ${C.getProgramInfoLog(this.program)}`);C.deleteShader(Ne),C.deleteShader(ye);for(let Ze=0;Ze<ge.length;Ze++){const Je=ge[Ze];if(Je&&!qe[Je]){const pt=C.getUniformLocation(this.program,Je);pt&&(qe[Je]=pt)}}this.fixedUniforms=g(r,qe),this.terrainUniforms=((Ze,Je)=>({u_depth:new o.aG(Ze,Je.u_depth),u_terrain:new o.aG(Ze,Je.u_terrain),u_terrain_dim:new o.aH(Ze,Je.u_terrain_dim),u_terrain_matrix:new o.aI(Ze,Je.u_terrain_matrix),u_terrain_unpack:new o.aJ(Ze,Je.u_terrain_unpack),u_terrain_exaggeration:new o.aH(Ze,Je.u_terrain_exaggeration)}))(r,qe),this.binderUniforms=m?m.getUniforms(r,qe):[]}draw(r,d,m,g,x,T,C,A,F,j,Z,ie,pe,fe,ge,le,Le,We){const ye=r.gl;if(this.failedToCreate)return;if(r.program.set(this.program),r.setDepthMode(m),r.setStencilMode(g),r.setColorMode(x),r.setCullFace(T),A){r.activeTexture.set(ye.TEXTURE2),ye.bindTexture(ye.TEXTURE_2D,A.depthTexture),r.activeTexture.set(ye.TEXTURE3),ye.bindTexture(ye.TEXTURE_2D,A.texture);for(const qe in this.terrainUniforms)this.terrainUniforms[qe].set(A[qe])}for(const qe in this.fixedUniforms)this.fixedUniforms[qe].set(C[qe]);ge&&ge.setUniforms(r,this.binderUniforms,pe,{zoom:fe});let Ne=0;switch(d){case ye.LINES:Ne=2;break;case ye.TRIANGLES:Ne=3;break;case ye.LINE_STRIP:Ne=1}for(const qe of ie.get()){const Ze=qe.vaos||(qe.vaos={});(Ze[F]||(Ze[F]=new be)).bind(r,this,j,ge?ge.getPaintVertexBuffers():[],Z,qe.vertexOffset,le,Le,We),ye.drawElements(d,qe.primitiveLength*Ne,ye.UNSIGNED_SHORT,qe.primitiveOffset*Ne*2)}}}function Ue(b,r,d){const m=1/Ge(d,1,r.transform.tileZoom),g=Math.pow(2,d.tileID.overscaledZ),x=d.tileSize*Math.pow(2,r.transform.tileZoom)/g,T=x*(d.tileID.canonical.x+d.tileID.wrap*g),C=x*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[m,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[T>>16,C>>16],u_pixel_coord_lower:[65535&T,65535&C]}}const xe=(b,r,d,m)=>{const g=r.style.light,x=g.properties.get("position"),T=[x.x,x.y,x.z],C=function(){var F=new o.A(9);return o.A!=Float32Array&&(F[1]=0,F[2]=0,F[3]=0,F[5]=0,F[6]=0,F[7]=0),F[0]=1,F[4]=1,F[8]=1,F}();g.properties.get("anchor")==="viewport"&&function(F,j){var Z=Math.sin(j),ie=Math.cos(j);F[0]=ie,F[1]=Z,F[2]=0,F[3]=-Z,F[4]=ie,F[5]=0,F[6]=0,F[7]=0,F[8]=1}(C,-r.transform.angle),function(F,j,Z){var ie=j[0],pe=j[1],fe=j[2];F[0]=ie*Z[0]+pe*Z[3]+fe*Z[6],F[1]=ie*Z[1]+pe*Z[4]+fe*Z[7],F[2]=ie*Z[2]+pe*Z[5]+fe*Z[8]}(T,T,C);const A=g.properties.get("color");return{u_matrix:b,u_lightpos:T,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[A.r,A.g,A.b],u_vertical_gradient:+d,u_opacity:m}},st=(b,r,d,m,g,x,T)=>o.e(xe(b,r,d,m),Ue(x,r,T),{u_height_factor:-Math.pow(2,g.overscaledZ)/T.tileSize/8}),bt=b=>({u_matrix:b}),Rt=(b,r,d,m)=>o.e(bt(b),Ue(d,r,m)),vt=(b,r)=>({u_matrix:b,u_world:r}),Zt=(b,r,d,m,g)=>o.e(Rt(b,r,d,m),{u_world:g}),fi=(b,r,d,m)=>{const g=b.transform;let x,T;if(m.paint.get("circle-pitch-alignment")==="map"){const C=Ge(d,1,g.zoom);x=!0,T=[C,C]}else x=!1,T=g.pixelsToGLUnits;return{u_camera_to_center_distance:g.cameraToCenterDistance,u_scale_with_map:+(m.paint.get("circle-pitch-scale")==="map"),u_matrix:b.translatePosMatrix(r.posMatrix,d,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_pitch_with_map:+x,u_device_pixel_ratio:b.pixelRatio,u_extrude_scale:T}},ii=(b,r,d)=>{const m=Ge(d,1,r.zoom),g=Math.pow(2,r.zoom-d.tileID.overscaledZ),x=d.tileID.overscaleFactor();return{u_matrix:b,u_camera_to_center_distance:r.cameraToCenterDistance,u_pixels_to_tile_units:m,u_extrude_scale:[r.pixelsToGLUnits[0]/(m*g),r.pixelsToGLUnits[1]/(m*g)],u_overscale_factor:x}},Mt=(b,r,d=1)=>({u_matrix:b,u_color:r,u_overlay:0,u_overlay_scale:d}),ct=b=>({u_matrix:b}),Ot=(b,r,d,m)=>({u_matrix:b,u_extrude_scale:Ge(r,1,d),u_intensity:m});function ui(b,r){const d=Math.pow(2,r.canonical.z),m=r.canonical.y;return[new o.Y(0,m/d).toLngLat().lat,new o.Y(0,(m+1)/d).toLngLat().lat]}const li=(b,r,d,m)=>{const g=b.transform;return{u_matrix:Xt(b,r,d,m),u_ratio:1/Ge(r,1,g.zoom),u_device_pixel_ratio:b.pixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Ji=(b,r,d,m,g)=>o.e(li(b,r,d,g),{u_image:0,u_image_height:m}),di=(b,r,d,m,g)=>{const x=b.transform,T=Kt(r,x);return{u_matrix:Xt(b,r,d,g),u_texsize:r.imageAtlasTexture.size,u_ratio:1/Ge(r,1,x.zoom),u_device_pixel_ratio:b.pixelRatio,u_image:0,u_scale:[T,m.fromScale,m.toScale],u_fade:m.t,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},It=(b,r,d,m,g,x)=>{const T=b.lineAtlas,C=Kt(r,b.transform),A=d.layout.get("line-cap")==="round",F=T.getDash(m.from,A),j=T.getDash(m.to,A),Z=F.width*g.fromScale,ie=j.width*g.toScale;return o.e(li(b,r,d,x),{u_patternscale_a:[C/Z,-F.height/2],u_patternscale_b:[C/ie,-j.height/2],u_sdfgamma:T.width/(256*Math.min(Z,ie)*b.pixelRatio)/2,u_image:0,u_tex_y_a:F.y,u_tex_y_b:j.y,u_mix:g.t})};function Kt(b,r){return 1/Ge(b,1,r.tileZoom)}function Xt(b,r,d,m){return b.translatePosMatrix(m?m.posMatrix:r.tileID.posMatrix,r,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}const Li=(b,r,d,m,g)=>{return{u_matrix:b,u_tl_parent:r,u_scale_parent:d,u_buffer_scale:1,u_fade_t:m.mix,u_opacity:m.opacity*g.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:g.paint.get("raster-brightness-min"),u_brightness_high:g.paint.get("raster-brightness-max"),u_saturation_factor:(T=g.paint.get("raster-saturation"),T>0?1-1/(1.001-T):-T),u_contrast_factor:(x=g.paint.get("raster-contrast"),x>0?1/(1-x):1+x),u_spin_weights:un(g.paint.get("raster-hue-rotate"))};var x,T};function un(b){b*=Math.PI/180;const r=Math.sin(b),d=Math.cos(b);return[(2*d+1)/3,(-Math.sqrt(3)*r-d+1)/3,(Math.sqrt(3)*r-d+1)/3]}const zi=(b,r,d,m,g,x,T,C,A,F)=>{const j=g.transform;return{u_is_size_zoom_constant:+(b==="constant"||b==="source"),u_is_size_feature_constant:+(b==="constant"||b==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:j.cameraToCenterDistance,u_pitch:j.pitch/360*2*Math.PI,u_rotate_symbol:+d,u_aspect_ratio:j.width/j.height,u_fade_change:g.options.fadeDuration?g.symbolFadeChange:1,u_matrix:x,u_label_plane_matrix:T,u_coord_matrix:C,u_is_text:+A,u_pitch_with_map:+m,u_texsize:F,u_texture:0}},Ui=(b,r,d,m,g,x,T,C,A,F,j)=>{const Z=g.transform;return o.e(zi(b,r,d,m,g,x,T,C,A,F),{u_gamma_scale:m?Math.cos(Z._pitch)*Z.cameraToCenterDistance:1,u_device_pixel_ratio:g.pixelRatio,u_is_halo:+j})},nn=(b,r,d,m,g,x,T,C,A,F)=>o.e(Ui(b,r,d,m,g,x,T,C,!0,A,!0),{u_texsize_icon:F,u_texture_icon:1}),Ja=(b,r,d)=>({u_matrix:b,u_opacity:r,u_color:d}),Rr=(b,r,d,m,g,x)=>o.e(function(T,C,A,F){const j=A.imageManager.getPattern(T.from.toString()),Z=A.imageManager.getPattern(T.to.toString()),{width:ie,height:pe}=A.imageManager.getPixelSize(),fe=Math.pow(2,F.tileID.overscaledZ),ge=F.tileSize*Math.pow(2,A.transform.tileZoom)/fe,le=ge*(F.tileID.canonical.x+F.tileID.wrap*fe),Le=ge*F.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:j.tl,u_pattern_br_a:j.br,u_pattern_tl_b:Z.tl,u_pattern_br_b:Z.br,u_texsize:[ie,pe],u_mix:C.t,u_pattern_size_a:j.displaySize,u_pattern_size_b:Z.displaySize,u_scale_a:C.fromScale,u_scale_b:C.toScale,u_tile_units_to_pixels:1/Ge(F,1,A.transform.tileZoom),u_pixel_coord_upper:[le>>16,Le>>16],u_pixel_coord_lower:[65535&le,65535&Le]}}(m,x,d,g),{u_matrix:b,u_opacity:r}),qa={fillExtrusion:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_lightpos:new o.aK(b,r.u_lightpos),u_lightintensity:new o.aH(b,r.u_lightintensity),u_lightcolor:new o.aK(b,r.u_lightcolor),u_vertical_gradient:new o.aH(b,r.u_vertical_gradient),u_opacity:new o.aH(b,r.u_opacity)}),fillExtrusionPattern:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_lightpos:new o.aK(b,r.u_lightpos),u_lightintensity:new o.aH(b,r.u_lightintensity),u_lightcolor:new o.aK(b,r.u_lightcolor),u_vertical_gradient:new o.aH(b,r.u_vertical_gradient),u_height_factor:new o.aH(b,r.u_height_factor),u_image:new o.aG(b,r.u_image),u_texsize:new o.aL(b,r.u_texsize),u_pixel_coord_upper:new o.aL(b,r.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(b,r.u_pixel_coord_lower),u_scale:new o.aK(b,r.u_scale),u_fade:new o.aH(b,r.u_fade),u_opacity:new o.aH(b,r.u_opacity)}),fill:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix)}),fillPattern:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_image:new o.aG(b,r.u_image),u_texsize:new o.aL(b,r.u_texsize),u_pixel_coord_upper:new o.aL(b,r.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(b,r.u_pixel_coord_lower),u_scale:new o.aK(b,r.u_scale),u_fade:new o.aH(b,r.u_fade)}),fillOutline:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_world:new o.aL(b,r.u_world)}),fillOutlinePattern:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_world:new o.aL(b,r.u_world),u_image:new o.aG(b,r.u_image),u_texsize:new o.aL(b,r.u_texsize),u_pixel_coord_upper:new o.aL(b,r.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(b,r.u_pixel_coord_lower),u_scale:new o.aK(b,r.u_scale),u_fade:new o.aH(b,r.u_fade)}),circle:(b,r)=>({u_camera_to_center_distance:new o.aH(b,r.u_camera_to_center_distance),u_scale_with_map:new o.aG(b,r.u_scale_with_map),u_pitch_with_map:new o.aG(b,r.u_pitch_with_map),u_extrude_scale:new o.aL(b,r.u_extrude_scale),u_device_pixel_ratio:new o.aH(b,r.u_device_pixel_ratio),u_matrix:new o.aI(b,r.u_matrix)}),collisionBox:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_camera_to_center_distance:new o.aH(b,r.u_camera_to_center_distance),u_pixels_to_tile_units:new o.aH(b,r.u_pixels_to_tile_units),u_extrude_scale:new o.aL(b,r.u_extrude_scale),u_overscale_factor:new o.aH(b,r.u_overscale_factor)}),collisionCircle:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_inv_matrix:new o.aI(b,r.u_inv_matrix),u_camera_to_center_distance:new o.aH(b,r.u_camera_to_center_distance),u_viewport_size:new o.aL(b,r.u_viewport_size)}),debug:(b,r)=>({u_color:new o.aM(b,r.u_color),u_matrix:new o.aI(b,r.u_matrix),u_overlay:new o.aG(b,r.u_overlay),u_overlay_scale:new o.aH(b,r.u_overlay_scale)}),clippingMask:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix)}),heatmap:(b,r)=>({u_extrude_scale:new o.aH(b,r.u_extrude_scale),u_intensity:new o.aH(b,r.u_intensity),u_matrix:new o.aI(b,r.u_matrix)}),heatmapTexture:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_world:new o.aL(b,r.u_world),u_image:new o.aG(b,r.u_image),u_color_ramp:new o.aG(b,r.u_color_ramp),u_opacity:new o.aH(b,r.u_opacity)}),hillshade:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_image:new o.aG(b,r.u_image),u_latrange:new o.aL(b,r.u_latrange),u_light:new o.aL(b,r.u_light),u_shadow:new o.aM(b,r.u_shadow),u_highlight:new o.aM(b,r.u_highlight),u_accent:new o.aM(b,r.u_accent)}),hillshadePrepare:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_image:new o.aG(b,r.u_image),u_dimension:new o.aL(b,r.u_dimension),u_zoom:new o.aH(b,r.u_zoom),u_unpack:new o.aJ(b,r.u_unpack)}),line:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_ratio:new o.aH(b,r.u_ratio),u_device_pixel_ratio:new o.aH(b,r.u_device_pixel_ratio),u_units_to_pixels:new o.aL(b,r.u_units_to_pixels)}),lineGradient:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_ratio:new o.aH(b,r.u_ratio),u_device_pixel_ratio:new o.aH(b,r.u_device_pixel_ratio),u_units_to_pixels:new o.aL(b,r.u_units_to_pixels),u_image:new o.aG(b,r.u_image),u_image_height:new o.aH(b,r.u_image_height)}),linePattern:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_texsize:new o.aL(b,r.u_texsize),u_ratio:new o.aH(b,r.u_ratio),u_device_pixel_ratio:new o.aH(b,r.u_device_pixel_ratio),u_image:new o.aG(b,r.u_image),u_units_to_pixels:new o.aL(b,r.u_units_to_pixels),u_scale:new o.aK(b,r.u_scale),u_fade:new o.aH(b,r.u_fade)}),lineSDF:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_ratio:new o.aH(b,r.u_ratio),u_device_pixel_ratio:new o.aH(b,r.u_device_pixel_ratio),u_units_to_pixels:new o.aL(b,r.u_units_to_pixels),u_patternscale_a:new o.aL(b,r.u_patternscale_a),u_patternscale_b:new o.aL(b,r.u_patternscale_b),u_sdfgamma:new o.aH(b,r.u_sdfgamma),u_image:new o.aG(b,r.u_image),u_tex_y_a:new o.aH(b,r.u_tex_y_a),u_tex_y_b:new o.aH(b,r.u_tex_y_b),u_mix:new o.aH(b,r.u_mix)}),raster:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_tl_parent:new o.aL(b,r.u_tl_parent),u_scale_parent:new o.aH(b,r.u_scale_parent),u_buffer_scale:new o.aH(b,r.u_buffer_scale),u_fade_t:new o.aH(b,r.u_fade_t),u_opacity:new o.aH(b,r.u_opacity),u_image0:new o.aG(b,r.u_image0),u_image1:new o.aG(b,r.u_image1),u_brightness_low:new o.aH(b,r.u_brightness_low),u_brightness_high:new o.aH(b,r.u_brightness_high),u_saturation_factor:new o.aH(b,r.u_saturation_factor),u_contrast_factor:new o.aH(b,r.u_contrast_factor),u_spin_weights:new o.aK(b,r.u_spin_weights)}),symbolIcon:(b,r)=>({u_is_size_zoom_constant:new o.aG(b,r.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aG(b,r.u_is_size_feature_constant),u_size_t:new o.aH(b,r.u_size_t),u_size:new o.aH(b,r.u_size),u_camera_to_center_distance:new o.aH(b,r.u_camera_to_center_distance),u_pitch:new o.aH(b,r.u_pitch),u_rotate_symbol:new o.aG(b,r.u_rotate_symbol),u_aspect_ratio:new o.aH(b,r.u_aspect_ratio),u_fade_change:new o.aH(b,r.u_fade_change),u_matrix:new o.aI(b,r.u_matrix),u_label_plane_matrix:new o.aI(b,r.u_label_plane_matrix),u_coord_matrix:new o.aI(b,r.u_coord_matrix),u_is_text:new o.aG(b,r.u_is_text),u_pitch_with_map:new o.aG(b,r.u_pitch_with_map),u_texsize:new o.aL(b,r.u_texsize),u_texture:new o.aG(b,r.u_texture)}),symbolSDF:(b,r)=>({u_is_size_zoom_constant:new o.aG(b,r.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aG(b,r.u_is_size_feature_constant),u_size_t:new o.aH(b,r.u_size_t),u_size:new o.aH(b,r.u_size),u_camera_to_center_distance:new o.aH(b,r.u_camera_to_center_distance),u_pitch:new o.aH(b,r.u_pitch),u_rotate_symbol:new o.aG(b,r.u_rotate_symbol),u_aspect_ratio:new o.aH(b,r.u_aspect_ratio),u_fade_change:new o.aH(b,r.u_fade_change),u_matrix:new o.aI(b,r.u_matrix),u_label_plane_matrix:new o.aI(b,r.u_label_plane_matrix),u_coord_matrix:new o.aI(b,r.u_coord_matrix),u_is_text:new o.aG(b,r.u_is_text),u_pitch_with_map:new o.aG(b,r.u_pitch_with_map),u_texsize:new o.aL(b,r.u_texsize),u_texture:new o.aG(b,r.u_texture),u_gamma_scale:new o.aH(b,r.u_gamma_scale),u_device_pixel_ratio:new o.aH(b,r.u_device_pixel_ratio),u_is_halo:new o.aG(b,r.u_is_halo)}),symbolTextAndIcon:(b,r)=>({u_is_size_zoom_constant:new o.aG(b,r.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aG(b,r.u_is_size_feature_constant),u_size_t:new o.aH(b,r.u_size_t),u_size:new o.aH(b,r.u_size),u_camera_to_center_distance:new o.aH(b,r.u_camera_to_center_distance),u_pitch:new o.aH(b,r.u_pitch),u_rotate_symbol:new o.aG(b,r.u_rotate_symbol),u_aspect_ratio:new o.aH(b,r.u_aspect_ratio),u_fade_change:new o.aH(b,r.u_fade_change),u_matrix:new o.aI(b,r.u_matrix),u_label_plane_matrix:new o.aI(b,r.u_label_plane_matrix),u_coord_matrix:new o.aI(b,r.u_coord_matrix),u_is_text:new o.aG(b,r.u_is_text),u_pitch_with_map:new o.aG(b,r.u_pitch_with_map),u_texsize:new o.aL(b,r.u_texsize),u_texsize_icon:new o.aL(b,r.u_texsize_icon),u_texture:new o.aG(b,r.u_texture),u_texture_icon:new o.aG(b,r.u_texture_icon),u_gamma_scale:new o.aH(b,r.u_gamma_scale),u_device_pixel_ratio:new o.aH(b,r.u_device_pixel_ratio),u_is_halo:new o.aG(b,r.u_is_halo)}),background:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_opacity:new o.aH(b,r.u_opacity),u_color:new o.aM(b,r.u_color)}),backgroundPattern:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_opacity:new o.aH(b,r.u_opacity),u_image:new o.aG(b,r.u_image),u_pattern_tl_a:new o.aL(b,r.u_pattern_tl_a),u_pattern_br_a:new o.aL(b,r.u_pattern_br_a),u_pattern_tl_b:new o.aL(b,r.u_pattern_tl_b),u_pattern_br_b:new o.aL(b,r.u_pattern_br_b),u_texsize:new o.aL(b,r.u_texsize),u_mix:new o.aH(b,r.u_mix),u_pattern_size_a:new o.aL(b,r.u_pattern_size_a),u_pattern_size_b:new o.aL(b,r.u_pattern_size_b),u_scale_a:new o.aH(b,r.u_scale_a),u_scale_b:new o.aH(b,r.u_scale_b),u_pixel_coord_upper:new o.aL(b,r.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(b,r.u_pixel_coord_lower),u_tile_units_to_pixels:new o.aH(b,r.u_tile_units_to_pixels)}),terrain:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_texture:new o.aG(b,r.u_texture),u_ele_delta:new o.aH(b,r.u_ele_delta)}),terrainDepth:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_ele_delta:new o.aH(b,r.u_ele_delta)}),terrainCoords:(b,r)=>({u_matrix:new o.aI(b,r.u_matrix),u_texture:new o.aG(b,r.u_texture),u_terrain_coords_id:new o.aH(b,r.u_terrain_coords_id),u_ele_delta:new o.aH(b,r.u_ele_delta)})};class Cr{constructor(r,d,m){this.context=r;const g=r.gl;this.buffer=g.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const d=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ha={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Xa{constructor(r,d,m,g){this.length=d.length,this.attributes=m,this.itemSize=d.bytesPerElement,this.dynamicDraw=g,this.context=r;const x=r.gl;this.buffer=x.createBuffer(),r.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){if(r.length!==this.length)throw new Error(`Length of new data is ${r.length}, which doesn't match current length of ${this.length}`);const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,d){for(let m=0;m<this.attributes.length;m++){const g=d.attributes[this.attributes[m].name];g!==void 0&&r.enableVertexAttribArray(g)}}setVertexAttribPointers(r,d,m){for(let g=0;g<this.attributes.length;g++){const x=this.attributes[g],T=d.attributes[x.name];T!==void 0&&r.vertexAttribPointer(T,x.components,r[Ha[x.type]],!1,this.itemSize,x.offset+this.itemSize*(m||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ca=new WeakMap;function ws(b){var r;if(ca.has(b))return ca.get(b);{const d=(r=b.getParameter(b.VERSION))===null||r===void 0?void 0:r.startsWith("WebGL 2.0");return ca.set(b,d),d}}class dn{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class yl extends dn{getDefault(){return o.aO.transparent}set(r){const d=this.current;(r.r!==d.r||r.g!==d.g||r.b!==d.b||r.a!==d.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class lc extends dn{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class cc extends dn{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class bl extends dn{getDefault(){return[!0,!0,!0,!0]}set(r){const d=this.current;(r[0]!==d[0]||r[1]!==d[1]||r[2]!==d[2]||r[3]!==d[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class uc extends dn{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class hc extends dn{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class vl extends dn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const d=this.current;(r.func!==d.func||r.ref!==d.ref||r.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class Yu extends dn{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const d=this.current;(r[0]!==d[0]||r[1]!==d[1]||r[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class Ju extends dn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const d=this.gl;r?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=r,this.dirty=!1}}class oo extends dn{getDefault(){return[0,1]}set(r){const d=this.current;(r[0]!==d[0]||r[1]!==d[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class sf extends dn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const d=this.gl;r?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=r,this.dirty=!1}}class of extends dn{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class lf extends dn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const d=this.gl;r?d.enable(d.BLEND):d.disable(d.BLEND),this.current=r,this.dirty=!1}}class cf extends dn{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const d=this.current;(r[0]!==d[0]||r[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class uf extends dn{getDefault(){return o.aO.transparent}set(r){const d=this.current;(r.r!==d.r||r.g!==d.g||r.b!==d.b||r.a!==d.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class hf extends dn{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class dc extends dn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const d=this.gl;r?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=r,this.dirty=!1}}class xl extends dn{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class fc extends dn{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class pc extends dn{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class lo extends dn{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class Xu extends dn{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const d=this.current;(r[0]!==d[0]||r[1]!==d[1]||r[2]!==d[2]||r[3]!==d[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Qu extends dn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class mc extends dn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Os extends dn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class eh extends dn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class co extends dn{getDefault(){return null}set(r){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class uo extends dn{getDefault(){return null}set(r){var d;if(r===this.current&&!this.dirty)return;const m=this.gl;ws(m)?m.bindVertexArray(r):(d=m.getExtension("OES_vertex_array_object"))===null||d===void 0||d.bindVertexArrayOES(r),this.current=r,this.dirty=!1}}class th extends dn{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class gc extends dn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class fn extends dn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class ho extends dn{constructor(r,d){super(r),this.context=r,this.parent=d}getDefault(){return null}}class df extends ho{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class ih extends ho{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Uo extends ho{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class ff{constructor(r,d,m,g,x){this.context=r,this.width=d,this.height=m;const T=r.gl,C=this.framebuffer=T.createFramebuffer();if(this.colorAttachment=new df(r,C),g)this.depthAttachment=x?new Uo(r,C):new ih(r,C);else if(x)throw new Error("Stencil cannot be set without depth");if(T.checkFramebufferStatus(T.FRAMEBUFFER)!==T.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const r=this.context.gl,d=this.colorAttachment.get();if(d&&r.deleteTexture(d),this.depthAttachment){const m=this.depthAttachment.get();m&&r.deleteRenderbuffer(m)}r.deleteFramebuffer(this.framebuffer)}}class ua{constructor(r,d,m){this.blendFunction=r,this.blendColor=d,this.mask=m}}ua.Replace=[1,0],ua.disabled=new ua(ua.Replace,o.aO.transparent,[!1,!1,!1,!1]),ua.unblended=new ua(ua.Replace,o.aO.transparent,[!0,!0,!0,!0]),ua.alphaBlended=new ua([1,771],o.aO.transparent,[!0,!0,!0,!0]);class nh{constructor(r){var d,m;if(this.gl=r,this.clearColor=new yl(this),this.clearDepth=new lc(this),this.clearStencil=new cc(this),this.colorMask=new bl(this),this.depthMask=new uc(this),this.stencilMask=new hc(this),this.stencilFunc=new vl(this),this.stencilOp=new Yu(this),this.stencilTest=new Ju(this),this.depthRange=new oo(this),this.depthTest=new sf(this),this.depthFunc=new of(this),this.blend=new lf(this),this.blendFunc=new cf(this),this.blendColor=new uf(this),this.blendEquation=new hf(this),this.cullFace=new dc(this),this.cullFaceSide=new xl(this),this.frontFace=new fc(this),this.program=new pc(this),this.activeTexture=new lo(this),this.viewport=new Xu(this),this.bindFramebuffer=new Qu(this),this.bindRenderbuffer=new mc(this),this.bindTexture=new Os(this),this.bindVertexBuffer=new eh(this),this.bindElementBuffer=new co(this),this.bindVertexArray=new uo(this),this.pixelStoreUnpack=new th(this),this.pixelStoreUnpackPremultiplyAlpha=new gc(this),this.pixelStoreUnpackFlipY=new fn(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),ws(r)){this.HALF_FLOAT=r.HALF_FLOAT;const g=r.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(d=r.RGBA16F)!==null&&d!==void 0?d:g==null?void 0:g.RGBA16F_EXT,this.RGB16F=(m=r.RGB16F)!==null&&m!==void 0?m:g==null?void 0:g.RGB16F_EXT,r.getExtension("EXT_color_buffer_float")}else{r.getExtension("EXT_color_buffer_half_float"),r.getExtension("OES_texture_half_float_linear");const g=r.getExtension("OES_texture_half_float");this.HALF_FLOAT=g==null?void 0:g.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,d){return new Cr(this,r,d)}createVertexBuffer(r,d,m){return new Xa(this,r,d,m)}createRenderbuffer(r,d,m){const g=this.gl,x=g.createRenderbuffer();return this.bindRenderbuffer.set(x),g.renderbufferStorage(g.RENDERBUFFER,r,d,m),this.bindRenderbuffer.set(null),x}createFramebuffer(r,d,m,g){return new ff(this,r,d,m,g)}clear({color:r,depth:d,stencil:m}){const g=this.gl;let x=0;r&&(x|=g.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),d!==void 0&&(x|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),m!==void 0&&(x|=g.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),g.clear(x)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){o.aD(r.blendFunction,ua.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}createVertexArray(){var r;return ws(this.gl)?this.gl.createVertexArray():(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.createVertexArrayOES()}deleteVertexArray(r){var d;return ws(this.gl)?this.gl.deleteVertexArray(r):(d=this.gl.getExtension("OES_vertex_array_object"))===null||d===void 0?void 0:d.deleteVertexArrayOES(r)}unbindVAO(){this.bindVertexArray.set(null)}}class ln{constructor(r,d,m){this.func=r,this.mask=d,this.range=m}}ln.ReadOnly=!1,ln.ReadWrite=!0,ln.disabled=new ln(519,ln.ReadOnly,[0,1]);const Wo=7680;class En{constructor(r,d,m,g,x,T){this.test=r,this.ref=d,this.mask=m,this.fail=g,this.depthFail=x,this.pass=T}}En.disabled=new En({func:519,mask:0},0,0,Wo,Wo,Wo);class Cn{constructor(r,d,m){this.enable=r,this.mode=d,this.frontFace=m}}let fo;function wl(b,r,d,m,g,x,T){const C=b.context,A=C.gl,F=b.useProgram("collisionBox"),j=[];let Z=0,ie=0;for(let ye=0;ye<m.length;ye++){const Ne=m[ye],qe=r.getTile(Ne),Ze=qe.getBucket(d);if(!Ze)continue;let Je=Ne.posMatrix;g[0]===0&&g[1]===0||(Je=b.translatePosMatrix(Ne.posMatrix,qe,g,x));const pt=T?Ze.textCollisionBox:Ze.iconCollisionBox,ut=Ze.collisionCircleArray;if(ut.length>0){const dt=o.F(),Gt=Je;o.aP(dt,Ze.placementInvProjMatrix,b.transform.glCoordMatrix),o.aP(dt,dt,Ze.placementViewportMatrix),j.push({circleArray:ut,circleOffset:ie,transform:Gt,invTransform:dt,coord:Ne}),Z+=ut.length/4,ie=Z}pt&&F.draw(C,A.LINES,ln.disabled,En.disabled,b.colorModeForRenderPass(),Cn.disabled,ii(Je,b.transform,qe),b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ne),d.id,pt.layoutVertexBuffer,pt.indexBuffer,pt.segments,null,b.transform.zoom,null,null,pt.collisionVertexBuffer)}if(!T||!j.length)return;const pe=b.useProgram("collisionCircle"),fe=new o.aQ;fe.resize(4*Z),fe._trim();let ge=0;for(const ye of j)for(let Ne=0;Ne<ye.circleArray.length/4;Ne++){const qe=4*Ne,Ze=ye.circleArray[qe+0],Je=ye.circleArray[qe+1],pt=ye.circleArray[qe+2],ut=ye.circleArray[qe+3];fe.emplace(ge++,Ze,Je,pt,ut,0),fe.emplace(ge++,Ze,Je,pt,ut,1),fe.emplace(ge++,Ze,Je,pt,ut,2),fe.emplace(ge++,Ze,Je,pt,ut,3)}(!fo||fo.length<2*Z)&&(fo=function(ye){const Ne=2*ye,qe=new o.aS;qe.resize(Ne),qe._trim();for(let Ze=0;Ze<Ne;Ze++){const Je=6*Ze;qe.uint16[Je+0]=4*Ze+0,qe.uint16[Je+1]=4*Ze+1,qe.uint16[Je+2]=4*Ze+2,qe.uint16[Je+3]=4*Ze+2,qe.uint16[Je+4]=4*Ze+3,qe.uint16[Je+5]=4*Ze+0}return qe}(Z));const le=C.createIndexBuffer(fo,!0),Le=C.createVertexBuffer(fe,o.aR.members,!0);for(const ye of j){const Ne={u_matrix:ye.transform,u_inv_matrix:ye.invTransform,u_camera_to_center_distance:(We=b.transform).cameraToCenterDistance,u_viewport_size:[We.width,We.height]};pe.draw(C,A.TRIANGLES,ln.disabled,En.disabled,b.colorModeForRenderPass(),Cn.disabled,Ne,b.style.map.terrain&&b.style.map.terrain.getTerrainData(ye.coord),d.id,Le,le,o.$.simpleSegment(0,2*ye.circleOffset,ye.circleArray.length,ye.circleArray.length/2),null,b.transform.zoom,null,null,null)}var We;Le.destroy(),le.destroy()}Cn.disabled=new Cn(!1,1029,2305),Cn.backCCW=new Cn(!0,1029,2305);const ah=o.an(new Float32Array(16));function kl(b,r,d,m,g,x){const{horizontalAlign:T,verticalAlign:C}=o.at(b);return new o.P((-(T-.5)*r/g+m[0])*x,(-(C-.5)*d/g+m[1])*x)}function Sl(b,r,d,m,g,x,T,C,A,F,j){const Z=b.text.placedSymbolArray,ie=b.text.dynamicLayoutVertexArray,pe=b.icon.dynamicLayoutVertexArray,fe={};ie.clear();for(let ge=0;ge<Z.length;ge++){const le=Z.get(ge),Le=le.hidden||!le.crossTileID||b.allowVerticalPlacement&&!le.placedOrientation?null:m[le.crossTileID];if(Le){const We=new o.P(le.anchorX,le.anchorY),ye=re(We,d?T:x,j),Ne=U(g.cameraToCenterDistance,ye.signedDistanceFromCamera);let qe=o.ai(b.textSizeData,A,le)*Ne/o.ao;d&&(qe*=b.tilePixelRatio/C);const{width:Ze,height:Je,anchor:pt,textOffset:ut,textBoxScale:dt}=Le,Gt=kl(pt,Ze,Je,ut,dt,qe),Ri=d?re(We.add(Gt),x,j).point:ye.point.add(r?Gt.rotate(-g.angle):Gt),Pt=b.allowVerticalPlacement&&le.placedOrientation===o.ah.vertical?Math.PI/2:0;for(let wi=0;wi<le.numGlyphs;wi++)o.aj(ie,Ri,Pt);F&&le.associatedIconIndex>=0&&(fe[le.associatedIconIndex]={shiftedAnchor:Ri,angle:Pt})}else ae(le.numGlyphs,ie)}if(F){pe.clear();const ge=b.icon.placedSymbolArray;for(let le=0;le<ge.length;le++){const Le=ge.get(le);if(Le.hidden)ae(Le.numGlyphs,pe);else{const We=fe[le];if(We)for(let ye=0;ye<Le.numGlyphs;ye++)o.aj(pe,We.shiftedAnchor,We.angle);else ae(Le.numGlyphs,pe)}}b.icon.dynamicLayoutVertexBuffer.updateData(pe)}b.text.dynamicLayoutVertexBuffer.updateData(ie)}function _c(b,r,d){return d.iconsInText&&r?"symbolTextAndIcon":b?"symbolSDF":"symbolIcon"}function rh(b,r,d,m,g,x,T,C,A,F,j,Z){const ie=b.context,pe=ie.gl,fe=b.transform,ge=C==="map",le=A==="map",Le=C!=="viewport"&&d.layout.get("symbol-placement")!=="point",We=ge&&!le&&!Le,ye=!d.layout.get("symbol-sort-key").isConstant();let Ne=!1;const qe=b.depthModeForSublayer(0,ln.ReadOnly),Ze=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Je=[];for(const pt of m){const ut=r.getTile(pt),dt=ut.getBucket(d);if(!dt)continue;const Gt=g?dt.text:dt.icon;if(!Gt||!Gt.segments.get().length||!Gt.hasVisibleVertices)continue;const Ri=Gt.programConfigurations.get(d.id),Pt=g||dt.sdfIcons,wi=g?dt.textSizeData:dt.iconSizeData,Bi=le||fe.pitch!==0,an=b.useProgram(_c(Pt,g,dt),Ri),Di=o.ag(wi,fe.zoom),Vi=b.style.map.terrain&&b.style.map.terrain.getTerrainData(pt);let Hi,Yn,Pn,lr,ga=[0,0],Ln=null;if(g)Yn=ut.glyphAtlasTexture,Pn=pe.LINEAR,Hi=ut.glyphAtlasTexture.size,dt.iconsInText&&(ga=ut.imageAtlasTexture.size,Ln=ut.imageAtlasTexture,lr=Bi||b.options.rotating||b.options.zooming||wi.kind==="composite"||wi.kind==="camera"?pe.LINEAR:pe.NEAREST);else{const qn=d.layout.get("icon-size").constantOr(0)!==1||dt.iconsNeedLinear;Yn=ut.imageAtlasTexture,Pn=Pt||b.options.rotating||b.options.zooming||qn||Bi?pe.LINEAR:pe.NEAREST,Hi=ut.imageAtlasTexture.size}const Za=Ge(ut,1,b.transform.zoom),Br=Ei(pt.posMatrix,le,ge,b.transform,Za),es=ji(pt.posMatrix,le,ge,b.transform,Za),Us=Ze&&dt.hasTextData(),Ws=d.layout.get("icon-text-fit")!=="none"&&Us&&dt.hasIconData();if(Le){const qn=b.style.map.terrain?(kr,Xi)=>b.style.map.terrain.getElevation(pt,kr,Xi):null,La=d.layout.get("text-rotation-alignment")==="map";te(dt,pt.posMatrix,b,g,Br,es,le,F,La,qn)}const ts=b.translatePosMatrix(pt.posMatrix,ut,x,T),Nr=Le||g&&Ze||Ws?ah:Br,ea=b.translatePosMatrix(es,ut,x,T,!0),On=Pt&&d.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ra;ra=Pt?dt.iconsInText?nn(wi.kind,Di,We,le,b,ts,Nr,ea,Hi,ga):Ui(wi.kind,Di,We,le,b,ts,Nr,ea,g,Hi,!0):zi(wi.kind,Di,We,le,b,ts,Nr,ea,g,Hi);const So={program:an,buffers:Gt,uniformValues:ra,atlasTexture:Yn,atlasTextureIcon:Ln,atlasInterpolation:Pn,atlasInterpolationIcon:lr,isSDF:Pt,hasHalo:On};if(ye&&dt.canOverlap){Ne=!0;const qn=Gt.segments.get();for(const La of qn)Je.push({segments:new o.$([La]),sortKey:La.sortKey,state:So,terrainData:Vi})}else Je.push({segments:Gt.segments,sortKey:0,state:So,terrainData:Vi})}Ne&&Je.sort((pt,ut)=>pt.sortKey-ut.sortKey);for(const pt of Je){const ut=pt.state;if(ie.activeTexture.set(pe.TEXTURE0),ut.atlasTexture.bind(ut.atlasInterpolation,pe.CLAMP_TO_EDGE),ut.atlasTextureIcon&&(ie.activeTexture.set(pe.TEXTURE1),ut.atlasTextureIcon&&ut.atlasTextureIcon.bind(ut.atlasInterpolationIcon,pe.CLAMP_TO_EDGE)),ut.isSDF){const dt=ut.uniformValues;ut.hasHalo&&(dt.u_is_halo=1,Ml(ut.buffers,pt.segments,d,b,ut.program,qe,j,Z,dt,pt.terrainData)),dt.u_is_halo=0}Ml(ut.buffers,pt.segments,d,b,ut.program,qe,j,Z,ut.uniformValues,pt.terrainData)}}function Ml(b,r,d,m,g,x,T,C,A,F){const j=m.context;g.draw(j,j.gl.TRIANGLES,x,T,C,Cn.disabled,A,F,d.id,b.layoutVertexBuffer,b.indexBuffer,r,d.paint,m.transform.zoom,b.programConfigurations.get(d.id),b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer)}function sh(b,r,d,m,g){if(!d||!m||!m.imageAtlas)return;const x=m.imageAtlas.patternPositions;let T=x[d.to.toString()],C=x[d.from.toString()];if(!T&&C&&(T=C),!C&&T&&(C=T),!T||!C){const A=g.getPaintProperty(r);T=x[A],C=x[A]}T&&C&&b.setConstantPatternPositions(T,C)}function yc(b,r,d,m,g,x,T){const C=b.context.gl,A="fill-pattern",F=d.paint.get(A),j=F&&F.constantOr(1),Z=d.getCrossfadeParameters();let ie,pe,fe,ge,le;T?(pe=j&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ie=C.LINES):(pe=j?"fillPattern":"fill",ie=C.TRIANGLES);const Le=F.constantOr(null);for(const We of m){const ye=r.getTile(We);if(j&&!ye.patternsLoaded())continue;const Ne=ye.getBucket(d);if(!Ne)continue;const qe=Ne.programConfigurations.get(d.id),Ze=b.useProgram(pe,qe),Je=b.style.map.terrain&&b.style.map.terrain.getTerrainData(We);j&&(b.context.activeTexture.set(C.TEXTURE0),ye.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),qe.updatePaintBuffers(Z)),sh(qe,A,Le,ye,d);const pt=Je?We:null,ut=b.translatePosMatrix(pt?pt.posMatrix:We.posMatrix,ye,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(T){ge=Ne.indexBuffer2,le=Ne.segments2;const dt=[C.drawingBufferWidth,C.drawingBufferHeight];fe=pe==="fillOutlinePattern"&&j?Zt(ut,b,Z,ye,dt):vt(ut,dt)}else ge=Ne.indexBuffer,le=Ne.segments,fe=j?Rt(ut,b,Z,ye):bt(ut);Ze.draw(b.context,ie,g,b.stencilModeForClipping(We),x,Cn.disabled,fe,Je,d.id,Ne.layoutVertexBuffer,ge,le,d.paint,b.transform.zoom,qe)}}function po(b,r,d,m,g,x,T){const C=b.context,A=C.gl,F="fill-extrusion-pattern",j=d.paint.get(F),Z=j.constantOr(1),ie=d.getCrossfadeParameters(),pe=d.paint.get("fill-extrusion-opacity"),fe=j.constantOr(null);for(const ge of m){const le=r.getTile(ge),Le=le.getBucket(d);if(!Le)continue;const We=b.style.map.terrain&&b.style.map.terrain.getTerrainData(ge),ye=Le.programConfigurations.get(d.id),Ne=b.useProgram(Z?"fillExtrusionPattern":"fillExtrusion",ye);Z&&(b.context.activeTexture.set(A.TEXTURE0),le.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),ye.updatePaintBuffers(ie)),sh(ye,F,fe,le,d);const qe=b.translatePosMatrix(ge.posMatrix,le,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Ze=d.paint.get("fill-extrusion-vertical-gradient"),Je=Z?st(qe,b,Ze,pe,ge,ie,le):xe(qe,b,Ze,pe);Ne.draw(C,C.gl.TRIANGLES,g,x,T,Cn.backCCW,Je,We,d.id,Le.layoutVertexBuffer,Le.indexBuffer,Le.segments,d.paint,b.transform.zoom,ye,b.style.map.terrain&&Le.centroidVertexBuffer)}}function bc(b,r,d,m,g,x,T){const C=b.context,A=C.gl,F=d.fbo;if(!F)return;const j=b.useProgram("hillshade"),Z=b.style.map.terrain&&b.style.map.terrain.getTerrainData(r);C.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,F.colorAttachment.get()),j.draw(C,A.TRIANGLES,g,x,T,Cn.disabled,((ie,pe,fe,ge)=>{const le=fe.paint.get("hillshade-shadow-color"),Le=fe.paint.get("hillshade-highlight-color"),We=fe.paint.get("hillshade-accent-color");let ye=fe.paint.get("hillshade-illumination-direction")*(Math.PI/180);fe.paint.get("hillshade-illumination-anchor")==="viewport"&&(ye-=ie.transform.angle);const Ne=!ie.options.moving;return{u_matrix:ge?ge.posMatrix:ie.transform.calculatePosMatrix(pe.tileID.toUnwrapped(),Ne),u_image:0,u_latrange:ui(0,pe.tileID),u_light:[fe.paint.get("hillshade-exaggeration"),ye],u_shadow:le,u_highlight:Le,u_accent:We}})(b,d,m,Z?r:null),Z,m.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments)}function oh(b,r,d,m,g,x){const T=b.context,C=T.gl,A=r.dem;if(A&&A.data){const F=A.dim,j=A.stride,Z=A.getPixels();if(T.activeTexture.set(C.TEXTURE1),T.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||b.getTileTexture(j),r.demTexture){const pe=r.demTexture;pe.update(Z,{premultiply:!1}),pe.bind(C.NEAREST,C.CLAMP_TO_EDGE)}else r.demTexture=new Ye(T,Z,C.RGBA,{premultiply:!1}),r.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE);T.activeTexture.set(C.TEXTURE0);let ie=r.fbo;if(!ie){const pe=new Ye(T,{width:F,height:F,data:null},C.RGBA);pe.bind(C.LINEAR,C.CLAMP_TO_EDGE),ie=r.fbo=T.createFramebuffer(F,F,!0,!1),ie.colorAttachment.set(pe.texture)}T.bindFramebuffer.set(ie.framebuffer),T.viewport.set([0,0,F,F]),b.useProgram("hillshadePrepare").draw(T,C.TRIANGLES,m,g,x,Cn.disabled,((pe,fe)=>{const ge=fe.stride,le=o.F();return o.aN(le,0,o.W,-o.W,0,0,1),o.H(le,le,[0,-o.W,0]),{u_matrix:le,u_image:1,u_dimension:[ge,ge],u_zoom:pe.overscaledZ,u_unpack:fe.getUnpackVector()}})(r.tileID,A),null,d.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments),r.needsHillshadePrepare=!1}}function lh(b,r,d,m,g,x){const T=m.paint.get("raster-fade-duration");if(!x&&T>0){const C=M.now(),A=(C-b.timeAdded)/T,F=r?(C-r.timeAdded)/T:-1,j=d.getSource(),Z=g.coveringZoomLevel({tileSize:j.tileSize,roundZoom:j.roundZoom}),ie=!r||Math.abs(r.tileID.overscaledZ-Z)>Math.abs(b.tileID.overscaledZ-Z),pe=ie&&b.refreshedUponExpiration?1:o.ac(ie?A:1-F,0,1);return b.refreshedUponExpiration&&A>=1&&(b.refreshedUponExpiration=!1),r?{opacity:1,mix:1-pe}:{opacity:pe,mix:0}}return{opacity:1,mix:0}}const Dl=new o.aO(1,0,0,1),vc=new o.aO(0,1,0,1),pf=new o.aO(0,0,1,1),ch=new o.aO(1,0,1,1),aa=new o.aO(0,1,1,1);function ks(b,r,d,m){mo(b,0,r+d/2,b.transform.width,d,m)}function wr(b,r,d,m){mo(b,r-d/2,0,d,b.transform.height,m)}function mo(b,r,d,m,g,x){const T=b.context,C=T.gl;C.enable(C.SCISSOR_TEST),C.scissor(r*b.pixelRatio,d*b.pixelRatio,m*b.pixelRatio,g*b.pixelRatio),T.clear({color:x}),C.disable(C.SCISSOR_TEST)}function xc(b,r,d){const m=b.context,g=m.gl,x=d.posMatrix,T=b.useProgram("debug"),C=ln.disabled,A=En.disabled,F=b.colorModeForRenderPass(),j="$debug",Z=b.style.map.terrain&&b.style.map.terrain.getTerrainData(d);m.activeTexture.set(g.TEXTURE0);const ie=r.getTileByID(d.key).latestRawTileData,pe=Math.floor((ie&&ie.byteLength||0)/1024),fe=r.getTile(d).tileSize,ge=512/Math.min(fe,512)*(d.overscaledZ/b.transform.zoom)*.5;let le=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(le+=` => ${d.overscaledZ}`),function(Le,We){Le.initDebugOverlayCanvas();const ye=Le.debugOverlayCanvas,Ne=Le.context.gl,qe=Le.debugOverlayCanvas.getContext("2d");qe.clearRect(0,0,ye.width,ye.height),qe.shadowColor="white",qe.shadowBlur=2,qe.lineWidth=1.5,qe.strokeStyle="white",qe.textBaseline="top",qe.font="bold 36px Open Sans, sans-serif",qe.fillText(We,5,5),qe.strokeText(We,5,5),Le.debugOverlayTexture.update(ye),Le.debugOverlayTexture.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE)}(b,`${le} ${pe}kB`),T.draw(m,g.TRIANGLES,C,A,ua.alphaBlended,Cn.disabled,Mt(x,o.aO.transparent,ge),null,j,b.debugBuffer,b.quadTriangleIndexBuffer,b.debugSegments),T.draw(m,g.LINE_STRIP,C,A,F,Cn.disabled,Mt(x,o.aO.red),Z,j,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments)}function wc(b,r,d){const m=b.context,g=m.gl,x=b.colorModeForRenderPass(),T=new ln(g.LEQUAL,ln.ReadWrite,b.depthRangeFor3D),C=b.useProgram("terrain"),A=r.getTerrainMesh();m.bindFramebuffer.set(null),m.viewport.set([0,0,b.width,b.height]);for(const F of d){const j=b.renderToTexture.getTexture(F),Z=r.getTerrainData(F.tileID);m.activeTexture.set(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,j.texture);const ie={u_matrix:b.transform.calculatePosMatrix(F.tileID.toUnwrapped()),u_texture:0,u_ele_delta:r.getMeshFrameDelta(b.transform.zoom)};C.draw(m,g.TRIANGLES,T,En.disabled,x,Cn.backCCW,ie,Z,"terrain",A.vertexBuffer,A.indexBuffer,A.segments)}}class go{constructor(r,d){this.context=new nh(r),this.transform=d,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=lt.maxUnderzooming+lt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Rn}resize(r,d,m){if(this.width=Math.floor(r*m),this.height=Math.floor(d*m),this.pixelRatio=m,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style._order)this.style._layers[g].resize()}setup(){const r=this.context,d=new o.aV;d.emplaceBack(0,0),d.emplaceBack(o.W,0),d.emplaceBack(0,o.W),d.emplaceBack(o.W,o.W),this.tileExtentBuffer=r.createVertexBuffer(d,wa.members),this.tileExtentSegments=o.$.simpleSegment(0,0,4,2);const m=new o.aV;m.emplaceBack(0,0),m.emplaceBack(o.W,0),m.emplaceBack(0,o.W),m.emplaceBack(o.W,o.W),this.debugBuffer=r.createVertexBuffer(m,wa.members),this.debugSegments=o.$.simpleSegment(0,0,4,5);const g=new o.Z;g.emplaceBack(0,0,0,0),g.emplaceBack(o.W,0,o.W,0),g.emplaceBack(0,o.W,0,o.W),g.emplaceBack(o.W,o.W,o.W,o.W),this.rasterBoundsBuffer=r.createVertexBuffer(g,tn.members),this.rasterBoundsSegments=o.$.simpleSegment(0,0,4,2);const x=new o.aV;x.emplaceBack(0,0),x.emplaceBack(1,0),x.emplaceBack(0,1),x.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(x,wa.members),this.viewportSegments=o.$.simpleSegment(0,0,4,2);const T=new o.aW;T.emplaceBack(0),T.emplaceBack(1),T.emplaceBack(3),T.emplaceBack(2),T.emplaceBack(0),this.tileBorderIndexBuffer=r.createIndexBuffer(T);const C=new o.aX;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(C);const A=this.context.gl;this.stencilClearMode=new En({func:A.ALWAYS,mask:0},0,255,A.ZERO,A.ZERO,A.ZERO)}clearStencil(){const r=this.context,d=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const m=o.F();o.aN(m,0,this.width,this.height,0,0,1),o.J(m,m,[d.drawingBufferWidth,d.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(r,d.TRIANGLES,ln.disabled,this.stencilClearMode,ua.disabled,Cn.disabled,ct(m),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(r,d){if(this.currentStencilSource===r.source||!r.isTileClipped()||!d||!d.length)return;this.currentStencilSource=r.source;const m=this.context,g=m.gl;this.nextStencilID+d.length>256&&this.clearStencil(),m.setColorMode(ua.disabled),m.setDepthMode(ln.disabled);const x=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const T of d){const C=this._tileClippingMaskIDs[T.key]=this.nextStencilID++,A=this.style.map.terrain&&this.style.map.terrain.getTerrainData(T);x.draw(m,g.TRIANGLES,ln.disabled,new En({func:g.ALWAYS,mask:0},C,255,g.KEEP,g.KEEP,g.REPLACE),ua.disabled,Cn.disabled,ct(T.posMatrix),A,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,d=this.context.gl;return new En({func:d.NOTEQUAL,mask:255},r,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(r){const d=this.context.gl;return new En({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(r){const d=this.context.gl,m=r.sort((T,C)=>C.overscaledZ-T.overscaledZ),g=m[m.length-1].overscaledZ,x=m[0].overscaledZ-g+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const T={};for(let C=0;C<x;C++)T[C+g]=new En({func:d.GEQUAL,mask:255},C+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=x,[T,m]}return[{[g]:En.disabled},m]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new ua([r.CONSTANT_COLOR,r.ONE],new o.aO(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ua.unblended:ua.alphaBlended}depthModeForSublayer(r,d,m){if(!this.opaquePassEnabledForLayer())return ln.disabled;const g=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new ln(m||this.context.gl.LEQUAL,d,[g,g])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,d){this.style=r,this.options=d,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(M.now()),this.imageManager.beginFrame();const m=this.style._order,g=this.style.sourceCaches,x={},T={},C={};for(const A in g){const F=g[A];F.used&&F.prepare(this.context),x[A]=F.getVisibleCoordinates(),T[A]=x[A].slice().reverse(),C[A]=F.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let A=0;A<m.length;A++)if(this.style._layers[m[A]].is3D()){this.opaquePassCutoff=A;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const A of m){const F=this.style._layers[A];if(!F.hasOffscreenPass()||F.isHidden(this.transform.zoom))continue;const j=T[F.source];(F.type==="custom"||j.length)&&this.renderLayer(this,g[F.source],F,j)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:d.showOverdrawInspector?o.aO.black:o.aO.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.depthRangeFor3D=[0,1-(r._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const A=this.style._layers[m[this.currentLayer]],F=g[A.source],j=x[A.source];this._renderTileClippingMasks(A,j),this.renderLayer(this,F,A,j)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const A=this.style._layers[m[this.currentLayer]],F=g[A.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(A))continue;const j=(A.type==="symbol"?C:T)[A.source];this._renderTileClippingMasks(A,x[A.source]),this.renderLayer(this,F,A,j)}if(this.options.showTileBoundaries){const A=function(F,j){let Z=null;const ie=Object.values(F._layers).flatMap(le=>le.source&&!le.isHidden(j)?[F.sourceCaches[le.source]]:[]),pe=ie.filter(le=>le.getSource().type==="vector"),fe=ie.filter(le=>le.getSource().type!=="vector"),ge=le=>{(!Z||Z.getSource().maxzoom<le.getSource().maxzoom)&&(Z=le)};return pe.forEach(le=>ge(le)),Z||fe.forEach(le=>ge(le)),Z}(this.style,this.transform.zoom);A&&function(F,j,Z){for(let ie=0;ie<Z.length;ie++)xc(F,j,Z[ie])}(this,A,A.getVisibleCoordinates())}this.options.showPadding&&function(A){const F=A.transform.padding;ks(A,A.transform.height-(F.top||0),3,Dl),ks(A,F.bottom||0,3,vc),wr(A,F.left||0,3,pf),wr(A,A.transform.width-(F.right||0),3,ch);const j=A.transform.centerPoint;(function(Z,ie,pe,fe){mo(Z,ie-1,pe-10,2,20,fe),mo(Z,ie-10,pe-1,20,2,fe)})(A,j.x,A.transform.height-j.y,aa)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(r){if(!this.style||!this.style.map||!this.style.map.terrain)return;const d=this.terrainFacilitator.matrix,m=this.transform.projMatrix;let g=this.terrainFacilitator.dirty;g||(g=r?!o.aY(d,m):!o.aZ(d,m)),g||(g=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),g&&(o.a_(d,m),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(x,T){const C=x.context,A=C.gl,F=ua.unblended,j=new ln(A.LEQUAL,ln.ReadWrite,[0,1]),Z=T.getTerrainMesh(),ie=T.sourceCache.getRenderableTiles(),pe=x.useProgram("terrainDepth");C.bindFramebuffer.set(T.getFramebuffer("depth").framebuffer),C.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),C.clear({color:o.aO.transparent,depth:1});for(const fe of ie){const ge=T.getTerrainData(fe.tileID),le={u_matrix:x.transform.calculatePosMatrix(fe.tileID.toUnwrapped()),u_ele_delta:T.getMeshFrameDelta(x.transform.zoom)};pe.draw(C,A.TRIANGLES,j,En.disabled,F,Cn.backCCW,le,ge,"terrain",Z.vertexBuffer,Z.indexBuffer,Z.segments)}C.bindFramebuffer.set(null),C.viewport.set([0,0,x.width,x.height])}(this,this.style.map.terrain),function(x,T){const C=x.context,A=C.gl,F=ua.unblended,j=new ln(A.LEQUAL,ln.ReadWrite,[0,1]),Z=T.getTerrainMesh(),ie=T.getCoordsTexture(),pe=T.sourceCache.getRenderableTiles(),fe=x.useProgram("terrainCoords");C.bindFramebuffer.set(T.getFramebuffer("coords").framebuffer),C.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),C.clear({color:o.aO.transparent,depth:1}),T.coordsIndex=[];for(const ge of pe){const le=T.getTerrainData(ge.tileID);C.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,ie.texture);const Le={u_matrix:x.transform.calculatePosMatrix(ge.tileID.toUnwrapped()),u_terrain_coords_id:(255-T.coordsIndex.length)/255,u_texture:0,u_ele_delta:T.getMeshFrameDelta(x.transform.zoom)};fe.draw(C,A.TRIANGLES,j,En.disabled,F,Cn.backCCW,Le,le,"terrain",Z.vertexBuffer,Z.indexBuffer,Z.segments),T.coordsIndex.push(ge.tileID.key)}C.bindFramebuffer.set(null),C.viewport.set([0,0,x.width,x.height])}(this,this.style.map.terrain))}renderLayer(r,d,m,g){if(!m.isHidden(this.transform.zoom)&&(m.type==="background"||m.type==="custom"||(g||[]).length))switch(this.id=m.id,m.type){case"symbol":(function(x,T,C,A,F){if(x.renderPass!=="translucent")return;const j=En.disabled,Z=x.colorModeForRenderPass();(C._unevaluatedLayout.hasValue("text-variable-anchor")||C._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ie,pe,fe,ge,le,Le,We){const ye=pe.transform,Ne=le==="map",qe=Le==="map";for(const Ze of ie){const Je=ge.getTile(Ze),pt=Je.getBucket(fe);if(!pt||!pt.text||!pt.text.segments.get().length)continue;const ut=o.ag(pt.textSizeData,ye.zoom),dt=Ge(Je,1,pe.transform.zoom),Gt=Ei(Ze.posMatrix,qe,Ne,pe.transform,dt),Ri=fe.layout.get("icon-text-fit")!=="none"&&pt.hasIconData();if(ut){const Pt=Math.pow(2,ye.zoom-Je.tileID.overscaledZ);Sl(pt,Ne,qe,We,ye,Gt,Ze.posMatrix,Pt,ut,Ri,pe.style.map.terrain?(wi,Bi)=>pe.style.map.terrain.getElevation(Ze,wi,Bi):null)}}}(A,x,C,T,C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),F),C.paint.get("icon-opacity").constantOr(1)!==0&&rh(x,T,C,A,!1,C.paint.get("icon-translate"),C.paint.get("icon-translate-anchor"),C.layout.get("icon-rotation-alignment"),C.layout.get("icon-pitch-alignment"),C.layout.get("icon-keep-upright"),j,Z),C.paint.get("text-opacity").constantOr(1)!==0&&rh(x,T,C,A,!0,C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.layout.get("text-keep-upright"),j,Z),T.map.showCollisionBoxes&&(wl(x,T,C,A,C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),!0),wl(x,T,C,A,C.paint.get("icon-translate"),C.paint.get("icon-translate-anchor"),!1))})(r,d,m,g,this.style.placement.variableOffsets);break;case"circle":(function(x,T,C,A){if(x.renderPass!=="translucent")return;const F=C.paint.get("circle-opacity"),j=C.paint.get("circle-stroke-width"),Z=C.paint.get("circle-stroke-opacity"),ie=!C.layout.get("circle-sort-key").isConstant();if(F.constantOr(1)===0&&(j.constantOr(1)===0||Z.constantOr(1)===0))return;const pe=x.context,fe=pe.gl,ge=x.depthModeForSublayer(0,ln.ReadOnly),le=En.disabled,Le=x.colorModeForRenderPass(),We=[];for(let ye=0;ye<A.length;ye++){const Ne=A[ye],qe=T.getTile(Ne),Ze=qe.getBucket(C);if(!Ze)continue;const Je=Ze.programConfigurations.get(C.id),pt=x.useProgram("circle",Je),ut=Ze.layoutVertexBuffer,dt=Ze.indexBuffer,Gt=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Ne),Ri={programConfiguration:Je,program:pt,layoutVertexBuffer:ut,indexBuffer:dt,uniformValues:fi(x,Ne,qe,C),terrainData:Gt};if(ie){const Pt=Ze.segments.get();for(const wi of Pt)We.push({segments:new o.$([wi]),sortKey:wi.sortKey,state:Ri})}else We.push({segments:Ze.segments,sortKey:0,state:Ri})}ie&&We.sort((ye,Ne)=>ye.sortKey-Ne.sortKey);for(const ye of We){const{programConfiguration:Ne,program:qe,layoutVertexBuffer:Ze,indexBuffer:Je,uniformValues:pt,terrainData:ut}=ye.state;qe.draw(pe,fe.TRIANGLES,ge,le,Le,Cn.disabled,pt,ut,C.id,Ze,Je,ye.segments,C.paint,x.transform.zoom,Ne)}})(r,d,m,g);break;case"heatmap":(function(x,T,C,A){if(C.paint.get("heatmap-opacity")!==0)if(x.renderPass==="offscreen"){const F=x.context,j=F.gl,Z=En.disabled,ie=new ua([j.ONE,j.ONE],o.aO.transparent,[!0,!0,!0,!0]);(function(pe,fe,ge){const le=pe.gl;pe.activeTexture.set(le.TEXTURE1),pe.viewport.set([0,0,fe.width/4,fe.height/4]);let Le=ge.heatmapFbo;if(Le)le.bindTexture(le.TEXTURE_2D,Le.colorAttachment.get()),pe.bindFramebuffer.set(Le.framebuffer);else{const We=le.createTexture();le.bindTexture(le.TEXTURE_2D,We),le.texParameteri(le.TEXTURE_2D,le.TEXTURE_WRAP_S,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_2D,le.TEXTURE_WRAP_T,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_2D,le.TEXTURE_MIN_FILTER,le.LINEAR),le.texParameteri(le.TEXTURE_2D,le.TEXTURE_MAG_FILTER,le.LINEAR),Le=ge.heatmapFbo=pe.createFramebuffer(fe.width/4,fe.height/4,!1,!1),function(ye,Ne,qe,Ze){var Je,pt;const ut=ye.gl,dt=(Je=ye.HALF_FLOAT)!==null&&Je!==void 0?Je:ut.UNSIGNED_BYTE,Gt=(pt=ye.RGBA16F)!==null&&pt!==void 0?pt:ut.RGBA;ut.texImage2D(ut.TEXTURE_2D,0,Gt,Ne.width/4,Ne.height/4,0,ut.RGBA,dt,null),Ze.colorAttachment.set(qe)}(pe,fe,We,Le)}})(F,x,C),F.clear({color:o.aO.transparent});for(let pe=0;pe<A.length;pe++){const fe=A[pe];if(T.hasRenderableParent(fe))continue;const ge=T.getTile(fe),le=ge.getBucket(C);if(!le)continue;const Le=le.programConfigurations.get(C.id),We=x.useProgram("heatmap",Le),{zoom:ye}=x.transform;We.draw(F,j.TRIANGLES,ln.disabled,Z,ie,Cn.disabled,Ot(fe.posMatrix,ge,ye,C.paint.get("heatmap-intensity")),null,C.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,C.paint,x.transform.zoom,Le)}F.viewport.set([0,0,x.width,x.height])}else x.renderPass==="translucent"&&(x.context.setColorMode(x.colorModeForRenderPass()),function(F,j){const Z=F.context,ie=Z.gl,pe=j.heatmapFbo;if(!pe)return;Z.activeTexture.set(ie.TEXTURE0),ie.bindTexture(ie.TEXTURE_2D,pe.colorAttachment.get()),Z.activeTexture.set(ie.TEXTURE1);let fe=j.colorRampTexture;fe||(fe=j.colorRampTexture=new Ye(Z,j.colorRamp,ie.RGBA)),fe.bind(ie.LINEAR,ie.CLAMP_TO_EDGE),F.useProgram("heatmapTexture").draw(Z,ie.TRIANGLES,ln.disabled,En.disabled,F.colorModeForRenderPass(),Cn.disabled,((ge,le,Le,We)=>{const ye=o.F();o.aN(ye,0,ge.width,ge.height,0,0,1);const Ne=ge.context.gl;return{u_matrix:ye,u_world:[Ne.drawingBufferWidth,Ne.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:le.paint.get("heatmap-opacity")}})(F,j),null,j.id,F.viewportBuffer,F.quadTriangleIndexBuffer,F.viewportSegments,j.paint,F.transform.zoom)}(x,C))})(r,d,m,g);break;case"line":(function(x,T,C,A){if(x.renderPass!=="translucent")return;const F=C.paint.get("line-opacity"),j=C.paint.get("line-width");if(F.constantOr(1)===0||j.constantOr(1)===0)return;const Z=x.depthModeForSublayer(0,ln.ReadOnly),ie=x.colorModeForRenderPass(),pe=C.paint.get("line-dasharray"),fe=C.paint.get("line-pattern"),ge=fe.constantOr(1),le=C.paint.get("line-gradient"),Le=C.getCrossfadeParameters(),We=ge?"linePattern":pe?"lineSDF":le?"lineGradient":"line",ye=x.context,Ne=ye.gl;let qe=!0;for(const Ze of A){const Je=T.getTile(Ze);if(ge&&!Je.patternsLoaded())continue;const pt=Je.getBucket(C);if(!pt)continue;const ut=pt.programConfigurations.get(C.id),dt=x.context.program.get(),Gt=x.useProgram(We,ut),Ri=qe||Gt.program!==dt,Pt=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Ze),wi=fe.constantOr(null);if(wi&&Je.imageAtlas){const Di=Je.imageAtlas,Vi=Di.patternPositions[wi.to.toString()],Hi=Di.patternPositions[wi.from.toString()];Vi&&Hi&&ut.setConstantPatternPositions(Vi,Hi)}const Bi=Pt?Ze:null,an=ge?di(x,Je,C,Le,Bi):pe?It(x,Je,C,pe,Le,Bi):le?Ji(x,Je,C,pt.lineClipsArray.length,Bi):li(x,Je,C,Bi);if(ge)ye.activeTexture.set(Ne.TEXTURE0),Je.imageAtlasTexture.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE),ut.updatePaintBuffers(Le);else if(pe&&(Ri||x.lineAtlas.dirty))ye.activeTexture.set(Ne.TEXTURE0),x.lineAtlas.bind(ye);else if(le){const Di=pt.gradients[C.id];let Vi=Di.texture;if(C.gradientVersion!==Di.version){let Hi=256;if(C.stepInterpolant){const Yn=T.getSource().maxzoom,Pn=Ze.canonical.z===Yn?Math.ceil(1<<x.transform.maxZoom-Ze.canonical.z):1;Hi=o.ac(o.aT(pt.maxLineLength/o.W*1024*Pn),256,ye.maxTextureSize)}Di.gradient=o.aU({expression:C.gradientExpression(),evaluationKey:"lineProgress",resolution:Hi,image:Di.gradient||void 0,clips:pt.lineClipsArray}),Di.texture?Di.texture.update(Di.gradient):Di.texture=new Ye(ye,Di.gradient,Ne.RGBA),Di.version=C.gradientVersion,Vi=Di.texture}ye.activeTexture.set(Ne.TEXTURE0),Vi.bind(C.stepInterpolant?Ne.NEAREST:Ne.LINEAR,Ne.CLAMP_TO_EDGE)}Gt.draw(ye,Ne.TRIANGLES,Z,x.stencilModeForClipping(Ze),ie,Cn.disabled,an,Pt,C.id,pt.layoutVertexBuffer,pt.indexBuffer,pt.segments,C.paint,x.transform.zoom,ut,pt.layoutVertexBuffer2),qe=!1}})(r,d,m,g);break;case"fill":(function(x,T,C,A){const F=C.paint.get("fill-color"),j=C.paint.get("fill-opacity");if(j.constantOr(1)===0)return;const Z=x.colorModeForRenderPass(),ie=C.paint.get("fill-pattern"),pe=x.opaquePassEnabledForLayer()&&!ie.constantOr(1)&&F.constantOr(o.aO.transparent).a===1&&j.constantOr(0)===1?"opaque":"translucent";if(x.renderPass===pe){const fe=x.depthModeForSublayer(1,x.renderPass==="opaque"?ln.ReadWrite:ln.ReadOnly);yc(x,T,C,A,fe,Z,!1)}if(x.renderPass==="translucent"&&C.paint.get("fill-antialias")){const fe=x.depthModeForSublayer(C.getPaintProperty("fill-outline-color")?2:0,ln.ReadOnly);yc(x,T,C,A,fe,Z,!0)}})(r,d,m,g);break;case"fill-extrusion":(function(x,T,C,A){const F=C.paint.get("fill-extrusion-opacity");if(F!==0&&x.renderPass==="translucent"){const j=new ln(x.context.gl.LEQUAL,ln.ReadWrite,x.depthRangeFor3D);if(F!==1||C.paint.get("fill-extrusion-pattern").constantOr(1))po(x,T,C,A,j,En.disabled,ua.disabled),po(x,T,C,A,j,x.stencilModeFor3D(),x.colorModeForRenderPass());else{const Z=x.colorModeForRenderPass();po(x,T,C,A,j,En.disabled,Z)}}})(r,d,m,g);break;case"hillshade":(function(x,T,C,A){if(x.renderPass!=="offscreen"&&x.renderPass!=="translucent")return;const F=x.context,j=x.depthModeForSublayer(0,ln.ReadOnly),Z=x.colorModeForRenderPass(),[ie,pe]=x.renderPass==="translucent"?x.stencilConfigForOverlap(A):[{},A];for(const fe of pe){const ge=T.getTile(fe);ge.needsHillshadePrepare!==void 0&&ge.needsHillshadePrepare&&x.renderPass==="offscreen"?oh(x,ge,C,j,En.disabled,Z):x.renderPass==="translucent"&&bc(x,fe,ge,C,j,ie[fe.overscaledZ],Z)}F.viewport.set([0,0,x.width,x.height])})(r,d,m,g);break;case"raster":(function(x,T,C,A){if(x.renderPass!=="translucent"||C.paint.get("raster-opacity")===0||!A.length)return;const F=x.context,j=F.gl,Z=T.getSource(),ie=x.useProgram("raster"),pe=x.colorModeForRenderPass(),[fe,ge]=Z instanceof xn?[{},A]:x.stencilConfigForOverlap(A),le=ge[ge.length-1].overscaledZ,Le=!x.options.moving;for(const We of ge){const ye=x.depthModeForSublayer(We.overscaledZ-le,C.paint.get("raster-opacity")===1?ln.ReadWrite:ln.ReadOnly,j.LESS),Ne=T.getTile(We);Ne.registerFadeDuration(C.paint.get("raster-fade-duration"));const qe=T.findLoadedParent(We,0),Ze=lh(Ne,qe,T,C,x.transform,x.style.map.terrain);let Je,pt;const ut=C.paint.get("raster-resampling")==="nearest"?j.NEAREST:j.LINEAR;F.activeTexture.set(j.TEXTURE0),Ne.texture.bind(ut,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),F.activeTexture.set(j.TEXTURE1),qe?(qe.texture.bind(ut,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),Je=Math.pow(2,qe.tileID.overscaledZ-Ne.tileID.overscaledZ),pt=[Ne.tileID.canonical.x*Je%1,Ne.tileID.canonical.y*Je%1]):Ne.texture.bind(ut,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST);const dt=x.style.map.terrain&&x.style.map.terrain.getTerrainData(We),Gt=dt?We:null,Ri=Gt?Gt.posMatrix:x.transform.calculatePosMatrix(We.toUnwrapped(),Le),Pt=Li(Ri,pt||[0,0],Je||1,Ze,C);Z instanceof xn?ie.draw(F,j.TRIANGLES,ye,En.disabled,pe,Cn.disabled,Pt,dt,C.id,Z.boundsBuffer,x.quadTriangleIndexBuffer,Z.boundsSegments):ie.draw(F,j.TRIANGLES,ye,fe[We.overscaledZ],pe,Cn.disabled,Pt,dt,C.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments)}})(r,d,m,g);break;case"background":(function(x,T,C,A){const F=C.paint.get("background-color"),j=C.paint.get("background-opacity");if(j===0)return;const Z=x.context,ie=Z.gl,pe=x.transform,fe=pe.tileSize,ge=C.paint.get("background-pattern");if(x.isPatternMissing(ge))return;const le=!ge&&F.a===1&&j===1&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass!==le)return;const Le=En.disabled,We=x.depthModeForSublayer(0,le==="opaque"?ln.ReadWrite:ln.ReadOnly),ye=x.colorModeForRenderPass(),Ne=x.useProgram(ge?"backgroundPattern":"background"),qe=A||pe.coveringTiles({tileSize:fe,terrain:x.style.map.terrain});ge&&(Z.activeTexture.set(ie.TEXTURE0),x.imageManager.bind(x.context));const Ze=C.getCrossfadeParameters();for(const Je of qe){const pt=A?Je.posMatrix:x.transform.calculatePosMatrix(Je.toUnwrapped()),ut=ge?Rr(pt,j,x,ge,{tileID:Je,tileSize:fe},Ze):Ja(pt,j,F),dt=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Je);Ne.draw(Z,ie.TRIANGLES,We,Le,ye,Cn.disabled,ut,dt,C.id,x.tileExtentBuffer,x.quadTriangleIndexBuffer,x.tileExtentSegments)}})(r,0,m,g);break;case"custom":(function(x,T,C){const A=x.context,F=C.implementation;if(x.renderPass==="offscreen"){const j=F.prerender;j&&(x.setCustomLayerDefaults(),A.setColorMode(x.colorModeForRenderPass()),j.call(F,A.gl,x.transform.customLayerMatrix()),A.setDirty(),x.setBaseState())}else if(x.renderPass==="translucent"){x.setCustomLayerDefaults(),A.setColorMode(x.colorModeForRenderPass()),A.setStencilMode(En.disabled);const j=F.renderingMode==="3d"?new ln(x.context.gl.LEQUAL,ln.ReadWrite,x.depthRangeFor3D):x.depthModeForSublayer(0,ln.ReadOnly);A.setDepthMode(j),F.render(A.gl,x.transform.customLayerMatrix()),A.setDirty(),x.setBaseState(),A.bindFramebuffer.set(null)}})(r,0,m)}}translatePosMatrix(r,d,m,g,x){if(!m[0]&&!m[1])return r;const T=x?g==="map"?this.transform.angle:0:g==="viewport"?-this.transform.angle:0;if(T){const F=Math.sin(T),j=Math.cos(T);m=[m[0]*j-m[1]*F,m[0]*F+m[1]*j]}const C=[x?m[0]:Ge(d,m[0],this.transform.zoom),x?m[1]:Ge(d,m[1],this.transform.zoom),0],A=new Float32Array(16);return o.H(A,r,C),A}saveTileTexture(r){const d=this._tileTextures[r.size[0]];d?d.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const d=this._tileTextures[r];return d&&d.length>0?d.pop():null}isPatternMissing(r){if(!r)return!1;if(!r.from||!r.to)return!0;const d=this.imageManager.getPattern(r.from.toString()),m=this.imageManager.getPattern(r.to.toString());return!d||!m}useProgram(r,d){this.cache=this.cache||{};const m=r+(d?d.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[m]||(this.cache[m]=new de(this.context,z[r],d,qa[r],this._showOverdrawInspector,this.style.map.terrain)),this.cache[m]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Ye(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:r,drawingBufferHeight:d}=this.context.gl;return this.width!==r||this.height!==d}}class Bs{constructor(r,d){this.points=r,this.planes=d}static fromInvProjectionMatrix(r,d,m){const g=Math.pow(2,m),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(C=>{const A=1/(C=o.af([],C,r))[3]/d*g;return o.a$(C,C,[A,A,1/C[3],A])}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(C=>{const A=function(ie,pe){var fe=pe[0],ge=pe[1],le=pe[2],Le=fe*fe+ge*ge+le*le;return Le>0&&(Le=1/Math.sqrt(Le)),ie[0]=pe[0]*Le,ie[1]=pe[1]*Le,ie[2]=pe[2]*Le,ie}([],function(ie,pe,fe){var ge=pe[0],le=pe[1],Le=pe[2],We=fe[0],ye=fe[1],Ne=fe[2];return ie[0]=le*Ne-Le*ye,ie[1]=Le*We-ge*Ne,ie[2]=ge*ye-le*We,ie}([],_e([],x[C[0]],x[C[1]]),_e([],x[C[2]],x[C[1]]))),F=-((j=A)[0]*(Z=x[C[1]])[0]+j[1]*Z[1]+j[2]*Z[2]);var j,Z;return A.concat(F)});return new Bs(x,T)}}class _o{constructor(r,d){this.min=r,this.max=d,this.center=function(m,g,x){return m[0]=.5*g[0],m[1]=.5*g[1],m[2]=.5*g[2],m}([],function(m,g,x){return m[0]=g[0]+x[0],m[1]=g[1]+x[1],m[2]=g[2]+x[2],m}([],this.min,this.max))}quadrant(r){const d=[r%2==0,r<2],m=Pe(this.min),g=Pe(this.max);for(let x=0;x<d.length;x++)m[x]=d[x]?this.min[x]:this.center[x],g[x]=d[x]?this.center[x]:this.max[x];return g[2]=this.max[2],new _o(m,g)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}intersects(r){const d=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let m=!0;for(let g=0;g<r.planes.length;g++){const x=r.planes[g];let T=0;for(let C=0;C<d.length;C++)o.b0(x,d[C])>=0&&T++;if(T===0)return 0;T!==d.length&&(m=!1)}if(m)return 2;for(let g=0;g<3;g++){let x=Number.MAX_VALUE,T=-Number.MAX_VALUE;for(let C=0;C<r.points.length;C++){const A=r.points[C][g]-this.min[g];x=Math.min(x,A),T=Math.max(T,A)}if(T<0||x>this.max[g]-this.min[g])return 0}return 1}}class qo{constructor(r=0,d=0,m=0,g=0){if(isNaN(r)||r<0||isNaN(d)||d<0||isNaN(m)||m<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=d,this.left=m,this.right=g}interpolate(r,d,m){return d.top!=null&&r.top!=null&&(this.top=o.z.number(r.top,d.top,m)),d.bottom!=null&&r.bottom!=null&&(this.bottom=o.z.number(r.bottom,d.bottom,m)),d.left!=null&&r.left!=null&&(this.left=o.z.number(r.left,d.left,m)),d.right!=null&&r.right!=null&&(this.right=o.z.number(r.right,d.right,m)),this}getCenter(r,d){const m=o.ac((this.left+r-this.right)/2,0,r),g=o.ac((this.top+d-this.bottom)/2,0,d);return new o.P(m,g)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new qo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const kc=85.051129;class Tl{constructor(r,d,m,g,x){this.tileSize=512,this._renderWorldCopies=x===void 0||!!x,this._minZoom=r||0,this._maxZoom=d||22,this._minPitch=m??0,this._maxPitch=g??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new qo,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const r=new Tl(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return r.apply(this),r}apply(r){this.tileSize=r.tileSize,this.latRange=r.latRange,this.width=r.width,this.height=r.height,this._center=r._center,this._elevation=r._elevation,this.minElevationForCurrentTile=r.minElevationForCurrentTile,this.zoom=r.zoom,this.angle=r.angle,this._fov=r._fov,this._pitch=r._pitch,this._unmodified=r._unmodified,this._edgeInsets=r._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(r){const d=-o.b1(r,-180,180)*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=function(){var m=new o.A(4);return o.A!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m}(),function(m,g,x){var T=g[0],C=g[1],A=g[2],F=g[3],j=Math.sin(x),Z=Math.cos(x);m[0]=T*Z+A*j,m[1]=C*Z+F*j,m[2]=T*-j+A*Z,m[3]=C*-j+F*Z}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const d=o.ac(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=r/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(r){const d=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._zoom=d,this.tileZoom=Math.max(0,Math.floor(d)),this.scale=this.zoomScale(d),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(r){r!==this._elevation&&(this._elevation=r,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,d,m){this._unmodified=!1,this._edgeInsets.interpolate(r,d,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const d=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(r){const d=[new o.b2(0,r)];if(this._renderWorldCopies){const m=this.pointCoordinate(new o.P(0,0)),g=this.pointCoordinate(new o.P(this.width,0)),x=this.pointCoordinate(new o.P(this.width,this.height)),T=this.pointCoordinate(new o.P(0,this.height)),C=Math.floor(Math.min(m.x,g.x,x.x,T.x)),A=Math.floor(Math.max(m.x,g.x,x.x,T.x)),F=1;for(let j=C-F;j<=A+F;j++)j!==0&&d.push(new o.b2(j,r))}return d}coveringTiles(r){var d,m;let g=this.coveringZoomLevel(r);const x=g;if(r.minzoom!==void 0&&g<r.minzoom)return[];r.maxzoom!==void 0&&g>r.maxzoom&&(g=r.maxzoom);const T=this.pointCoordinate(this.getCameraPoint()),C=o.Y.fromLngLat(this.center),A=Math.pow(2,g),F=[A*T.x,A*T.y,0],j=[A*C.x,A*C.y,0],Z=Bs.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,g);let ie=r.minzoom||0;!r.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(ie=g);const pe=r.terrain?2/Math.min(this.tileSize,r.tileSize)*this.tileSize:3,fe=ye=>({aabb:new _o([ye*A,0,0],[(ye+1)*A,A,0]),zoom:0,x:0,y:0,wrap:ye,fullyVisible:!1}),ge=[],le=[],Le=g,We=r.reparseOverscaled?x:g;if(this._renderWorldCopies)for(let ye=1;ye<=3;ye++)ge.push(fe(-ye)),ge.push(fe(ye));for(ge.push(fe(0));ge.length>0;){const ye=ge.pop(),Ne=ye.x,qe=ye.y;let Ze=ye.fullyVisible;if(!Ze){const Gt=ye.aabb.intersects(Z);if(Gt===0)continue;Ze=Gt===2}const Je=r.terrain?F:j,pt=ye.aabb.distanceX(Je),ut=ye.aabb.distanceY(Je),dt=Math.max(Math.abs(pt),Math.abs(ut));if(ye.zoom===Le||dt>pe+(1<<Le-ye.zoom)-2&&ye.zoom>=ie){const Gt=Le-ye.zoom,Ri=F[0]-.5-(Ne<<Gt),Pt=F[1]-.5-(qe<<Gt);le.push({tileID:new o.Q(ye.zoom===Le?We:ye.zoom,ye.wrap,ye.zoom,Ne,qe),distanceSq:ze([j[0]-.5-Ne,j[1]-.5-qe]),tileDistanceToCamera:Math.sqrt(Ri*Ri+Pt*Pt)})}else for(let Gt=0;Gt<4;Gt++){const Ri=(Ne<<1)+Gt%2,Pt=(qe<<1)+(Gt>>1),wi=ye.zoom+1;let Bi=ye.aabb.quadrant(Gt);if(r.terrain){const an=new o.Q(wi,ye.wrap,wi,Ri,Pt),Di=r.terrain.getMinMaxElevation(an),Vi=(d=Di.minElevation)!==null&&d!==void 0?d:this.elevation,Hi=(m=Di.maxElevation)!==null&&m!==void 0?m:this.elevation;Bi=new _o([Bi.min[0],Bi.min[1],Vi],[Bi.max[0],Bi.max[1],Hi])}ge.push({aabb:Bi,zoom:wi,x:Ri,y:Pt,wrap:ye.wrap,fullyVisible:Ze})}}return le.sort((ye,Ne)=>ye.distanceSq-Ne.distanceSq).map(ye=>ye.tileID)}resize(r,d){this.width=r,this.height=d,this.pixelsToGLUnits=[2/r,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const d=o.ac(r.lat,-85.051129,kc);return new o.P(o.N(r.lng)*this.worldSize,o.O(d)*this.worldSize)}unproject(r){return new o.Y(r.x/this.worldSize,r.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(r){const d=this.elevation,m=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,g=this.pointLocation(this.centerPoint,r),x=r.getElevationForLngLatZoom(g,this.tileZoom);if(!(this.elevation-x))return;const T=m+d-x,C=Math.cos(this._pitch)*this.cameraToCenterDistance/T/o.b3(1,g.lat),A=this.scaleZoom(C/this.tileSize);this._elevation=x,this._center=g,this.zoom=A}setLocationAtPoint(r,d){const m=this.pointCoordinate(d),g=this.pointCoordinate(this.centerPoint),x=this.locationCoordinate(r),T=new o.Y(x.x-(m.x-g.x),x.y-(m.y-g.y));this.center=this.coordinateLocation(T),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(r,d){return d?this.coordinatePoint(this.locationCoordinate(r),d.getElevationForLngLatZoom(r,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(r))}pointLocation(r,d){return this.coordinateLocation(this.pointCoordinate(r,d))}locationCoordinate(r){return o.Y.fromLngLat(r)}coordinateLocation(r){return r&&r.toLngLat()}pointCoordinate(r,d){if(d){const ie=d.pointCoordinate(r);if(ie!=null)return ie}const m=[r.x,r.y,0,1],g=[r.x,r.y,1,1];o.af(m,m,this.pixelMatrixInverse),o.af(g,g,this.pixelMatrixInverse);const x=m[3],T=g[3],C=m[1]/x,A=g[1]/T,F=m[2]/x,j=g[2]/T,Z=F===j?0:(0-F)/(j-F);return new o.Y(o.z.number(m[0]/x,g[0]/T,Z)/this.worldSize,o.z.number(C,A,Z)/this.worldSize)}coordinatePoint(r,d=0,m=this.pixelMatrix){const g=[r.x*this.worldSize,r.y*this.worldSize,d,1];return o.af(g,g,m),new o.P(g[0]/g[3],g[1]/g[3])}getBounds(){const r=Math.max(0,this.height/2-this.getHorizon());return new Yi().extend(this.pointLocation(new o.P(0,r))).extend(this.pointLocation(new o.P(this.width,r))).extend(this.pointLocation(new o.P(this.width,this.height))).extend(this.pointLocation(new o.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Yi([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(r){r?(this.lngRange=[r.getWest(),r.getEast()],this.latRange=[r.getSouth(),r.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,kc])}calculatePosMatrix(r,d=!1){const m=r.key,g=d?this._alignedPosMatrixCache:this._posMatrixCache;if(g[m])return g[m];const x=r.canonical,T=this.worldSize/this.zoomScale(x.z),C=x.x+Math.pow(2,x.z)*r.wrap,A=o.an(new Float64Array(16));return o.H(A,A,[C*T,x.y*T,0]),o.J(A,A,[T/o.W,T/o.W,1]),o.K(A,d?this.alignedProjMatrix:this.projMatrix,A),g[m]=new Float32Array(A),g[m]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(r,d){d=o.ac(+d,this.minZoom,this.maxZoom);const m={center:new o.M(r.lng,r.lat),zoom:d};let g=this.lngRange;if(!this._renderWorldCopies&&g===null){const ye=179.9999999999;g=[-ye,ye]}const x=this.tileSize*this.zoomScale(m.zoom);let T=0,C=x,A=0,F=x,j=0,Z=0;const{x:ie,y:pe}=this.size;if(this.latRange){const ye=this.latRange;T=o.O(ye[1])*x,C=o.O(ye[0])*x,C-T<pe&&(j=pe/(C-T))}g&&(A=o.b1(o.N(g[0])*x,0,x),F=o.b1(o.N(g[1])*x,0,x),F<A&&(F+=x),F-A<ie&&(Z=ie/(F-A)));const{x:fe,y:ge}=this.project.call({worldSize:x},r);let le,Le;const We=Math.max(Z||0,j||0);if(We){const ye=new o.P(Z?(F+A)/2:fe,j?(C+T)/2:ge);return m.center=this.unproject.call({worldSize:x},ye).wrap(),m.zoom+=this.scaleZoom(We),m}if(this.latRange){const ye=pe/2;ge-ye<T&&(Le=T+ye),ge+ye>C&&(Le=C-ye)}if(g){const ye=(A+F)/2;let Ne=fe;this._renderWorldCopies&&(Ne=o.b1(fe,ye-x/2,ye+x/2));const qe=ie/2;Ne-qe<A&&(le=A+qe),Ne+qe>F&&(le=F-qe)}if(le!==void 0||Le!==void 0){const ye=new o.P(le??fe,Le??ge);m.center=this.unproject.call({worldSize:x},ye).wrap()}return m}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this._unmodified,{center:d,zoom:m}=this.getConstrained(this.center,this.zoom);this.center=d,this.zoom=m,this._unmodified=r,this._constraining=!1}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,d=this.point.x,m=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=o.b3(1,this.center.lat)*this.worldSize;let g=o.an(new Float64Array(16));o.J(g,g,[this.width/2,-this.height/2,1]),o.H(g,g,[1,-1,0]),this.labelPlaneMatrix=g,g=o.an(new Float64Array(16)),o.J(g,g,[1,-1,1]),o.H(g,g,[-1,-1,0]),o.J(g,g,[2/this.width,2/this.height,1]),this.glCoordMatrix=g;const x=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),T=Math.min(this.elevation,this.minElevationForCurrentTile),C=x-T*this._pixelPerMeter/Math.cos(this._pitch),A=T<0?C:x,F=Math.PI/2+this._pitch,j=this._fov*(.5+r.y/this.height),Z=Math.sin(j)*A/Math.sin(o.ac(Math.PI-F-j,.01,Math.PI-.01)),ie=this.getHorizon(),pe=2*Math.atan(ie/this.cameraToCenterDistance)*(.5+r.y/(2*ie)),fe=Math.sin(pe)*A/Math.sin(o.ac(Math.PI-F-pe,.01,Math.PI-.01)),ge=Math.min(Z,fe),le=1.01*(Math.cos(Math.PI/2-this._pitch)*ge+A),Le=this.height/50;g=new Float64Array(16),o.b4(g,this._fov,this.width/this.height,Le,le),g[8]=2*-r.x/this.width,g[9]=2*r.y/this.height,o.J(g,g,[1,-1,1]),o.H(g,g,[0,0,-this.cameraToCenterDistance]),o.b5(g,g,this._pitch),o.ad(g,g,this.angle),o.H(g,g,[-d,-m,0]),this.mercatorMatrix=o.J([],g,[this.worldSize,this.worldSize,this.worldSize]),o.J(g,g,[1,1,this._pixelPerMeter]),this.pixelMatrix=o.K(new Float64Array(16),this.labelPlaneMatrix,g),o.H(g,g,[0,0,-this.elevation]),this.projMatrix=g,this.invProjMatrix=o.ar([],g),this.pixelMatrix3D=o.K(new Float64Array(16),this.labelPlaneMatrix,g);const We=this.width%2/2,ye=this.height%2/2,Ne=Math.cos(this.angle),qe=Math.sin(this.angle),Ze=d-Math.round(d)+Ne*We+qe*ye,Je=m-Math.round(m)+Ne*ye+qe*We,pt=new Float64Array(g);if(o.H(pt,pt,[Ze>.5?Ze-1:Ze,Je>.5?Je-1:Je,0]),this.alignedProjMatrix=pt,g=o.ar(new Float64Array(16),this.pixelMatrix),!g)throw new Error("failed to invert matrix");this.pixelMatrixInverse=g,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const r=this.pointCoordinate(new o.P(0,0)),d=[r.x*this.worldSize,r.y*this.worldSize,0,1];return o.af(d,d,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(0,r))}getCameraQueryGeometry(r){const d=this.getCameraPoint();if(r.length===1)return[r[0],d];{let m=d.x,g=d.y,x=d.x,T=d.y;for(const C of r)m=Math.min(m,C.x),g=Math.min(g,C.y),x=Math.max(x,C.x),T=Math.max(T,C.y);return[new o.P(m,g),new o.P(x,g),new o.P(x,T),new o.P(m,T),new o.P(m,g)]}}lngLatToCameraDepth(r,d){const m=this.locationCoordinate(r),g=[m.x*this.worldSize,m.y*this.worldSize,d,1];return o.af(g,g,this.projMatrix),g[2]/g[3]}}function Sc(b,r){let d,m=!1,g=null,x=null;const T=()=>{g=null,m&&(b.apply(x,d),g=setTimeout(T,r),m=!1)};return(...C)=>(m=!0,x=this,d=C,g||T(),g)}class Mc{constructor(r){this._getCurrentHash=()=>{const d=window.location.hash.replace("#","");if(this._hashName){let m;return d.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(m=g)}),(m&&m[1]||"").split("/")}return d.split("/")},this._onHashChange=()=>{const d=this._getCurrentHash();if(d.length>=3&&!d.some(m=>isNaN(m))){const m=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(d[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:m,pitch:+(d[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const d=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,d)}catch{}},this._updateHash=Sc(this._updateHashUnthrottled,300),this._hashName=r&&encodeURIComponent(r)}addTo(r){return this._map=r,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(r){const d=this._map.getCenter(),m=Math.round(100*this._map.getZoom())/100,g=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,g),T=Math.round(d.lng*x)/x,C=Math.round(d.lat*x)/x,A=this._map.getBearing(),F=this._map.getPitch();let j="";if(j+=r?`/${T}/${C}/${m}`:`${m}/${C}/${T}`,(A||F)&&(j+="/"+Math.round(10*A)/10),F&&(j+=`/${Math.round(F)}`),this._hashName){const Z=this._hashName;let ie=!1;const pe=window.location.hash.slice(1).split("&").map(fe=>{const ge=fe.split("=")[0];return ge===Z?(ie=!0,`${ge}=${j}`):fe}).filter(fe=>fe);return ie||pe.push(`${Z}=${j}`),`#${pe.join("&")}`}return`#${j}`}}const Xr={linearity:.3,easing:o.b6(0,0,.3,1)},uh=o.e({deceleration:2500,maxSpeed:1400},Xr),hh=o.e({deceleration:20,maxSpeed:1400},Xr),dh=o.e({deceleration:1e3,maxSpeed:360},Xr),fh=o.e({deceleration:1e3,maxSpeed:90},Xr);class ph{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:M.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,d=M.now();for(;r.length>0&&d-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)d.zoom+=x.zoomDelta||0,d.bearing+=x.bearingDelta||0,d.pitch+=x.pitchDelta||0,x.panDelta&&d.pan._add(x.panDelta),x.around&&(d.around=x.around),x.pinchAround&&(d.pinchAround=x.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(d.pan.mag()){const x=Go(d.pan.mag(),m,o.e({},uh,r||{}));g.offset=d.pan.mult(x.amount/d.pan.mag()),g.center=this._map.transform.center,Zo(g,x)}if(d.zoom){const x=Go(d.zoom,m,hh);g.zoom=this._map.transform.zoom+x.amount,Zo(g,x)}if(d.bearing){const x=Go(d.bearing,m,dh);g.bearing=this._map.transform.bearing+o.ac(x.amount,-179,179),Zo(g,x)}if(d.pitch){const x=Go(d.pitch,m,fh);g.pitch=this._map.transform.pitch+x.amount,Zo(g,x)}if(g.zoom||g.bearing){const x=d.pinchAround===void 0?d.around:d.pinchAround;g.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),o.e(g,{noMoveStart:!0})}}function Zo(b,r){(!b.duration||b.duration<r.duration)&&(b.duration=r.duration,b.easing=r.easing)}function Go(b,r,d){const{maxSpeed:m,linearity:g,deceleration:x}=d,T=o.ac(b*g/(r/1e3),-m,m),C=Math.abs(T)/(x*g);return{easing:d.easing,duration:1e3*C,amount:T*(C/2)}}class Ea extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,d,m,g={}){const x=S.mousePos(d.getCanvas(),m),T=d.unproject(x);super(r,o.e({point:x,lngLat:T,originalEvent:m},g)),this._defaultPrevented=!1,this.target=d}}class yo extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,d,m){const g=r==="touchend"?m.changedTouches:m.touches,x=S.touchPos(d.getCanvasContainer(),g),T=x.map(A=>d.unproject(A)),C=x.reduce((A,F,j,Z)=>A.add(F.div(Z.length)),new o.P(0,0));super(r,{points:x,point:C,lngLats:T,lngLat:d.unproject(C),originalEvent:m}),this._defaultPrevented=!1}}class Pr extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,d,m){super(r,{originalEvent:m}),this._defaultPrevented=!1}}class Qr{constructor(r,d){this._map=r,this._clickTolerance=d.clickTolerance}reset(){delete this._mousedownPos}wheel(r){return this._firePreventable(new Pr(r.type,this._map,r))}mousedown(r,d){return this._mousedownPos=d,this._firePreventable(new Ea(r.type,this._map,r))}mouseup(r){this._map.fire(new Ea(r.type,this._map,r))}click(r,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||this._map.fire(new Ea(r.type,this._map,r))}dblclick(r){return this._firePreventable(new Ea(r.type,this._map,r))}mouseover(r){this._map.fire(new Ea(r.type,this._map,r))}mouseout(r){this._map.fire(new Ea(r.type,this._map,r))}touchstart(r){return this._firePreventable(new yo(r.type,this._map,r))}touchmove(r){this._map.fire(new yo(r.type,this._map,r))}touchend(r){this._map.fire(new yo(r.type,this._map,r))}touchcancel(r){this._map.fire(new yo(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class mh{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(r){this._map.fire(new Ea(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ea("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._ignoreContextMenu||this._map.fire(new Ea(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class sr{constructor(r){this._map=r}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(r){return this.transform.pointLocation(o.P.convert(r),this._map.terrain)}}class bo{constructor(r,d){this._map=r,this._tr=new sr(r),this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,d){this.isEnabled()&&r.shiftKey&&r.button===0&&(S.disableDrag(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(r,d){if(!this._active)return;const m=d;if(this._lastPos.equals(m)||!this._box&&m.dist(this._startPos)<this._clickTolerance)return;const g=this._startPos;this._lastPos=m,this._box||(this._box=S.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",r));const x=Math.min(g.x,m.x),T=Math.max(g.x,m.x),C=Math.min(g.y,m.y),A=Math.max(g.y,m.y);S.setTransform(this._box,`translate(${x}px,${C}px)`),this._box.style.width=T-x+"px",this._box.style.height=A-C+"px"}mouseupWindow(r,d){if(!this._active||r.button!==0)return;const m=this._startPos,g=d;if(this.reset(),S.suppressClick(),m.x!==g.x||m.y!==g.y)return this._map.fire(new o.k("boxzoomend",{originalEvent:r})),{cameraAnimation:x=>x.fitScreenCoordinates(m,g,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",r)}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(S.remove(this._box),this._box=null),S.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(r,d){return this._map.fire(new o.k(r,{originalEvent:d}))}}function Dc(b,r){if(b.length!==r.length)throw new Error(`The number of touches and points are not equal - touches ${b.length}, points ${r.length}`);const d={};for(let m=0;m<b.length;m++)d[b[m].identifier]=r[m];return d}class mf{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(r,d,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=r.timeStamp),m.length===this.numTouches&&(this.centroid=function(g){const x=new o.P(0,0);for(const T of g)x._add(T);return x.div(g.length)}(d),this.touches=Dc(m,d)))}touchmove(r,d,m){if(this.aborted||!this.centroid)return;const g=Dc(m,d);for(const x in this.touches){const T=g[x];(!T||T.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(r,d,m){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const g=!this.aborted&&this.centroid;if(this.reset(),g)return g}}}class Tc{constructor(r){this.singleTap=new mf(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(r,d,m){this.singleTap.touchstart(r,d,m)}touchmove(r,d,m){this.singleTap.touchmove(r,d,m)}touchend(r,d,m){const g=this.singleTap.touchend(r,d,m);if(g){const x=r.timeStamp-this.lastTime<500,T=!this.lastTap||this.lastTap.dist(g)<30;if(x&&T||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class gh{constructor(r){this._tr=new sr(r),this._zoomIn=new Tc({numTouches:1,numTaps:2}),this._zoomOut=new Tc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,d,m){this._zoomIn.touchstart(r,d,m),this._zoomOut.touchstart(r,d,m)}touchmove(r,d,m){this._zoomIn.touchmove(r,d,m),this._zoomOut.touchmove(r,d,m)}touchend(r,d,m){const g=this._zoomIn.touchend(r,d,m),x=this._zoomOut.touchend(r,d,m),T=this._tr;return g?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:T.zoom+1,around:T.unproject(g)},{originalEvent:r})}):x?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:T.zoom-1,around:T.unproject(x)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class cs{constructor(r){this._enabled=!!r.enable,this._moveStateManager=r.moveStateManager,this._clickTolerance=r.clickTolerance||1,this._moveFunction=r.move,this._activateOnStart=!!r.activateOnStart,r.assignEvents(this),this.reset()}reset(r){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(r)}_move(...r){const d=this._moveFunction(...r);if(d.bearingDelta||d.pitchDelta||d.around||d.panDelta)return this._active=!0,d}dragStart(r,d){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(r)&&(this._moveStateManager.startMove(r),this._lastPoint=d.length?d[0]:d,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(r,d){if(!this.isEnabled())return;const m=this._lastPoint;if(!m)return;if(r.preventDefault(),!this._moveStateManager.isValidMoveEvent(r))return void this.reset(r);const g=d.length?d[0]:d;return!this._moved&&g.dist(m)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=g,this._move(m,g))}dragEnd(r){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(r)&&(this._moved&&S.suppressClick(),this.reset(r))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ss={0:1,2:2};class Yt{constructor(r){this._correctEvent=r.checkCorrectEvent}startMove(r){const d=S.mouseButton(r);this._eventButton=d}endMove(r){delete this._eventButton}isValidStartEvent(r){return this._correctEvent(r)}isValidMoveEvent(r){return!function(d,m){const g=Ss[m];return d.buttons===void 0||(d.buttons&g)!==g}(r,this._eventButton)}isValidEndEvent(r){return S.mouseButton(r)===this._eventButton}}class Cc{constructor(){this._firstTouch=void 0}_isOneFingerTouch(r){return r.targetTouches.length===1}_isSameTouchEvent(r){return r.targetTouches[0].identifier===this._firstTouch}startMove(r){this._firstTouch=r.targetTouches[0].identifier}endMove(r){delete this._firstTouch}isValidStartEvent(r){return this._isOneFingerTouch(r)}isValidMoveEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}isValidEndEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}}const Ns=b=>{b.mousedown=b.dragStart,b.mousemoveWindow=b.dragMove,b.mouseup=b.dragEnd,b.contextmenu=function(r){r.preventDefault()}},vo=({enable:b,clickTolerance:r,bearingDegreesPerPixelMoved:d=.8})=>{const m=new Yt({checkCorrectEvent:g=>S.mouseButton(g)===0&&g.ctrlKey||S.mouseButton(g)===2});return new cs({clickTolerance:r,move:(g,x)=>({bearingDelta:(x.x-g.x)*d}),moveStateManager:m,enable:b,assignEvents:Ns})},Pc=({enable:b,clickTolerance:r,pitchDegreesPerPixelMoved:d=-.5})=>{const m=new Yt({checkCorrectEvent:g=>S.mouseButton(g)===0&&g.ctrlKey||S.mouseButton(g)===2});return new cs({clickTolerance:r,move:(g,x)=>({pitchDelta:(x.y-g.y)*d}),moveStateManager:m,enable:b,assignEvents:Ns})};class qt{constructor(r,d){this._clickTolerance=r.clickTolerance||1,this._map=d,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(r,d,m){return this._calculateTransform(r,d,m)}touchmove(r,d,m){if(this._active&&!(m.length<this.minTouchs()))return r.preventDefault(),this._calculateTransform(r,d,m)}touchend(r,d,m){this._calculateTransform(r,d,m),this._active&&m.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,d,m){m.length>0&&(this._active=!0);const g=Dc(m,d),x=new o.P(0,0),T=new o.P(0,0);let C=0;for(const F in g){const j=g[F],Z=this._touches[F];Z&&(x._add(j),T._add(j.sub(Z)),C++,g[F]=j)}if(this._touches=g,C<this.minTouchs()||!T.mag())return;const A=T.div(C);return this._sum._add(A),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(C),panDelta:A}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $o{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(r,d,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([d[0],d[1]]))}touchmove(r,d,m){if(!this._firstTwoTouches)return;r.preventDefault();const[g,x]=this._firstTwoTouches,T=Cl(m,d,g),C=Cl(m,d,x);if(!T||!C)return;const A=this._aroundCenter?null:T.add(C).div(2);return this._move([T,C],A,r)}touchend(r,d,m){if(!this._firstTwoTouches)return;const[g,x]=this._firstTwoTouches,T=Cl(m,d,g),C=Cl(m,d,x);T&&C||(this._active&&S.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Cl(b,r,d){for(let m=0;m<b.length;m++)if(b[m].identifier===d)return r[m]}function _h(b,r){return Math.log(b/r)/Math.LN2}class Pl extends $o{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,d){const m=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(_h(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:_h(this._distance,m),pinchAround:d}}}function Ac(b,r){return 180*b.angleWith(r)/Math.PI}class Ic extends $o{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,d,m){const g=this._vector;if(this._vector=r[0].sub(r[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ac(this._vector,g),pinchAround:d}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const d=25/(Math.PI*this._minDiameter)*360,m=Ac(r,this._startVector);return Math.abs(m)<d}}function Ec(b){return Math.abs(b.y)>Math.abs(b.x)}class yh extends $o{constructor(r){super(),this._currentTouchCount=0,this._map=r}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(r,d,m){super.touchstart(r,d,m),this._currentTouchCount=m.length}_start(r){this._lastPoints=r,Ec(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,d,m){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const g=r[0].sub(this._lastPoints[0]),x=r[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(g,x,m.timeStamp),this._valid?(this._lastPoints=r,this._active=!0,{pitchDelta:(g.y+x.y)/2*-.5}):void 0}gestureBeginsVertically(r,d,m){if(this._valid!==void 0)return this._valid;const g=r.mag()>=2,x=d.mag()>=2;if(!g&&!x)return;if(!g||!x)return this._firstMove===void 0&&(this._firstMove=m),m-this._firstMove<100&&void 0;const T=r.y>0==d.y>0;return Ec(r)&&Ec(d)&&T}}const Vs={panStep:100,bearingStep:15,pitchStep:10};class Fn{constructor(r){this._tr=new sr(r);const d=Vs;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let d=0,m=0,g=0,x=0,T=0;switch(r.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:r.shiftKey?m=-1:(r.preventDefault(),x=-1);break;case 39:r.shiftKey?m=1:(r.preventDefault(),x=1);break;case 38:r.shiftKey?g=1:(r.preventDefault(),T=-1);break;case 40:r.shiftKey?g=-1:(r.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(m=0,g=0),{cameraAnimation:C=>{const A=this._tr;C.easeTo({duration:300,easeId:"keyboardHandler",easing:Al,zoom:d?Math.round(A.zoom)+d*(r.shiftKey?2:1):A.zoom,bearing:A.bearing+m*this._bearingStep,pitch:A.pitch+g*this._pitchStep,offset:[-x*this._panStep,-T*this._panStep],center:A.center},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Al(b){return b*(2-b)}const Il=4.000244140625;class Lc{constructor(r,d){this._onTimeout=m=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(m)},this._map=r,this._tr=new sr(r),this._triggerRenderFrame=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(r){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!r[this._map.cooperativeGestures._bypassKey])return;let d=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const m=M.now(),g=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,d!==0&&d%Il==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(g*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),r.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=r,this._delta-=d,this._active||this._start(r)),r.preventDefault()}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=S.mousePos(this._map.getCanvas(),r),m=this._tr;this._around=d.y>m.transform.height/2-m.transform.getHorizon()?o.M.convert(this._aroundCenter?m.center:m.unproject(d)):o.M.convert(m.center),this._aroundPoint=m.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._tr.transform;if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>Il?this._wheelZoomRate:this._defaultZoomRate;let A=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&A!==0&&(A=1/A);const F=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(F*A))),this._type==="wheel"&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const d=typeof this._targetZoom=="number"?this._targetZoom:r.zoom,m=this._startZoom,g=this._easing;let x,T=!1;if(this._type==="wheel"&&m&&g){const C=Math.min((M.now()-this._lastWheelEventTime)/200,1),A=g(C);x=o.z.number(m,d,A),C<1?this._frameId||(this._frameId=!0):T=!0}else x=d,T=!0;return this._active=!0,T&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!T,zoomDelta:x-r.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let d=o.b7;if(this._prevEase){const m=this._prevEase,g=(M.now()-m.start)/m.duration,x=m.easing(g+.01)-m.easing(g),T=.27/Math.sqrt(x*x+1e-4)*.01,C=Math.sqrt(.0729-T*T);d=o.b6(T,C,.25,1)}return this._prevEase={start:M.now(),duration:r,easing:d},d}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class zc{constructor(r,d){this._clickZoom=r,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class bh{constructor(r){this._tr=new sr(r),this.reset()}reset(){this._active=!1}dblclick(r,d){return r.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:this._tr.zoom+(r.shiftKey?-1:1),around:this._tr.unproject(d)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gf{constructor(){this._tap=new Tc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(r,d,m){if(!this._swipePoint)if(this._tapTime){const g=d[0],x=r.timeStamp-this._tapTime<500,T=this._tapPoint.dist(g)<30;x&&T?m.length>0&&(this._swipePoint=g,this._swipeTouch=m[0].identifier):this.reset()}else this._tap.touchstart(r,d,m)}touchmove(r,d,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const g=d[0],x=g.y-this._swipePoint.y;return this._swipePoint=g,r.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(r,d,m)}touchend(r,d,m){if(this._tapTime)this._swipePoint&&m.length===0&&this.reset();else{const g=this._tap.touchend(r,d,m);g&&(this._tapTime=r.timeStamp,this._tapPoint=g)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fr{constructor(r,d,m){this._el=r,this._mousePan=d,this._touchPan=m}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ko{constructor(r,d,m){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=d,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ri{constructor(r,d,m,g){this._el=r,this._touchZoom=d,this._touchRotate=m,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class yi{constructor(r,d){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=r,this._options=d,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const r=this._map.getCanvasContainer();r.classList.add("maplibregl-cooperative-gestures"),this._container=S.create("div","maplibregl-cooperative-gesture-screen",r);let d=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(d=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const m=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),g=document.createElement("div");g.className="maplibregl-desktop-message",g.textContent=d,this._container.appendChild(g);const x=document.createElement("div");x.className="maplibregl-mobile-message",x.textContent=m,this._container.appendChild(x),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(S.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(r){this._onCooperativeGesture(r.touches.length===1)}wheel(r){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!r[this._bypassKey])}_onCooperativeGesture(r){this._enabled&&r&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Hs=b=>b.zoom||b.drag||b.pitch||b.rotate;class Rc extends o.k{}function Yo(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta}class or{constructor(r,d){this.handleWindowEvent=g=>{this.handleEvent(g,`${g.type}Window`)},this.handleEvent=(g,x)=>{if(g.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const T=g.type==="renderFrame"?void 0:g,C={needsRenderFrame:!1},A={},F={},j=g.touches,Z=j?this._getMapTouches(j):void 0,ie=Z?S.touchPos(this._map.getCanvas(),Z):S.mousePos(this._map.getCanvas(),g);for(const{handlerName:ge,handler:le,allowed:Le}of this._handlers){if(!le.isEnabled())continue;let We;this._blockedByActive(F,Le,ge)?le.reset():le[x||g.type]&&(We=le[x||g.type](g,ie,Z),this.mergeHandlerResult(C,A,We,ge,T),We&&We.needsRenderFrame&&this._triggerRenderFrame()),(We||le.isActive())&&(F[ge]=le)}const pe={};for(const ge in this._previousActiveHandlers)F[ge]||(pe[ge]=T);this._previousActiveHandlers=F,(Object.keys(pe).length||Yo(C))&&(this._changes.push([C,A,pe]),this._triggerRenderFrame()),(Object.keys(F).length||Yo(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:fe}=C;fe&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],fe(this._map))},this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ph(r),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(d);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];for(const[g,x,T]of this._listeners)S.addEventListener(g,x,g===document?this.handleWindowEvent:this.handleEvent,T)}destroy(){for(const[r,d,m]of this._listeners)S.removeEventListener(r,d,r===document?this.handleWindowEvent:this.handleEvent,m)}_addDefaultHandlers(r){const d=this._map,m=d.getCanvasContainer();this._add("mapEvent",new Qr(d,r));const g=d.boxZoom=new bo(d,r);this._add("boxZoom",g),r.interactive&&r.boxZoom&&g.enable();const x=d.cooperativeGestures=new yi(d,r.cooperativeGestures);this._add("cooperativeGestures",x),r.cooperativeGestures&&x.enable();const T=new gh(d),C=new bh(d);d.doubleClickZoom=new zc(C,T),this._add("tapZoom",T),this._add("clickZoom",C),r.interactive&&r.doubleClickZoom&&d.doubleClickZoom.enable();const A=new gf;this._add("tapDragZoom",A);const F=d.touchPitch=new yh(d);this._add("touchPitch",F),r.interactive&&r.touchPitch&&d.touchPitch.enable(r.touchPitch);const j=vo(r),Z=Pc(r);d.dragRotate=new Ko(r,j,Z),this._add("mouseRotate",j,["mousePitch"]),this._add("mousePitch",Z,["mouseRotate"]),r.interactive&&r.dragRotate&&d.dragRotate.enable();const ie=(({enable:We,clickTolerance:ye})=>{const Ne=new Yt({checkCorrectEvent:qe=>S.mouseButton(qe)===0&&!qe.ctrlKey});return new cs({clickTolerance:ye,move:(qe,Ze)=>({around:Ze,panDelta:Ze.sub(qe)}),activateOnStart:!0,moveStateManager:Ne,enable:We,assignEvents:Ns})})(r),pe=new qt(r,d);d.dragPan=new Fr(m,ie,pe),this._add("mousePan",ie),this._add("touchPan",pe,["touchZoom","touchRotate"]),r.interactive&&r.dragPan&&d.dragPan.enable(r.dragPan);const fe=new Ic,ge=new Pl;d.touchZoomRotate=new ri(m,ge,fe,A),this._add("touchRotate",fe,["touchPan","touchZoom"]),this._add("touchZoom",ge,["touchPan","touchRotate"]),r.interactive&&r.touchZoomRotate&&d.touchZoomRotate.enable(r.touchZoomRotate);const le=d.scrollZoom=new Lc(d,()=>this._triggerRenderFrame());this._add("scrollZoom",le,["mousePan"]),r.interactive&&r.scrollZoom&&d.scrollZoom.enable(r.scrollZoom);const Le=d.keyboard=new Fn(d);this._add("keyboard",Le),r.interactive&&r.keyboard&&d.keyboard.enable(),this._add("blockableMapEvent",new mh(d))}_add(r,d,m){this._handlers.push({handlerName:r,handler:d,allowed:m}),this._handlersById[r]=d}stop(r){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Hs(this._eventsInProgress)||this.isZooming()}_blockedByActive(r,d,m){for(const g in r)if(g!==m&&(!d||d.indexOf(g)<0))return!0;return!1}_getMapTouches(r){const d=[];for(const m of r)this._el.contains(m.target)&&d.push(m);return d}mergeHandlerResult(r,d,m,g,x){if(!m)return;o.e(r,m);const T={handlerName:g,originalEvent:m.originalEvent||x};m.zoomDelta!==void 0&&(d.zoom=T),m.panDelta!==void 0&&(d.drag=T),m.pitchDelta!==void 0&&(d.pitch=T),m.bearingDelta!==void 0&&(d.rotate=T)}_applyChanges(){const r={},d={},m={};for(const[g,x,T]of this._changes)g.panDelta&&(r.panDelta=(r.panDelta||new o.P(0,0))._add(g.panDelta)),g.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+g.pitchDelta),g.around!==void 0&&(r.around=g.around),g.pinchAround!==void 0&&(r.pinchAround=g.pinchAround),g.noInertia&&(r.noInertia=g.noInertia),o.e(d,x),o.e(m,T);this._updateMapTransform(r,d,m),this._changes=[]}_updateMapTransform(r,d,m){const g=this._map,x=g._getTransformForUpdate(),T=g.terrain;if(!(Yo(r)||T&&this._terrainMovement))return this._fireEvents(d,m,!0);let{panDelta:C,zoomDelta:A,bearingDelta:F,pitchDelta:j,around:Z,pinchAround:ie}=r;ie!==void 0&&(Z=ie),g._stop(!0),Z=Z||g.transform.centerPoint;const pe=x.pointLocation(C?Z.sub(C):Z);F&&(x.bearing+=F),j&&(x.pitch+=j),A&&(x.zoom+=A),T?this._terrainMovement||!d.drag&&!d.zoom?d.drag&&this._terrainMovement?x.center=x.pointLocation(x.centerPoint.sub(C)):x.setLocationAtPoint(pe,Z):(this._terrainMovement=!0,this._map._elevationFreeze=!0,x.setLocationAtPoint(pe,Z),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,x.recalculateZoom(g.terrain)})):x.setLocationAtPoint(pe,Z),g._applyUpdatedTransform(x),this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(d,m,!0)}_fireEvents(r,d,m){const g=Hs(this._eventsInProgress),x=Hs(r),T={};for(const j in r){const{originalEvent:Z}=r[j];this._eventsInProgress[j]||(T[`${j}start`]=Z),this._eventsInProgress[j]=r[j]}!g&&x&&this._fireEvent("movestart",x.originalEvent);for(const j in T)this._fireEvent(j,T[j]);x&&this._fireEvent("move",x.originalEvent);for(const j in r){const{originalEvent:Z}=r[j];this._fireEvent(j,Z)}const C={};let A;for(const j in this._eventsInProgress){const{handlerName:Z,originalEvent:ie}=this._eventsInProgress[j];this._handlersById[Z].isActive()||(delete this._eventsInProgress[j],A=d[Z]||ie,C[`${j}end`]=A)}for(const j in C)this._fireEvent(j,C[j]);const F=Hs(this._eventsInProgress);if(m&&(g||x)&&!F){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Z=ie=>ie!==0&&-this._bearingSnap<ie&&ie<this._bearingSnap;!j||!j.essential&&M.prefersReducedMotion?(this._map.fire(new o.k("moveend",{originalEvent:A})),Z(this._map.getBearing())&&this._map.resetNorth()):(Z(j.bearing||this._map.getBearing())&&(j.bearing=0),j.freezeElevation=!0,this._map.easeTo(j,{originalEvent:A})),this._updatingCamera=!1}}_fireEvent(r,d){this._map.fire(new o.k(r,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{delete this._frameId,this.handleEvent(new Rc("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class vh extends o.E{constructor(r,d){super(),this._renderFrameCallback=()=>{const m=Math.min((M.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(m)),m<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=d.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new o.M(this.transform.center.lng,this.transform.center.lat)}setCenter(r,d){return this.jumpTo({center:r},d)}panBy(r,d,m){return r=o.P.convert(r).mult(-1),this.panTo(this.transform.center,o.e({offset:r},d),m)}panTo(r,d,m){return this.easeTo(o.e({center:r},d),m)}getZoom(){return this.transform.zoom}setZoom(r,d){return this.jumpTo({zoom:r},d),this}zoomTo(r,d,m){return this.easeTo(o.e({zoom:r},d),m)}zoomIn(r,d){return this.zoomTo(this.getZoom()+1,r,d),this}zoomOut(r,d){return this.zoomTo(this.getZoom()-1,r,d),this}getBearing(){return this.transform.bearing}setBearing(r,d){return this.jumpTo({bearing:r},d),this}getPadding(){return this.transform.padding}setPadding(r,d){return this.jumpTo({padding:r},d),this}rotateTo(r,d,m){return this.easeTo(o.e({bearing:r},d),m)}resetNorth(r,d){return this.rotateTo(0,o.e({duration:1e3},r),d),this}resetNorthPitch(r,d){return this.easeTo(o.e({bearing:0,pitch:0,duration:1e3},r),d),this}snapToNorth(r,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,d):this}getPitch(){return this.transform.pitch}setPitch(r,d){return this.jumpTo({pitch:r},d),this}cameraForBounds(r,d){r=Yi.convert(r);const m=d&&d.bearing||0;return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),m,d)}_cameraForBoxAndBearing(r,d,m,g){const x={top:0,bottom:0,right:0,left:0};if(typeof(g=o.e({padding:x,offset:[0,0],maxZoom:this.transform.maxZoom},g)).padding=="number"){const Gt=g.padding;g.padding={top:Gt,bottom:Gt,right:Gt,left:Gt}}g.padding=o.e(x,g.padding);const T=this.transform,C=T.padding,A=new Yi(r,d),F=T.project(A.getNorthWest()),j=T.project(A.getNorthEast()),Z=T.project(A.getSouthEast()),ie=T.project(A.getSouthWest()),pe=o.b8(-m),fe=F.rotate(pe),ge=j.rotate(pe),le=Z.rotate(pe),Le=ie.rotate(pe),We=new o.P(Math.max(fe.x,ge.x,Le.x,le.x),Math.max(fe.y,ge.y,Le.y,le.y)),ye=new o.P(Math.min(fe.x,ge.x,Le.x,le.x),Math.min(fe.y,ge.y,Le.y,le.y)),Ne=We.sub(ye),qe=(T.width-(C.left+C.right+g.padding.left+g.padding.right))/Ne.x,Ze=(T.height-(C.top+C.bottom+g.padding.top+g.padding.bottom))/Ne.y;if(Ze<0||qe<0)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Je=Math.min(T.scaleZoom(T.scale*Math.min(qe,Ze)),g.maxZoom),pt=o.P.convert(g.offset),ut=new o.P((g.padding.left-g.padding.right)/2,(g.padding.top-g.padding.bottom)/2).rotate(o.b8(m)),dt=pt.add(ut).mult(T.scale/T.zoomScale(Je));return{center:T.unproject(F.add(Z).div(2).sub(dt)),zoom:Je,bearing:m}}fitBounds(r,d,m){return this._fitInternal(this.cameraForBounds(r,d),d,m)}fitScreenCoordinates(r,d,m,g,x){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.P.convert(r)),this.transform.pointLocation(o.P.convert(d)),m,g),g,x)}_fitInternal(r,d,m){return r?(delete(d=o.e(r,d)).padding,d.linear?this.easeTo(d,m):this.flyTo(d,m)):this}jumpTo(r,d){this.stop();const m=this._getTransformForUpdate();let g=!1,x=!1,T=!1;return"zoom"in r&&m.zoom!==+r.zoom&&(g=!0,m.zoom=+r.zoom),r.center!==void 0&&(m.center=o.M.convert(r.center)),"bearing"in r&&m.bearing!==+r.bearing&&(x=!0,m.bearing=+r.bearing),"pitch"in r&&m.pitch!==+r.pitch&&(T=!0,m.pitch=+r.pitch),r.padding==null||m.isPaddingEqual(r.padding)||(m.padding=r.padding),this._applyUpdatedTransform(m),this.fire(new o.k("movestart",d)).fire(new o.k("move",d)),g&&this.fire(new o.k("zoomstart",d)).fire(new o.k("zoom",d)).fire(new o.k("zoomend",d)),x&&this.fire(new o.k("rotatestart",d)).fire(new o.k("rotate",d)).fire(new o.k("rotateend",d)),T&&this.fire(new o.k("pitchstart",d)).fire(new o.k("pitch",d)).fire(new o.k("pitchend",d)),this.fire(new o.k("moveend",d))}calculateCameraOptionsFromTo(r,d,m,g=0){const x=o.Y.fromLngLat(r,d),T=o.Y.fromLngLat(m,g),C=T.x-x.x,A=T.y-x.y,F=T.z-x.z,j=Math.hypot(C,A,F);if(j===0)throw new Error("Can't calculate camera options with same From and To");const Z=Math.hypot(C,A),ie=this.transform.scaleZoom(this.transform.cameraToCenterDistance/j/this.transform.tileSize),pe=180*Math.atan2(C,-A)/Math.PI;let fe=180*Math.acos(Z/j)/Math.PI;return fe=F<0?90-fe:90+fe,{center:T.toLngLat(),zoom:ie,pitch:fe,bearing:pe}}easeTo(r,d){var m;this._stop(!1,r.easeId),((r=o.e({offset:[0,0],duration:500,easing:o.b7},r)).animate===!1||!r.essential&&M.prefersReducedMotion)&&(r.duration=0);const g=this._getTransformForUpdate(),x=this.getZoom(),T=this.getBearing(),C=this.getPitch(),A=this.getPadding(),F="bearing"in r?this._normalizeBearing(r.bearing,T):T,j="pitch"in r?+r.pitch:C,Z="padding"in r?r.padding:g.padding,ie=o.P.convert(r.offset);let pe=g.centerPoint.add(ie);const fe=g.pointLocation(pe),{center:ge,zoom:le}=g.getConstrained(o.M.convert(r.center||fe),(m=r.zoom)!==null&&m!==void 0?m:x);this._normalizeCenter(ge);const Le=g.project(fe),We=g.project(ge).sub(Le),ye=g.zoomScale(le-x);let Ne,qe;r.around&&(Ne=o.M.convert(r.around),qe=g.locationPoint(Ne));const Ze={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||le!==x,this._rotating=this._rotating||T!==F,this._pitching=this._pitching||j!==C,this._padding=!g.isPaddingEqual(Z),this._easeId=r.easeId,this._prepareEase(d,r.noMoveStart,Ze),this.terrain&&this._prepareElevation(ge),this._ease(Je=>{if(this._zooming&&(g.zoom=o.z.number(x,le,Je)),this._rotating&&(g.bearing=o.z.number(T,F,Je)),this._pitching&&(g.pitch=o.z.number(C,j,Je)),this._padding&&(g.interpolatePadding(A,Z,Je),pe=g.centerPoint.add(ie)),this.terrain&&!r.freezeElevation&&this._updateElevation(Je),Ne)g.setLocationAtPoint(Ne,qe);else{const pt=g.zoomScale(g.zoom-x),ut=le>x?Math.min(2,ye):Math.max(.5,ye),dt=Math.pow(ut,1-Je),Gt=g.unproject(Le.add(We.mult(Je*dt)).mult(pt));g.setLocationAtPoint(g.renderWorldCopies?Gt.wrap():Gt,pe)}this._applyUpdatedTransform(g),this._fireMoveEvents(d)},Je=>{this.terrain&&this._finalizeElevation(),this._afterEase(d,Je)},r),this}_prepareEase(r,d,m={}){this._moving=!0,d||m.moving||this.fire(new o.k("movestart",r)),this._zooming&&!m.zooming&&this.fire(new o.k("zoomstart",r)),this._rotating&&!m.rotating&&this.fire(new o.k("rotatestart",r)),this._pitching&&!m.pitching&&this.fire(new o.k("pitchstart",r))}_prepareElevation(r){this._elevationCenter=r,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(r){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const d=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(r<1&&d!==this._elevationTarget){const m=this._elevationTarget-this._elevationStart;this._elevationStart+=r*(m-(d-(m*r+this._elevationStart))/(1-r)),this._elevationTarget=d}this.transform.elevation=o.z.number(this._elevationStart,this._elevationTarget,r)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(r){if(!this.transformCameraUpdate)return;const d=r.clone(),{center:m,zoom:g,pitch:x,bearing:T,elevation:C}=this.transformCameraUpdate(d);m&&(d.center=m),g!==void 0&&(d.zoom=g),x!==void 0&&(d.pitch=x),T!==void 0&&(d.bearing=T),C!==void 0&&(d.elevation=C),this.transform.apply(d)}_fireMoveEvents(r){this.fire(new o.k("move",r)),this._zooming&&this.fire(new o.k("zoom",r)),this._rotating&&this.fire(new o.k("rotate",r)),this._pitching&&this.fire(new o.k("pitch",r))}_afterEase(r,d){if(this._easeId&&d&&this._easeId===d)return;delete this._easeId;const m=this._zooming,g=this._rotating,x=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new o.k("zoomend",r)),g&&this.fire(new o.k("rotateend",r)),x&&this.fire(new o.k("pitchend",r)),this.fire(new o.k("moveend",r))}flyTo(r,d){var m;if(!r.essential&&M.prefersReducedMotion){const an=o.L(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(an,d)}this.stop(),r=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.b7},r);const g=this._getTransformForUpdate(),x=this.getZoom(),T=this.getBearing(),C=this.getPitch(),A=this.getPadding(),F="bearing"in r?this._normalizeBearing(r.bearing,T):T,j="pitch"in r?+r.pitch:C,Z="padding"in r?r.padding:g.padding,ie=o.P.convert(r.offset);let pe=g.centerPoint.add(ie);const fe=g.pointLocation(pe),{center:ge,zoom:le}=g.getConstrained(o.M.convert(r.center||fe),(m=r.zoom)!==null&&m!==void 0?m:x);this._normalizeCenter(ge);const Le=g.zoomScale(le-x),We=g.project(fe),ye=g.project(ge).sub(We);let Ne=r.curve;const qe=Math.max(g.width,g.height),Ze=qe/Le,Je=ye.mag();if("minZoom"in r){const an=o.ac(Math.min(r.minZoom,x,le),g.minZoom,g.maxZoom),Di=qe/g.zoomScale(an-x);Ne=Math.sqrt(Di/Je*2)}const pt=Ne*Ne;function ut(an){const Di=(Ze*Ze-qe*qe+(an?-1:1)*pt*pt*Je*Je)/(2*(an?Ze:qe)*pt*Je);return Math.log(Math.sqrt(Di*Di+1)-Di)}function dt(an){return(Math.exp(an)-Math.exp(-an))/2}function Gt(an){return(Math.exp(an)+Math.exp(-an))/2}const Ri=ut(!1);let Pt=function(an){return Gt(Ri)/Gt(Ri+Ne*an)},wi=function(an){return qe*((Gt(Ri)*(dt(Di=Ri+Ne*an)/Gt(Di))-dt(Ri))/pt)/Je;var Di},Bi=(ut(!0)-Ri)/Ne;if(Math.abs(Je)<1e-6||!isFinite(Bi)){if(Math.abs(qe-Ze)<1e-6)return this.easeTo(r,d);const an=Ze<qe?-1:1;Bi=Math.abs(Math.log(Ze/qe))/Ne,wi=function(){return 0},Pt=function(Di){return Math.exp(an*Ne*Di)}}return r.duration="duration"in r?+r.duration:1e3*Bi/("screenSpeed"in r?+r.screenSpeed/Ne:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0),this._zooming=!0,this._rotating=T!==F,this._pitching=j!==C,this._padding=!g.isPaddingEqual(Z),this._prepareEase(d,!1),this.terrain&&this._prepareElevation(ge),this._ease(an=>{const Di=an*Bi,Vi=1/Pt(Di);g.zoom=an===1?le:x+g.scaleZoom(Vi),this._rotating&&(g.bearing=o.z.number(T,F,an)),this._pitching&&(g.pitch=o.z.number(C,j,an)),this._padding&&(g.interpolatePadding(A,Z,an),pe=g.centerPoint.add(ie)),this.terrain&&!r.freezeElevation&&this._updateElevation(an);const Hi=an===1?ge:g.unproject(We.add(ye.mult(wi(Di))).mult(Vi));g.setLocationAtPoint(g.renderWorldCopies?Hi.wrap():Hi,pe),this._applyUpdatedTransform(g),this._fireMoveEvents(d)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(d)},r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const m=this._onEaseEnd;delete this._onEaseEnd,m.call(this,d)}if(!r){const m=this.handlers;m&&m.stop(!1)}return this}_ease(r,d,m){m.animate===!1||m.duration===0?(r(1),d()):(this._easeStart=M.now(),this._easeOptions=m,this._onEaseFrame=r,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(r,d){r=o.b1(r,-180,180);const m=Math.abs(r-d);return Math.abs(r-360-d)<m&&(r-=360),Math.abs(r+360-d)<m&&(r+=360),r}_normalizeCenter(r){const d=this.transform;if(!d.renderWorldCopies||d.lngRange)return;const m=r.lng-d.center.lng;r.lng+=m>180?-360:m<-180?360:0}queryTerrainElevation(r){return this.terrain?this.terrain.getElevationForLngLatZoom(o.M.convert(r),this.transform.tileZoom)-this.transform.elevation:null}}const Or={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class xh{constructor(r=Or){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=d=>{!d||d.sourceDataType!=="metadata"&&d.sourceDataType!=="visibility"&&d.dataType!=="style"&&d.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=r}getDefaultPosition(){return"bottom-right"}onAdd(r){return this._map=r,this._compact=this.options.compact,this._container=S.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=S.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=S.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){S.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(r,d){const m=this._map._getUIString(`AttributionControl.${d}`);r.title=m,r.setAttribute("aria-label",m)}_updateAttributions(){if(!this._map.style)return;let r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(g=>typeof g!="string"?"":g)):typeof this.options.customAttribution=="string"&&r.push(this.options.customAttribution)),this._map.style.stylesheet){const g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}const d=this._map.style.sourceCaches;for(const g in d){const x=d[g];if(x.used||x.usedForTerrain){const T=x.getSource();T.attribution&&r.indexOf(T.attribution)<0&&r.push(T.attribution)}}r=r.filter(g=>String(g).trim()),r.sort((g,x)=>g.length-x.length),r=r.filter((g,x)=>{for(let T=x+1;T<r.length;T++)if(r[T].indexOf(g)>=0)return!1;return!0});const m=r.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,r.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class xo{constructor(r={}){this._updateCompact=()=>{const d=this._container.children;if(d.length){const m=d[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&m.classList.add("maplibregl-compact"):m.classList.remove("maplibregl-compact")}},this.options=r}getDefaultPosition(){return"bottom-left"}onAdd(r){this._map=r,this._compact=this.options&&this.options.compact,this._container=S.create("div","maplibregl-ctrl");const d=S.create("a","maplibregl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://maplibre.org/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){S.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Qn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const d=++this._id;return this._queue.push({callback:r,id:d,cancelled:!1}),d}remove(r){const d=this._currentlyRunning,m=d?this._queue.concat(d):this._queue;for(const g of m)if(g.id===r)return void(g.cancelled=!0)}run(r=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const d=this._currentlyRunning=this._queue;this._queue=[];for(const m of d)if(!m.cancelled&&(m.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var ha=o.X([{name:"a_pos3d",type:"Int16",components:3}]);class wh extends o.E{constructor(r){super(),this.sourceCache=r,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,r.usedForTerrain=!0,r.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(r,d){this.sourceCache.update(r,d),this._renderableTilesKeys=[];const m={};for(const g of r.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:d}))m[g.key]=!0,this._renderableTilesKeys.push(g.key),this._tiles[g.key]||(g.posMatrix=new Float64Array(16),o.aN(g.posMatrix,0,o.W,0,o.W,0,1),this._tiles[g.key]=new hn(g,this.tileSize));for(const g in this._tiles)m[g]||delete this._tiles[g]}freeRtt(r){for(const d in this._tiles){const m=this._tiles[d];(!r||m.tileID.equals(r)||m.tileID.isChildOf(r)||r.isChildOf(m.tileID))&&(m.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(r=>this.getTileByID(r))}getTileByID(r){return this._tiles[r]}getTerrainCoords(r){const d={};for(const m of this._renderableTilesKeys){const g=this._tiles[m].tileID;if(g.canonical.equals(r.canonical)){const x=r.clone();x.posMatrix=new Float64Array(16),o.aN(x.posMatrix,0,o.W,0,o.W,0,1),d[m]=x}else if(g.canonical.isChildOf(r.canonical)){const x=r.clone();x.posMatrix=new Float64Array(16);const T=g.canonical.z-r.canonical.z,C=g.canonical.x-(g.canonical.x>>T<<T),A=g.canonical.y-(g.canonical.y>>T<<T),F=o.W>>T;o.aN(x.posMatrix,0,F,0,F,0,1),o.H(x.posMatrix,x.posMatrix,[-C*F,-A*F,0]),d[m]=x}else if(r.canonical.isChildOf(g.canonical)){const x=r.clone();x.posMatrix=new Float64Array(16);const T=r.canonical.z-g.canonical.z,C=r.canonical.x-(r.canonical.x>>T<<T),A=r.canonical.y-(r.canonical.y>>T<<T),F=o.W>>T;o.aN(x.posMatrix,0,o.W,0,o.W,0,1),o.H(x.posMatrix,x.posMatrix,[C*F,A*F,0]),o.J(x.posMatrix,x.posMatrix,[1/2**T,1/2**T,0]),d[m]=x}}return d}getSourceTile(r,d){const m=this.sourceCache._source;let g=r.overscaledZ-this.deltaZoom;if(g>m.maxzoom&&(g=m.maxzoom),g<m.minzoom)return null;this._sourceTileCache[r.key]||(this._sourceTileCache[r.key]=r.scaledTo(g).key);let x=this.sourceCache.getTileByID(this._sourceTileCache[r.key]);if((!x||!x.dem)&&d)for(;g>=m.minzoom&&(!x||!x.dem);)x=this.sourceCache.getTileByID(r.scaledTo(g--).key);return x}tilesAfterTime(r=Date.now()){return Object.values(this._tiles).filter(d=>d.timeAdded>=r)}}class Jo{constructor(r,d,m){this.painter=r,this.sourceCache=new wh(d),this.options=m,this.exaggeration=typeof m.exaggeration=="number"?m.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(r,d,m,g=o.W){var x;if(!(d>=0&&d<g&&m>=0&&m<g))return 0;const T=this.getTerrainData(r),C=(x=T.tile)===null||x===void 0?void 0:x.dem;if(!C)return 0;const A=function(fe,ge,le){var Le=ge[0],We=ge[1];return fe[0]=le[0]*Le+le[4]*We+le[12],fe[1]=le[1]*Le+le[5]*We+le[13],fe}([],[d/g*o.W,m/g*o.W],T.u_terrain_matrix),F=[A[0]*C.dim,A[1]*C.dim],j=Math.floor(F[0]),Z=Math.floor(F[1]),ie=F[0]-j,pe=F[1]-Z;return C.get(j,Z)*(1-ie)*(1-pe)+C.get(j+1,Z)*ie*(1-pe)+C.get(j,Z+1)*(1-ie)*pe+C.get(j+1,Z+1)*ie*pe}getElevationForLngLatZoom(r,d){const{tileID:m,mercatorX:g,mercatorY:x}=this._getOverscaledTileIDFromLngLatZoom(r,d);return this.getElevation(m,g%o.W,x%o.W,o.W)}getElevation(r,d,m,g=o.W){return this.getDEMElevation(r,d,m,g)*this.exaggeration}getTerrainData(r){if(!this._emptyDemTexture){const g=this.painter.context,x=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Ye(g,x,g.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Ye(g,new o.R({width:1,height:1}),g.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.an([])}const d=this.sourceCache.getSourceTile(r,!0);if(d&&d.dem&&(!d.demTexture||d.needsTerrainPrepare)){const g=this.painter.context;d.demTexture=this.painter.getTileTexture(d.dem.stride),d.demTexture?d.demTexture.update(d.dem.getPixels(),{premultiply:!1}):d.demTexture=new Ye(g,d.dem.getPixels(),g.gl.RGBA,{premultiply:!1}),d.demTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),d.needsTerrainPrepare=!1}const m=d&&d+d.tileID.key+r.key;if(m&&!this._demMatrixCache[m]){const g=this.sourceCache.sourceCache._source.maxzoom;let x=r.canonical.z-d.tileID.canonical.z;r.overscaledZ>r.canonical.z&&(r.canonical.z>=g?x=r.canonical.z-g:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const T=r.canonical.x-(r.canonical.x>>x<<x),C=r.canonical.y-(r.canonical.y>>x<<x),A=o.b9(new Float64Array(16),[1/(o.W<<x),1/(o.W<<x),0]);o.H(A,A,[T*o.W,C*o.W,0]),this._demMatrixCache[r.key]={matrix:A,coord:r}}return{u_depth:2,u_terrain:3,u_terrain_dim:d&&d.dem&&d.dem.dim||1,u_terrain_matrix:m?this._demMatrixCache[r.key].matrix:this._emptyDemMatrix,u_terrain_unpack:d&&d.dem&&d.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(d&&d.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:d}}getFramebuffer(r){const d=this.painter,m=d.width/devicePixelRatio,g=d.height/devicePixelRatio;return!this._fbo||this._fbo.width===m&&this._fbo.height===g||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Ye(d.context,{width:m,height:g,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Ye(d.context,{width:m,height:g,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=d.context.createFramebuffer(m,g,!0,!1),this._fbo.depthAttachment.set(d.context.createRenderbuffer(d.context.gl.DEPTH_COMPONENT16,m,g))),this._fbo.colorAttachment.set(r==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const r=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const d=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let x=0,T=0;x<this._coordsTextureSize;x++)for(let C=0;C<this._coordsTextureSize;C++,T+=4)d[T+0]=255&C,d[T+1]=255&x,d[T+2]=C>>8<<4|x>>8,d[T+3]=0;const m=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(d.buffer)),g=new Ye(r,m,r.gl.RGBA,{premultiply:!1});return g.bind(r.gl.NEAREST,r.gl.CLAMP_TO_EDGE),this._coordsTexture=g,g}pointCoordinate(r){this.painter.maybeDrawDepthAndCoords(!0);const d=new Uint8Array(4),m=this.painter.context,g=m.gl;m.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),g.readPixels(r.x,this.painter.height/devicePixelRatio-r.y-1,1,1,g.RGBA,g.UNSIGNED_BYTE,d),m.bindFramebuffer.set(null);const x=d[0]+(d[2]>>4<<8),T=d[1]+((15&d[2])<<8),C=this.coordsIndex[255-d[3]],A=C&&this.sourceCache.getTileByID(C);if(!A)return null;const F=this._coordsTextureSize,j=(1<<A.tileID.canonical.z)*F;return new o.Y((A.tileID.canonical.x*F+x)/j+A.tileID.wrap,(A.tileID.canonical.y*F+T)/j,this.getElevation(A.tileID,x,T,F))}depthAtPoint(r){const d=new Uint8Array(4),m=this.painter.context,g=m.gl;return m.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),g.readPixels(r.x,this.painter.height/devicePixelRatio-r.y-1,1,1,g.RGBA,g.UNSIGNED_BYTE,d),m.bindFramebuffer.set(null),(d[0]/16777216+d[1]/65536+d[2]/256+d[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const r=this.painter.context,d=new o.ba,m=new o.aX,g=this.meshSize,x=o.W/g,T=g*g;for(let Z=0;Z<=g;Z++)for(let ie=0;ie<=g;ie++)d.emplaceBack(ie*x,Z*x,0);for(let Z=0;Z<T;Z+=g+1)for(let ie=0;ie<g;ie++)m.emplaceBack(ie+Z,g+ie+Z+1,g+ie+Z+2),m.emplaceBack(ie+Z,g+ie+Z+2,ie+Z+1);const C=d.length,A=C+2*(g+1);for(const Z of[0,1])for(let ie=0;ie<=g;ie++)for(const pe of[0,1])d.emplaceBack(ie*x,Z*o.W,pe);for(let Z=0;Z<2*g;Z+=2)m.emplaceBack(A+Z,A+Z+1,A+Z+3),m.emplaceBack(A+Z,A+Z+3,A+Z+2),m.emplaceBack(C+Z,C+Z+3,C+Z+1),m.emplaceBack(C+Z,C+Z+2,C+Z+3);const F=d.length,j=F+2*(g+1);for(const Z of[0,1])for(let ie=0;ie<=g;ie++)for(const pe of[0,1])d.emplaceBack(Z*o.W,ie*x,pe);for(let Z=0;Z<2*g;Z+=2)m.emplaceBack(F+Z,F+Z+1,F+Z+3),m.emplaceBack(F+Z,F+Z+3,F+Z+2),m.emplaceBack(j+Z,j+Z+3,j+Z+1),m.emplaceBack(j+Z,j+Z+2,j+Z+3);return this._mesh={indexBuffer:r.createIndexBuffer(m),vertexBuffer:r.createVertexBuffer(d,ha.members),segments:o.$.simpleSegment(0,0,d.length,m.length)},this._mesh}getMeshFrameDelta(r){return 2*Math.PI*o.bb/Math.pow(2,r)/5}getMinTileElevationForLngLatZoom(r,d){var m;const{tileID:g}=this._getOverscaledTileIDFromLngLatZoom(r,d);return(m=this.getMinMaxElevation(g).minElevation)!==null&&m!==void 0?m:0}getMinMaxElevation(r){const d=this.getTerrainData(r).tile,m={minElevation:null,maxElevation:null};return d&&d.dem&&(m.minElevation=d.dem.min*this.exaggeration,m.maxElevation=d.dem.max*this.exaggeration),m}_getOverscaledTileIDFromLngLatZoom(r,d){const m=o.Y.fromLngLat(r.wrap()),g=(1<<d)*o.W,x=m.x*g,T=m.y*g,C=Math.floor(x/o.W),A=Math.floor(T/o.W);return{tileID:new o.Q(d,0,d,C,A),mercatorX:x,mercatorY:T}}}class El{constructor(r,d,m){this._context=r,this._size=d,this._tileSize=m,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const r of this._objects)r.texture.destroy(),r.fbo.destroy()}_createObject(r){const d=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),m=new Ye(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return m.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),d.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),d.colorAttachment.set(m.texture),{id:r,fbo:d,texture:m,stamp:-1,inUse:!1}}getObjectForId(r){return this._objects[r]}useObject(r){r.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(d=>r.id!==d),this._recentlyUsed.push(r.id)}stampObject(r){r.stamp=++this._stamp}getOrCreateFreeObject(){for(const d of this._recentlyUsed)if(!this._objects[d].inUse)return this._objects[d];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const r=this._createObject(this._objects.length);return this._objects.push(r),r}freeObject(r){r.inUse=!1}freeAllObjects(){for(const r of this._objects)this.freeObject(r)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(r=>!r.inUse)===!1}}const Ms={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Fc{constructor(r,d){this.painter=r,this.terrain=d,this.pool=new El(r.context,30,d.sourceCache.tileSize*d.qualityFactor)}destruct(){this.pool.destruct()}getTexture(r){return this.pool.getObjectForId(r.rtt[this._stacks.length-1].id).texture}prepareForRender(r,d){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=r._order.filter(m=>!r._layers[m].isHidden(d)),this._coordsDescendingInv={};for(const m in r.sourceCaches){this._coordsDescendingInv[m]={};const g=r.sourceCaches[m].getVisibleCoordinates();for(const x of g){const T=this.terrain.sourceCache.getTerrainCoords(x);for(const C in T)this._coordsDescendingInv[m][C]||(this._coordsDescendingInv[m][C]=[]),this._coordsDescendingInv[m][C].push(T[C])}}this._coordsDescendingInvStr={};for(const m of r._order){const g=r._layers[m],x=g.source;if(Ms[g.type]&&!this._coordsDescendingInvStr[x]){this._coordsDescendingInvStr[x]={};for(const T in this._coordsDescendingInv[x])this._coordsDescendingInvStr[x][T]=this._coordsDescendingInv[x][T].map(C=>C.key).sort().join()}}for(const m of this._renderableTiles)for(const g in this._coordsDescendingInvStr){const x=this._coordsDescendingInvStr[g][m.tileID.key];x&&x!==m.rttCoords[g]&&(m.rtt=[])}}renderLayer(r){if(r.isHidden(this.painter.transform.zoom))return!1;const d=r.type,m=this.painter,g=this._renderableLayerIds[this._renderableLayerIds.length-1]===r.id;if(Ms[d]&&(this._prevType&&Ms[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(r.id),!g))return!0;if(Ms[this._prevType]||Ms[d]&&g){this._prevType=d;const x=this._stacks.length-1,T=this._stacks[x]||[];for(const C of this._renderableTiles){if(this.pool.isFull()&&(wc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(C),C.rtt[x]){const F=this.pool.getObjectForId(C.rtt[x].id);if(F.stamp===C.rtt[x].stamp){this.pool.useObject(F);continue}}const A=this.pool.getOrCreateFreeObject();this.pool.useObject(A),this.pool.stampObject(A),C.rtt[x]={id:A.id,stamp:A.stamp},m.context.bindFramebuffer.set(A.fbo.framebuffer),m.context.clear({color:o.aO.transparent,stencil:0}),m.currentStencilSource=void 0;for(let F=0;F<T.length;F++){const j=m.style._layers[T[F]],Z=j.source?this._coordsDescendingInv[j.source][C.tileID.key]:[C.tileID];m.context.viewport.set([0,0,A.fbo.width,A.fbo.height]),m._renderTileClippingMasks(j,Z),m.renderLayer(m,m.style.sourceCaches[j.source],j,Z),j.source&&(C.rttCoords[j.source]=this._coordsDescendingInvStr[j.source][C.tileID.key])}}return wc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Ms[d]}return!1}}const Oc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Xo=p,Bc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:Or,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.a.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Ll=b=>{b.touchstart=b.dragStart,b.touchmoveWindow=b.dragMove,b.touchend=b.dragEnd},Nc={showCompass:!0,showZoom:!0,visualizePitch:!1};class Vc{constructor(r,d,m=!1){this.mousedown=T=>{this.startMouse(o.e({},T,{ctrlKey:!0,preventDefault:()=>T.preventDefault()}),S.mousePos(this.element,T)),S.addEventListener(window,"mousemove",this.mousemove),S.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=T=>{this.moveMouse(T,S.mousePos(this.element,T))},this.mouseup=T=>{this.mouseRotate.dragEnd(T),this.mousePitch&&this.mousePitch.dragEnd(T),this.offTemp()},this.touchstart=T=>{T.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=S.touchPos(this.element,T.targetTouches)[0],this.startTouch(T,this._startPos),S.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),S.addEventListener(window,"touchend",this.touchend))},this.touchmove=T=>{T.targetTouches.length!==1?this.reset():(this._lastPos=S.touchPos(this.element,T.targetTouches)[0],this.moveTouch(T,this._lastPos))},this.touchend=T=>{T.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const g=r.dragRotate._mouseRotate.getClickTolerance(),x=r.dragRotate._mousePitch.getClickTolerance();this.element=d,this.mouseRotate=vo({clickTolerance:g,enable:!0}),this.touchRotate=(({enable:T,clickTolerance:C,bearingDegreesPerPixelMoved:A=.8})=>{const F=new Cc;return new cs({clickTolerance:C,move:(j,Z)=>({bearingDelta:(Z.x-j.x)*A}),moveStateManager:F,enable:T,assignEvents:Ll})})({clickTolerance:g,enable:!0}),this.map=r,m&&(this.mousePitch=Pc({clickTolerance:x,enable:!0}),this.touchPitch=(({enable:T,clickTolerance:C,pitchDegreesPerPixelMoved:A=-.5})=>{const F=new Cc;return new cs({clickTolerance:C,move:(j,Z)=>({pitchDelta:(Z.y-j.y)*A}),moveStateManager:F,enable:T,assignEvents:Ll})})({clickTolerance:x,enable:!0})),S.addEventListener(d,"mousedown",this.mousedown),S.addEventListener(d,"touchstart",this.touchstart,{passive:!1}),S.addEventListener(d,"touchcancel",this.reset)}startMouse(r,d){this.mouseRotate.dragStart(r,d),this.mousePitch&&this.mousePitch.dragStart(r,d),S.disableDrag()}startTouch(r,d){this.touchRotate.dragStart(r,d),this.touchPitch&&this.touchPitch.dragStart(r,d),S.disableDrag()}moveMouse(r,d){const m=this.map,{bearingDelta:g}=this.mouseRotate.dragMove(r,d)||{};if(g&&m.setBearing(m.getBearing()+g),this.mousePitch){const{pitchDelta:x}=this.mousePitch.dragMove(r,d)||{};x&&m.setPitch(m.getPitch()+x)}}moveTouch(r,d){const m=this.map,{bearingDelta:g}=this.touchRotate.dragMove(r,d)||{};if(g&&m.setBearing(m.getBearing()+g),this.touchPitch){const{pitchDelta:x}=this.touchPitch.dragMove(r,d)||{};x&&m.setPitch(m.getPitch()+x)}}off(){const r=this.element;S.removeEventListener(r,"mousedown",this.mousedown),S.removeEventListener(r,"touchstart",this.touchstart,{passive:!1}),S.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),S.removeEventListener(window,"touchend",this.touchend),S.removeEventListener(r,"touchcancel",this.reset),this.offTemp()}offTemp(){S.enableDrag(),S.removeEventListener(window,"mousemove",this.mousemove),S.removeEventListener(window,"mouseup",this.mouseup),S.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),S.removeEventListener(window,"touchend",this.touchend)}}let us;function zl(b,r,d){const m=new o.M(b.lng,b.lat);if(b=new o.M(b.lng,b.lat),r){const g=new o.M(b.lng-360,b.lat),x=new o.M(b.lng+360,b.lat),T=d.locationPoint(b).distSqr(r);d.locationPoint(g).distSqr(r)<T?b=g:d.locationPoint(x).distSqr(r)<T&&(b=x)}for(;Math.abs(b.lng-d.center.lng)>180;){const g=d.locationPoint(b);if(g.x>=0&&g.y>=0&&g.x<=d.width&&g.y<=d.height)break;b.lng>d.center.lng?b.lng-=360:b.lng+=360}return b.lng!==m.lng&&d.locationPoint(b).y>d.height/2-d.getHorizon()?b:m}const Qo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Rl(b,r,d){const m=b.classList;for(const g in Qo)m.remove(`maplibregl-${d}-anchor-${g}`);m.add(`maplibregl-${d}-anchor-${r}`)}class wo extends o.E{constructor(r){if(super(),this._onKeyPress=d=>{const m=d.code,g=d.charCode||d.keyCode;m!=="Space"&&m!=="Enter"&&g!==32&&g!==13||this.togglePopup()},this._onMapClick=d=>{const m=d.originalEvent.target,g=this._element;this._popup&&(m===g||g.contains(m))&&this.togglePopup()},this._update=d=>{var m;if(!this._map)return;const g=this._map.loaded()&&!this._map.isMoving();((d==null?void 0:d.type)==="terrain"||(d==null?void 0:d.type)==="render"&&!g)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?zl(this._lngLat,this._flatPos,this._map.transform):(m=this._lngLat)===null||m===void 0?void 0:m.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let x="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?x=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(x=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let T="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?T="rotateX(0deg)":this._pitchAlignment==="map"&&(T=`rotateX(${this._map.getPitch()}deg)`),d&&d.type!=="moveend"||(this._pos=this._pos.round()),S.setTransform(this._element,`${Qo[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${T} ${x}`),M.frameAsync(new AbortController).then(()=>{this._updateOpacity(d&&d.type==="moveend")}).catch(()=>{})},this._onMove=d=>{if(!this._isDragging){const m=this._clickTolerance||this._map._clickTolerance;this._isDragging=d.point.dist(this._pointerdownPos)>=m}this._isDragging&&(this._pos=d.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.k("dragstart"))),this.fire(new o.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.k("dragend")),this._state="inactive"},this._addDragHandler=d=>{this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(this._pos).add(this._offset),this._pointerdownPos=d.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment!=="auto"?r.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(r==null?void 0:r.opacity,r==null?void 0:r.opacityWhenCovered),r&&r.element)this._element=r.element,this._offset=o.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=S.create("div"),this._element.setAttribute("aria-label","Map marker");const d=S.createNS("http://www.w3.org/2000/svg","svg"),m=41,g=27;d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height",`${m}px`),d.setAttributeNS(null,"width",`${g}px`),d.setAttributeNS(null,"viewBox",`0 0 ${g} ${m}`);const x=S.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const T=S.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"fill-rule","nonzero");const C=S.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"transform","translate(3.0, 29.0)"),C.setAttributeNS(null,"fill","#000000");const A=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Le of A){const We=S.createNS("http://www.w3.org/2000/svg","ellipse");We.setAttributeNS(null,"opacity","0.04"),We.setAttributeNS(null,"cx","10.5"),We.setAttributeNS(null,"cy","5.80029008"),We.setAttributeNS(null,"rx",Le.rx),We.setAttributeNS(null,"ry",Le.ry),C.appendChild(We)}const F=S.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"fill",this._color);const j=S.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),F.appendChild(j);const Z=S.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"opacity","0.25"),Z.setAttributeNS(null,"fill","#000000");const ie=S.createNS("http://www.w3.org/2000/svg","path");ie.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Z.appendChild(ie);const pe=S.createNS("http://www.w3.org/2000/svg","g");pe.setAttributeNS(null,"transform","translate(6.0, 7.0)"),pe.setAttributeNS(null,"fill","#FFFFFF");const fe=S.createNS("http://www.w3.org/2000/svg","g");fe.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ge=S.createNS("http://www.w3.org/2000/svg","circle");ge.setAttributeNS(null,"fill","#000000"),ge.setAttributeNS(null,"opacity","0.25"),ge.setAttributeNS(null,"cx","5.5"),ge.setAttributeNS(null,"cy","5.5"),ge.setAttributeNS(null,"r","5.4999962");const le=S.createNS("http://www.w3.org/2000/svg","circle");le.setAttributeNS(null,"fill","#FFFFFF"),le.setAttributeNS(null,"cx","5.5"),le.setAttributeNS(null,"cy","5.5"),le.setAttributeNS(null,"r","5.4999962"),fe.appendChild(ge),fe.appendChild(le),T.appendChild(C),T.appendChild(F),T.appendChild(Z),T.appendChild(pe),T.appendChild(fe),d.appendChild(T),d.setAttributeNS(null,"height",m*this._scale+"px"),d.setAttributeNS(null,"width",g*this._scale+"px"),this._element.appendChild(d),this._offset=o.P.convert(r&&r.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",d=>{d.preventDefault()}),this._element.addEventListener("mousedown",d=>{d.preventDefault()}),Rl(this._element,this._anchor,"marker"),r&&r.className)for(const d of r.className.split(" "))this._element.classList.add(d);this._popup=null}addTo(r){return this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._update),r.on("moveend",this._update),r.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),S.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=o.M.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const g=Math.abs(13.5)/Math.SQRT2;r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(38.1-13.5+g)],"bottom-right":[-g,-1*(38.1-13.5+g)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const r=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:r?(r.isOpen()?r.remove():(r.setLngLat(this._lngLat),r.addTo(this._map)),this):this}_updateOpacity(r=!1){var d,m;if(!(!((d=this._map)===null||d===void 0)&&d.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(r)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const g=this._map,x=g.terrain.depthAtPoint(this._pos),T=g.terrain.getElevationForLngLatZoom(this._lngLat,g.transform.tileZoom);if(g.transform.lngLatToCameraDepth(this._lngLat,T)-x<.006)return void(this._element.style.opacity=this._opacity);const C=-this._offset.y/g.transform._pixelPerMeter,A=Math.sin(g.getPitch()*Math.PI/180)*C,F=g.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),j=g.transform.lngLatToCameraDepth(this._lngLat,T+A)-F>.006;!((m=this._popup)===null||m===void 0)&&m.isOpen()&&j&&this._popup.remove(),this._element.style.opacity=j?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(r){return this._offset=o.P.convert(r),this._update(),this}addClassName(r){this._element.classList.add(r)}removeClassName(r){this._element.classList.remove(r)}toggleClassName(r){return this._element.classList.toggle(r)}setDraggable(r){return this._draggable=!!r,this._map&&(r?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r&&r!=="auto"?r:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(r,d){return r===void 0&&d===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),r!==void 0&&(this._opacity=r),d!==void 0&&(this._opacityWhenCovered=d),this._map&&this._updateOpacity(!0),this}}const Hc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ko=0,Ds=!1;const jc={maxWidth:100,unit:"metric"};function Fl(b,r,d){const m=d&&d.maxWidth||100,g=b._container.clientHeight/2,x=b.unproject([0,g]),T=b.unproject([m,g]),C=x.distanceTo(T);if(d&&d.unit==="imperial"){const A=3.2808*C;A>5280?js(r,m,A/5280,b._getUIString("ScaleControl.Miles")):js(r,m,A,b._getUIString("ScaleControl.Feet"))}else d&&d.unit==="nautical"?js(r,m,C/1852,b._getUIString("ScaleControl.NauticalMiles")):C>=1e3?js(r,m,C/1e3,b._getUIString("ScaleControl.Kilometers")):js(r,m,C,b._getUIString("ScaleControl.Meters"))}function js(b,r,d,m){const g=function(x){const T=Math.pow(10,`${Math.floor(x)}`.length-1);let C=x/T;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(A){const F=Math.pow(10,Math.ceil(-Math.log(A)/Math.LN10));return Math.round(A*F)/F}(C),T*C}(d);b.style.width=r*(g/d)+"px",b.innerHTML=`${g}&nbsp;${m}`}const Uc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Wc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function qc(b){if(b){if(typeof b=="number"){const r=Math.round(Math.abs(b)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,b),"top-left":new o.P(r,r),"top-right":new o.P(-r,r),bottom:new o.P(0,-b),"bottom-left":new o.P(r,-r),"bottom-right":new o.P(-r,-r),left:new o.P(b,0),right:new o.P(-b,0)}}if(b instanceof o.P||Array.isArray(b)){const r=o.P.convert(b);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:o.P.convert(b.center||[0,0]),top:o.P.convert(b.top||[0,0]),"top-left":o.P.convert(b["top-left"]||[0,0]),"top-right":o.P.convert(b["top-right"]||[0,0]),bottom:o.P.convert(b.bottom||[0,0]),"bottom-left":o.P.convert(b["bottom-left"]||[0,0]),"bottom-right":o.P.convert(b["bottom-right"]||[0,0]),left:o.P.convert(b.left||[0,0]),right:o.P.convert(b.right||[0,0])}}return qc(new o.P(0,0))}const kh=p;u.AJAXError=o.be,u.Evented=o.E,u.LngLat=o.M,u.MercatorCoordinate=o.Y,u.Point=o.P,u.addProtocol=o.bf,u.config=o.a,u.removeProtocol=o.bg,u.AttributionControl=xh,u.BoxZoomHandler=bo,u.CanvasSource=bn,u.CooperativeGesturesHandler=yi,u.DoubleClickZoomHandler=zc,u.DragPanHandler=Fr,u.DragRotateHandler=Ko,u.EdgeInsets=qo,u.FullscreenControl=class extends o.E{constructor(b={}){super(),this._onFullscreenChange=()=>{var r;let d=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((r=d==null?void 0:d.shadowRoot)===null||r===void 0)&&r.fullscreenElement;)d=d.shadowRoot.fullscreenElement;d===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){S.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const b=this._fullscreenButton=S.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);S.create("span","maplibregl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.title=b}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},u.GeoJSONSource=xi,u.GeolocateControl=class extends o.E{constructor(b){super(),this._onSuccess=r=>{if(this._map){if(this._isOutOfMapMaxBounds(r))return this._setErrorState(),this.fire(new o.k("outofmaxbounds",r)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=r,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(r),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(r),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.k("geolocate",r)),this._finish()}},this._updateCamera=r=>{const d=new o.M(r.coords.longitude,r.coords.latitude),m=r.coords.accuracy,g=this._map.getBearing(),x=o.e({bearing:g},this.options.fitBoundsOptions),T=Yi.fromLngLat(d,m);this._map.fitBounds(T,x,{geolocateSource:!0})},this._updateMarker=r=>{if(r){const d=new o.M(r.coords.longitude,r.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=r.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=r=>{if(this._map){if(this.options.trackUserLocation)if(r.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(r.code===3&&Ds)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.k("error",r)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=r=>{if(this._map){if(this._container.addEventListener("contextmenu",d=>d.preventDefault()),this._geolocateButton=S.create("button","maplibregl-ctrl-geolocate",this._container),S.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",r===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=S.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new wo({element:this._dotElement}),this._circleElement=S.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new wo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{d.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d.originalEvent&&d.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.k("trackuserlocationend")))})}},this.options=o.e({},Hc,b)}onAdd(b){return this._map=b,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(){return o._(this,arguments,void 0,function*(r=!1){if(us!==void 0&&!r)return us;if(window.navigator.permissions===void 0)return us=!!window.navigator.geolocation,us;try{us=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{us=!!window.navigator.geolocation}return us})}().then(r=>this._setupUI(r)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),S.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ko=0,Ds=!1}_isOutOfMapMaxBounds(b){const r=this._map.getMaxBounds(),d=b.coords;return r&&(d.longitude<r.getWest()||d.longitude>r.getEast()||d.latitude<r.getSouth()||d.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const b=this._map.getBounds(),r=b.getSouthEast(),d=b.getNorthEast(),m=r.distanceTo(d),g=Math.ceil(this._accuracy/(m/this._map._container.clientHeight)*2);this._circleElement.style.width=`${g}px`,this._circleElement.style.height=`${g}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ko--,Ds=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let b;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ko++,ko>1?(b={maximumAge:6e5,timeout:0},Ds=!0):(b=this.options.positionOptions,Ds=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,b)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},u.Hash=Mc,u.ImageSource=xn,u.KeyboardHandler=Fn,u.LngLatBounds=Yi,u.LogoControl=xo,u.Map=class extends vh{constructor(b){if(o.bc.mark(o.bd.create),(b=o.e({},Bc,b)).minZoom!=null&&b.maxZoom!=null&&b.minZoom>b.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(b.minPitch!=null&&b.maxPitch!=null&&b.minPitch>b.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(b.minPitch!=null&&b.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(b.maxPitch!=null&&b.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Tl(b.minZoom,b.maxZoom,b.minPitch,b.maxPitch,b.renderWorldCopies),{bearingSnap:b.bearingSnap}),this._contextLost=r=>{r.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new o.k("webglcontextlost",{originalEvent:r}))},this._contextRestored=r=>{this._setupPainter(),this.resize(),this._update(),this.fire(new o.k("webglcontextrestored",{originalEvent:r}))},this._onMapScroll=r=>{if(r.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=b.interactive,this._maxTileCacheSize=b.maxTileCacheSize,this._maxTileCacheZoomLevels=b.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=b.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=b.preserveDrawingBuffer,this._antialias=b.antialias,this._trackResize=b.trackResize,this._bearingSnap=b.bearingSnap,this._refreshExpiredTiles=b.refreshExpiredTiles,this._fadeDuration=b.fadeDuration,this._crossSourceCollisions=b.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=b.collectResourceTiming,this._renderTaskQueue=new Qn,this._controls=[],this._mapId=o.a3(),this._locale=o.e({},Oc,b.locale),this._clickTolerance=b.clickTolerance,this._overridePixelRatio=b.pixelRatio,this._maxCanvasSize=b.maxCanvasSize,this.transformCameraUpdate=b.transformCameraUpdate,this._imageQueueHandle=Q.addThrottleControl(()=>this.isMoving()),this._requestManager=new De(b.transformRequest),typeof b.container=="string"){if(this._container=document.getElementById(b.container),!this._container)throw new Error(`Container '${b.container}' not found.`)}else{if(!(b.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=b.container}if(b.maxBounds&&this.setMaxBounds(b.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let r=!1;const d=Sc(m=>{this._trackResize&&!this._removed&&this.resize(m)._update()},50);this._resizeObserver=new ResizeObserver(m=>{r?d(m):r=!0}),this._resizeObserver.observe(this._container)}this.handlers=new or(this,b),this._hash=b.hash&&new Mc(typeof b.hash=="string"&&b.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:b.center,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch}),b.bounds&&(this.resize(),this.fitBounds(b.bounds,o.e({},b.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=b.localIdeographFontFamily,this._validateStyle=b.validateStyle,b.style&&this.setStyle(b.style,{localIdeographFontFamily:b.localIdeographFontFamily}),b.attributionControl&&this.addControl(new xh(typeof b.attributionControl=="boolean"?void 0:b.attributionControl)),b.maplibreLogo&&this.addControl(new xo,b.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update(r.dataType==="style"),this.fire(new o.k(`${r.dataType}data`,r))}),this.on("dataloading",r=>{this.fire(new o.k(`${r.dataType}dataloading`,r))}),this.on("dataabort",r=>{this.fire(new o.k("sourcedataabort",r))})}_getMapId(){return this._mapId}addControl(b,r){if(r===void 0&&(r=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new o.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=b.onAdd(this);this._controls.push(b);const m=this._controlPositions[r];return r.indexOf("bottom")!==-1?m.insertBefore(d,m.firstChild):m.appendChild(d),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new o.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(b);return r>-1&&this._controls.splice(r,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}calculateCameraOptionsFromTo(b,r,d,m){return m==null&&this.terrain&&(m=this.terrain.getElevationForLngLatZoom(d,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(b,r,d,m)}resize(b){var r;const d=this._containerDimensions(),m=d[0],g=d[1],x=this._getClampedPixelRatio(m,g);if(this._resizeCanvas(m,g,x),this.painter.resize(m,g,x),this.painter.overLimit()){const C=this.painter.context.gl;this._maxCanvasSize=[C.drawingBufferWidth,C.drawingBufferHeight];const A=this._getClampedPixelRatio(m,g);this._resizeCanvas(m,g,A),this.painter.resize(m,g,A)}this.transform.resize(m,g),(r=this._requestedCameraState)===null||r===void 0||r.resize(m,g);const T=!this._moving;return T&&(this.stop(),this.fire(new o.k("movestart",b)).fire(new o.k("move",b))),this.fire(new o.k("resize",b)),T&&this.fire(new o.k("moveend",b)),this}_getClampedPixelRatio(b,r){const{0:d,1:m}=this._maxCanvasSize,g=this.getPixelRatio(),x=b*g,T=r*g;return Math.min(x>d?d/x:1,T>m?m/T:1)*g}getPixelRatio(){var b;return(b=this._overridePixelRatio)!==null&&b!==void 0?b:devicePixelRatio}setPixelRatio(b){this._overridePixelRatio=b,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(b){return this.transform.setMaxBounds(Yi.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom)return this.transform.minZoom=b,this._update(),this.getZoom()<b&&this.setZoom(b),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom)return this.transform.maxZoom=b,this._update(),this.getZoom()>b&&this.setZoom(b),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.minPitch=b,this._update(),this.getPitch()<b&&this.setPitch(b),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(b>=this.transform.minPitch)return this.transform.maxPitch=b,this._update(),this.getPitch()>b&&this.setPitch(b),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.renderWorldCopies=b,this._update()}project(b){return this.transform.locationPoint(o.M.convert(b),this.style&&this.terrain)}unproject(b){return this.transform.pointLocation(o.P.convert(b),this.terrain)}isMoving(){var b;return this._moving||((b=this.handlers)===null||b===void 0?void 0:b.isMoving())}isZooming(){var b;return this._zooming||((b=this.handlers)===null||b===void 0?void 0:b.isZooming())}isRotating(){var b;return this._rotating||((b=this.handlers)===null||b===void 0?void 0:b.isRotating())}_createDelegatedListener(b,r,d){if(b==="mouseenter"||b==="mouseover"){let m=!1;return{layer:r,listener:d,delegates:{mousemove:x=>{const T=this.getLayer(r)?this.queryRenderedFeatures(x.point,{layers:[r]}):[];T.length?m||(m=!0,d.call(this,new Ea(b,this,x.originalEvent,{features:T}))):m=!1},mouseout:()=>{m=!1}}}}if(b==="mouseleave"||b==="mouseout"){let m=!1;return{layer:r,listener:d,delegates:{mousemove:T=>{(this.getLayer(r)?this.queryRenderedFeatures(T.point,{layers:[r]}):[]).length?m=!0:m&&(m=!1,d.call(this,new Ea(b,this,T.originalEvent)))},mouseout:T=>{m&&(m=!1,d.call(this,new Ea(b,this,T.originalEvent)))}}}}{const m=g=>{const x=this.getLayer(r)?this.queryRenderedFeatures(g.point,{layers:[r]}):[];x.length&&(g.features=x,d.call(this,g),delete g.features)};return{layer:r,listener:d,delegates:{[b]:m}}}}on(b,r,d){if(d===void 0)return super.on(b,r);const m=this._createDelegatedListener(b,r,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(m);for(const g in m.delegates)this.on(g,m.delegates[g]);return this}once(b,r,d){if(d===void 0)return super.once(b,r);const m=this._createDelegatedListener(b,r,d);for(const g in m.delegates)this.once(g,m.delegates[g]);return this}off(b,r,d){return d===void 0?super.off(b,r):(this._delegatedListeners&&this._delegatedListeners[b]&&(m=>{const g=this._delegatedListeners[b];for(let x=0;x<g.length;x++){const T=g[x];if(T.layer===r&&T.listener===d){for(const C in T.delegates)this.off(C,T.delegates[C]);return g.splice(x,1),this}}})(),this)}queryRenderedFeatures(b,r){if(!this.style)return[];let d;const m=b instanceof o.P||Array.isArray(b),g=m?b:[[0,0],[this.transform.width,this.transform.height]];if(r=r||(m?{}:b)||{},g instanceof o.P||typeof g[0]=="number")d=[o.P.convert(g)];else{const x=o.P.convert(g[0]),T=o.P.convert(g[1]);d=[x,new o.P(T.x,x.y),T,new o.P(x.x,T.y),x]}return this.style.queryRenderedFeatures(d,r,this.transform)}querySourceFeatures(b,r){return this.style.querySourceFeatures(b,r)}setStyle(b,r){return(r=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(b,r))}setTransformRequest(b){return this._requestManager.setTransformRequest(b),this}_getUIString(b){const r=this._locale[b];if(r==null)throw new Error(`Missing UI string '${b}'`);return r}_updateStyle(b,r){if(r.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(b,r));const d=this.style&&r.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!b)),b?(this.style=new ls(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof b=="string"?this.style.loadURL(b,r,d):this.style.loadJSON(b,r,d),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ls(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,r){if(typeof b=="string"){const d=this._requestManager.transformRequest(b,ce.Style);o.h(d,new AbortController).then(m=>{this._updateDiff(m.data,r)}).catch(m=>{m&&this.fire(new o.j(m))})}else typeof b=="object"&&this._updateDiff(b,r)}_updateDiff(b,r){try{this.style.setState(b,r)&&this._update(!0)}catch(d){o.w(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(b,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(b,r){return this._lazyInitEmptyStyle(),this.style.addSource(b,r),this._update(!0)}isSourceLoaded(b){const r=this.style&&this.style.sourceCaches[b];if(r!==void 0)return r.loaded();this.fire(new o.j(new Error(`There is no source with ID '${b}'`)))}setTerrain(b){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),b){const r=this.style.sourceCaches[b.source];if(!r)throw new Error(`cannot load terrain, because there exists no source with ID: ${b.source}`);this.terrain===null&&r.reload();for(const d in this.style._layers){const m=this.style._layers[d];m.type==="hillshade"&&m.source===b.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Jo(this.painter,r,b),this.painter.renderToTexture=new Fc(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=d=>{d.dataType==="style"?this.terrain.sourceCache.freeRtt():d.dataType==="source"&&d.tile&&(d.sourceId!==b.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(d.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new o.k("terrain",{terrain:b})),this}getTerrain(){var b,r;return(r=(b=this.terrain)===null||b===void 0?void 0:b.options)!==null&&r!==void 0?r:null}areTilesLoaded(){const b=this.style&&this.style.sourceCaches;for(const r in b){const d=b[r]._tiles;for(const m in d){const g=d[m];if(g.state!=="loaded"&&g.state!=="errored")return!1}}return!0}removeSource(b){return this.style.removeSource(b),this._update(!0)}getSource(b){return this.style.getSource(b)}addImage(b,r,d={}){const{pixelRatio:m=1,sdf:g=!1,stretchX:x,stretchY:T,content:C}=d;if(this._lazyInitEmptyStyle(),!(r instanceof HTMLImageElement||o.b(r))){if(r.width===void 0||r.height===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:A,height:F,data:j}=r,Z=r;return this.style.addImage(b,{data:new o.R({width:A,height:F},new Uint8Array(j)),pixelRatio:m,stretchX:x,stretchY:T,content:C,sdf:g,version:0,userImage:Z}),Z.onAdd&&Z.onAdd(this,b),this}}{const{width:A,height:F,data:j}=M.getImageData(r);this.style.addImage(b,{data:new o.R({width:A,height:F},j),pixelRatio:m,stretchX:x,stretchY:T,content:C,sdf:g,version:0})}}updateImage(b,r){const d=this.style.getImage(b);if(!d)return this.fire(new o.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=r instanceof HTMLImageElement||o.b(r)?M.getImageData(r):r,{width:g,height:x,data:T}=m;if(g===void 0||x===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(g!==d.data.width||x!==d.data.height)return this.fire(new o.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const C=!(r instanceof HTMLImageElement||o.b(r));return d.data.replace(T,C),this.style.updateImage(b,d),this}getImage(b){return this.style.getImage(b)}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new o.j(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b){return Q.getImage(this._requestManager.transformRequest(b,ce.Image),new AbortController)}listImages(){return this.style.listImages()}addLayer(b,r){return this._lazyInitEmptyStyle(),this.style.addLayer(b,r),this._update(!0)}moveLayer(b,r){return this.style.moveLayer(b,r),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(b,r,d){return this.style.setLayerZoomRange(b,r,d),this._update(!0)}setFilter(b,r,d={}){return this.style.setFilter(b,r,d),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,r,d,m={}){return this.style.setPaintProperty(b,r,d,m),this._update(!0)}getPaintProperty(b,r){return this.style.getPaintProperty(b,r)}setLayoutProperty(b,r,d,m={}){return this.style.setLayoutProperty(b,r,d,m),this._update(!0)}getLayoutProperty(b,r){return this.style.getLayoutProperty(b,r)}setGlyphs(b,r={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(b,r),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(b,r,d={}){return this._lazyInitEmptyStyle(),this.style.addSprite(b,r,d,m=>{m||this._update(!0)}),this}removeSprite(b){return this._lazyInitEmptyStyle(),this.style.removeSprite(b),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(b,r={}){return this._lazyInitEmptyStyle(),this.style.setSprite(b,r,d=>{d||this._update(!0)}),this}setLight(b,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,r),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(b,r){return this.style.setFeatureState(b,r),this._update()}removeFeatureState(b,r){return this.style.removeFeatureState(b,r),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let b=0,r=0;return this._container&&(b=this._container.clientWidth||400,r=this._container.clientHeight||300),[b,r]}_setupContainer(){const b=this._container;b.classList.add("maplibregl-map");const r=this._canvasContainer=S.create("div","maplibregl-canvas-container",b);this._interactive&&r.classList.add("maplibregl-interactive"),this._canvas=S.create("canvas","maplibregl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const d=this._containerDimensions(),m=this._getClampedPixelRatio(d[0],d[1]);this._resizeCanvas(d[0],d[1],m);const g=this._controlContainer=S.create("div","maplibregl-control-container",b),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(T=>{x[T]=S.create("div",`maplibregl-ctrl-${T} `,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,r,d){this._canvas.width=Math.floor(d*b),this._canvas.height=Math.floor(d*r),this._canvas.style.width=`${b}px`,this._canvas.style.height=`${r}px`}_setupPainter(){const b={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let r=null;this._canvas.addEventListener("webglcontextcreationerror",m=>{r={requestedAttributes:b},m&&(r.statusMessage=m.statusMessage,r.type=m.type)},{once:!0});const d=this._canvas.getContext("webgl2",b)||this._canvas.getContext("webgl",b);if(!d){const m="Failed to initialize WebGL";throw r?(r.message=m,new Error(JSON.stringify(r))):new Error(m)}this.painter=new go(d,this.transform),I.testSupport(d)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_render(b){const r=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(b),this._removed)return;let d=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const g=this.transform.zoom,x=M.now();this.style.zoomHistory.update(g,x);const T=new o.a8(g,{now:x,fadeDuration:r,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),C=T.crossFadingFactor();C===1&&C===this._crossFadingFactor||(d=!0,this._crossFadingFactor=C),this.style.update(T)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,r,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:r,showPadding:this.showPadding}),this.fire(new o.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.bc.mark(o.bd.load),this.fire(new o.k("load"))),this.style&&(this.style.hasTransitions()||d)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const m=this._sourcesDirty||this._styleDirty||this._placementDirty;return m||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.k("idle")),!this._loaded||this._fullyLoaded||m||(this._fullyLoaded=!0,o.bc.mark(o.bd.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var b;this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Q.removeThrottleControl(this._imageQueueHandle),(b=this._resizeObserver)===null||b===void 0||b.disconnect();const r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),S.remove(this._canvasContainer),S.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),o.bc.clearMetrics(),this._removed=!0,this.fire(new o.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,M.frameAsync(this._frameRequest).then(b=>{o.bc.frame(b),this._frameRequest=null,this._render(b)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}get version(){return Xo}getCameraTargetElevation(){return this.transform.elevation}},u.MapMouseEvent=Ea,u.MapTouchEvent=yo,u.MapWheelEvent=Pr,u.Marker=wo,u.NavigationControl=class{constructor(b){this._updateZoomButtons=()=>{const r=this._map.getZoom(),d=r===this._map.getMaxZoom(),m=r===this._map.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())},this._rotateCompassArrow=()=>{const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=r},this._setButtonTitle=(r,d)=>{const m=this._map._getUIString(`NavigationControl.${d}`);r.title=m,r.setAttribute("aria-label",m)},this.options=o.e({},Nc,b),this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",r=>this._map.zoomIn({},{originalEvent:r})),S.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",r=>this._map.zoomOut({},{originalEvent:r})),S.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",r=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}),this._compassIcon=S.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Vc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){S.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(b,r){const d=S.create("button",b,this._container);return d.type="button",d.addEventListener("click",r),d}},u.Popup=class extends o.E{constructor(b){super(),this.remove=()=>(this._content&&S.remove(this._content),this._container&&(S.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.k("close"))),this),this._onMouseUp=r=>{this._update(r.point)},this._onMouseMove=r=>{this._update(r.point)},this._onDrag=r=>{this._update(r.point)},this._update=r=>{var d;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=S.create("div","maplibregl-popup",this._map.getContainer()),this._tip=S.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const C of this.options.className.split(" "))this._container.classList.add(C);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?zl(this._lngLat,this._flatPos,this._map.transform):(d=this._lngLat)===null||d===void 0?void 0:d.wrap(),this._trackPointer&&!r)return;const m=this._flatPos=this._pos=this._trackPointer&&r?r:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&r?r:this._map.transform.locationPoint(this._lngLat));let g=this.options.anchor;const x=qc(this.options.offset);if(!g){const C=this._container.offsetWidth,A=this._container.offsetHeight;let F;F=m.y+x.bottom.y<A?["top"]:m.y>this._map.transform.height-A?["bottom"]:[],m.x<C/2?F.push("left"):m.x>this._map.transform.width-C/2&&F.push("right"),g=F.length===0?"bottom":F.join("-")}let T=m.add(x[g]);this.options.subpixelPositioning||(T=T.round()),S.setTransform(this._container,`${Qo[g]} translate(${T.x}px,${T.y}px)`),Rl(this._container,g,"popup")},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(Uc),b)}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=o.M.convert(b),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const r=document.createDocumentFragment(),d=document.createElement("body");let m;for(d.innerHTML=b;m=d.firstChild,m;)r.appendChild(m);return this.setDOMContent(r)}getMaxWidth(){var b;return(b=this._container)===null||b===void 0?void 0:b.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=S.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(b),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(b){this._container&&this._container.classList.add(b)}removeClassName(b){this._container&&this._container.classList.remove(b)}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){if(this._container)return this._container.classList.toggle(b)}setSubpixelPositioning(b){this.options.subpixelPositioning=b}_createCloseButton(){this.options.closeButton&&(this._closeButton=S.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(Wc);b&&b.focus()}},u.RasterDEMTileSource=Dn,u.RasterTileSource=Ci,u.ScaleControl=class{constructor(b){this._onMove=()=>{Fl(this._map,this._container,this.options)},this.setUnit=r=>{this.options.unit=r,Fl(this._map,this._container,this.options)},this.options=o.e({},jc,b)}getDefaultPosition(){return"bottom-left"}onAdd(b){return this._map=b,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-scale",b.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){S.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},u.ScrollZoomHandler=Lc,u.Style=ls,u.TerrainControl=class{constructor(b){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=b}onAdd(b){return this._map=b,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=S.create("button","maplibregl-ctrl-terrain",this._container),S.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){S.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},u.TwoFingersTouchPitchHandler=yh,u.TwoFingersTouchRotateHandler=Ic,u.TwoFingersTouchZoomHandler=Pl,u.TwoFingersTouchZoomRotateHandler=ri,u.VectorTileSource=je,u.VideoSource=tt,u.addSourceType=(b,r)=>o._(void 0,void 0,void 0,function*(){if(cn(b))throw new Error(`A source type called "${b}" already exists.`);((d,m)=>{_n[d]=m})(b,r)}),u.clearPrewarmedResources=function(){const b=vi;b&&(b.isPreloaded()&&b.numActive()===1?(b.release(Ft),vi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},u.getMaxParallelImageRequests=function(){return o.a.MAX_PARALLEL_IMAGE_REQUESTS},u.getRTLTextPluginStatus=function(){return jn().getRTLTextPluginStatus()},u.getVersion=function(){return kh},u.getWorkerCount=function(){return oi.workerCount},u.getWorkerUrl=function(){return o.a.WORKER_URL},u.importScriptInWorkers=function(b){return Pi().broadcast("importScript",b)},u.prewarm=function(){ht().acquire(Ft)},u.setMaxParallelImageRequests=function(b){o.a.MAX_PARALLEL_IMAGE_REQUESTS=b},u.setRTLTextPlugin=function(b,r){return jn().setRTLTextPlugin(b,r)},u.setWorkerCount=function(b){oi.workerCount=b},u.setWorkerUrl=function(b){o.a.WORKER_URL=b}});var c=t;return c})})(q2);var md=q2.exports;const rw=R2(md);function sw(n){let e,t,i;return{c(){e=mt("link"),t=Jt(),i=mt("div"),he(e,"href","./maplibre-gl.css"),he(e,"rel","stylesheet"),he(i,"class","map relative top-0 left-0 h-full w-full"),he(i,"id","map")},m(s,c){ve(document.head,e),at(s,t,c),at(s,i,c),n[5](i)},p:ci,i:ci,o:ci,d(s){nt(e),s&&nt(t),s&&nt(i),n[5](null)}}}function ow(n,e,t){let{map:i=void 0}=e,{mapProperties:s=void 0}=e,{interactive:c=!0}=e,{autorecovery:u=!1}=e,o,p;function _(){var Y,X,oe,Q;const{lon:M,lat:S}=((Y=s==null?void 0:s.location)==null?void 0:Y.data)??{lon:0,lat:0},I=(oe=(X=s==null?void 0:s.rasterLayer)==null?void 0:X.data)==null?void 0:oe.properties;let R;if((I==null?void 0:I.type)==="vector")R=(I==null?void 0:I.style)??(I==null?void 0:I.url)??vg.defaultBackgroundLayer.properties.url;else{const ce=vg.defaultBackgroundLayer.properties;R=ce.style??ce.url}console.log("Initiating mapLIbremap with style",R);const G={container:o,style:R,zoom:((Q=s==null?void 0:s.zoom)==null?void 0:Q.data)??1,center:{lng:M,lat:S},maxZoom:24,interactive:!0,attributionControl:!1};p=new md.Map(G),window.requestAnimationFrame(()=>{p.resize()}),p.on("load",function(){p.resize();const ce=p.getCanvas();ce.addEventListener("webglcontextlost",De=>{console.warn("A MapLibreMap lost their context. Recovery is",u,De);try{p==null||p.remove()}catch(Oe){console.debug("Could not remove map due to",Oe)}u&&requestAnimationFrame(()=>{console.warn("Attempting map recovery"),p=new md.Map(G),_()})}),c?(Tx(ce,yr.t.general.visualFeedback.navigation),ce.role="application",ce.tabIndex=0):(ce.tabIndex=-1,p.getContainer().tabIndex=-1)}),i.set(p)}sc(()=>_()),$r(async()=>{await Gn.waitFor(100),requestAnimationFrame(()=>{try{p==null||p.remove(),console.log("Removed map"),t(1,i=null)}catch{console.error("Could not destroy map")}})});function v(M){Fs[M?"unshift":"push"](()=>{o=M,t(0,o)})}return n.$$set=M=>{"map"in M&&t(1,i=M.map),"mapProperties"in M&&t(2,s=M.mapProperties),"interactive"in M&&t(3,c=M.interactive),"autorecovery"in M&&t(4,u=M.autorecovery)},[o,i,s,c,u,v]}class G2 extends Zi{constructor(e){super(),Gi(this,e,ow,sw,$i,{map:1,mapProperties:2,interactive:3,autorecovery:4})}}function lw(n,e){if(n.match(/^[a-z]+:\/\//i))return n;if(n.match(/^\/\//))return window.location.protocol+n;if(n.match(/^[a-z]+:/i))return n;const t=document.implementation.createHTMLDocument(),i=t.createElement("base"),s=t.createElement("a");return t.head.appendChild(i),t.body.appendChild(s),e&&(i.href=e),s.href=n,s.href}const cw=(()=>{let n=0;const e=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(n+=1,`u${e()}${n}`)})();function so(n){const e=[];for(let t=0,i=n.length;t<i;t++)e.push(n[t]);return e}function gd(n,e){const i=(n.ownerDocument.defaultView||window).getComputedStyle(n).getPropertyValue(e);return i?parseFloat(i.replace("px","")):0}function uw(n){const e=gd(n,"border-left-width"),t=gd(n,"border-right-width");return n.clientWidth+e+t}function hw(n){const e=gd(n,"border-top-width"),t=gd(n,"border-bottom-width");return n.clientHeight+e+t}function dw(n,e={}){const t=e.width||uw(n),i=e.height||hw(n);return{width:t,height:i}}function Hp(n){return new Promise((e,t)=>{const i=new Image;i.decode=()=>e(i),i.onload=()=>e(i),i.onerror=t,i.crossOrigin="anonymous",i.decoding="async",i.src=n})}async function fw(n){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(n)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)}async function pw(n,e,t){const i="http://www.w3.org/2000/svg",s=document.createElementNS(i,"svg"),c=document.createElementNS(i,"foreignObject");return s.setAttribute("width",`${e}`),s.setAttribute("height",`${t}`),s.setAttribute("viewBox",`0 0 ${e} ${t}`),c.setAttribute("width","100%"),c.setAttribute("height","100%"),c.setAttribute("x","0"),c.setAttribute("y","0"),c.setAttribute("externalResourcesRequired","true"),s.appendChild(c),c.appendChild(n),fw(s)}const zr=(n,e)=>{if(n instanceof e)return!0;const t=Object.getPrototypeOf(n);return t===null?!1:t.constructor.name===e.name||zr(t,e)};function mw(n){const e=n.getPropertyValue("content");return`${n.cssText} content: '${e.replace(/'|"/g,"")}';`}function gw(n){return so(n).map(e=>{const t=n.getPropertyValue(e),i=n.getPropertyPriority(e);return`${e}: ${t}${i?" !important":""};`}).join(" ")}function _w(n,e,t){const i=`.${n}:${e}`,s=t.cssText?mw(t):gw(t);return document.createTextNode(`${i}{${s}}`)}function jg(n,e,t){const i=window.getComputedStyle(n,t),s=i.getPropertyValue("content");if(s===""||s==="none")return;const c=cw();try{e.className=`${e.className} ${c}`}catch{return}const u=document.createElement("style");u.appendChild(_w(c,t,i)),e.appendChild(u)}function yw(n,e){jg(n,e,":before"),jg(n,e,":after")}const Ug="application/font-woff",Wg="image/jpeg",bw={woff:Ug,woff2:Ug,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Wg,jpeg:Wg,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function vw(n){const e=/\.([^./]*?)$/g.exec(n);return e?e[1]:""}function mm(n){const e=vw(n).toLowerCase();return bw[e]||""}function xw(n){return n.split(/,/)[1]}function jp(n){return n.search(/^(data:)/)!==-1}function $2(n,e){return`data:${e};base64,${n}`}async function K2(n,e,t){const i=await fetch(n,e);if(i.status===404)throw new Error(`Resource "${i.url}" not found`);const s=await i.blob();return new Promise((c,u)=>{const o=new FileReader;o.onerror=u,o.onloadend=()=>{try{c(t({res:i,result:o.result}))}catch(p){u(p)}},o.readAsDataURL(s)})}const kp={};function ww(n,e,t){let i=n.replace(/\?.*/,"");return t&&(i=n),/ttf|otf|eot|woff2?/i.test(i)&&(i=i.replace(/.*\//,"")),e?`[${e}]${i}`:i}async function gm(n,e,t){const i=ww(n,e,t.includeQueryParams);if(kp[i]!=null)return kp[i];t.cacheBust&&(n+=(/\?/.test(n)?"&":"?")+new Date().getTime());let s;try{const c=await K2(n,t.fetchRequestInit,({res:u,result:o})=>(e||(e=u.headers.get("Content-Type")||""),xw(o)));s=$2(c,e)}catch(c){s=t.imagePlaceholder||"";let u=`Failed to fetch resource: ${n}`;c&&(u=typeof c=="string"?c:c.message),u&&console.warn(u)}return kp[i]=s,s}async function kw(n){const e=n.toDataURL();return e==="data:,"?n.cloneNode(!1):Hp(e)}async function Sw(n,e){if(n.currentSrc){const c=document.createElement("canvas"),u=c.getContext("2d");c.width=n.clientWidth,c.height=n.clientHeight,u==null||u.drawImage(n,0,0,c.width,c.height);const o=c.toDataURL();return Hp(o)}const t=n.poster,i=mm(t),s=await gm(t,i,e);return Hp(s)}async function Mw(n){var e;try{if(!((e=n==null?void 0:n.contentDocument)===null||e===void 0)&&e.body)return await Vd(n.contentDocument.body,{},!0)}catch{}return n.cloneNode(!1)}async function Dw(n,e){return zr(n,HTMLCanvasElement)?kw(n):zr(n,HTMLVideoElement)?Sw(n,e):zr(n,HTMLIFrameElement)?Mw(n):n.cloneNode(!1)}const Tw=n=>n.tagName!=null&&n.tagName.toUpperCase()==="SLOT";async function Cw(n,e,t){var i,s;let c=[];return Tw(n)&&n.assignedNodes?c=so(n.assignedNodes()):zr(n,HTMLIFrameElement)&&(!((i=n.contentDocument)===null||i===void 0)&&i.body)?c=so(n.contentDocument.body.childNodes):c=so(((s=n.shadowRoot)!==null&&s!==void 0?s:n).childNodes),c.length===0||zr(n,HTMLVideoElement)||await c.reduce((u,o)=>u.then(()=>Vd(o,t)).then(p=>{p&&e.appendChild(p)}),Promise.resolve()),e}function Pw(n,e){const t=e.style;if(!t)return;const i=window.getComputedStyle(n);i.cssText?(t.cssText=i.cssText,t.transformOrigin=i.transformOrigin):so(i).forEach(s=>{let c=i.getPropertyValue(s);s==="font-size"&&c.endsWith("px")&&(c=`${Math.floor(parseFloat(c.substring(0,c.length-2)))-.1}px`),zr(n,HTMLIFrameElement)&&s==="display"&&c==="inline"&&(c="block"),s==="d"&&e.getAttribute("d")&&(c=`path(${e.getAttribute("d")})`),t.setProperty(s,c,i.getPropertyPriority(s))})}function Aw(n,e){zr(n,HTMLTextAreaElement)&&(e.innerHTML=n.value),zr(n,HTMLInputElement)&&e.setAttribute("value",n.value)}function Iw(n,e){if(zr(n,HTMLSelectElement)){const t=e,i=Array.from(t.children).find(s=>n.value===s.getAttribute("value"));i&&i.setAttribute("selected","")}}function Ew(n,e){return zr(e,Element)&&(Pw(n,e),yw(n,e),Aw(n,e),Iw(n,e)),e}async function Lw(n,e){const t=n.querySelectorAll?n.querySelectorAll("use"):[];if(t.length===0)return n;const i={};for(let c=0;c<t.length;c++){const o=t[c].getAttribute("xlink:href");if(o){const p=n.querySelector(o),_=document.querySelector(o);!p&&_&&!i[o]&&(i[o]=await Vd(_,e,!0))}}const s=Object.values(i);if(s.length){const c="http://www.w3.org/1999/xhtml",u=document.createElementNS(c,"svg");u.setAttribute("xmlns",c),u.style.position="absolute",u.style.width="0",u.style.height="0",u.style.overflow="hidden",u.style.display="none";const o=document.createElementNS(c,"defs");u.appendChild(o);for(let p=0;p<s.length;p++)o.appendChild(s[p]);n.appendChild(u)}return n}async function Vd(n,e,t){return!t&&e.filter&&!e.filter(n)?null:Promise.resolve(n).then(i=>Dw(i,e)).then(i=>Cw(n,i,e)).then(i=>Ew(n,i)).then(i=>Lw(i,e))}const Y2=/url\((['"]?)([^'"]+?)\1\)/g,zw=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,Rw=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function Fw(n){const e=n.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function Ow(n){const e=[];return n.replace(Y2,(t,i,s)=>(e.push(s),t)),e.filter(t=>!jp(t))}async function Bw(n,e,t,i,s){try{const c=t?lw(e,t):e,u=mm(e);let o;if(s){const p=await s(c);o=$2(p,u)}else o=await gm(c,u,i);return n.replace(Fw(e),`$1${o}$3`)}catch{}return n}function Nw(n,{preferredFontFormat:e}){return e?n.replace(Rw,t=>{for(;;){const[i,,s]=zw.exec(t)||[];if(!s)return"";if(s===e)return`src: ${i};`}}):n}function J2(n){return n.search(Y2)!==-1}async function X2(n,e,t){if(!J2(n))return n;const i=Nw(n,t);return Ow(i).reduce((c,u)=>c.then(o=>Bw(o,u,e,t)),Promise.resolve(i))}async function Kh(n,e,t){var i;const s=(i=e.style)===null||i===void 0?void 0:i.getPropertyValue(n);if(s){const c=await X2(s,null,t);return e.style.setProperty(n,c,e.style.getPropertyPriority(n)),!0}return!1}async function Vw(n,e){await Kh("background",n,e)||await Kh("background-image",n,e),await Kh("mask",n,e)||await Kh("mask-image",n,e)}async function Hw(n,e){const t=zr(n,HTMLImageElement);if(!(t&&!jp(n.src))&&!(zr(n,SVGImageElement)&&!jp(n.href.baseVal)))return;const i=t?n.src:n.href.baseVal,s=await gm(i,mm(i),e);await new Promise((c,u)=>{n.onload=c,n.onerror=u;const o=n;o.decode&&(o.decode=c),o.loading==="lazy"&&(o.loading="eager"),t?(n.srcset="",n.src=s):n.href.baseVal=s})}async function jw(n,e){const i=so(n.childNodes).map(s=>Q2(s,e));await Promise.all(i).then(()=>n)}async function Q2(n,e){zr(n,Element)&&(await Vw(n,e),await Hw(n,e),await jw(n,e))}function Uw(n,e){const{style:t}=n;e.backgroundColor&&(t.backgroundColor=e.backgroundColor),e.width&&(t.width=`${e.width}px`),e.height&&(t.height=`${e.height}px`);const i=e.style;return i!=null&&Object.keys(i).forEach(s=>{t[s]=i[s]}),n}const qg={};async function Zg(n){let e=qg[n];if(e!=null)return e;const i=await(await fetch(n)).text();return e={url:n,cssText:i},qg[n]=e,e}async function Gg(n,e){let t=n.cssText;const i=/url\(["']?([^"')]+)["']?\)/g,c=(t.match(/url\([^)]+\)/g)||[]).map(async u=>{let o=u.replace(i,"$1");return o.startsWith("https://")||(o=new URL(o,n.url).href),K2(o,e.fetchRequestInit,({result:p})=>(t=t.replace(u,`url(${p})`),[u,p]))});return Promise.all(c).then(()=>t)}function $g(n){if(n==null)return[];const e=[],t=/(\/\*[\s\S]*?\*\/)/gi;let i=n.replace(t,"");const s=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const p=s.exec(i);if(p===null)break;e.push(p[0])}i=i.replace(s,"");const c=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,u="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",o=new RegExp(u,"gi");for(;;){let p=c.exec(i);if(p===null){if(p=o.exec(i),p===null)break;c.lastIndex=o.lastIndex}else o.lastIndex=c.lastIndex;e.push(p[0])}return e}async function Ww(n,e){const t=[],i=[];return n.forEach(s=>{if("cssRules"in s)try{so(s.cssRules||[]).forEach((c,u)=>{if(c.type===CSSRule.IMPORT_RULE){let o=u+1;const p=c.href,_=Zg(p).then(v=>Gg(v,e)).then(v=>$g(v).forEach(M=>{try{s.insertRule(M,M.startsWith("@import")?o+=1:s.cssRules.length)}catch(S){console.error("Error inserting rule from remote css",{rule:M,error:S})}})).catch(v=>{console.error("Error loading remote css",v.toString())});i.push(_)}})}catch(c){const u=n.find(o=>o.href==null)||document.styleSheets[0];s.href!=null&&i.push(Zg(s.href).then(o=>Gg(o,e)).then(o=>$g(o).forEach(p=>{u.insertRule(p,s.cssRules.length)})).catch(o=>{console.error("Error loading remote stylesheet",o)})),console.error("Error inlining remote css file",c)}}),Promise.all(i).then(()=>(n.forEach(s=>{if("cssRules"in s)try{so(s.cssRules||[]).forEach(c=>{t.push(c)})}catch(c){console.error(`Error while reading CSS rules from ${s.href}`,c)}}),t))}function qw(n){return n.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>J2(e.style.getPropertyValue("src")))}async function Zw(n,e){if(n.ownerDocument==null)throw new Error("Provided element is not within a Document");const t=so(n.ownerDocument.styleSheets),i=await Ww(t,e);return qw(i)}async function Gw(n,e){const t=await Zw(n,e);return(await Promise.all(t.map(s=>{const c=s.parentStyleSheet?s.parentStyleSheet.href:null;return X2(s.cssText,c,e)}))).join(`
`)}async function $w(n,e){const t=e.fontEmbedCSS!=null?e.fontEmbedCSS:e.skipFonts?null:await Gw(n,e);if(t){const i=document.createElement("style"),s=document.createTextNode(t);i.appendChild(s),n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i)}}async function Kw(n,e={}){const{width:t,height:i}=dw(n,e),s=await Vd(n,e,!0);return await $w(s,e),await Q2(s,e),Uw(s,e),await pw(s,t,i)}const Eu=class Eu{constructor(e,t,i){ft(this,"opacity",new ki(0));ft(this,"_map");ft(this,"_background");ft(this,"_targetLayer");ft(this,"_deactivationTime");ft(this,"fadeStep",.1);this._targetLayer=t,this._map=e,this._background=i,i.addCallback(async()=>{await this.update()}),e.addCallbackAndRunD(async s=>{s.on("load",async()=>{await this.update()}),await this.update(),s.on("moveend",()=>this.onMove(s)),s.on("zoomend",()=>this.onMove(s))})}onMove(e){if(!(!this._deactivationTime||(new Date().getTime()-this._deactivationTime.getTime())/1e3<Eu.DEACTIVATE_AFTER)){console.debug("Removing raster layer",this._targetLayer.properties.id,"map moved and not been used for",Eu.DEACTIVATE_AFTER);try{e.getLayer(this._targetLayer.properties.id)&&e.removeLayer(this._targetLayer.properties.id)}catch(i){console.warn("Could not (try to) remove the raster layer",i)}}}async update(){var i;const e=this._background.data,t=this._targetLayer;((i=e==null?void 0:e.properties)==null?void 0:i.id)!==t.properties.id?(this._deactivationTime=new Date,await this.awaitStyleIsLoaded(),this.fadeOut()):(this._deactivationTime=void 0,await this.enable(),this.fadeIn())}async awaitStyleIsLoaded(){const e=this._map.data;if(e)for(;!(e!=null&&e.isStyleLoaded());)await Gn.waitFor(100)}async enable(){let e=15;for(await this.awaitStyleIsLoaded();!this.tryEnable()&&e>0;)e--,await Gn.waitFor(250)}tryEnable(){var s;const e=this._map.data;if(!e)return!0;const t=this._targetLayer.properties;console.debug("Enabling",t.id);let i="transit_pier";if(e.getLayer(i)||(console.warn("Layer",i,"not found"),i=void 0),(t.category==="osmbasedmap"||t.category==="map")&&(i=void 0),!e.getSource(t.id))try{e.addSource(t.id,zu.prepareSource(t))}catch{return!1}if(!e.getLayer(t.id))if(i??(i=(s=e.getStyle().layers.find(c=>c.id.startsWith("mapcomplete_")))==null?void 0:s.id),t.type==="vector"){const c=t.style??t.url;e.setStyle(c)}else e.addLayer({id:t.id,type:"raster",source:t.id,paint:{"raster-opacity":0}},i),this.opacity.addCallbackAndRun(c=>{try{e.setPaintProperty(t.id,"raster-opacity",c)}catch{return console.debug("Could not set raster-opacity of",t.id),!0}});return!0}fadeOut(){dd.Chronic(8,()=>this.opacity.data>0&&this._deactivationTime!==void 0).addCallback(e=>this.opacity.setData(Math.max(0,this.opacity.data-this.fadeStep)))}fadeIn(){dd.Chronic(8,()=>this.opacity.data<1&&this._deactivationTime===void 0).addCallback(e=>this.opacity.setData(Math.min(1,this.opacity.data+this.fadeStep)))}};ft(Eu,"DEACTIVATE_AFTER",60);let Up=Eu;class zu{constructor(e,t){ft(this,"_singleLayerHandlers",{});t.addCallbackAndRunD(i=>{const s=i.properties.id;this._singleLayerHandlers[s]||(this._singleLayerHandlers[s]=new Up(e,i,t))})}static prepareSource(e){return e.type==="vector"?{type:"vector",url:e.url}:{type:"raster",tiles:[zu.prepareWmsURL(e.url,e["tile-size"]??256)],tileSize:e["tile-size"]??256,minzoom:e.min_zoom??1,maxzoom:e.max_zoom??25,scheme:e.url.includes("{-y}")?"tms":"xyz"}}static prepareWmsURL(e,t=256){const i={"{bbox}":"{bbox-epsg-3857}","{proj}":"EPSG:3857","{width}":""+t,"{height}":""+t,"{zoom}":"{z}","{-y}":"{y}"};for(const c in i)e=e.replace(new RegExp(c),i[c]);const s=e.match(/\{switch:([a-zA-Z0-9,]*)}/);if(s!==null){const c=s[1].split(","),u=c[Math.floor(Math.random()*c.length)];e=e.replace(s[0],u)}return e}}var Xl=Math.pow,gr=(n,e,t)=>new Promise((i,s)=>{var c=p=>{try{o(t.next(p))}catch(_){s(_)}},u=p=>{try{o(t.throw(p))}catch(_){s(_)}},o=p=>p.done?i(p.value):Promise.resolve(p.value).then(c,u);o((t=t.apply(n,e)).next())}),Gr=Uint8Array,Jl=Uint16Array,Yw=Int32Array,ey=new Gr([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ty=new Gr([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Jw=new Gr([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),iy=function(n,e){for(var t=new Jl(31),i=0;i<31;++i)t[i]=e+=1<<n[i-1];for(var s=new Yw(t[30]),i=1;i<30;++i)for(var c=t[i];c<t[i+1];++c)s[c]=c-t[i]<<5|i;return{b:t,r:s}},ny=iy(ey,2),ay=ny.b,Xw=ny.r;ay[28]=258,Xw[258]=28;var Qw=iy(ty,0),e5=Qw.b,Wp=new Jl(32768);for(Mn=0;Mn<32768;++Mn)Xs=(Mn&43690)>>1|(Mn&21845)<<1,Xs=(Xs&52428)>>2|(Xs&13107)<<2,Xs=(Xs&61680)>>4|(Xs&3855)<<4,Wp[Mn]=((Xs&65280)>>8|(Xs&255)<<8)>>1;var Xs,Mn,Su=function(n,e,t){for(var i=n.length,s=0,c=new Jl(e);s<i;++s)n[s]&&++c[n[s]-1];var u=new Jl(e);for(s=1;s<e;++s)u[s]=u[s-1]+c[s-1]<<1;var o;if(t){o=new Jl(1<<e);var p=15-e;for(s=0;s<i;++s)if(n[s])for(var _=s<<4|n[s],v=e-n[s],M=u[n[s]-1]++<<v,S=M|(1<<v)-1;M<=S;++M)o[Wp[M]>>p]=_}else for(o=new Jl(i),s=0;s<i;++s)n[s]&&(o[s]=Wp[u[n[s]-1]++]>>15-n[s]);return o},ju=new Gr(288);for(Mn=0;Mn<144;++Mn)ju[Mn]=8;var Mn;for(Mn=144;Mn<256;++Mn)ju[Mn]=9;var Mn;for(Mn=256;Mn<280;++Mn)ju[Mn]=7;var Mn;for(Mn=280;Mn<288;++Mn)ju[Mn]=8;var Mn,ry=new Gr(32);for(Mn=0;Mn<32;++Mn)ry[Mn]=5;var Mn,t5=Su(ju,9,1),i5=Su(ry,5,1),Sp=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},ms=function(n,e,t){var i=e/8|0;return(n[i]|n[i+1]<<8)>>(e&7)&t},Mp=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(e&7)},n5=function(n){return(n+7)/8|0},a5=function(n,e,t){(e==null||e<0)&&(e=0),(t==null||t>n.length)&&(t=n.length);var i=new Gr(t-e);return i.set(n.subarray(e,t)),i},r5=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Wr=function(n,e,t){var i=new Error(e||r5[n]);if(i.code=n,Error.captureStackTrace&&Error.captureStackTrace(i,Wr),!t)throw i;return i},_m=function(n,e,t,i){var s=n.length,c=i?i.length:0;if(!s||e.f&&!e.l)return t||new Gr(0);var u=!t||e.i!=2,o=e.i;t||(t=new Gr(s*3));var p=function(Pi){var Ni=t.length;if(Pi>Ni){var Oi=new Gr(Math.max(Ni*2,Pi));Oi.set(t),t=Oi}},_=e.f||0,v=e.p||0,M=e.b||0,S=e.l,I=e.d,R=e.m,G=e.n,Y=s*8;do{if(!S){_=ms(n,v,1);var X=ms(n,v+1,3);if(v+=3,X)if(X==1)S=t5,I=i5,R=9,G=5;else if(X==2){var De=ms(n,v,31)+257,Oe=ms(n,v+10,15)+4,Pe=De+ms(n,v+5,31)+1;v+=14;for(var Se=new Gr(Pe),_e=new Gr(19),ze=0;ze<Oe;++ze)_e[Jw[ze]]=ms(n,v+ze*3,7);v+=Oe*3;for(var Re=Sp(_e),Ye=(1<<Re)-1,Xe=Su(_e,Re,1),ze=0;ze<Pe;){var si=Xe[ms(n,v,Ye)];v+=si&15;var oe=si>>4;if(oe<16)Se[ze++]=oe;else{var Bt=0,bi=0;for(oe==16?(bi=3+ms(n,v,3),v+=2,Bt=Se[ze-1]):oe==17?(bi=3+ms(n,v,7),v+=3):oe==18&&(bi=11+ms(n,v,127),v+=7);bi--;)Se[ze++]=Bt}}var Et=Se.subarray(0,De),Vt=Se.subarray(De);R=Sp(Et),G=Sp(Vt),S=Su(Et,R,1),I=Su(Vt,G,1)}else Wr(1);else{var oe=n5(v)+4,Q=n[oe-4]|n[oe-3]<<8,ce=oe+Q;if(ce>s){o&&Wr(0);break}u&&p(M+Q),t.set(n.subarray(oe,ce),M),e.b=M+=Q,e.p=v=ce*8,e.f=_;continue}if(v>Y){o&&Wr(0);break}}u&&p(M+131072);for(var Ki=(1<<R)-1,zt=(1<<G)-1,_t=v;;_t=v){var Bt=S[Mp(n,v)&Ki],Dt=Bt>>4;if(v+=Bt&15,v>Y){o&&Wr(0);break}if(Bt||Wr(2),Dt<256)t[M++]=Dt;else if(Dt==256){_t=v,S=null;break}else{var Ft=Dt-254;if(Dt>264){var ze=Dt-257,oi=ey[ze];Ft=ms(n,v,(1<<oi)-1)+ay[ze],v+=oi}var pi=I[Mp(n,v)&zt],vi=pi>>4;pi||Wr(3),v+=pi&15;var Vt=e5[vi];if(vi>3){var oi=ty[vi];Vt+=Mp(n,v)&(1<<oi)-1,v+=oi}if(v>Y){o&&Wr(0);break}u&&p(M+131072);var Ti=M+Ft;if(M<Vt){var ht=c-Vt,mi=Math.min(Vt,Ti);for(ht+M<0&&Wr(3);M<mi;++M)t[M]=i[ht+M]}for(;M<Ti;M+=4)t[M]=t[M-Vt],t[M+1]=t[M+1-Vt],t[M+2]=t[M+2-Vt],t[M+3]=t[M+3-Vt];M=Ti}}e.l=S,e.p=_t,e.b=M,e.f=_,S&&(_=1,e.m=R,e.d=I,e.n=G)}while(!_);return M==t.length?t:a5(t,0,M)},s5=new Gr(0),o5=function(n){(n[0]!=31||n[1]!=139||n[2]!=8)&&Wr(6,"invalid gzip data");var e=n[3],t=10;e&4&&(t+=(n[10]|n[11]<<8)+2);for(var i=(e>>3&1)+(e>>4&1);i>0;i-=!n[t++]);return t+(e&2)},l5=function(n){var e=n.length;return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0},c5=function(n,e){return((n[0]&15)!=8||n[0]>>4>7||(n[0]<<8|n[1])%31)&&Wr(6,"invalid zlib data"),(n[1]>>5&1)==+!e&&Wr(6,"invalid zlib data: "+(n[1]&32?"need":"unexpected")+" dictionary"),(n[1]>>3&4)+2};function u5(n,e){return _m(n,{i:2},e&&e.out,e&&e.dictionary)}function h5(n,e){var t=o5(n);return t+8>n.length&&Wr(6,"invalid gzip data"),_m(n.subarray(t,-8),{i:2},e&&e.out||new Gr(l5(n)),e&&e.dictionary)}function d5(n,e){return _m(n.subarray(c5(n,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function qp(n,e){return n[0]==31&&n[1]==139&&n[2]==8?h5(n,e):(n[0]&15)!=8||n[0]>>4>7||(n[0]<<8|n[1])%31?u5(n,e):d5(n,e)}var f5=typeof TextDecoder<"u"&&new TextDecoder,p5=0;try{f5.decode(s5,{stream:!0}),p5=1}catch{}var sy=(n,e)=>n*Xl(2,e),du=(n,e)=>Math.floor(n/Xl(2,e)),_d=(n,e)=>sy(n.getUint16(e+1,!0),8)+n.getUint8(e),oy=(n,e)=>sy(n.getUint32(e+2,!0),16)+n.getUint16(e,!0),m5=(n,e,t,i,s)=>{if(n!==i.getUint8(s))return n-i.getUint8(s);const c=_d(i,s+1);if(e!==c)return e-c;const u=_d(i,s+4);return t!==u?t-u:0},g5=(n,e,t,i)=>{const s=ly(n,e|128,t,i);return s?{z:e,x:t,y:i,offset:s[0],length:s[1],isDir:!0}:null},Kg=(n,e,t,i)=>{const s=ly(n,e,t,i);return s?{z:e,x:t,y:i,offset:s[0],length:s[1],isDir:!1}:null},ly=(n,e,t,i)=>{let s=0,c=n.byteLength/17-1;for(;s<=c;){const u=c+s>>1,o=m5(e,t,i,n,u*17);if(o>0)s=u+1;else if(o<0)c=u-1;else return[oy(n,u*17+7),n.getUint32(u*17+13,!0)]}return null},_5=(n,e)=>n.isDir&&!e.isDir?1:!n.isDir&&e.isDir?-1:n.z!==e.z?n.z-e.z:n.x!==e.x?n.x-e.x:n.y-e.y,cy=(n,e)=>{const t=n.getUint8(e*17);return{z:t&127,x:_d(n,e*17+1),y:_d(n,e*17+4),offset:oy(n,e*17+7),length:n.getUint32(e*17+13,!0),isDir:t>>7===1}},Yg=n=>{const e=[],t=new DataView(n);for(let i=0;i<t.byteLength/17;i++)e.push(cy(t,i));return y5(e)},y5=n=>{n.sort(_5);const e=new ArrayBuffer(17*n.length),t=new Uint8Array(e);for(let i=0;i<n.length;i++){const s=n[i];let c=s.z;s.isDir&&(c=c|128),t[i*17]=c,t[i*17+1]=s.x&255,t[i*17+2]=s.x>>8&255,t[i*17+3]=s.x>>16&255,t[i*17+4]=s.y&255,t[i*17+5]=s.y>>8&255,t[i*17+6]=s.y>>16&255,t[i*17+7]=s.offset&255,t[i*17+8]=du(s.offset,8)&255,t[i*17+9]=du(s.offset,16)&255,t[i*17+10]=du(s.offset,24)&255,t[i*17+11]=du(s.offset,32)&255,t[i*17+12]=du(s.offset,48)&255,t[i*17+13]=s.length&255,t[i*17+14]=s.length>>8&255,t[i*17+15]=s.length>>16&255,t[i*17+16]=s.length>>24&255}return e},b5=(n,e)=>{if(n.byteLength<17)return null;const t=n.byteLength/17,i=cy(n,t-1);if(i.isDir){const s=i.z,c=e.z-s,u=Math.trunc(e.x/(1<<c)),o=Math.trunc(e.y/(1<<c));return{z:s,x:u,y:o}}return null};function v5(n){return gr(this,null,function*(){const e=yield n.getBytes(0,512e3),t=new DataView(e.data),i=t.getUint32(4,!0),s=t.getUint16(8,!0),c=new TextDecoder("utf-8"),u=JSON.parse(c.decode(new DataView(e.data,10,i)));let o=0;u.compression==="gzip"&&(o=2);let p=0;"minzoom"in u&&(p=+u.minzoom);let _=0;"maxzoom"in u&&(_=+u.maxzoom);let v=0,M=0,S=0,I=-180,R=-85,G=180,Y=85;if(u.bounds){const oe=u.bounds.split(",");I=+oe[0],R=+oe[1],G=+oe[2],Y=+oe[3]}if(u.center){const oe=u.center.split(",");v=+oe[0],M=+oe[1],S=+oe[2]}return{specVersion:t.getUint16(2,!0),rootDirectoryOffset:10+i,rootDirectoryLength:s*17,jsonMetadataOffset:10,jsonMetadataLength:i,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:o,tileType:1,minZoom:p,maxZoom:_,minLon:I,minLat:R,maxLon:G,maxLat:Y,centerZoom:S,centerLon:v,centerLat:M,etag:e.etag}})}function x5(n,e,t,i,s,c,u){return gr(this,null,function*(){let o=yield t.getArrayBuffer(e,n.rootDirectoryOffset,n.rootDirectoryLength,n);n.specVersion===1&&(o=Yg(o));const p=Kg(new DataView(o),i,s,c);if(p){let M=(yield e.getBytes(p.offset,p.length,u)).data;const S=new DataView(M);return S.getUint8(0)===31&&S.getUint8(1)===139&&(M=qp(new Uint8Array(M))),{data:M}}const _=b5(new DataView(o),{z:i,x:s,y:c});if(_){const v=g5(new DataView(o),_.z,_.x,_.y);if(v){let M=yield t.getArrayBuffer(e,v.offset,v.length,n);n.specVersion===1&&(M=Yg(M));const S=Kg(new DataView(M),i,s,c);if(S){let R=(yield e.getBytes(S.offset,S.length,u)).data;const G=new DataView(R);return G.getUint8(0)===31&&G.getUint8(1)===139&&(R=qp(new Uint8Array(R))),{data:R}}}}})}var uy={getHeader:v5,getZxy:x5},w5=n=>(e,t)=>{if(t instanceof AbortController)return n(e,t);const i=new AbortController;return n(e,i).then(s=>t(void 0,s.data,s.cacheControl||"",s.expires||""),s=>t(s)).catch(s=>t(s)),{cancel:()=>i.abort()}},k5=class{constructor(){this.tilev4=(n,e)=>gr(this,null,function*(){if(n.type==="json"){const M=n.url.substr(10);let S=this.tiles.get(M);S||(S=new Jg(M),this.tiles.set(M,S));const I=yield S.getHeader();return{data:{tiles:[`${n.url}/{z}/{x}/{y}`],minzoom:I.minZoom,maxzoom:I.maxZoom,bounds:[I.minLon,I.minLat,I.maxLon,I.maxLat]}}}const t=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),i=n.url.match(t);if(!i)throw new Error("Invalid PMTiles protocol URL");const s=i[1];let c=this.tiles.get(s);c||(c=new Jg(s),this.tiles.set(s,c));const u=i[2],o=i[3],p=i[4],_=yield c.getHeader(),v=yield c==null?void 0:c.getZxy(+u,+o,+p,e.signal);return v?{data:new Uint8Array(v.data),cacheControl:v.cacheControl,expires:v.expires}:_.tileType===1?{data:new Uint8Array}:{data:null}}),this.tile=w5(this.tilev4),this.tiles=new Map}add(n){this.tiles.set(n.source.getKey(),n)}get(n){return this.tiles.get(n)}};function $l(n,e){return(e>>>0)*4294967296+(n>>>0)}function S5(n,e){const t=e.buf;let i=t[e.pos++],s=(i&112)>>4;if(i<128||(i=t[e.pos++],s|=(i&127)<<3,i<128)||(i=t[e.pos++],s|=(i&127)<<10,i<128)||(i=t[e.pos++],s|=(i&127)<<17,i<128)||(i=t[e.pos++],s|=(i&127)<<24,i<128)||(i=t[e.pos++],s|=(i&1)<<31,i<128))return $l(n,s);throw new Error("Expected varint not more than 10 bytes")}function fu(n){const e=n.buf;let t=e[n.pos++],i=t&127;return t<128||(t=e[n.pos++],i|=(t&127)<<7,t<128)||(t=e[n.pos++],i|=(t&127)<<14,t<128)||(t=e[n.pos++],i|=(t&127)<<21,t<128)?i:(t=e[n.pos],i|=(t&15)<<28,S5(i,n))}function M5(n,e,t,i){if(i===0){t===1&&(e[0]=n-1-e[0],e[1]=n-1-e[1]);const s=e[0];e[0]=e[1],e[1]=s}}var D5=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function T5(n,e,t){if(n>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Xl(2,n)-1||t>Xl(2,n)-1)throw Error("tile x/y outside zoom level bounds");const i=D5[n],s=Xl(2,n);let c=0,u=0,o=0;const p=[e,t];let _=s/2;for(;_>0;)c=(p[0]&_)>0?1:0,u=(p[1]&_)>0?1:0,o+=_*_*(3*c^u),M5(_,p,c,u),_=_/2;return i+o}function hy(n,e){return gr(this,null,function*(){if(e===1||e===0)return n;if(e===2){if(typeof globalThis.DecompressionStream>"u")return qp(new Uint8Array(n));const t=new Response(n).body;if(!t)throw Error("Failed to read response stream");const i=t.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(i).arrayBuffer()}throw Error("Compression method not supported")})}var C5=127;function P5(n,e){let t=0,i=n.length-1;for(;t<=i;){const s=i+t>>1,c=e-n[s].tileId;if(c>0)t=s+1;else if(c<0)i=s-1;else return n[s]}return i>=0&&(n[i].runLength===0||e-n[i].tileId<n[i].runLength)?n[i]:null}var A5=class{constructor(n,e=new Headers){this.url=n,this.customHeaders=e,this.mustReload=!1}getKey(){return this.url}setHeaders(n){this.customHeaders=n}getBytes(n,e,t,i){return gr(this,null,function*(){let s,c;t?c=t:(s=new AbortController,c=s.signal);const u=new Headers(this.customHeaders);u.set("range",`bytes=${n}-${n+e-1}`);let o;this.mustReload&&(o="reload");let p=yield fetch(this.url,{signal:c,cache:o,headers:u});if(n===0&&p.status===416){const S=p.headers.get("Content-Range");if(!S||!S.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const I=+S.substr(8);p=yield fetch(this.url,{signal:c,cache:"reload",headers:{range:`bytes=0-${I-1}`}})}let _=p.headers.get("Etag");if(_!=null&&_.startsWith("W/")&&(_=null),p.status===416||i&&_&&_!==i)throw this.mustReload=!0,new Zp(i);if(p.status>=300)throw Error(`Bad response code: ${p.status}`);const v=p.headers.get("Content-Length");if(p.status===200&&(!v||+v>e))throw s&&s.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield p.arrayBuffer(),etag:_||void 0,cacheControl:p.headers.get("Cache-Control")||void 0,expires:p.headers.get("Expires")||void 0}})}};function gs(n,e){const t=n.getUint32(e+4,!0),i=n.getUint32(e+0,!0);return t*Xl(2,32)+i}function I5(n,e){const t=new DataView(n),i=t.getUint8(7);if(i>3)throw Error(`Archive is spec version ${i} but this library supports up to spec version 3`);return{specVersion:i,rootDirectoryOffset:gs(t,8),rootDirectoryLength:gs(t,16),jsonMetadataOffset:gs(t,24),jsonMetadataLength:gs(t,32),leafDirectoryOffset:gs(t,40),leafDirectoryLength:gs(t,48),tileDataOffset:gs(t,56),tileDataLength:gs(t,64),numAddressedTiles:gs(t,72),numTileEntries:gs(t,80),numTileContents:gs(t,88),clustered:t.getUint8(96)===1,internalCompression:t.getUint8(97),tileCompression:t.getUint8(98),tileType:t.getUint8(99),minZoom:t.getUint8(100),maxZoom:t.getUint8(101),minLon:t.getInt32(102,!0)/1e7,minLat:t.getInt32(106,!0)/1e7,maxLon:t.getInt32(110,!0)/1e7,maxLat:t.getInt32(114,!0)/1e7,centerZoom:t.getUint8(118),centerLon:t.getInt32(119,!0)/1e7,centerLat:t.getInt32(123,!0)/1e7,etag:e}}function dy(n){const e={buf:new Uint8Array(n),pos:0},t=fu(e),i=[];let s=0;for(let c=0;c<t;c++){const u=fu(e);i.push({tileId:s+u,offset:0,length:0,runLength:1}),s+=u}for(let c=0;c<t;c++)i[c].runLength=fu(e);for(let c=0;c<t;c++)i[c].length=fu(e);for(let c=0;c<t;c++){const u=fu(e);u===0&&c>0?i[c].offset=i[c-1].offset+i[c-1].length:i[c].offset=u-1}return i}function E5(n){const e=new DataView(n);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var Zp=class extends Error{};function L5(n,e){return gr(this,null,function*(){const t=yield n.getBytes(0,16384);if(new DataView(t.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(E5(t.data)<3)return[yield uy.getHeader(n)];const s=t.data.slice(0,C5),c=I5(s,t.etag),u=t.data.slice(c.rootDirectoryOffset,c.rootDirectoryOffset+c.rootDirectoryLength),o=`${n.getKey()}|${c.etag||""}|${c.rootDirectoryOffset}|${c.rootDirectoryLength}`,p=dy(yield e(u,c.internalCompression));return[c,[o,p.length,p]]})}function z5(n,e,t,i,s){return gr(this,null,function*(){const c=yield n.getBytes(t,i,void 0,s.etag),u=yield e(c.data,s.internalCompression),o=dy(u);if(o.length===0)throw new Error("Empty directory is invalid");return o})}var R5=class{constructor(n=100,e=!0,t=hy){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=n,this.counter=1,this.decompress=t}getHeader(n){return gr(this,null,function*(){const e=n.getKey(),t=this.cache.get(e);if(t)return t.lastUsed=this.counter++,yield t.data;const i=new Promise((s,c)=>{L5(n,this.decompress).then(u=>{u[1]&&this.cache.set(u[1][0],{lastUsed:this.counter++,data:Promise.resolve(u[1][2])}),s(u[0]),this.prune()}).catch(u=>{c(u)})});return this.cache.set(e,{lastUsed:this.counter++,data:i}),i})}getDirectory(n,e,t,i){return gr(this,null,function*(){const s=`${n.getKey()}|${i.etag||""}|${e}|${t}`,c=this.cache.get(s);if(c)return c.lastUsed=this.counter++,yield c.data;const u=new Promise((o,p)=>{z5(n,this.decompress,e,t,i).then(_=>{o(_),this.prune()}).catch(_=>{p(_)})});return this.cache.set(s,{lastUsed:this.counter++,data:u}),u})}getArrayBuffer(n,e,t,i){return gr(this,null,function*(){const s=`${n.getKey()}|${i.etag||""}|${e}|${t}`,c=this.cache.get(s);if(c)return c.lastUsed=this.counter++,yield c.data;const u=new Promise((o,p)=>{n.getBytes(e,t,void 0,i.etag).then(_=>{o(_.data),this.cache.has(s),this.prune()}).catch(_=>{p(_)})});return this.cache.set(s,{lastUsed:this.counter++,data:u}),u})}prune(){if(this.cache.size>=this.maxCacheEntries){let n=1/0,e;this.cache.forEach((t,i)=>{t.lastUsed<n&&(n=t.lastUsed,e=i)}),e&&this.cache.delete(e)}}invalidate(n){return gr(this,null,function*(){const e=n.getKey();if(this.invalidations.get(e))return yield this.invalidations.get(e);this.cache.delete(n.getKey());const t=new Promise((i,s)=>{this.getHeader(n).then(c=>{i(),this.invalidations.delete(e)}).catch(c=>{s(c)})});this.invalidations.set(e,t)})}},Jg=class{constructor(n,e,t){typeof n=="string"?this.source=new A5(n):this.source=n,t?this.decompress=t:this.decompress=hy,e?this.cache=e:this.cache=new R5}getHeader(){return gr(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(n,e,t,i){return gr(this,null,function*(){const s=T5(n,e,t),c=yield this.cache.getHeader(this.source);if(c.specVersion<3)return uy.getZxy(c,this.source,this.cache,n,e,t,i);if(n<c.minZoom||n>c.maxZoom)return;let u=c.rootDirectoryOffset,o=c.rootDirectoryLength;for(let p=0;p<=3;p++){const _=yield this.cache.getDirectory(this.source,u,o,c),v=P5(_,s);if(v){if(v.runLength>0){const M=yield this.source.getBytes(c.tileDataOffset+v.offset,v.length,i,c.etag);return{data:yield this.decompress(M.data,c.tileCompression),cacheControl:M.cacheControl,expires:M.expires}}u=c.leafDirectoryOffset+v.offset,o=v.length}else return}throw Error("Maximum directory depth exceeded")})}getZxy(n,e,t,i){return gr(this,null,function*(){try{return yield this.getZxyAttempt(n,e,t,i)}catch(s){if(s instanceof Zp)return this.cache.invalidate(this.source),yield this.getZxyAttempt(n,e,t,i);throw s}})}getMetadataAttempt(){return gr(this,null,function*(){const n=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(n.jsonMetadataOffset,n.jsonMetadataLength,void 0,n.etag),t=yield this.decompress(e.data,n.internalCompression),i=new TextDecoder("utf-8");return JSON.parse(i.decode(t))})}getMetadata(){return gr(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(n){if(n instanceof Zp)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw n}})}};const Ir=class Ir{constructor(e,t){ft(this,"location");ft(this,"isFlying",new ki(!1));ft(this,"zoom");ft(this,"bounds");ft(this,"rasterLayer");ft(this,"maxbounds");ft(this,"allowMoving");ft(this,"allowRotating");ft(this,"allowZooming");ft(this,"lastClickLocation");ft(this,"minzoom");ft(this,"maxzoom");ft(this,"rotation");ft(this,"pitch");ft(this,"useTerrain");ft(this,"showScale");ft(this,"_onKeyNavigation",[]);ft(this,"_maplibreMap");ft(this,"scaleControl");var o,p;Ir.pmtilesInited||(rw.addProtocol("pmtiles",new k5().tile),Ir.pmtilesInited=!0),this._maplibreMap=e,this.location=(t==null?void 0:t.location)??new ki(void 0),this.location.data&&this.location.setData({...this.location.data}),this.zoom=(t==null?void 0:t.zoom)??new ki(1),this.minzoom=(t==null?void 0:t.minzoom)??new ki(.5),this.maxzoom=(t==null?void 0:t.maxzoom)??new ki(24),this.zoom.addCallbackAndRunD(_=>{_<this.minzoom.data&&this.zoom.setData(this.minzoom.data);const v=Math.min(24,this.maxzoom.data??24);_>v&&this.zoom.setData(v)}),this.maxbounds=(t==null?void 0:t.maxbounds)??new ki(void 0),this.allowMoving=(t==null?void 0:t.allowMoving)??new ki(!0),this.allowRotating=(t==null?void 0:t.allowRotating)??new ki(!0),this.allowZooming=(t==null?void 0:t.allowZooming)??new ki(!0),this.bounds=(t==null?void 0:t.bounds)??new ki(void 0),this.rotation=(t==null?void 0:t.rotation)??new ki(0),this.pitch=(t==null?void 0:t.pitch)??new ki(0),this.useTerrain=(t==null?void 0:t.useTerrain)??new fd(!1),this.rasterLayer=(t==null?void 0:t.rasterLayer)??new ki(void 0),this.showScale=(t==null?void 0:t.showScale)??new ki(!1);const i=new ki(void 0);this.lastClickLocation=i;const s=this;new zu(this._maplibreMap,this.rasterLayer);const c=["left","middle","right"];function u(_,v){if(_.originalEvent.consumed)return;const M=_.lngLat.lng,S=_.lngLat.lat,I=_.originalEvent;v=v??c[I.button],i.setData({lon:M,lat:S,mode:v})}e.addCallbackAndRunD(_=>{_.on("load",()=>{s.MoveMapToCurrentLoc(s.location.data),s.SetZoom(s.zoom.data),s.setMaxBounds(s.maxbounds.data),s.setAllowMoving(s.allowMoving.data),s.setAllowRotating(s.allowRotating.data),s.setAllowZooming(s.allowZooming.data),s.setMinzoom(s.minzoom.data),s.setMaxzoom(s.maxzoom.data),s.setBounds(s.bounds.data),s.setTerrain(s.useTerrain.data),s.setScale(s.showScale.data),this.updateStores(!0)}),s.MoveMapToCurrentLoc(s.location.data),s.SetZoom(s.zoom.data),s.setMaxBounds(s.maxbounds.data),s.setAllowMoving(s.allowMoving.data),s.setAllowRotating(s.allowRotating.data),s.setAllowZooming(s.allowZooming.data),s.setMinzoom(s.minzoom.data),s.setMaxzoom(s.maxzoom.data),s.setBounds(s.bounds.data),s.SetRotation(s.rotation.data),s.setTerrain(s.useTerrain.data),s.setScale(s.showScale.data),this.updateStores(!0),_.on("movestart",()=>{this.isFlying.setData(!0)}),_.on("moveend",()=>{this.isFlying.setData(!1),this.updateStores()}),_.on("click",v=>{u(v)}),_._container.addEventListener("contextmenu",v=>{const M=_.unproject([v.x,v.y]);i.setData({lon:M.lng,lat:M.lat,mode:"right"})}),_.on("dblclick",v=>{u(v,"left")}),_.on("touchend",v=>{v.originalEvent}),_.on("rotateend",v=>{this.updateStores()}),_.on("pitchend",()=>{this.updateStores()}),_.getContainer().addEventListener("keydown",v=>{let M;switch(this.allowMoving.data||(M="islocked"),v.key){case"ArrowUp":this.pingKeycodeEvent(M??"north");break;case"ArrowRight":this.pingKeycodeEvent(M??"east");break;case"ArrowDown":this.pingKeycodeEvent(M??"south");break;case"ArrowLeft":this.pingKeycodeEvent(M??"west");break;case"+":this.pingKeycodeEvent("in");break;case"=":this.pingKeycodeEvent("in");break;case"-":this.pingKeycodeEvent("out");break}})}),this.location.addCallbackAndRunD(_=>{s.MoveMapToCurrentLoc(_)}),this.zoom.addCallbackAndRunD(_=>s.SetZoom(_)),this.maxbounds.addCallbackAndRun(_=>s.setMaxBounds(_)),this.rotation.addCallbackAndRunD(_=>s.SetRotation(_)),this.allowMoving.addCallbackAndRun(_=>{s.setAllowMoving(_),s.pingKeycodeEvent(_?"unlocked":"locked")}),this.allowRotating.addCallbackAndRunD(_=>s.setAllowRotating(_)),this.allowZooming.addCallbackAndRun(_=>s.setAllowZooming(_)),this.bounds.addCallbackAndRunD(_=>s.setBounds(_)),(o=this.useTerrain)==null||o.addCallbackAndRun(_=>s.setTerrain(_)),(p=this.showScale)==null||p.addCallbackAndRun(_=>s.setScale(_))}static construct(){const e=new ki(void 0);return{map:e,ui:new zd(G2,{map:e}),mapproperties:new Ir(e)}}static prepareWmsSource(e){return zu.prepareSource(e)}static async toBlob(e){return await new Promise(t=>e.toBlob(i=>t(i)))}static async createImage(e){return new Promise((t,i)=>{const s=new Image;s.decode=()=>t(s),s.onload=()=>t(s),s.onerror=i,s.crossOrigin="anonymous",s.decoding="async",s.src=e})}onKeyNavigationEvent(e){return this._onKeyNavigation.push(e),()=>{this._onKeyNavigation.splice(this._onKeyNavigation.indexOf(e),1)}}async exportAsPng(e=1,t=void 0){const i=this._maplibreMap.data;if(!i)return;const s=document.createElement("canvas",{}),c=s.getContext("2d"),u=i.getContainer().getBoundingClientRect().width,o=i.getContainer().getBoundingClientRect().height,p=i.getPixelRatio();return s.style.width=u+"px",s.style.height=o+"px",s.width=Math.ceil(u*p),s.height=Math.ceil(o*p),await this.exportBackgroundOnCanvas(c),await this.drawMarkers(c,e,t),await Ir.toBlob(s)}pingKeycodeEvent(e){const t={date:new Date,key:e};for(let i=0;i<this._onKeyNavigation.length;i++){const s=this._onKeyNavigation[i];s(t)===!0&&(this._onKeyNavigation.splice(i,1),i--)}}async exportBackgroundOnCanvas(e){const t=this._maplibreMap.data,i=new Promise(s=>{t.once("render",()=>{e.drawImage(t.getCanvas(),0,0),s()})});for(;!t.isStyleLoaded();)console.log("Waiting to fully load the style..."),await Gn.waitFor(100);t.triggerRepaint(),await i}async drawElement(e,t,i,s){{const X=t.getElementsByTagName("img");for(const oe of Array.from(X)){let Q=!1;for(;!Q;)console.log("Waiting for image",oe.src,"to load",oe.complete,oe.naturalWidth,oe),await Gn.waitFor(250),Q=oe.complete&&oe.width>0}}const c=t.style.transform;let u=t.getBoundingClientRect().x,o=t.getBoundingClientRect().y;t.style.transform="";const p=c.match(/translate\(([-0-9]+)%, ?([-0-9]+)%\)/);let _=Array.from(t.getElementsByClassName("marker-label"));const v=_.map(X=>X.style.transform),M=t.style.width,S=Number(t.style.height),I=Math.max(t.getBoundingClientRect().width*4,..._.map(X=>X.getBoundingClientRect().width)),R=t.getBoundingClientRect().height+Math.max(..._.map(X=>X.getBoundingClientRect().height*2));t.style.width=I+"px",t.style.height=R+"px",t.classList.add("w-full","flex","flex-col","items-center"),_.forEach(X=>{X.style.transform=""}),await Gn.awaitAnimationFrame();const G=await Kw(t),Y=await Ir.createImage(G);for(let X=0;X<_.length;X++)_[X].style.transform=v[X];if(t.style.width=""+M,t.style.height=""+S,p&&i!==1){const[X,oe,Q]=p,ce=Number(Q);o+=Y.height*(ce/100)}u*=s,o*=s;try{const X=Y.width*i/2;e.drawImage(Y,u-X,o,Y.width*i,Y.height*i)}catch(X){console.log("Could not draw image because of",X)}t.classList.remove("w-full","flex","flex-col","items-center")}async drawMarkers(e,t=1,i){const s=this._maplibreMap.data;if(!s){console.error("There is no map to export from");return}const c=s.getContainer(),u=s.getPixelRatio();function o(_){const v=_.getBoundingClientRect(),M=c.getBoundingClientRect();return!(M.left>v.right||M.right<v.left||M.top>v.bottom||M.bottom<v.top)}const p=Array.from(c.getElementsByClassName("marker"));for(let _=0;_<p.length;_++){const v=p[_],M=v.style.transform;o(v)&&await this.drawElement(e,v,t,u),i&&i.setData({current:_,total:p.length}),v.style.transform=M}}updateStores(e=!1){const t=this._maplibreMap.data;if(!t)return;const{lng:i,lat:s}=t.getCenter();if(i===0&&s===0)return;if(this.location.data===void 0)this.location.setData({lon:i,lat:s});else if(!e){const o=t.getCenter().lng,p=t.getCenter().lat;this.location.setData({lon:o,lat:p})}this.zoom.setData(Math.round(t.getZoom()*10)/10);const c=t.getBounds(),u=new Cx([[c.getEast(),c.getNorth()],[c.getWest(),c.getSouth()]]);(this.bounds.data===void 0||!e)&&this.bounds.setData(u),this.rotation.setData(t.getBearing()),this.pitch.setData(t.getPitch())}SetZoom(e){const t=this._maplibreMap.data;!t||e===void 0||this.isFlying.data||Math.abs(t.getZoom()-e)>.01&&t.setZoom(e)}SetRotation(e){const t=this._maplibreMap.data;!t||e===void 0||t.rotateTo(e,{duration:0})}MoveMapToCurrentLoc(e){const t=this._maplibreMap.data;if(!t||e===void 0)return;const i=t.getCenter();(i.lng!==e.lon||i.lat!==e.lat)&&(isNaN(e.lon)||isNaN(e.lat)?console.error("Got invalid lat or lon, not setting"):t.setCenter({lng:e.lon,lat:e.lat}))}installCustomKeyboardHandler(e){e.mapD(t=>{const i=this._maplibreMap.data;if(!i)return;const s=i.keyboard,c=t.getBoundingClientRect().width;if(c<10){console.log("Got a very small bound",c,t),window.requestAnimationFrame(()=>{e.ping()});return}s._panStep=c},[this._maplibreMap])}setMaxBounds(e){const t=this._maplibreMap.data;t&&(e?t==null||t.setMaxBounds(e.toLngLat()):t==null||t.setMaxBounds(null))}setAllowRotating(e){const t=this._maplibreMap.data;t&&(e===!1?(t.rotateTo(0,{duration:0}),t.setPitch(0),t.dragRotate.disable(),t.keyboard.disableRotation(),t.touchZoomRotate.disableRotation()):(t.dragRotate.enable(),t.keyboard.enableRotation(),t.touchZoomRotate.enableRotation()))}setAllowMoving(e){const t=this._maplibreMap.data;if(t){if(e===!1)for(const i of Ir.maplibre_control_handlers)t[i].disable();else for(const i of Ir.maplibre_control_handlers)t[i].enable();this.setAllowRotating(this.allowRotating.data)}}setMinzoom(e){const t=this._maplibreMap.data;t&&t.setMinZoom(e)}setMaxzoom(e){const t=this._maplibreMap.data;t&&t.setMaxZoom(e)}setAllowZooming(e){const t=this._maplibreMap.data;if(t)if(e===!1)for(const i of Ir.maplibre_zoom_handlers)t[i].disable();else for(const i of Ir.maplibre_zoom_handlers)t[i].enable()}setBounds(e){const t=this._maplibreMap.data;if(!t||e===void 0)return;const i=t.getBounds(),s=1e-7;Math.abs(i.getWest()-e.getWest())>s&&Math.abs(i.getEast()-e.getEast())>s&&Math.abs(i.getNorth()-e.getNorth())>s&&Math.abs(i.getSouth()-e.getSouth())>s&&(this.lockZoom(),t.fitBounds(e.toLngLat()))}lockZoom(){this.isFlying.setData(!0),this.zoom.setData(1)}async setTerrain(e){const t=this._maplibreMap.data;if(!t)return;const i="maptiler-terrain-data";if(e){if(t.getTerrain())return;t.addSource(i,{type:"raster-dem",url:"https://api.maptiler.com/tiles/terrain-rgb/tiles.json?key="+Nx.maptilerApiKey});try{for(;!(t!=null&&t.isStyleLoaded());)await Gn.waitFor(250);t.setTerrain({source:i})}catch(s){console.error(s)}}}setScale(e){const t=this._maplibreMap.data;if(t){if(!e){this.scaleControl&&(t.removeControl(this.scaleControl),this.scaleControl=void 0);return}this.scaleControl===void 0&&(this.scaleControl=new md.ScaleControl({maxWidth:100,unit:"metric"})),t.hasControl(this.scaleControl)||t.addControl(this.scaleControl,"bottom-right")}}flyTo(e,t,i){this.lockZoom(),window.requestAnimationFrame(()=>{var s;(s=this._maplibreMap.data)==null||s.flyTo({zoom:i,center:[e,t]})})}};ft(Ir,"maplibre_control_handlers",["dragRotate","dragPan","keyboard","touchZoomRotate"]),ft(Ir,"maplibre_zoom_handlers",["scrollZoom","boxZoom","doubleClickZoom","touchZoomRotate"]),ft(Ir,"pmtilesInited",!1);let Gp=Ir;function F5(n){let e,t,i,s,c;const u=n[2].default,o=Ra(u,n,n[1],null);let p=[{xmlns:"http://www.w3.org/2000/svg"},{fill:"none"},{viewBox:"0 0 24 24"},{"stroke-width":"1.5"},{stroke:"currentColor"},{"aria-hidden":"true"},n[0]],_={};for(let v=0;v<p.length;v+=1)_=Wi(_,p[v]);return{c(){e=et("svg"),o&&o.c(),t=et("path"),he(t,"stroke-linecap","round"),he(t,"stroke-linejoin","round"),he(t,"d","M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"),va(e,_)},m(v,M){at(v,e,M),o&&o.m(e,null),ve(e,t),i=!0,s||(c=[xt(e,"click",n[3]),xt(e,"mouseover",n[4]),xt(e,"mouseenter",n[5]),xt(e,"mouseleave",n[6]),xt(e,"keydown",n[7])],s=!0)},p(v,[M]){o&&o.p&&(!i||M&2)&&Fa(o,u,v,v[1],i?Ba(u,v[1],M,null):Oa(v[1]),null),va(e,_=ar(p,[{xmlns:"http://www.w3.org/2000/svg"},{fill:"none"},{viewBox:"0 0 24 24"},{"stroke-width":"1.5"},{stroke:"currentColor"},{"aria-hidden":"true"},M&1&&v[0]]))},i(v){i||(Fe(o,v),i=!0)},o(v){He(o,v),i=!1},d(v){v&&nt(e),o&&o.d(v),s=!1,rr(c)}}}function O5(n,e,t){const i=[];let s=Vn(e,i),{$$slots:c={},$$scope:u}=e;function o(S){ei.call(this,n,S)}function p(S){ei.call(this,n,S)}function _(S){ei.call(this,n,S)}function v(S){ei.call(this,n,S)}function M(S){ei.call(this,n,S)}return n.$$set=S=>{e=Wi(Wi({},e),nr(S)),t(0,s=Vn(e,i)),"$$scope"in S&&t(1,u=S.$$scope)},[s,u,c,o,p,_,v,M]}class B5 extends Zi{constructor(e){super(),Gi(this,e,O5,F5,$i,{})}}function N5(n){let e,t,i,s,c;const u=n[2].default,o=Ra(u,n,n[1],null);let p=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 20 20"},{fill:"currentColor"},{"aria-hidden":"true"},n[0]],_={};for(let v=0;v<p.length;v+=1)_=Wi(_,p[v]);return{c(){e=et("svg"),o&&o.c(),t=et("path"),he(t,"fill-rule","evenodd"),he(t,"d","M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z"),he(t,"clip-rule","evenodd"),va(e,_)},m(v,M){at(v,e,M),o&&o.m(e,null),ve(e,t),i=!0,s||(c=[xt(e,"click",n[3]),xt(e,"mouseover",n[4]),xt(e,"mouseenter",n[5]),xt(e,"mouseleave",n[6]),xt(e,"keydown",n[7])],s=!0)},p(v,[M]){o&&o.p&&(!i||M&2)&&Fa(o,u,v,v[1],i?Ba(u,v[1],M,null):Oa(v[1]),null),va(e,_=ar(p,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 20 20"},{fill:"currentColor"},{"aria-hidden":"true"},M&1&&v[0]]))},i(v){i||(Fe(o,v),i=!0)},o(v){He(o,v),i=!1},d(v){v&&nt(e),o&&o.d(v),s=!1,rr(c)}}}function V5(n,e,t){const i=[];let s=Vn(e,i),{$$slots:c={},$$scope:u}=e;function o(S){ei.call(this,n,S)}function p(S){ei.call(this,n,S)}function _(S){ei.call(this,n,S)}function v(S){ei.call(this,n,S)}function M(S){ei.call(this,n,S)}return n.$$set=S=>{e=Wi(Wi({},e),nr(S)),t(0,s=Vn(e,i)),"$$scope"in S&&t(1,u=S.$$scope)},[s,u,c,o,p,_,v,M]}class H5 extends Zi{constructor(e){super(),Gi(this,e,V5,N5,$i,{})}}function j5(n){let e,t,i,s,c;const u=n[2].default,o=Ra(u,n,n[1],null);let p=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 20 20"},{fill:"currentColor"},{"aria-hidden":"true"},n[0]],_={};for(let v=0;v<p.length;v+=1)_=Wi(_,p[v]);return{c(){e=et("svg"),o&&o.c(),t=et("path"),he(t,"fill-rule","evenodd"),he(t,"d","M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.52.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4zM8.58 7.72a.75.75 0 00-1.5.06l.3 7.5a.75.75 0 101.5-.06l-.3-7.5zm4.34.06a.75.75 0 10-1.5-.06l-.3 7.5a.75.75 0 101.5.06l.3-7.5z"),he(t,"clip-rule","evenodd"),va(e,_)},m(v,M){at(v,e,M),o&&o.m(e,null),ve(e,t),i=!0,s||(c=[xt(e,"click",n[3]),xt(e,"mouseover",n[4]),xt(e,"mouseenter",n[5]),xt(e,"mouseleave",n[6]),xt(e,"keydown",n[7])],s=!0)},p(v,[M]){o&&o.p&&(!i||M&2)&&Fa(o,u,v,v[1],i?Ba(u,v[1],M,null):Oa(v[1]),null),va(e,_=ar(p,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 20 20"},{fill:"currentColor"},{"aria-hidden":"true"},M&1&&v[0]]))},i(v){i||(Fe(o,v),i=!0)},o(v){He(o,v),i=!1},d(v){v&&nt(e),o&&o.d(v),s=!1,rr(c)}}}function U5(n,e,t){const i=[];let s=Vn(e,i),{$$slots:c={},$$scope:u}=e;function o(S){ei.call(this,n,S)}function p(S){ei.call(this,n,S)}function _(S){ei.call(this,n,S)}function v(S){ei.call(this,n,S)}function M(S){ei.call(this,n,S)}return n.$$set=S=>{e=Wi(Wi({},e),nr(S)),t(0,s=Vn(e,i)),"$$scope"in S&&t(1,u=S.$$scope)},[s,u,c,o,p,_,v,M]}class Hd extends Zi{constructor(e){super(),Gi(this,e,U5,j5,$i,{})}}class tP extends Hu{constructor(t,i=!1){super();ft(this,"uiElements");ft(this,"_ordered");this._ordered=i,this.uiElements=Gn.NoNull(t).map(s=>yr.W(s))}AsMarkdown(){return this._ordered?`

`+this.uiElements.map((t,i)=>"  "+i+". "+t.AsMarkdown().replace(/\n/g,`  
`)).join(`
`)+`
`:`

`+this.uiElements.map(t=>"  - "+t.AsMarkdown().replace(/\n/g,`  
`)).join(`
`)+`
`}InnerConstructElement(){const t=document.createElement(this._ordered?"ol":"ul");for(const i of this.uiElements){if(i==null)continue;const s=i.ConstructElement();if(s!==void 0){const c=document.createElement("li");c.appendChild(s),t.appendChild(c)}}return t}}class W5{async getRelevantUrlsFor(e,t){var c,u;const i=[],s=new Set;for(const o in e){if(!t.some(_=>o===_||o.match(new RegExp(_+":[0-9]+"))))continue;const p=Gn.NoEmpty(((u=(c=e[o])==null?void 0:c.split(";"))==null?void 0:u.map(_=>_.trim()))??[]);for(const _ of p){if(s.has(_))continue;s.add(_);let v=this.ExtractUrls(o,_);Array.isArray(v)||(v=await v),v&&i.push(...v)}}return i}getRelevantUrls(e,t){return dd.FromPromise(this.getRelevantUrlsFor(e,t))}}class q5{constructor(){ft(this,"title","");ft(this,"artist","");ft(this,"license");ft(this,"licenseShortName","");ft(this,"usageTerms","");ft(this,"attributionRequired",!1);ft(this,"copyrighted",!1);ft(this,"credit","");ft(this,"description","");ft(this,"informationLocation");ft(this,"date");ft(this,"views")}}class ym{static async GetCategoryContents(e,t=10,i=void 0){var _;if(e==null||e==="")return[];e.startsWith("Category:")||(e="Category:"+e);let s="https://commons.wikimedia.org/w/api.php?action=query&list=categorymembers&format=json&&origin=*&cmtitle="+encodeURIComponent(e);i!==void 0&&(s=`${s}&cmcontinue=${i}`);const c=await Gn.downloadJson(s),o=(((_=c.query)==null?void 0:_.categorymembers)??[]).map(v=>v.title);if(c.continue===void 0)return o;if(t-o.length<=0)return console.debug(`Recursive wikimedia category load stopped for ${e}`),o;const p=await ym.GetCategoryContents(e,t-o.length,c.continue.cmcontinue);return o.push(...p),o}}function Z5(n){let e,t,i,s,c,u,o,p,_,v,M,S,I,R,G,Y,X,oe,Q,ce,De,Oe,Pe,Se,_e,ze,Re,Ye,Xe,si,Bt,bi,Et,Vt,Ki,zt,_t,Dt,Ft,oi,pi,vi,Ti,ht,mi,Pi,Ni,Oi,mn,vn,Yi,Kn,je,Ci,Dn,xi,tn,xn,tt,bn,_n,cn,ta,pa,rt,jn,hn,Un,Ii,lt,gi,_i,on,wn,ni,Ei,ji,re,U,J,te,se,Ae,Ee,$,O,V,q,L,W,ae,Me,Ie,Qe,Ge,$e,Te,gt,wt,St,$t,Tt,Ct,Si,Ai,Wn,Aa=[n[0],{xmlns:"http://www.w3.org/2000/svg"},{width:"279px"},{height:"374px"},{viewBox:"0 0 279 374"},{version:"1.1"}],Fi={};for(let ia=0;ia<Aa.length;ia+=1)Fi=Wi(Fi,Aa[ia]);return{c(){e=et("svg"),t=et("defs"),i=et("clipPath"),s=et("path"),c=et("clipPath"),u=et("path"),o=et("clipPath"),p=et("path"),_=et("clipPath"),v=et("path"),M=et("clipPath"),S=et("path"),I=et("clipPath"),R=et("path"),G=et("clipPath"),Y=et("path"),X=et("clipPath"),oe=et("path"),Q=et("clipPath"),ce=et("path"),De=et("clipPath"),Oe=et("path"),Pe=et("clipPath"),Se=et("path"),_e=et("clipPath"),ze=et("path"),Re=et("clipPath"),Ye=et("path"),Xe=et("clipPath"),si=et("path"),Bt=et("clipPath"),bi=et("path"),Et=et("clipPath"),Vt=et("path"),Ki=et("clipPath"),zt=et("path"),_t=et("clipPath"),Dt=et("path"),Ft=et("clipPath"),oi=et("path"),pi=et("clipPath"),vi=et("path"),Ti=et("clipPath"),ht=et("path"),mi=et("clipPath"),Pi=et("path"),Ni=et("clipPath"),Oi=et("path"),mn=et("clipPath"),vn=et("path"),Yi=et("clipPath"),Kn=et("path"),je=et("clipPath"),Ci=et("path"),Dn=et("clipPath"),xi=et("path"),tn=et("clipPath"),xn=et("path"),tt=et("g"),bn=et("path"),_n=et("path"),cn=et("path"),ta=et("g"),pa=et("g"),rt=et("path"),jn=et("g"),hn=et("g"),Un=et("path"),Ii=et("g"),lt=et("g"),gi=et("path"),_i=et("g"),on=et("g"),wn=et("path"),ni=et("g"),Ei=et("g"),ji=et("path"),re=et("g"),U=et("g"),J=et("path"),te=et("g"),se=et("g"),Ae=et("path"),Ee=et("g"),$=et("g"),O=et("path"),V=et("g"),q=et("g"),L=et("path"),W=et("g"),ae=et("g"),Me=et("path"),Ie=et("g"),Qe=et("g"),Ge=et("path"),$e=et("g"),Te=et("g"),gt=et("path"),wt=et("g"),St=et("g"),$t=et("path"),Tt=et("g"),Ct=et("g"),Si=et("path"),he(s,"d","M 134 317 L 145 317 L 145 372 L 134 372 Z M 134 317 "),he(i,"id","clip1"),he(u,"d","M 275.746094 235.347656 C 275.746094 310.410156 214.746094 371.261719 139.5 371.261719 C 64.253906 371.261719 3.253906 310.410156 3.253906 235.347656 C 3.253906 160.28125 64.253906 99.429688 139.5 99.429688 C 214.746094 99.429688 275.746094 160.28125 275.746094 235.347656 Z M 275.746094 235.347656 "),he(c,"id","clip2"),he(p,"d","M 119 285 L 160 285 L 160 320 L 119 320 Z M 119 285 "),he(o,"id","clip3"),he(v,"d","M 275.746094 235.347656 C 275.746094 310.410156 214.746094 371.261719 139.5 371.261719 C 64.253906 371.261719 3.253906 310.410156 3.253906 235.347656 C 3.253906 160.28125 64.253906 99.429688 139.5 99.429688 C 214.746094 99.429688 275.746094 160.28125 275.746094 235.347656 Z M 275.746094 235.347656 "),he(_,"id","clip4"),he(S,"d","M 39 289 L 85 289 L 85 335 L 39 335 Z M 39 289 "),he(M,"id","clip5"),he(R,"d","M 235.839844 331.453125 C 182.632812 384.53125 96.367188 384.53125 43.160156 331.453125 C -10.046875 278.375 -10.046875 192.316406 43.160156 139.238281 C 96.367188 86.160156 182.632812 86.160156 235.839844 139.238281 C 289.046875 192.316406 289.046875 278.375 235.839844 331.453125 Z M 235.839844 331.453125 "),he(I,"id","clip6"),he(Y,"d","M 65 270 L 104 270 L 104 309 L 65 309 Z M 65 270 "),he(G,"id","clip7"),he(oe,"d","M 235.839844 331.453125 C 182.632812 384.53125 96.367188 384.53125 43.160156 331.453125 C -10.046875 278.375 -10.046875 192.316406 43.160156 139.238281 C 96.367188 86.160156 182.632812 86.160156 235.839844 139.238281 C 289.046875 192.316406 289.046875 278.375 235.839844 331.453125 Z M 235.839844 331.453125 "),he(X,"id","clip8"),he(ce,"d","M 3 230 L 58 230 L 58 241 L 3 241 Z M 3 230 "),he(Q,"id","clip9"),he(Oe,"d","M 139.5 371.261719 C 64.253906 371.261719 3.253906 310.410156 3.253906 235.347656 C 3.253906 160.28125 64.253906 99.429688 139.5 99.429688 C 214.746094 99.429688 275.746094 160.28125 275.746094 235.347656 C 275.746094 310.410156 214.746094 371.261719 139.5 371.261719 Z M 139.5 371.261719 "),he(De,"id","clip10"),he(Se,"d","M 54 215 L 90 215 L 90 255 L 54 255 Z M 54 215 "),he(Pe,"id","clip11"),he(ze,"d","M 139.5 371.261719 C 64.253906 371.261719 3.253906 310.410156 3.253906 235.347656 C 3.253906 160.28125 64.253906 99.429688 139.5 99.429688 C 214.746094 99.429688 275.746094 160.28125 275.746094 235.347656 C 275.746094 310.410156 214.746094 371.261719 139.5 371.261719 Z M 139.5 371.261719 "),he(_e,"id","clip12"),he(Ye,"d","M 39 135 L 85 135 L 85 181 L 39 181 Z M 39 135 "),he(Re,"id","clip13"),he(si,"d","M 43.160156 331.453125 C -10.046875 278.375 -10.046875 192.316406 43.160156 139.238281 C 96.367188 86.160156 182.632812 86.160156 235.839844 139.238281 C 289.046875 192.316406 289.046875 278.375 235.839844 331.453125 C 182.632812 384.53125 96.367188 384.53125 43.160156 331.453125 Z M 43.160156 331.453125 "),he(Xe,"id","clip14"),he(bi,"d","M 65 161 L 104 161 L 104 200 L 65 200 Z M 65 161 "),he(Bt,"id","clip15"),he(Vt,"d","M 43.160156 331.453125 C -10.046875 278.375 -10.046875 192.316406 43.160156 139.238281 C 96.367188 86.160156 182.632812 86.160156 235.839844 139.238281 C 289.046875 192.316406 289.046875 278.375 235.839844 331.453125 C 182.632812 384.53125 96.367188 384.53125 43.160156 331.453125 Z M 43.160156 331.453125 "),he(Et,"id","clip16"),he(zt,"d","M 194 289 L 240 289 L 240 335 L 194 335 Z M 194 289 "),he(Ki,"id","clip17"),he(Dt,"d","M 43.160156 331.453125 C 96.367188 384.53125 182.632812 384.53125 235.839844 331.453125 C 289.046875 278.375 289.046875 192.316406 235.839844 139.238281 C 182.632812 86.160156 96.367188 86.160156 43.160156 139.238281 C -10.046875 192.316406 -10.046875 278.375 43.160156 331.453125 Z M 43.160156 331.453125 "),he(_t,"id","clip18"),he(oi,"d","M 175 270 L 214 270 L 214 309 L 175 309 Z M 175 270 "),he(Ft,"id","clip19"),he(vi,"d","M 43.160156 331.453125 C 96.367188 384.53125 182.632812 384.53125 235.839844 331.453125 C 289.046875 278.375 289.046875 192.316406 235.839844 139.238281 C 182.632812 86.160156 96.367188 86.160156 43.160156 139.238281 C -10.046875 192.316406 -10.046875 278.375 43.160156 331.453125 Z M 43.160156 331.453125 "),he(pi,"id","clip20"),he(ht,"d","M 221 230 L 276 230 L 276 241 L 221 241 Z M 221 230 "),he(Ti,"id","clip21"),he(Pi,"d","M 139.5 371.261719 C 214.746094 371.261719 275.746094 310.410156 275.746094 235.347656 C 275.746094 160.28125 214.746094 99.429688 139.5 99.429688 C 64.253906 99.429688 3.253906 160.28125 3.253906 235.347656 C 3.253906 310.410156 64.253906 371.261719 139.5 371.261719 Z M 139.5 371.261719 "),he(mi,"id","clip22"),he(Oi,"d","M 189 215 L 225 215 L 225 255 L 189 255 Z M 189 215 "),he(Ni,"id","clip23"),he(vn,"d","M 139.5 371.261719 C 214.746094 371.261719 275.746094 310.410156 275.746094 235.347656 C 275.746094 160.28125 214.746094 99.429688 139.5 99.429688 C 64.253906 99.429688 3.253906 160.28125 3.253906 235.347656 C 3.253906 310.410156 64.253906 371.261719 139.5 371.261719 Z M 139.5 371.261719 "),he(mn,"id","clip24"),he(Kn,"d","M 194 135 L 240 135 L 240 181 L 194 181 Z M 194 135 "),he(Yi,"id","clip25"),he(Ci,"d","M 235.839844 331.453125 C 289.046875 278.375 289.046875 192.316406 235.839844 139.238281 C 182.632812 86.160156 96.367188 86.160156 43.160156 139.238281 C -10.046875 192.316406 -10.046875 278.375 43.160156 331.453125 C 96.367188 384.53125 182.632812 384.53125 235.839844 331.453125 Z M 235.839844 331.453125 "),he(je,"id","clip26"),he(xi,"d","M 175 161 L 214 161 L 214 200 L 175 200 Z M 175 161 "),he(Dn,"id","clip27"),he(xn,"d","M 235.839844 331.453125 C 289.046875 278.375 289.046875 192.316406 235.839844 139.238281 C 182.632812 86.160156 96.367188 86.160156 43.160156 139.238281 C -10.046875 192.316406 -10.046875 278.375 43.160156 331.453125 C 96.367188 384.53125 182.632812 384.53125 235.839844 331.453125 Z M 235.839844 331.453125 "),he(tn,"id","clip28"),Ke(bn,"stroke","none"),Ke(bn,"fill-rule","nonzero"),Ke(bn,"fill","rgb(100%,100%,100%)"),Ke(bn,"fill-opacity","1"),he(bn,"d","M 185.21875 235.347656 C 185.21875 260.535156 164.75 280.957031 139.5 280.957031 C 114.25 280.957031 93.78125 260.535156 93.78125 235.347656 C 93.78125 210.15625 114.25 189.738281 139.5 189.738281 C 164.75 189.738281 185.21875 210.15625 185.21875 235.347656 Z M 185.21875 235.347656 "),Ke(_n,"fill","none",1),Ke(_n,"stroke-width","84"),Ke(_n,"stroke-linecap","butt"),Ke(_n,"stroke-linejoin","miter"),Ke(_n,"stroke","rgb(100%,100%,100%)"),Ke(_n,"stroke-opacity","1"),Ke(_n,"stroke-miterlimit","4"),he(_n,"d","M -0.000738017 -255.996731 C -141.388895 -256.001049 -256.005126 -141.384818 -256.000807 0.00333872 C -256.00253 141.385454 -141.385454 256.00253 -0.00333872 256.000807 C 141.384818 256.005126 256.001049 141.388895 255.996731 0.000738017 C 256.002819 -100.002285 155.001784 -149.999521 250.002579 -275.001813 "),he(_n,"transform","matrix(0.323291,-0.32251,0.323291,0.32251,139.5,235.346341)"),Ke(cn,"stroke","none"),Ke(cn,"fill-rule","nonzero"),Ke(cn,"fill","rgb(100%,100%,100%)"),Ke(cn,"fill-opacity","1"),he(cn,"d","M 128.984375 0.457031 C 128.984375 0.457031 112.523438 62.027344 92.40625 84.835938 C 72.292969 107.640625 145.445312 56.554688 170.132812 82.554688 C 194.820312 108.550781 128.984375 0.457031 128.984375 0.457031 Z M 128.984375 0.457031 "),Ke(rt,"stroke","none"),Ke(rt,"fill-rule","nonzero"),Ke(rt,"fill","rgb(100%,100%,100%)"),Ke(rt,"fill-opacity","1"),he(rt,"d","M 134.472656 317.445312 L 134.472656 371.261719 L 144.527344 371.261719 L 144.527344 317.445312 "),he(pa,"clip-path","url(#clip2)"),he(pa,"clip-rule","nonzero"),he(ta,"clip-path","url(#clip1)"),he(ta,"clip-rule","nonzero"),Ke(Un,"stroke","none"),Ke(Un,"fill-rule","nonzero"),Ke(Un,"fill","rgb(100%,100%,100%)"),Ke(Un,"fill-opacity","1"),he(Un,"d","M 119.839844 319.722656 L 139.5 285.515625 L 159.160156 319.722656 "),he(hn,"clip-path","url(#clip4)"),he(hn,"clip-rule","nonzero"),he(jn,"clip-path","url(#clip3)"),he(jn,"clip-rule","nonzero"),Ke(gi,"stroke","none"),Ke(gi,"fill-rule","nonzero"),Ke(gi,"fill","rgb(100%,100%,100%)"),Ke(gi,"fill-opacity","1"),he(gi,"d","M 77.75 289.851562 L 39.601562 327.90625 L 46.714844 335 L 84.863281 296.945312 "),he(lt,"clip-path","url(#clip6)"),he(lt,"clip-rule","nonzero"),he(Ii,"clip-path","url(#clip5)"),he(Ii,"clip-rule","nonzero"),Ke(wn,"stroke","none"),Ke(wn,"fill-rule","nonzero"),Ke(wn,"fill","rgb(100%,100%,100%)"),Ke(wn,"fill-opacity","1"),he(wn,"d","M 65.789062 281.144531 L 103.9375 270.824219 L 93.59375 308.878906 "),he(on,"clip-path","url(#clip8)"),he(on,"clip-rule","nonzero"),he(_i,"clip-path","url(#clip7)"),he(_i,"clip-rule","nonzero"),Ke(ji,"stroke","none"),Ke(ji,"fill-rule","nonzero"),Ke(ji,"fill","rgb(100%,100%,100%)"),Ke(ji,"fill-opacity","1"),he(ji,"d","M 57.203125 230.328125 L 3.253906 230.328125 L 3.253906 240.363281 L 57.203125 240.363281 "),he(Ei,"clip-path","url(#clip10)"),he(Ei,"clip-rule","nonzero"),he(ni,"clip-path","url(#clip9)"),he(ni,"clip-rule","nonzero"),Ke(J,"stroke","none"),Ke(J,"fill-rule","nonzero"),Ke(J,"fill","rgb(100%,100%,100%)"),Ke(J,"fill-opacity","1"),he(J,"d","M 54.917969 215.734375 L 89.207031 235.347656 L 54.917969 254.957031 "),he(U,"clip-path","url(#clip12)"),he(U,"clip-rule","nonzero"),he(re,"clip-path","url(#clip11)"),he(re,"clip-rule","nonzero"),Ke(Ae,"stroke","none"),Ke(Ae,"fill-rule","nonzero"),Ke(Ae,"fill","rgb(100%,100%,100%)"),Ke(Ae,"fill-opacity","1"),he(Ae,"d","M 84.863281 173.746094 L 46.714844 135.691406 L 39.601562 142.785156 L 77.75 180.84375 "),he(se,"clip-path","url(#clip14)"),he(se,"clip-rule","nonzero"),he(te,"clip-path","url(#clip13)"),he(te,"clip-rule","nonzero"),Ke(O,"stroke","none"),Ke(O,"fill-rule","nonzero"),Ke(O,"fill","rgb(100%,100%,100%)"),Ke(O,"fill-opacity","1"),he(O,"d","M 93.59375 161.8125 L 103.9375 199.871094 L 65.789062 189.550781 "),he($,"clip-path","url(#clip16)"),he($,"clip-rule","nonzero"),he(Ee,"clip-path","url(#clip15)"),he(Ee,"clip-rule","nonzero"),Ke(L,"stroke","none"),Ke(L,"fill-rule","nonzero"),Ke(L,"fill","rgb(100%,100%,100%)"),Ke(L,"fill-opacity","1"),he(L,"d","M 201.25 289.851562 L 239.398438 327.90625 L 232.285156 335 L 194.136719 296.945312 "),he(q,"clip-path","url(#clip18)"),he(q,"clip-rule","nonzero"),he(V,"clip-path","url(#clip17)"),he(V,"clip-rule","nonzero"),Ke(Me,"stroke","none"),Ke(Me,"fill-rule","nonzero"),Ke(Me,"fill","rgb(100%,100%,100%)"),Ke(Me,"fill-opacity","1"),he(Me,"d","M 213.210938 281.144531 L 175.0625 270.824219 L 185.40625 308.878906 "),he(ae,"clip-path","url(#clip20)"),he(ae,"clip-rule","nonzero"),he(W,"clip-path","url(#clip19)"),he(W,"clip-rule","nonzero"),Ke(Ge,"stroke","none"),Ke(Ge,"fill-rule","nonzero"),Ke(Ge,"fill","rgb(100%,100%,100%)"),Ke(Ge,"fill-opacity","1"),he(Ge,"d","M 221.796875 230.328125 L 275.746094 230.328125 L 275.746094 240.363281 L 221.796875 240.363281 "),he(Qe,"clip-path","url(#clip22)"),he(Qe,"clip-rule","nonzero"),he(Ie,"clip-path","url(#clip21)"),he(Ie,"clip-rule","nonzero"),Ke(gt,"stroke","none"),Ke(gt,"fill-rule","nonzero"),Ke(gt,"fill","rgb(100%,100%,100%)"),Ke(gt,"fill-opacity","1"),he(gt,"d","M 224.082031 215.734375 L 189.792969 235.347656 L 224.082031 254.957031 "),he(Te,"clip-path","url(#clip24)"),he(Te,"clip-rule","nonzero"),he($e,"clip-path","url(#clip23)"),he($e,"clip-rule","nonzero"),Ke($t,"stroke","none"),Ke($t,"fill-rule","nonzero"),Ke($t,"fill","rgb(100%,100%,100%)"),Ke($t,"fill-opacity","1"),he($t,"d","M 194.136719 173.746094 L 232.285156 135.691406 L 239.398438 142.785156 L 201.25 180.84375 "),he(St,"clip-path","url(#clip26)"),he(St,"clip-rule","nonzero"),he(wt,"clip-path","url(#clip25)"),he(wt,"clip-rule","nonzero"),Ke(Si,"stroke","none"),Ke(Si,"fill-rule","nonzero"),Ke(Si,"fill","rgb(100%,100%,100%)"),Ke(Si,"fill-opacity","1"),he(Si,"d","M 185.40625 161.8125 L 175.0625 199.871094 L 213.210938 189.550781 "),he(Ct,"clip-path","url(#clip28)"),he(Ct,"clip-rule","nonzero"),he(Tt,"clip-path","url(#clip27)"),he(Tt,"clip-rule","nonzero"),he(tt,"id","surface1"),va(e,Fi)},m(ia,Wa){at(ia,e,Wa),ve(e,t),ve(t,i),ve(i,s),ve(t,c),ve(c,u),ve(t,o),ve(o,p),ve(t,_),ve(_,v),ve(t,M),ve(M,S),ve(t,I),ve(I,R),ve(t,G),ve(G,Y),ve(t,X),ve(X,oe),ve(t,Q),ve(Q,ce),ve(t,De),ve(De,Oe),ve(t,Pe),ve(Pe,Se),ve(t,_e),ve(_e,ze),ve(t,Re),ve(Re,Ye),ve(t,Xe),ve(Xe,si),ve(t,Bt),ve(Bt,bi),ve(t,Et),ve(Et,Vt),ve(t,Ki),ve(Ki,zt),ve(t,_t),ve(_t,Dt),ve(t,Ft),ve(Ft,oi),ve(t,pi),ve(pi,vi),ve(t,Ti),ve(Ti,ht),ve(t,mi),ve(mi,Pi),ve(t,Ni),ve(Ni,Oi),ve(t,mn),ve(mn,vn),ve(t,Yi),ve(Yi,Kn),ve(t,je),ve(je,Ci),ve(t,Dn),ve(Dn,xi),ve(t,tn),ve(tn,xn),ve(e,tt),ve(tt,bn),ve(tt,_n),ve(tt,cn),ve(tt,ta),ve(ta,pa),ve(pa,rt),ve(tt,jn),ve(jn,hn),ve(hn,Un),ve(tt,Ii),ve(Ii,lt),ve(lt,gi),ve(tt,_i),ve(_i,on),ve(on,wn),ve(tt,ni),ve(ni,Ei),ve(Ei,ji),ve(tt,re),ve(re,U),ve(U,J),ve(tt,te),ve(te,se),ve(se,Ae),ve(tt,Ee),ve(Ee,$),ve($,O),ve(tt,V),ve(V,q),ve(q,L),ve(tt,W),ve(W,ae),ve(ae,Me),ve(tt,Ie),ve(Ie,Qe),ve(Qe,Ge),ve(tt,$e),ve($e,Te),ve(Te,gt),ve(tt,wt),ve(wt,St),ve(St,$t),ve(tt,Tt),ve(Tt,Ct),ve(Ct,Si),Ai||(Wn=[xt(e,"click",n[2]),xt(e,"mouseover",n[3]),xt(e,"mouseenter",n[4]),xt(e,"mouseleave",n[5]),xt(e,"keydown",n[6]),xt(e,"focus",n[7])],Ai=!0)},p(ia,[Wa]){va(e,Fi=ar(Aa,[Wa&1&&ia[0],{xmlns:"http://www.w3.org/2000/svg"},{width:"279px"},{height:"374px"},{viewBox:"0 0 279 374"},{version:"1.1"}]))},i:ci,o:ci,d(ia){ia&&nt(e),Ai=!1,rr(Wn)}}}function G5(n,e,t){const i=["color"];let s=Vn(e,i),{color:c="#000000"}=e;function u(S){ei.call(this,n,S)}function o(S){ei.call(this,n,S)}function p(S){ei.call(this,n,S)}function _(S){ei.call(this,n,S)}function v(S){ei.call(this,n,S)}function M(S){ei.call(this,n,S)}return n.$$set=S=>{e=Wi(Wi({},e),nr(S)),t(0,s=Vn(e,i)),"color"in S&&t(1,c=S.color)},[s,c,u,o,p,_,v,M]}class $5 extends Zi{constructor(e){super(),Gi(this,e,G5,Z5,$i,{color:1})}}const pr=class pr extends W5{constructor(){super();ft(this,"commons_key","wikimedia_commons");ft(this,"defaultKeyPrefixes",[this.commons_key,"image"]);ft(this,"name","Wikimedia")}static ExtractFileName(t){if(!t.startsWith("http"))return t;const i=new URL(t).pathname;return i.substring(i.lastIndexOf("/")+1)}static PrepareUrl(t,i=!1){if(t.toLowerCase().startsWith("https://commons.wikimedia.org/wiki/"))return t;const s=`https://commons.wikimedia.org/wiki/Special:FilePath/${encodeURIComponent(t)}`;return i?s:s+"?width=500&height=400"}static startsWithCommonsPrefix(t){return pr.commonsPrefixes.some(i=>t.startsWith(i))}static removeCommonsPrefix(t){if(t.startsWith("https://upload.wikimedia.org/"))return t=t.substring(t.lastIndexOf("/")+1),t=decodeURIComponent(t),t.startsWith("File:")||(t="File:"+t),t;for(const i of pr.commonsPrefixes)if(t.startsWith(i)){let s=t.substr(i.length);return i.startsWith("http")&&(s=decodeURIComponent(s)),s}return t}apiUrls(){return pr.apiUrls}SourceIcon(){return new zd($5).SetStyle("width:2em;height: 2em")}PrepUrl(t){if(t!==void 0)return t=pr.removeCommonsPrefix(t),t.startsWith("File:")?this.UrlForImage(t):this.UrlForImage("File:"+t)}async ExtractUrls(t,i){const s=pr.startsWithCommonsPrefix(i);if(!(t!==void 0&&t!==this.commons_key&&!s)){if(i=pr.removeCommonsPrefix(i),i.startsWith("Category:"))return(await ym.GetCategoryContents(i)).filter(u=>u.startsWith("File:")).map(u=>this.UrlForImage(u));if(i.startsWith("File:"))return[this.UrlForImage(i)];if(!i.startsWith("http"))return[this.UrlForImage("File:"+i)]}}async DownloadAttribution(t){var v,M,S,I,R,G,Y,X,oe;const i=pr.ExtractFileName(t.url);if(i==="")return;const s="https://en.wikipedia.org/w/api.php?action=query&prop=imageinfo&iiprop=extmetadata&titles="+i+"&format=json&origin=*",c=await Gn.downloadJsonCached(s,365*24*60*60),u=new q5,o=c.query.pages.at(-1);if(o===void 0)return;const p=(v=(o.imageinfo??[])[0])==null?void 0:v.extmetadata;if(p===void 0){console.warn("The file",i,"has no usable metedata or license attached... Please fix the license info file yourself!");return}let _=o.title;return _.startsWith("File:")&&(_=_.substr(5)),(_.endsWith(".jpg")||_.endsWith(".png"))&&(_=_.substring(0,_.length-4)),u.title=_,u.artist=(M=p.Artist)==null?void 0:M.value,u.license=(S=p.License)==null?void 0:S.value,u.copyrighted=(I=p.Copyrighted)==null?void 0:I.value,u.attributionRequired=(R=p.AttributionRequired)==null?void 0:R.value,u.usageTerms=(G=p.UsageTerms)==null?void 0:G.value,u.licenseShortName=(Y=p.LicenseShortName)==null?void 0:Y.value,u.credit=(X=p.Credit)==null?void 0:X.value,u.description=(oe=p.ImageDescription)==null?void 0:oe.value,u.informationLocation=new URL("https://en.wikipedia.org/wiki/"+o.title),u}UrlForImage(t){return t.startsWith("File:")||(t="File:"+t),{url:pr.PrepareUrl(t),url_hd:pr.PrepareUrl(t,!0),key:void 0,provider:this,id:t}}};ft(pr,"singleton",new pr),ft(pr,"apiUrls",["https://commons.wikimedia.org/wiki/","https://upload.wikimedia.org"]),ft(pr,"commonsPrefixes",[...pr.apiUrls,"File:"]);let $p=pr;function K5(n){let e,t,i,s,c,u,o,p=[n[0],{xmlns:"http://www.w3.org/2000/svg"},{width:"373px"},{height:"210px"},{viewBox:"0 0 373 210"},{version:"1.1"}],_={};for(let v=0;v<p.length;v+=1)_=Wi(_,p[v]);return{c(){e=et("svg"),t=et("g"),i=et("path"),s=et("path"),c=et("path"),Ke(i,"stroke","none"),Ke(i,"fill-rule","nonzero"),Ke(i,"fill","rgb(60.000002%,0%,0%)"),Ke(i,"fill-opacity","1"),he(i,"d","M 42.628906 193.984375 L 53.285156 193.984375 L 53.285156 16.015625 L 42.628906 16.015625 Z M 63.941406 193.984375 L 95.914062 193.984375 L 95.914062 16.015625 L 63.941406 16.015625 Z M 106.570312 16.015625 L 106.570312 193.984375 L 138.542969 193.984375 L 138.542969 16.015625 Z M 106.570312 16.015625 "),Ke(s,"stroke","none"),Ke(s,"fill-rule","nonzero"),Ke(s,"fill","rgb(20%,60.000002%,40.000001%)"),Ke(s,"fill-opacity","1"),he(s,"d","M 298.398438 193.984375 L 309.058594 193.984375 L 309.058594 16.015625 L 298.398438 16.015625 Z M 319.714844 16.015625 L 319.714844 193.984375 L 330.371094 193.984375 L 330.371094 16.015625 Z M 149.199219 193.984375 L 159.855469 193.984375 L 159.855469 16.015625 L 149.199219 16.015625 Z M 170.515625 16.015625 L 170.515625 193.984375 L 181.171875 193.984375 L 181.171875 16.015625 Z M 170.515625 16.015625 "),Ke(c,"stroke","none"),Ke(c,"fill-rule","nonzero"),Ke(c,"fill","rgb(0%,40.000001%,60.000002%)"),Ke(c,"fill-opacity","1"),he(c,"d","M 191.828125 193.984375 L 223.800781 193.984375 L 223.800781 16.015625 L 191.828125 16.015625 Z M 234.457031 193.984375 L 245.113281 193.984375 L 245.113281 16.015625 L 234.457031 16.015625 Z M 255.769531 16.015625 L 255.769531 193.984375 L 287.742188 193.984375 L 287.742188 16.015625 Z M 255.769531 16.015625 "),he(t,"id","surface1"),va(e,_)},m(v,M){at(v,e,M),ve(e,t),ve(t,i),ve(t,s),ve(t,c),u||(o=[xt(e,"click",n[2]),xt(e,"mouseover",n[3]),xt(e,"mouseenter",n[4]),xt(e,"mouseleave",n[5]),xt(e,"keydown",n[6]),xt(e,"focus",n[7])],u=!0)},p(v,[M]){va(e,_=ar(p,[M&1&&v[0],{xmlns:"http://www.w3.org/2000/svg"},{width:"373px"},{height:"210px"},{viewBox:"0 0 373 210"},{version:"1.1"}]))},i:ci,o:ci,d(v){v&&nt(e),u=!1,rr(o)}}}function Y5(n,e,t){const i=["color"];let s=Vn(e,i),{color:c="#000000"}=e;function u(S){ei.call(this,n,S)}function o(S){ei.call(this,n,S)}function p(S){ei.call(this,n,S)}function _(S){ei.call(this,n,S)}function v(S){ei.call(this,n,S)}function M(S){ei.call(this,n,S)}return n.$$set=S=>{e=Wi(Wi({},e),nr(S)),t(0,s=Vn(e,i)),"color"in S&&t(1,c=S.color)},[s,c,u,o,p,_,v,M]}class fy extends Zi{constructor(e){super(),Gi(this,e,Y5,K5,$i,{color:1})}}const iP=Object.freeze(Object.defineProperty({__proto__:null,default:fy},Symbol.toStringTag,{value:"Module"}));function J5(n){let e;return{c(){e=mt("span")},m(t,i){at(t,e,i),n[4](e)},p:ci,i:ci,o:ci,d(t){t&&nt(e),n[4](null)}}}function X5(n){let e,t,i,s,c;const u=[e3,Q5],o=[];function p(_,v){return v&4&&(e=null),e==null&&(e=!!(_[2].getClass()||_[2].getStyle())),e?0:1}return t=p(n,-1),i=o[t]=u[t](n),{c(){i.c(),s=$n()},m(_,v){o[t].m(_,v),at(_,s,v),c=!0},p(_,v){let M=t;t=p(_,v),t===M?o[t].p(_,v):(Qi(),He(o[M],1,1,()=>{o[M]=null}),en(),i=o[t],i?i.p(_,v):(i=o[t]=u[t](_),i.c()),Fe(i,1),i.m(s.parentNode,s))},i(_){c||(Fe(i),c=!0)},o(_){He(i),c=!1},d(_){o[t].d(_),_&&nt(s)}}}function Q5(n){var o;let e,t,i;const s=[n[2]._props];var c=(o=n[2])==null?void 0:o._svelteComponent;function u(p){let _={};for(let v=0;v<s.length;v+=1)_=Wi(_,s[v]);return{props:_}}return c&&(e=ic(c,u())),{c(){e&&jt(e.$$.fragment),t=$n()},m(p,_){e&&Ut(e,p,_),at(p,t,_),i=!0},p(p,_){var M;const v=_&4?ar(s,[Rd(p[2]._props)]):{};if(_&4&&c!==(c=(M=p[2])==null?void 0:M._svelteComponent)){if(e){Qi();const S=e;He(S.$$.fragment,1,0,()=>{Wt(S,1)}),en()}c?(e=ic(c,u()),jt(e.$$.fragment),Fe(e.$$.fragment,1),Ut(e,t.parentNode,t)):e=null}else c&&e.$set(v)},i(p){i||(e&&Fe(e.$$.fragment,p),i=!0)},o(p){e&&He(e.$$.fragment,p),i=!1},d(p){p&&nt(t),e&&Wt(e,p)}}}function e3(n){var o;let e,t,i;const s=[n[2]._props,{class:n[2].getClass()},{style:n[2].getStyle()}];var c=(o=n[2])==null?void 0:o._svelteComponent;function u(p){let _={};for(let v=0;v<s.length;v+=1)_=Wi(_,s[v]);return{props:_}}return c&&(e=ic(c,u())),{c(){e&&jt(e.$$.fragment),t=$n()},m(p,_){e&&Ut(e,p,_),at(p,t,_),i=!0},p(p,_){var M;const v=_&4?ar(s,[Rd(p[2]._props),{class:p[2].getClass()},{style:p[2].getStyle()}]):{};if(_&4&&c!==(c=(M=p[2])==null?void 0:M._svelteComponent)){if(e){Qi();const S=e;He(S.$$.fragment,1,0,()=>{Wt(S,1)}),en()}c?(e=ic(c,u()),jt(e.$$.fragment),Fe(e.$$.fragment,1),Ut(e,t.parentNode,t)):e=null}else c&&e.$set(v)},i(p){i||(e&&Fe(e.$$.fragment,p),i=!0)},o(p){e&&He(e.$$.fragment,p),i=!1},d(p){p&&nt(t),e&&Wt(e,p)}}}function t3(n){let e,t,i,s;const c=[X5,J5],u=[];function o(p,_){return p[1]?0:1}return e=o(n),t=u[e]=c[e](n),{c(){t.c(),i=$n()},m(p,_){u[e].m(p,_),at(p,i,_),s=!0},p(p,[_]){let v=e;e=o(p),e===v?u[e].p(p,_):(Qi(),He(u[v],1,1,()=>{u[v]=null}),en(),t=u[e],t?t.p(p,_):(t=u[e]=c[e](p),t.c()),Fe(t,1),t.m(i.parentNode,i))},i(p){s||(Fe(t),s=!0)},o(p){He(t),s=!1},d(p){u[e].d(p),p&&nt(i)}}}function i3(n,e,t){let{construct:i}=e,s,c,u=!1,o,p;sc(()=>{if(o=typeof i=="function"?i():i,o!=null&&o.isSvelte){t(1,u=!0),t(2,p=o);return}c=o==null?void 0:o.ConstructElement(),c!==void 0&&(s==null||s.replaceWith(c))}),$r(()=>{c==null||c.remove(),o==null||o.Destroy()});function _(v){Fs[v?"unshift":"push"](()=>{s=v,t(0,s)})}return n.$$set=v=>{"construct"in v&&t(3,i=v.construct)},[s,u,p,i,_]}class Xg extends Zi{constructor(e){super(),Gi(this,e,i3,t3,$i,{construct:3})}}const n3=n=>({}),Qg=n=>({});function a3(n){let e;const t=n[3].else,i=Ra(t,n,n[2],Qg);return{c(){i&&i.c()},m(s,c){i&&i.m(s,c),e=!0},p(s,c){i&&i.p&&(!e||c&4)&&Fa(i,t,s,s[2],e?Ba(t,s[2],c,n3):Oa(s[2]),Qg)},i(s){e||(Fe(i,s),e=!0)},o(s){He(i,s),e=!1},d(s){i&&i.d(s)}}}function r3(n){let e;const t=n[3].default,i=Ra(t,n,n[2],null);return{c(){i&&i.c()},m(s,c){i&&i.m(s,c),e=!0},p(s,c){i&&i.p&&(!e||c&4)&&Fa(i,t,s,s[2],e?Ba(t,s[2],c,null):Oa(s[2]),null)},i(s){e||(Fe(i,s),e=!0)},o(s){He(i,s),e=!1},d(s){i&&i.d(s)}}}function s3(n){let e,t,i,s;const c=[r3,a3],u=[];function o(p,_){return p[0]?0:1}return e=o(n),t=u[e]=c[e](n),{c(){t.c(),i=$n()},m(p,_){u[e].m(p,_),at(p,i,_),s=!0},p(p,[_]){let v=e;e=o(p),e===v?u[e].p(p,_):(Qi(),He(u[v],1,1,()=>{u[v]=null}),en(),t=u[e],t?t.p(p,_):(t=u[e]=c[e](p),t.c()),Fe(t,1),t.m(i.parentNode,i))},i(p){s||(Fe(t),s=!0)},o(p){He(t),s=!1},d(p){u[e].d(p),p&&nt(i)}}}function o3(n,e,t){let{$$slots:i={},$$scope:s}=e,{condition:c}=e,u=c.data;return $r(c.addCallback(o=>(t(0,u=o),!1))),n.$$set=o=>{"condition"in o&&t(1,c=o.condition),"$$scope"in o&&t(2,s=o.$$scope)},[u,c,s,i]}class l3 extends Zi{constructor(e){super(),Gi(this,e,o3,s3,$i,{condition:1})}}class c3 extends Hu{InnerConstructElement(){const e=this.InnerRender();if(e===void 0||e==="")return;const t=document.createElement("span");if(typeof e=="string")t.innerHTML=e;else{const i=e.ConstructElement();if(i===void 0)return;t.appendChild(i)}return t}}class jd extends Hu{constructor(t,i=!1,s){super();ft(this,"_src");ft(this,"_rawSvg");ft(this,"_options");if(t===void 0||t==="undefined")throw"Undefined src for image";this._src=t,this._rawSvg=i,this._options=s}static AsData(t){if(Gn.runningFromConsole)return t;try{return`data:image/svg+xml;base64,${btoa(t)}`}catch(i){return console.error("Cannot create an image for",t.slice(0,100)),console.trace("Cannot create an image for the given source string due to ",i),""}}static AsImageElement(t,i="",s=""){return`<img class="${i}" style="${s}" alt="" src="${jd.AsData(t)}">`}AsMarkdown(){if(this._rawSvg===!0){console.warn("Converting raw svgs to markdown is not supported");return}let t=this._src;return this._src.startsWith("./")&&(t="https://mapcomplete.org/"+t),"![]("+t+")"}InnerConstructElement(){const t=this;if(this._rawSvg){const s=document.createElement("div");return s.innerHTML=this._src,s}const i=document.createElement("img");return i.src=this._src,i.onload=()=>{i.style.opacity="1"},i.onerror=()=>{var s;if((s=t._options)!=null&&s.fallbackImage){if(i.src===t._options.fallbackImage)return;i.src=t._options.fallbackImage}},i}}const u3=n=>({}),e0=n=>({});function t0(n){let e,t,i,s;const c=[d3,h3],u=[];function o(p,_){return typeof p[0]=="string"?0:1}return e=o(n),t=u[e]=c[e](n),{c(){t.c(),i=$n()},m(p,_){u[e].m(p,_),at(p,i,_),s=!0},p(p,_){let v=e;e=o(p),e===v?u[e].p(p,_):(Qi(),He(u[v],1,1,()=>{u[v]=null}),en(),t=u[e],t?t.p(p,_):(t=u[e]=c[e](p),t.c()),Fe(t,1),t.m(i.parentNode,i))},i(p){s||(Fe(t),s=!0)},o(p){He(t),s=!1},d(p){u[e].d(p),p&&nt(i)}}}function h3(n){let e;return{c(){e=mt("template")},m(t,i){at(t,e,i),n[8](e)},p:ci,i:ci,o:ci,d(t){t&&nt(e),n[8](null)}}}function d3(n){let e,t;return e=new jd({props:{src:n[0],class:n[5]}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s&1&&(c.src=i[0]),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function f3(n){let e,t,i=n[0]!==void 0&&t0(n);return{c(){i&&i.c(),e=$n()},m(s,c){i&&i.m(s,c),at(s,e,c),t=!0},p(s,c){s[0]!==void 0?i?(i.p(s,c),c&1&&Fe(i,1)):(i=t0(s),i.c(),Fe(i,1),i.m(e.parentNode,e)):i&&(Qi(),He(i,1,1,()=>{i=null}),en())},i(s){t||(Fe(i),t=!0)},o(s){He(i),t=!1},d(s){i&&i.d(s),s&&nt(e)}}}function p3(n){let e,t,i,s,c,u;const o=n[7].image,p=Ra(o,n,n[6],e0),_=p||f3(n),v=n[7].default,M=Ra(v,n,n[6],null);return{c(){e=mt("a"),_&&_.c(),t=Jt(),M&&M.c(),he(e,"class",i=tc(n[3].extraClasses,"button text-ellipsis")),he(e,"href",n[1]),he(e,"target",s=n[2]?"_blank":void 0),he(e,"rel",c=n[2]?"noopener":void 0)},m(S,I){at(S,e,I),_&&_.m(e,null),ve(e,t),M&&M.m(e,null),u=!0},p(S,[I]){p?p.p&&(!u||I&64)&&Fa(p,o,S,S[6],u?Ba(o,S[6],I,u3):Oa(S[6]),e0):_&&_.p&&(!u||I&17)&&_.p(S,u?I:-1),M&&M.p&&(!u||I&64)&&Fa(M,v,S,S[6],u?Ba(v,S[6],I,null):Oa(S[6]),null),(!u||I&8&&i!==(i=tc(S[3].extraClasses,"button text-ellipsis")))&&he(e,"class",i),(!u||I&2)&&he(e,"href",S[1]),(!u||I&4&&s!==(s=S[2]?"_blank":void 0))&&he(e,"target",s),(!u||I&4&&c!==(c=S[2]?"noopener":void 0))&&he(e,"rel",c)},i(S){u||(Fe(_,S),Fe(M,S),u=!0)},o(S){He(_,S),He(M,S),u=!1},d(S){S&&nt(e),_&&_.d(S),M&&M.d(S)}}}function m3(n,e,t){let{$$slots:i={},$$scope:s}=e,{imageUrl:c=void 0}=e,{href:u}=e,{newTab:o=!1}=e,{options:p={}}=e,_,v=Fx("block justify-center shrink-0 mr-4",(p==null?void 0:p.imgSize)??"h-11 w-11");sc(()=>{if(_&&c){let S;(c??"")===""?S=void 0:typeof c!="string"&&(S=c==null?void 0:c.SetClass(v)),S&&_.replaceWith(S.ConstructElement())}});function M(S){Fs[S?"unshift":"push"](()=>{_=S,t(4,_)})}return n.$$set=S=>{"imageUrl"in S&&t(0,c=S.imageUrl),"href"in S&&t(1,u=S.href),"newTab"in S&&t(2,o=S.newTab),"options"in S&&t(3,p=S.options),"$$scope"in S&&t(6,s=S.$$scope)},[c,u,o,p,_,v,s,i,M]}class g3 extends Zi{constructor(e){super(),Gi(this,e,m3,p3,$i,{imageUrl:0,href:1,newTab:2,options:3})}}class nP extends c3{constructor(t,i,s={}){super();ft(this,"imageUrl");ft(this,"message");ft(this,"options");this.imageUrl=t,this.message=i,this.options=s}InnerRender(){var o,p,_,v;if(this.options.url!==void 0)return new zd(g3,{href:this.options.url,newTab:this.options.newTab});const t="button",i=(o=yr.W(this.message))==null?void 0:o.SetClass("block overflow-ellipsis no-images flex-shrink");let s;const c="block justify-center flex-none mr-4 "+(((p=this.options)==null?void 0:p.imgSize)??"h-11 w-11");(this.imageUrl??"")===""?s=void 0:typeof this.imageUrl=="string"?s=(_=new jd(this.imageUrl))==null?void 0:_.SetClass(c):s=(v=this.imageUrl)==null?void 0:v.SetClass(c);const u=new dm([s,i]).SetClass("flex items-center group w-full");return this.SetClass(t),u}}function _3(n){let e,t,i,s,c,u=[n[1],{xmlns:"http://www.w3.org/2000/svg"},{width:"375px"},{height:"375px"},{viewBox:"0 0 375 375"},{version:"1.1"}],o={};for(let p=0;p<u.length;p+=1)o=Wi(o,u[p]);return{c(){e=et("svg"),t=et("g"),i=et("path"),Ke(i,"stroke","none"),Ke(i,"fill-rule","nonzero"),Ke(i,"fill",n[0]),Ke(i,"fill-opacity","1"),he(i,"d","M 254.679688 2.875 L 254.679688 27.652344 L 329.832031 27.652344 L 240.109375 117.371094 C 214.984375 96.203125 182.582031 83.410156 147.230469 83.410156 C 67.632812 83.414062 2.875 148.171875 2.875 227.769531 C 2.875 307.367188 67.632812 372.125 147.230469 372.125 C 226.828125 372.125 291.585938 307.367188 291.585938 227.769531 C 291.585938 192.417969 278.792969 160.015625 257.625 134.890625 L 347.347656 45.167969 L 347.347656 120.320312 L 372.125 120.320312 L 372.125 2.875 Z M 147.230469 347.347656 C 81.296875 347.347656 27.648438 293.703125 27.648438 227.769531 C 27.648438 161.832031 81.292969 108.1875 147.230469 108.1875 C 213.171875 108.1875 266.8125 161.828125 266.8125 227.769531 C 266.8125 293.703125 213.171875 347.347656 147.230469 347.347656 Z M 147.230469 347.347656 "),he(t,"id","surface1"),va(e,o)},m(p,_){at(p,e,_),ve(e,t),ve(t,i),s||(c=[xt(e,"click",n[2]),xt(e,"mouseover",n[3]),xt(e,"mouseenter",n[4]),xt(e,"mouseleave",n[5]),xt(e,"keydown",n[6]),xt(e,"focus",n[7])],s=!0)},p(p,[_]){_&1&&Ke(i,"fill",p[0]),va(e,o=ar(u,[_&2&&p[1],{xmlns:"http://www.w3.org/2000/svg"},{width:"375px"},{height:"375px"},{viewBox:"0 0 375 375"},{version:"1.1"}]))},i:ci,o:ci,d(p){p&&nt(e),s=!1,rr(c)}}}function y3(n,e,t){const i=["color"];let s=Vn(e,i),{color:c="#000000"}=e;function u(S){ei.call(this,n,S)}function o(S){ei.call(this,n,S)}function p(S){ei.call(this,n,S)}function _(S){ei.call(this,n,S)}function v(S){ei.call(this,n,S)}function M(S){ei.call(this,n,S)}return n.$$set=S=>{e=Wi(Wi({},e),nr(S)),t(1,s=Vn(e,i)),"color"in S&&t(0,c=S.color)},[c,s,u,o,p,_,v,M]}class b3 extends Zi{constructor(e){super(),Gi(this,e,y3,_3,$i,{color:0})}}function v3(n){let e,t,i,s,c,u=[n[1],{xmlns:"http://www.w3.org/2000/svg"},{width:"375px"},{height:"375px"},{viewBox:"0 0 375 375"},{version:"1.1"}],o={};for(let p=0;p<u.length;p+=1)o=Wi(o,u[p]);return{c(){e=et("svg"),t=et("g"),i=et("path"),Ke(i,"stroke","none"),Ke(i,"fill-rule","nonzero"),Ke(i,"fill",n[0]),Ke(i,"fill-opacity","1"),he(i,"d","M 273.230469 209.789062 C 320.503906 162.519531 320.503906 85.601562 273.230469 38.328125 C 225.964844 -8.941406 149.039062 -8.941406 101.769531 38.328125 C 54.496094 85.601562 54.496094 162.515625 101.769531 209.789062 C 122.273438 230.300781 148.363281 241.898438 175.191406 244.609375 L 175.191406 294.210938 L 123.847656 294.210938 L 123.847656 318.832031 L 175.191406 318.832031 L 175.191406 372.125 L 199.808594 372.125 L 199.808594 318.835938 L 251.148438 318.835938 L 251.148438 294.214844 L 199.808594 294.214844 L 199.808594 244.609375 C 226.636719 241.898438 252.726562 230.300781 273.230469 209.789062 Z M 119.175781 55.742188 C 138.015625 36.90625 162.757812 27.484375 187.5 27.484375 C 212.242188 27.484375 236.984375 36.902344 255.824219 55.738281 C 293.496094 93.410156 293.496094 154.707031 255.824219 192.382812 C 218.148438 230.054688 156.847656 230.050781 119.179688 192.382812 C 81.503906 154.710938 81.503906 93.410156 119.175781 55.742188 Z M 119.175781 55.742188 "),he(t,"id","surface1"),va(e,o)},m(p,_){at(p,e,_),ve(e,t),ve(t,i),s||(c=[xt(e,"click",n[2]),xt(e,"mouseover",n[3]),xt(e,"mouseenter",n[4]),xt(e,"mouseleave",n[5]),xt(e,"keydown",n[6]),xt(e,"focus",n[7])],s=!0)},p(p,[_]){_&1&&Ke(i,"fill",p[0]),va(e,o=ar(u,[_&2&&p[1],{xmlns:"http://www.w3.org/2000/svg"},{width:"375px"},{height:"375px"},{viewBox:"0 0 375 375"},{version:"1.1"}]))},i:ci,o:ci,d(p){p&&nt(e),s=!1,rr(c)}}}function x3(n,e,t){const i=["color"];let s=Vn(e,i),{color:c="#000000"}=e;function u(S){ei.call(this,n,S)}function o(S){ei.call(this,n,S)}function p(S){ei.call(this,n,S)}function _(S){ei.call(this,n,S)}function v(S){ei.call(this,n,S)}function M(S){ei.call(this,n,S)}return n.$$set=S=>{e=Wi(Wi({},e),nr(S)),t(1,s=Vn(e,i)),"color"in S&&t(0,c=S.color)},[c,s,u,o,p,_,v,M]}class w3 extends Zi{constructor(e){super(),Gi(this,e,x3,v3,$i,{color:0})}}function k3(n){let e,t,i,s,c,u=[n[1],{xmlns:"http://www.w3.org/2000/svg"},{width:"375px"},{height:"375px"},{viewBox:"0 0 375 375"},{version:"1.1"}],o={};for(let p=0;p<u.length;p+=1)o=Wi(o,u[p]);return{c(){e=et("svg"),t=et("g"),i=et("path"),Ke(i,"stroke","none"),Ke(i,"fill-rule","nonzero"),Ke(i,"fill",n[0]),Ke(i,"fill-opacity","1"),he(i,"d","M 244 216.746094 L 364.355469 337.101562 L 364.355469 212.675781 L 339.773438 212.675781 L 339.773438 277.761719 L 257.871094 195.851562 C 267.695312 177.457031 273.289062 156.472656 273.289062 134.199219 C 273.289062 61.789062 214.378906 2.875 141.964844 2.875 C 69.550781 2.875 10.644531 61.789062 10.644531 134.199219 C 10.644531 206.605469 69.554688 265.519531 141.964844 265.519531 C 164.238281 265.519531 185.222656 259.925781 203.621094 250.097656 L 240.511719 286.992188 L 197.96875 329.523438 L 215.347656 346.902344 L 257.886719 304.371094 L 325.640625 372.125 L 343.019531 354.742188 L 224.511719 236.230469 C 231.664062 230.433594 238.199219 223.898438 244 216.746094 Z M 35.226562 134.199219 C 35.226562 75.34375 83.109375 27.460938 141.964844 27.460938 C 200.820312 27.460938 248.703125 75.34375 248.703125 134.199219 C 248.703125 193.050781 200.820312 240.933594 141.964844 240.933594 C 83.105469 240.933594 35.226562 193.054688 35.226562 134.199219 Z M 35.226562 134.199219 "),he(t,"id","surface1"),va(e,o)},m(p,_){at(p,e,_),ve(e,t),ve(t,i),s||(c=[xt(e,"click",n[2]),xt(e,"mouseover",n[3]),xt(e,"mouseenter",n[4]),xt(e,"mouseleave",n[5]),xt(e,"keydown",n[6]),xt(e,"focus",n[7])],s=!0)},p(p,[_]){_&1&&Ke(i,"fill",p[0]),va(e,o=ar(u,[_&2&&p[1],{xmlns:"http://www.w3.org/2000/svg"},{width:"375px"},{height:"375px"},{viewBox:"0 0 375 375"},{version:"1.1"}]))},i:ci,o:ci,d(p){p&&nt(e),s=!1,rr(c)}}}function S3(n,e,t){const i=["color"];let s=Vn(e,i),{color:c="#000000"}=e;function u(S){ei.call(this,n,S)}function o(S){ei.call(this,n,S)}function p(S){ei.call(this,n,S)}function _(S){ei.call(this,n,S)}function v(S){ei.call(this,n,S)}function M(S){ei.call(this,n,S)}return n.$$set=S=>{e=Wi(Wi({},e),nr(S)),t(1,s=Vn(e,i)),"color"in S&&t(0,c=S.color)},[c,s,u,o,p,_,v,M]}class M3 extends Zi{constructor(e){super(),Gi(this,e,S3,k3,$i,{color:0})}}function D3(n){let e,t,i,s,c,u=[n[1],{xmlns:"http://www.w3.org/2000/svg"},{width:"375px"},{height:"375px"},{viewBox:"0 0 375 375"},{version:"1.1"}],o={};for(let p=0;p<u.length;p+=1)o=Wi(o,u[p]);return{c(){e=et("svg"),t=et("g"),i=et("path"),Ke(i,"stroke","none"),Ke(i,"fill-rule","nonzero"),Ke(i,"fill",n[0]),Ke(i,"fill-opacity","1"),he(i,"d","M 278.738281 2.875 L 278.738281 27.492188 L 309.691406 27.492188 L 250.769531 86.417969 C 233.425781 73.042969 211.722656 65.0625 188.179688 65.0625 C 164.289062 65.0625 142.296875 73.285156 124.832031 87.015625 L 106.859375 69.046875 L 128.496094 47.414062 L 111.089844 30.007812 L 89.457031 51.640625 L 65.308594 27.492188 L 96.261719 27.492188 L 96.261719 2.875 L 23.289062 2.875 L 23.289062 75.855469 L 47.90625 75.855469 L 47.90625 44.902344 L 72.050781 69.046875 L 50.414062 90.675781 L 67.820312 108.078125 L 89.453125 86.445312 L 107.421875 104.414062 C 93.691406 121.882812 85.46875 143.875 85.46875 167.765625 C 85.46875 220.230469 125.023438 263.605469 175.871094 269.710938 L 175.871094 300.851562 L 145.277344 300.851562 L 145.277344 325.464844 L 175.871094 325.464844 L 175.871094 372.125 L 200.488281 372.125 L 200.488281 325.476562 L 231.078125 325.476562 L 231.078125 300.859375 L 200.488281 300.859375 L 200.488281 269.71875 C 251.339844 263.613281 290.890625 220.234375 290.890625 167.769531 C 290.890625 143.53125 282.429688 121.246094 268.335938 103.65625 L 327.09375 44.898438 L 327.09375 75.851562 L 351.710938 75.851562 L 351.710938 2.875 Z M 188.179688 245.867188 C 145.117188 245.867188 110.085938 210.832031 110.085938 167.773438 C 110.085938 124.710938 145.117188 89.679688 188.179688 89.679688 C 231.238281 89.679688 266.273438 124.710938 266.273438 167.773438 C 266.273438 210.832031 231.238281 245.867188 188.179688 245.867188 Z M 188.179688 245.867188 "),he(t,"id","surface1"),va(e,o)},m(p,_){at(p,e,_),ve(e,t),ve(t,i),s||(c=[xt(e,"click",n[2]),xt(e,"mouseover",n[3]),xt(e,"mouseenter",n[4]),xt(e,"mouseleave",n[5]),xt(e,"keydown",n[6]),xt(e,"focus",n[7])],s=!0)},p(p,[_]){_&1&&Ke(i,"fill",p[0]),va(e,o=ar(u,[_&2&&p[1],{xmlns:"http://www.w3.org/2000/svg"},{width:"375px"},{height:"375px"},{viewBox:"0 0 375 375"},{version:"1.1"}]))},i:ci,o:ci,d(p){p&&nt(e),s=!1,rr(c)}}}function T3(n,e,t){const i=["color"];let s=Vn(e,i),{color:c="#000000"}=e;function u(S){ei.call(this,n,S)}function o(S){ei.call(this,n,S)}function p(S){ei.call(this,n,S)}function _(S){ei.call(this,n,S)}function v(S){ei.call(this,n,S)}function M(S){ei.call(this,n,S)}return n.$$set=S=>{e=Wi(Wi({},e),nr(S)),t(1,s=Vn(e,i)),"color"in S&&t(0,c=S.color)},[c,s,u,o,p,_,v,M]}class i0 extends Zi{constructor(e){super(),Gi(this,e,T3,D3,$i,{color:0})}}function C3(n){let e,t,i,s,c,u=[n[1],{xmlns:"http://www.w3.org/2000/svg"},{width:"375px"},{height:"375px"},{viewBox:"0 0 375 375"},{version:"1.1"}],o={};for(let p=0;p<u.length;p+=1)o=Wi(o,u[p]);return{c(){e=et("svg"),t=et("g"),i=et("path"),Ke(i,"stroke","none"),Ke(i,"fill-rule","nonzero"),Ke(i,"fill",n[0]),Ke(i,"fill-opacity","1"),he(i,"d","M 273.230469 165.210938 C 252.726562 144.699219 226.636719 133.105469 199.808594 130.390625 L 199.808594 79.359375 L 234.339844 98.398438 L 246.226562 76.832031 L 213 58.515625 L 246.226562 40.195312 L 234.339844 18.632812 L 199.808594 37.671875 L 199.808594 2.875 L 175.191406 2.875 L 175.191406 37.671875 L 140.660156 18.636719 L 128.773438 40.199219 L 162 58.519531 L 128.773438 76.835938 L 140.660156 98.402344 L 175.191406 79.359375 L 175.191406 130.390625 C 148.367188 133.105469 122.277344 144.699219 101.773438 165.207031 C 78.871094 188.105469 66.261719 218.550781 66.261719 250.9375 C 66.261719 283.324219 78.871094 313.769531 101.773438 336.667969 C 125.40625 360.308594 156.449219 372.125 187.5 372.125 C 218.550781 372.125 249.59375 360.308594 273.230469 336.667969 C 296.132812 313.769531 308.742188 283.324219 308.742188 250.9375 C 308.742188 218.550781 296.132812 188.105469 273.230469 165.210938 Z M 255.824219 319.257812 C 218.152344 356.925781 156.855469 356.929688 119.175781 319.257812 C 100.929688 301.011719 90.875 276.746094 90.875 250.9375 C 90.875 225.128906 100.929688 200.867188 119.175781 182.617188 C 138.015625 163.78125 162.757812 154.367188 187.5 154.367188 C 212.242188 154.367188 236.984375 163.78125 255.824219 182.621094 C 274.070312 200.871094 284.125 225.132812 284.125 250.941406 C 284.121094 276.746094 274.070312 301.011719 255.824219 319.257812 Z M 255.824219 319.257812 "),he(t,"id","surface1"),va(e,o)},m(p,_){at(p,e,_),ve(e,t),ve(t,i),s||(c=[xt(e,"click",n[2]),xt(e,"mouseover",n[3]),xt(e,"mouseenter",n[4]),xt(e,"mouseleave",n[5]),xt(e,"keydown",n[6]),xt(e,"focus",n[7])],s=!0)},p(p,[_]){_&1&&Ke(i,"fill",p[0]),va(e,o=ar(u,[_&2&&p[1],{xmlns:"http://www.w3.org/2000/svg"},{width:"375px"},{height:"375px"},{viewBox:"0 0 375 375"},{version:"1.1"}]))},i:ci,o:ci,d(p){p&&nt(e),s=!1,rr(c)}}}function P3(n,e,t){const i=["color"];let s=Vn(e,i),{color:c="#000000"}=e;function u(S){ei.call(this,n,S)}function o(S){ei.call(this,n,S)}function p(S){ei.call(this,n,S)}function _(S){ei.call(this,n,S)}function v(S){ei.call(this,n,S)}function M(S){ei.call(this,n,S)}return n.$$set=S=>{e=Wi(Wi({},e),nr(S)),t(1,s=Vn(e,i)),"color"in S&&t(0,c=S.color)},[c,s,u,o,p,_,v,M]}class A3 extends Zi{constructor(e){super(),Gi(this,e,P3,C3,$i,{color:0})}}const cl=class cl{};ft(cl,"isHuman",[{p:31,q:5}]),ft(cl,"extraProperties",[{requires:cl.isHuman,property:"P21",display:new Map([["Q6581097",b3],["Q6581072",w3],["Q1097630",M3],["Q1052281",i0],["Q2449503",i0],["Q48270",A3]]),textMode:new Map([["Q6581097","♂️"],["Q6581072","♀️"],["Q1097630","⚥️"],["Q1052281","🏳️‍⚧️"],["Q2449503","🏳️‍⚧️"],["Q48270","🏳️‍🌈 ⚧"]])},{property:"P569",requires:cl.isHuman,display:yr.t.general.wikipedia.previewbox.born},{property:"P570",requires:cl.isHuman,display:yr.t.general.wikipedia.previewbox.died}]);let Kp=cl;function n0(n,e,t){const i=n.slice();return i[3]=e[t],i}function I3(n){let e,t,i=n[0],s=[];for(let u=0;u<i.length;u+=1)s[u]=a0(n0(n,i,u));const c=u=>He(s[u],1,1,()=>{s[u]=null});return{c(){e=mt("div");for(let u=0;u<s.length;u+=1)s[u].c();he(e,"class","flex items-center justify-start")},m(u,o){at(u,e,o);for(let p=0;p<s.length;p+=1)s[p]&&s[p].m(e,null);t=!0},p(u,o){if(o&3){i=u[0];let p;for(p=0;p<i.length;p+=1){const _=n0(u,i,p);s[p]?(s[p].p(_,o),Fe(s[p],1)):(s[p]=a0(_),s[p].c(),Fe(s[p],1),s[p].m(e,null))}for(Qi(),p=i.length;p<s.length;p+=1)c(p);en()}},i(u){if(!t){for(let o=0;o<i.length;o+=1)Fe(s[o]);t=!0}},o(u){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)He(s[o]);t=!1},d(u){u&&nt(e),Kr(s,u)}}}function E3(n){let e,t,i;var s=n[3].display.get(n[1](n[3]));function c(u){return{props:{class:"m-1 h-6 w-fit"}}}return s&&(e=ic(s,c())),{c(){e&&jt(e.$$.fragment),t=$n()},m(u,o){e&&Ut(e,u,o),at(u,t,o),i=!0},p(u,o){if(s!==(s=u[3].display.get(u[1](u[3])))){if(e){Qi();const p=e;He(p.$$.fragment,1,0,()=>{Wt(p,1)}),en()}s?(e=ic(s,c()),jt(e.$$.fragment),Fe(e.$$.fragment,1),Ut(e,t.parentNode,t)):e=null}},i(u){i||(e&&Fe(e.$$.fragment,u),i=!0)},o(u){e&&He(e.$$.fragment,u),i=!1},d(u){u&&nt(t),e&&Wt(e,u)}}}function L3(n){let e,t;return e=new fa({props:{cls:"m-2 shrink-0",t:n[3].display.Subs({value:n[1](n[3])})}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p:ci,i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function z3(n){let e=n[3].display+"",t;return{c(){t=Sn(e)},m(i,s){at(i,t,s)},p:ci,i:ci,o:ci,d(i){i&&nt(t)}}}function a0(n){let e,t,i,s;const c=[z3,L3,E3],u=[];function o(p,_){return typeof p[3].display=="string"?0:p[3].display instanceof ul?1:2}return e=o(n),t=u[e]=c[e](n),{c(){t.c(),i=$n()},m(p,_){u[e].m(p,_),at(p,i,_),s=!0},p(p,_){t.p(p,_)},i(p){s||(Fe(t),s=!0)},o(p){He(t),s=!1},d(p){u[e].d(p),p&&nt(i)}}}function R3(n){let e,t,i=n[0].length>0&&I3(n);return{c(){i&&i.c(),e=$n()},m(s,c){i&&i.m(s,c),at(s,e,c),t=!0},p(s,[c]){s[0].length>0&&i.p(s,c)},i(s){t||(Fe(i),t=!0)},o(s){He(i),t=!1},d(s){i&&i.d(s),s&&nt(e)}}}function F3(n,e,t){let{wikidata:i}=e,s=Kp.extraProperties.filter(u=>{var o,p,_;for(const v of u.requires){if(!((o=i.claims)!=null&&o.has("P"+v.p))||!((p=i.claims)!=null&&p.get("P"+v.p).has("Q"+v.q)))return!1;const M=u.property;return((_=i.claims)==null?void 0:_.get(M))!==void 0}});function c(u){var _;const o=u.property;return Array.from((_=i.claims)==null?void 0:_.get(o)).join(", ")}return n.$$set=u=>{"wikidata"in u&&t(2,i=u.wikidata)},[s,c,i]}class O3 extends Zi{constructor(e){super(),Gi(this,e,F3,R3,$i,{wikidata:2})}}const B3=n=>({}),r0=n=>({});function N3(n){let e,t;return{c(){e=mt("img"),Vp(e.src,t=n[2])||he(e,"src",t),he(e,"style",n[1]),he(e,"class","mr-2")},m(i,s){at(i,e,s)},p(i,s){s&2&&he(e,"style",i[1])},d(i){i&&nt(e)}}}function V3(n){let e,t,i,s,c,u,o,p,_,v=n[0].id+"",M,S,I,R,G,Y,X,oe,Q,ce=n[2]&&N3(n);c=new fa({props:{cls:"font-bold",t:ul.fromMap(n[0].labels)}}),p=new fy({props:{class:"w-10"}}),R=new fa({props:{t:ul.fromMap(n[0].descriptions,!0)}}),X=new O3({props:{wikidata:n[0]}});const De=n[4].extra,Oe=Ra(De,n,n[3],r0);return{c(){e=mt("div"),ce&&ce.c(),t=Jt(),i=mt("div"),s=mt("div"),jt(c.$$.fragment),u=Jt(),o=mt("a"),jt(p.$$.fragment),_=Jt(),M=Sn(v),I=Jt(),jt(R.$$.fragment),G=Jt(),Y=mt("div"),jt(X.$$.fragment),oe=Jt(),Oe&&Oe.c(),he(o,"href",S=Lu.IdToArticle(n[0].id)),he(o,"target","_blank"),he(o,"class","must-link flex items-center"),he(s,"class","flex w-full flex-wrap justify-between"),he(Y,"class","flex"),he(i,"class","flex flex-grow flex-col"),he(e,"class","flex w-full flex-wrap p-2")},m(Pe,Se){at(Pe,e,Se),ce&&ce.m(e,null),ve(e,t),ve(e,i),ve(i,s),Ut(c,s,null),ve(s,u),ve(s,o),Ut(p,o,null),ve(o,_),ve(o,M),ve(i,I),Ut(R,i,null),ve(i,G),ve(i,Y),Ut(X,Y,null),ve(i,oe),Oe&&Oe.m(i,null),Q=!0},p(Pe,[Se]){Pe[2]&&ce.p(Pe,Se);const _e={};Se&1&&(_e.t=ul.fromMap(Pe[0].labels)),c.$set(_e),(!Q||Se&1)&&v!==(v=Pe[0].id+"")&&br(M,v),(!Q||Se&1&&S!==(S=Lu.IdToArticle(Pe[0].id)))&&he(o,"href",S);const ze={};Se&1&&(ze.t=ul.fromMap(Pe[0].descriptions,!0)),R.$set(ze);const Re={};Se&1&&(Re.wikidata=Pe[0]),X.$set(Re),Oe&&Oe.p&&(!Q||Se&8)&&Fa(Oe,De,Pe,Pe[3],Q?Ba(De,Pe[3],Se,B3):Oa(Pe[3]),r0)},i(Pe){Q||(Fe(c.$$.fragment,Pe),Fe(p.$$.fragment,Pe),Fe(R.$$.fragment,Pe),Fe(X.$$.fragment,Pe),Fe(Oe,Pe),Q=!0)},o(Pe){He(c.$$.fragment,Pe),He(p.$$.fragment,Pe),He(R.$$.fragment,Pe),He(X.$$.fragment,Pe),He(Oe,Pe),Q=!1},d(Pe){Pe&&nt(e),ce&&ce.d(),Wt(c),Wt(p),Wt(R),Wt(X),Oe&&Oe.d(Pe)}}}function H3(n,e,t){var _,v;let{$$slots:i={},$$scope:s}=e,{wikidata:c}=e,{imageStyle:u="max-width: 5rem; width: unset; height: 4rem"}=e,o=Array.from(((_=c==null?void 0:c.claims)==null?void 0:_.get("P18"))??[])[0],p=(v=$p.singleton.PrepUrl(o))==null?void 0:v.url;return n.$$set=M=>{"wikidata"in M&&t(0,c=M.wikidata),"imageStyle"in M&&t(1,u=M.imageStyle),"$$scope"in M&&t(3,s=M.$$scope)},[c,u,p,s,i]}class py extends Zi{constructor(e){super(),Gi(this,e,H3,V3,$i,{wikidata:0,imageStyle:1})}}const j3=n=>({svgSize:n&4}),s0=n=>({svgSize:n[5][n[2]]}),U3=n=>({svgSize:n&4}),o0=n=>({svgSize:n[5][n[2]]});function W3(n){let e,t,i,s,c,u,o=n[0]&&l0(n);const p=n[9].default,_=Ra(p,n,n[8],s0);let v=[{type:"button"},n[6],{class:n[4]},{"aria-label":i=n[1]??n[0]}],M={};for(let S=0;S<v.length;S+=1)M=Wi(M,v[S]);return{c(){e=mt("button"),o&&o.c(),t=Jt(),_&&_.c(),pd(e,M)},m(S,I){at(S,e,I),o&&o.m(e,null),ve(e,t),_&&_.m(e,null),e.autofocus&&e.focus(),s=!0,c||(u=xt(e,"click",n[10]),c=!0)},p(S,I){S[0]?o?o.p(S,I):(o=l0(S),o.c(),o.m(e,t)):o&&(o.d(1),o=null),_&&_.p&&(!s||I&260)&&Fa(_,p,S,S[8],s?Ba(p,S[8],I,j3):Oa(S[8]),s0),pd(e,M=ar(v,[{type:"button"},I&64&&S[6],(!s||I&16)&&{class:S[4]},(!s||I&3&&i!==(i=S[1]??S[0]))&&{"aria-label":i}]))},i(S){s||(Fe(_,S),s=!0)},o(S){He(_,S),s=!1},d(S){S&&nt(e),o&&o.d(),_&&_.d(S),c=!1,u()}}}function q3(n){let e,t,i,s,c=n[0]&&c0(n);const u=n[9].default,o=Ra(u,n,n[8],o0);let p=[{href:n[3]},n[6],{class:n[4]},{"aria-label":i=n[1]??n[0]}],_={};for(let v=0;v<p.length;v+=1)_=Wi(_,p[v]);return{c(){e=mt("a"),c&&c.c(),t=Jt(),o&&o.c(),pd(e,_)},m(v,M){at(v,e,M),c&&c.m(e,null),ve(e,t),o&&o.m(e,null),s=!0},p(v,M){v[0]?c?c.p(v,M):(c=c0(v),c.c(),c.m(e,t)):c&&(c.d(1),c=null),o&&o.p&&(!s||M&260)&&Fa(o,u,v,v[8],s?Ba(u,v[8],M,U3):Oa(v[8]),o0),pd(e,_=ar(p,[(!s||M&8)&&{href:v[3]},M&64&&v[6],(!s||M&16)&&{class:v[4]},(!s||M&3&&i!==(i=v[1]??v[0]))&&{"aria-label":i}]))},i(v){s||(Fe(o,v),s=!0)},o(v){He(o,v),s=!1},d(v){v&&nt(e),c&&c.d(),o&&o.d(v)}}}function l0(n){let e,t;return{c(){e=mt("span"),t=Sn(n[0]),he(e,"class","sr-only")},m(i,s){at(i,e,s),ve(e,t)},p(i,s){s&1&&br(t,i[0])},d(i){i&&nt(e)}}}function c0(n){let e,t;return{c(){e=mt("span"),t=Sn(n[0]),he(e,"class","sr-only")},m(i,s){at(i,e,s),ve(e,t)},p(i,s){s&1&&br(t,i[0])},d(i){i&&nt(e)}}}function Z3(n){let e,t,i,s;const c=[q3,W3],u=[];function o(p,_){return p[3]?0:1}return e=o(n),t=u[e]=c[e](n),{c(){t.c(),i=$n()},m(p,_){u[e].m(p,_),at(p,i,_),s=!0},p(p,[_]){let v=e;e=o(p),e===v?u[e].p(p,_):(Qi(),He(u[v],1,1,()=>{u[v]=null}),en(),t=u[e],t?t.p(p,_):(t=u[e]=c[e](p),t.c()),Fe(t,1),t.m(i.parentNode,i))},i(p){s||(Fe(t),s=!0)},o(p){He(t),s=!1},d(p){u[e].d(p),p&&nt(i)}}}function G3(n,e,t){const i=["color","name","ariaLabel","size","href"];let s=Vn(e,i),{$$slots:c={},$$scope:u}=e;const o=Ix("background");let{color:p="default"}=e,{name:_=void 0}=e,{ariaLabel:v=void 0}=e,{size:M="md"}=e,{href:S=void 0}=e;const I={dark:"text-gray-500 hover:text-gray-900 hover:bg-gray-200 dark:text-gray-400 dark:hover:text-white dark:hover:bg-gray-600",gray:"text-gray-500 focus:ring-gray-400 hover:bg-gray-200 dark:hover:bg-gray-800 dark:hover:text-gray-300",red:"text-red-500 focus:ring-red-400 hover:bg-red-200 dark:hover:bg-red-800 dark:hover:text-red-300",yellow:"text-yellow-500 focus:ring-yellow-400 hover:bg-yellow-200 dark:hover:bg-yellow-800 dark:hover:text-yellow-300",green:"text-green-500 focus:ring-green-400 hover:bg-green-200 dark:hover:bg-green-800 dark:hover:text-green-300",indigo:"text-indigo-500 focus:ring-indigo-400 hover:bg-indigo-200 dark:hover:bg-indigo-800 dark:hover:text-indigo-300",purple:"text-purple-500 focus:ring-purple-400 hover:bg-purple-200 dark:hover:bg-purple-800 dark:hover:text-purple-300",pink:"text-pink-500 focus:ring-pink-400 hover:bg-pink-200 dark:hover:bg-pink-800 dark:hover:text-pink-300",blue:"text-blue-500 focus:ring-blue-400 hover:bg-blue-200 dark:hover:bg-blue-800 dark:hover:text-blue-300",primary:"text-primary-500 focus:ring-primary-400 hover:bg-primary-200 dark:hover:bg-primary-800 dark:hover:text-primary-300",default:"focus:ring-gray-400 hover:bg-gray-100"},R={xs:"m-0.5 rounded-sm focus:ring-1 p-0.5",sm:"m-0.5 rounded focus:ring-1 p-0.5",md:"m-0.5 rounded-lg focus:ring-2 p-1.5",lg:"m-0.5 rounded-lg focus:ring-2 p-2.5"};let G;const Y={xs:"w-3 h-3",sm:"w-3.5 h-3.5",md:"w-5 h-5",lg:"w-5 h-5"};function X(oe){ei.call(this,n,oe)}return n.$$set=oe=>{t(14,e=Wi(Wi({},e),nr(oe))),t(6,s=Vn(e,i)),"color"in oe&&t(7,p=oe.color),"name"in oe&&t(0,_=oe.name),"ariaLabel"in oe&&t(1,v=oe.ariaLabel),"size"in oe&&t(2,M=oe.size),"href"in oe&&t(3,S=oe.href),"$$scope"in oe&&t(8,u=oe.$$scope)},n.$$.update=()=>{t(4,G=io("focus:outline-none whitespace-normal",R[M],I[p],p==="default"&&(o?"dark:hover:bg-gray-600":"dark:hover:bg-gray-700"),e.class))},e=nr(e),[_,v,M,S,G,Y,s,p,u,c,X]}class $3 extends Zi{constructor(e){super(),Gi(this,e,G3,Z3,$i,{color:7,name:0,ariaLabel:1,size:2,href:3})}}function K3(n){let e,t,i;return{c(){e=et("svg"),t=et("path"),he(t,"fill-rule","evenodd"),he(t,"d","M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"),he(t,"clip-rule","evenodd"),he(e,"class",i=n[4]),he(e,"fill","currentColor"),he(e,"viewBox","0 0 20 20"),he(e,"xmlns","http://www.w3.org/2000/svg")},m(s,c){at(s,e,c),ve(e,t)},p(s,c){c&16&&i!==(i=s[4])&&he(e,"class",i)},d(s){s&&nt(e)}}}function Y3(n){let e,t;const i=[{name:n[0]},n[1],{class:io("ms-auto",n[2].class)}];let s={$$slots:{default:[K3,({svgSize:c})=>({4:c}),({svgSize:c})=>c?16:0]},$$scope:{ctx:n}};for(let c=0;c<i.length;c+=1)s=Wi(s,i[c]);return e=new $3({props:s}),e.$on("click",n[3]),{c(){jt(e.$$.fragment)},m(c,u){Ut(e,c,u),t=!0},p(c,[u]){const o=u&7?ar(i,[u&1&&{name:c[0]},u&2&&Rd(c[1]),u&4&&{class:io("ms-auto",c[2].class)}]):{};u&48&&(o.$$scope={dirty:u,ctx:c}),e.$set(o)},i(c){t||(Fe(e.$$.fragment,c),t=!0)},o(c){He(e.$$.fragment,c),t=!1},d(c){Wt(e,c)}}}function J3(n,e,t){const i=["name"];let s=Vn(e,i),{name:c="Close"}=e;function u(o){ei.call(this,n,o)}return n.$$set=o=>{t(2,e=Wi(Wi({},e),nr(o))),t(1,s=Vn(e,i)),"name"in o&&t(0,c=o.name)},e=nr(e),[c,s,e,u]}class my extends Zi{constructor(e){super(),Gi(this,e,J3,Y3,$i,{name:0})}}const X3=`
  a[href], area[href], input:not([disabled]):not([tabindex='-1']),
  button:not([disabled]):not([tabindex='-1']),select:not([disabled]):not([tabindex='-1']),
  textarea:not([disabled]):not([tabindex='-1']),
  iframe, object, embed, *[tabindex]:not([tabindex='-1']):not([disabled]), *[contenteditable=true]
`;function Q3(n){function e(t){if(!(t.key==="Tab"||t.keyCode===9))return;const s=Array.from(n.querySelectorAll(X3)).filter(u=>u.hidden!==!0);let c=s.indexOf(document.activeElement??n);c===-1&&t.shiftKey&&(c=0),c+=s.length+(t.shiftKey?-1:1),c%=s.length,s[c].focus(),t.preventDefault()}return document.addEventListener("keydown",e,!0),{destroy(){document.removeEventListener("keydown",e,!0)}}}const ek=n=>({}),u0=n=>({}),tk=n=>({}),h0=n=>({});function d0(n){let e,t,i,s,c,u,o,p,_;const v=[{rounded:!0},{shadow:!0},n[17],{class:n[8]},{color:n[3]}];let M={$$slots:{default:[rk]},$$scope:{ctx:n}};for(let S=0;S<v.length;S+=1)M=Wi(M,v[S]);return c=new pm({props:M}),{c(){e=mt("div"),t=Jt(),i=mt("div"),s=mt("div"),jt(c.$$.fragment),he(e,"class",n[10]),he(s,"class",u="flex relative "+n[12][n[2]]+" w-full max-h-full"),he(i,"class",n[9]),he(i,"tabindex","-1"),he(i,"aria-modal","true"),he(i,"role","dialog")},m(S,I){at(S,e,I),at(S,t,I),at(S,i,I),ve(i,s),Ut(c,s,null),o=!0,p||(_=[xt(i,"keydown",n[16]),xt(i,"wheel",Ex(n[34]),{passive:!1}),xg(n[11].call(null,i)),xg(Q3.call(null,i)),xt(i,"click",n[13]),xt(i,"mousedown",n[14])],p=!0)},p(S,I){(!o||I[0]&1024)&&he(e,"class",S[10]);const R=I[0]&131336?ar(v,[v[0],v[1],I[0]&131072&&Rd(S[17]),I[0]&256&&{class:S[8]},I[0]&8&&{color:S[3]}]):{};I[0]&262394|I[1]&32&&(R.$$scope={dirty:I,ctx:S}),c.$set(R),(!o||I[0]&4&&u!==(u="flex relative "+S[12][S[2]]+" w-full max-h-full"))&&he(s,"class",u),(!o||I[0]&512)&&he(i,"class",S[9])},i(S){o||(Fe(c.$$.fragment,S),o=!0)},o(S){He(c.$$.fragment,S),o=!1},d(S){S&&nt(e),S&&nt(t),S&&nt(i),Wt(c),p=!1,rr(_)}}}function f0(n){let e,t;return e=new pm({props:{class:n[7],color:n[3],$$slots:{default:[nk]},$$scope:{ctx:n}}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s[0]&128&&(c.class=i[7]),s[0]&8&&(c.color=i[3]),s[0]&26|s[1]&32&&(c.$$scope={dirty:s,ctx:i}),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function ik(n){let e,t,i;return{c(){e=mt("h3"),t=Sn(n[1]),he(e,"class",i="text-xl font-semibold "+(n[3]==="default"?"":"text-gray-900 dark:text-white")+" p-0")},m(s,c){at(s,e,c),ve(e,t)},p(s,c){c[0]&2&&br(t,s[1]),c[0]&8&&i!==(i="text-xl font-semibold "+(s[3]==="default"?"":"text-gray-900 dark:text-white")+" p-0")&&he(e,"class",i)},d(s){s&&nt(e)}}}function p0(n){let e,t;return e=new my({props:{name:"Close modal",color:n[3]}}),e.$on("click",n[15]),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s[0]&8&&(c.color=i[3]),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function nk(n){let e,t,i;const s=n[33].header,c=Ra(s,n,n[36],h0),u=c||ik(n);let o=n[4]&&p0(n);return{c(){u&&u.c(),e=Jt(),o&&o.c(),t=$n()},m(p,_){u&&u.m(p,_),at(p,e,_),o&&o.m(p,_),at(p,t,_),i=!0},p(p,_){c?c.p&&(!i||_[1]&32)&&Fa(c,s,p,p[36],i?Ba(s,p[36],_,tk):Oa(p[36]),h0):u&&u.p&&(!i||_[0]&10)&&u.p(p,i?_:[-1,-1]),p[4]?o?(o.p(p,_),_[0]&16&&Fe(o,1)):(o=p0(p),o.c(),Fe(o,1),o.m(t.parentNode,t)):o&&(Qi(),He(o,1,1,()=>{o=null}),en())},i(p){i||(Fe(u,p),Fe(o),i=!0)},o(p){He(u,p),He(o),i=!1},d(p){u&&u.d(p),p&&nt(e),o&&o.d(p),p&&nt(t)}}}function m0(n){let e,t;return e=new my({props:{name:"Close modal",class:"absolute top-3 end-2.5",color:n[3]}}),e.$on("click",n[15]),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s[0]&8&&(c.color=i[3]),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function g0(n){let e,t;return e=new pm({props:{class:n[5],color:n[3],$$slots:{default:[ak]},$$scope:{ctx:n}}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s[0]&32&&(c.class=i[5]),s[0]&8&&(c.color=i[3]),s[1]&32&&(c.$$scope={dirty:s,ctx:i}),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function ak(n){let e;const t=n[33].footer,i=Ra(t,n,n[36],u0);return{c(){i&&i.c()},m(s,c){i&&i.m(s,c),e=!0},p(s,c){i&&i.p&&(!e||c[1]&32)&&Fa(i,t,s,s[36],e?Ba(t,s[36],c,ek):Oa(s[36]),u0)},i(s){e||(Fe(i,s),e=!0)},o(s){He(i,s),e=!1},d(s){i&&i.d(s)}}}function rk(n){let e,t,i,s,c,u,o,p,_=(n[18].header||n[1])&&f0(n),v=n[4]&&!n[18].header&&!n[1]&&m0(n);const M=n[33].default,S=Ra(M,n,n[36],null);let I=n[18].footer&&g0(n);return{c(){_&&_.c(),e=Jt(),t=mt("div"),v&&v.c(),i=Jt(),S&&S.c(),s=Jt(),I&&I.c(),c=$n(),he(t,"class",n[6]),he(t,"role","document")},m(R,G){_&&_.m(R,G),at(R,e,G),at(R,t,G),v&&v.m(t,null),ve(t,i),S&&S.m(t,null),at(R,s,G),I&&I.m(R,G),at(R,c,G),u=!0,o||(p=[xt(t,"keydown",wg(n[16])),xt(t,"wheel",wg(n[35]),{passive:!0})],o=!0)},p(R,G){R[18].header||R[1]?_?(_.p(R,G),G[0]&262146&&Fe(_,1)):(_=f0(R),_.c(),Fe(_,1),_.m(e.parentNode,e)):_&&(Qi(),He(_,1,1,()=>{_=null}),en()),R[4]&&!R[18].header&&!R[1]?v?(v.p(R,G),G[0]&262162&&Fe(v,1)):(v=m0(R),v.c(),Fe(v,1),v.m(t,i)):v&&(Qi(),He(v,1,1,()=>{v=null}),en()),S&&S.p&&(!u||G[1]&32)&&Fa(S,M,R,R[36],u?Ba(M,R[36],G,null):Oa(R[36]),null),(!u||G[0]&64)&&he(t,"class",R[6]),R[18].footer?I?(I.p(R,G),G[0]&262144&&Fe(I,1)):(I=g0(R),I.c(),Fe(I,1),I.m(c.parentNode,c)):I&&(Qi(),He(I,1,1,()=>{I=null}),en())},i(R){u||(Fe(_),Fe(v),Fe(S,R),Fe(I),u=!0)},o(R){He(_),He(v),He(S,R),He(I),u=!1},d(R){_&&_.d(R),R&&nt(e),R&&nt(t),v&&v.d(),S&&S.d(R),R&&nt(s),I&&I.d(R),R&&nt(c),o=!1,rr(p)}}}function sk(n){let e,t,i=n[0]&&d0(n);return{c(){i&&i.c(),e=$n()},m(s,c){i&&i.m(s,c),at(s,e,c),t=!0},p(s,c){s[0]?i?(i.p(s,c),c[0]&1&&Fe(i,1)):(i=d0(s),i.c(),Fe(i,1),i.m(e.parentNode,e)):i&&(Qi(),He(i,1,1,()=>{i=null}),en())},i(s){t||(Fe(i),t=!0)},o(s){He(i),t=!1},d(s){i&&i.d(s),s&&nt(e)}}}function ok(n,e,t){let i,s,c,u,o,p;const _=["open","title","size","color","placement","autoclose","outsideclose","dismissable","backdropClass","classBackdrop","dialogClass","classDialog","defaultClass","headerClass","classHeader","bodyClass","classBody","footerClass","classFooter"];let v=Vn(e,_),{$$slots:M={},$$scope:S}=e;const I=O2(M);let{open:R=!1}=e,{title:G=""}=e,{size:Y="md"}=e,{color:X="default"}=e,{placement:oe="center"}=e,{autoclose:Q=!1}=e,{outsideclose:ce=!1}=e,{dismissable:De=!0}=e,{backdropClass:Oe="fixed inset-0 z-40 bg-gray-900 bg-opacity-50 dark:bg-opacity-80"}=e,{classBackdrop:Pe=void 0}=e,{dialogClass:Se="fixed top-0 start-0 end-0 h-modal md:inset-0 md:h-full z-50 w-full p-4 flex"}=e,{classDialog:_e=void 0}=e,{defaultClass:ze="relative flex flex-col mx-auto"}=e,{headerClass:Re="flex justify-between items-center p-4 md:p-5 rounded-t-lg"}=e,{classHeader:Ye=void 0}=e,{bodyClass:Xe="p-4 md:p-5 space-y-4 flex-1 overflow-y-auto overscroll-contain"}=e,{classBody:si=void 0}=e,{footerClass:Bt="flex items-center p-4 md:p-5 space-x-3 rtl:space-x-reverse rounded-b-lg"}=e,{classFooter:bi=void 0}=e;const Et=Fd();function Vt(ht){const mi=document.createTreeWalker(ht,NodeFilter.SHOW_ELEMENT);let Pi;for(;Pi=mi.nextNode();)if(Pi instanceof HTMLElement){const Ni=Pi,[Oi,mn]=oi(Ni);(Oi||mn)&&(Ni.tabIndex=0)}ht.focus()}const Ki=ht=>{switch(ht){case"top-left":return["justify-start","items-start"];case"top-center":return["justify-center","items-start"];case"top-right":return["justify-end","items-start"];case"center-left":return["justify-start","items-center"];case"center":return["justify-center","items-center"];case"center-right":return["justify-end","items-center"];case"bottom-left":return["justify-start","items-end"];case"bottom-center":return["justify-center","items-end"];case"bottom-right":return["justify-end","items-end"];default:return["justify-center","items-center"]}},zt={xs:"max-w-md",sm:"max-w-lg",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-7xl"},_t=ht=>{const mi=ht.target;Q&&(mi==null?void 0:mi.tagName)==="BUTTON"&&Ft(ht)},Dt=ht=>{const mi=ht.target;ce&&mi===ht.currentTarget&&Ft(ht)},Ft=ht=>{ht.preventDefault(),t(0,R=!1)},oi=ht=>[ht.scrollWidth>ht.clientWidth&&["scroll","auto"].indexOf(getComputedStyle(ht).overflowX)>=0,ht.scrollHeight>ht.clientHeight&&["scroll","auto"].indexOf(getComputedStyle(ht).overflowY)>=0];function pi(ht){if(ht.key==="Escape"&&De)return Ft(ht)}function vi(ht){ei.call(this,n,ht)}function Ti(ht){ei.call(this,n,ht)}return n.$$set=ht=>{t(40,e=Wi(Wi({},e),nr(ht))),t(17,v=Vn(e,_)),"open"in ht&&t(0,R=ht.open),"title"in ht&&t(1,G=ht.title),"size"in ht&&t(2,Y=ht.size),"color"in ht&&t(3,X=ht.color),"placement"in ht&&t(19,oe=ht.placement),"autoclose"in ht&&t(20,Q=ht.autoclose),"outsideclose"in ht&&t(21,ce=ht.outsideclose),"dismissable"in ht&&t(4,De=ht.dismissable),"backdropClass"in ht&&t(22,Oe=ht.backdropClass),"classBackdrop"in ht&&t(23,Pe=ht.classBackdrop),"dialogClass"in ht&&t(24,Se=ht.dialogClass),"classDialog"in ht&&t(25,_e=ht.classDialog),"defaultClass"in ht&&t(26,ze=ht.defaultClass),"headerClass"in ht&&t(27,Re=ht.headerClass),"classHeader"in ht&&t(28,Ye=ht.classHeader),"bodyClass"in ht&&t(29,Xe=ht.bodyClass),"classBody"in ht&&t(30,si=ht.classBody),"footerClass"in ht&&t(31,Bt=ht.footerClass),"classFooter"in ht&&t(32,bi=ht.classFooter),"$$scope"in ht&&t(36,S=ht.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&1&&Et(R?"open":"close"),n.$$.dirty[0]&12582912&&t(10,i=io(Oe,Pe)),n.$$.dirty[0]&50855936&&t(9,s=io(Se,_e,Ki(oe))),t(8,c=io(ze,"w-full divide-y",e.class)),n.$$.dirty[0]&402653184&&t(7,u=io(Re,Ye)),n.$$.dirty[0]&1610612736&&t(6,o=io(Xe,si)),n.$$.dirty[1]&3&&t(5,p=io(Bt,bi))},e=nr(e),[R,G,Y,X,De,p,o,u,c,s,i,Vt,zt,_t,Dt,Ft,pi,v,I,oe,Q,ce,Oe,Pe,Se,_e,ze,Re,Ye,Xe,si,Bt,bi,M,vi,Ti,S]}class lk extends Zi{constructor(e){super(),Gi(this,e,ok,sk,$i,{open:0,title:1,size:2,color:3,placement:19,autoclose:20,outsideclose:21,dismissable:4,backdropClass:22,classBackdrop:23,dialogClass:24,classDialog:25,defaultClass:26,headerClass:27,classHeader:28,bodyClass:29,classBody:30,footerClass:31,classFooter:32},null,[-1,-1])}}const ck=n=>({}),_0=n=>({}),uk=n=>({}),y0=n=>({});function b0(n){let e;const t=n[10].footer,i=Ra(t,n,n[12],_0);return{c(){i&&i.c()},m(s,c){i&&i.m(s,c),e=!0},p(s,c){i&&i.p&&(!e||c&4096)&&Fa(i,t,s,s[12],e?Ba(t,s[12],c,ck):Oa(s[12]),_0)},i(s){e||(Fe(i,s),e=!0)},o(s){He(i,s),e=!1},d(s){i&&i.d(s)}}}function hk(n){let e,t,i;const s=n[10].default,c=Ra(s,n,n[12],null);let u=n[7].footer&&b0(n);return{c(){c&&c.c(),e=Jt(),u&&u.c(),t=$n()},m(o,p){c&&c.m(o,p),at(o,e,p),u&&u.m(o,p),at(o,t,p),i=!0},p(o,p){c&&c.p&&(!i||p&4096)&&Fa(c,s,o,o[12],i?Ba(s,o[12],p,null):Oa(o[12]),null),o[7].footer?u?(u.p(o,p),p&128&&Fe(u,1)):(u=b0(o),u.c(),Fe(u,1),u.m(t.parentNode,t)):u&&(Qi(),He(u,1,1,()=>{u=null}),en())},i(o){i||(Fe(c,o),Fe(u),i=!0)},o(o){He(c,o),He(u),i=!1},d(o){c&&c.d(o),o&&nt(e),u&&u.d(o),o&&nt(t)}}}function v0(n){let e,t;const i=n[10].header,s=Ra(i,n,n[12],y0);return{c(){e=mt("h1"),s&&s.c(),he(e,"class","page-header w-full")},m(c,u){at(c,e,u),s&&s.m(e,null),t=!0},p(c,u){s&&s.p&&(!t||u&4096)&&Fa(s,i,c,c[12],t?Ba(i,c[12],u,uk):Oa(c[12]),y0)},i(c){t||(Fe(s,c),t=!0)},o(c){He(s,c),t=!1},d(c){c&&nt(e),s&&s.d(c)}}}function dk(n){let e,t,i=n[7].header&&v0(n);return{c(){i&&i.c(),e=$n()},m(s,c){i&&i.m(s,c),at(s,e,c),t=!0},p(s,c){s[7].header?i?(i.p(s,c),c&128&&Fe(i,1)):(i=v0(s),i.c(),Fe(i,1),i.m(e.parentNode,e)):i&&(Qi(),He(i,1,1,()=>{i=null}),en())},i(s){t||(Fe(i),t=!0)},o(s){He(i),t=!1},d(s){i&&i.d(s),s&&nt(e)}}}function fk(n){let e,t;return e=new lk({props:{open:n[5],outsideclose:!0,size:"xl",dismissable:n[1],defaultClass:n[2],bodyClass:n[6],dialogClass:n[3],headerClass:n[4],color:"none",$$slots:{header:[dk],default:[hk]},$$scope:{ctx:n}}}),e.$on("close",n[11]),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,[s]){const c={};s&32&&(c.open=i[5]),s&2&&(c.dismissable=i[1]),s&4&&(c.defaultClass=i[2]),s&8&&(c.dialogClass=i[3]),s&16&&(c.headerClass=i[4]),s&4224&&(c.$$scope={dirty:s,ctx:i}),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}const x0="in-page normal-background dark:bg-gray-800 rounded-lg border-gray-200 dark:border-gray-700 border-gray-200 dark:border-gray-700 divide-gray-200 dark:divide-gray-700 shadow-md";function pk(n,e,t){let{$$slots:i={},$$scope:s}=e;const c=O2(i);let{fullscreen:u=!1}=e,o="relative flex flex-col mx-auto w-full divide-y "+x0;u&&(o=x0);let p="fixed top-0 start-0 end-0 h-modal inset-0 z-50 w-full p-4 flex";u&&(p+=" h-full-child");let{bodyPadding:_="p-4 md:p-5 "}=e,v=_+" h-full space-y-4 flex-1 overflow-y-auto overscroll-contain",M="flex justify-between items-center p-2 px-4 md:px-5 rounded-t-lg";c.header||(M="hidden");let{shown:S}=e,{dismissable:I=!0}=e,R=!1;S.addCallbackAndRun(Y=>{t(5,R=Y)});const G=()=>S.set(!1);return n.$$set=Y=>{"fullscreen"in Y&&t(8,u=Y.fullscreen),"bodyPadding"in Y&&t(9,_=Y.bodyPadding),"shown"in Y&&t(0,S=Y.shown),"dismissable"in Y&&t(1,I=Y.dismissable),"$$scope"in Y&&t(12,s=Y.$$scope)},[S,I,o,p,M,R,v,c,u,_,i,G,s]}class mk extends Zi{constructor(e){super(),Gi(this,e,pk,fk,$i,{fullscreen:8,bodyPadding:9,shown:0,dismissable:1})}}const Mi=class Mi{static hhmm(e,t){return e==24?"00:00":Gn.TwoDigits(e)+":"+Gn.TwoDigits(t)}static ToString(e){if(e.length==0)return"";const t=[[],[],[],[],[],[],[]];for(const p of e)t[p.weekday].push(Mi.hhmm(p.startHour,p.startMinutes)+"-"+Mi.hhmm(p.endHour,p.endMinutes));const i=t.map(p=>p.sort().join(", ")),s=[];let c=0,u=0;function o(){const p=i[c];p!==""&&(c==u-1?s.push(`${Mi.days[c]} ${p}`):s.push(`${Mi.days[c]}-${Mi.days[u-1]} ${p}`))}for(;u<7;u++)i[c]!=i[u]&&(o(),c=u);if(o(),s.length===1){const p=s[0];if(p==="Mo-Su 00:00-00:00")return"24/7";if(p.startsWith("Mo-Su "))return p.substring(6)}return s.join("; ")}static MergeTimes(e){const t=e.map(s=>{if(s.endHour===0&&s.endMinutes===0){const c={...s};return c.endHour=24,c}return s}),i=[];for(;t.length>0;){const s=t.pop();let c=!0;s.weekday==null&&(c=!1);for(let u=i.length-1;u>=0&&c;u--){let o=i[u];if(s.weekday==o.weekday){if(Mi.startTimeLiesInRange(s,o)&&Mi.endTimeLiesInRange(s,o)){c=!1;break}if(Mi.startTimeLiesInRange(o,s)&&Mi.endTimeLiesInRange(o,s)){i.splice(u,1);break}if(Mi.startTimeLiesInRange(s,o)||Mi.endTimeLiesInRange(s,o)||Mi.startTimeLiesInRange(o,s)||Mi.endTimeLiesInRange(o,s)){i.splice(u,1);let p=o.startHour,_=o.startMinutes;Mi.startTime(s)<Mi.startTime(o)&&(p=s.startHour,_=s.startMinutes);let v=o.endHour,M=o.endMinutes;Mi.endTime(s)>Mi.endTime(o)&&(v=s.endHour,M=s.endMinutes),t.push({startHour:p,startMinutes:_,endHour:v,endMinutes:M,weekday:o.weekday}),c=!1;break}}}c&&i.push(s)}return i.length!==e.length?(i.sort((s,c)=>c.weekday-s.weekday),i):e}static startTime(e){return e.startHour+e.startMinutes/60}static endTime(e){return e.endHour+e.endMinutes/60}static startTimeLiesInRange(e,t){return Mi.startTime(t)<=Mi.startTime(e)&&Mi.startTime(e)<=Mi.endTime(t)}static endTimeLiesInRange(e,t){return Mi.startTime(t)<=Mi.endTime(e)&&Mi.endTime(e)<=Mi.endTime(t)}static parseHHMMRange(e){if(e=="off")return null;const t=e.split("-"),i=Mi.parseHHMM(t[0]),s=Mi.parseHHMM(t[1]);return{startHour:i.hours,startMinutes:i.minutes,endHour:s.hours,endMinutes:s.minutes}}static ParseRule(e){try{if(e.trim()=="24/7")return Mi.multiply([0,1,2,3,4,5,6],[{startHour:0,startMinutes:0,endHour:24,endMinutes:0}]);const t=e.trim().replace(/, */g,",").split(" ");if(t.length==1){let i=Mi.ParseHhmmRanges(e),s=[0,1,2,3,4,5,6];return Mi.multiply(s,i)}if(t.length==2){const i=Mi.ParseWeekdayRanges(t[0]),s=Mi.ParseHhmmRanges(t[1]);return Mi.multiply(i,s)}return[]}catch{return console.log("Could not parse weekday rule ",e),[]}}static ParsePHRule(e){if(e==null||(e=e.trim(),!e.startsWith("PH")))return null;if(e=e.trim(),e.toLowerCase()==="ph off")return{mode:"off"};if(e.toLowerCase()==="ph open")return{mode:"open"};if(!e.startsWith("PH "))return null;try{const t=Mi.parseHHMMRange(e.substring(2));return t===null?null:{mode:" ",start:Mi.hhmm(t.startHour,t.startMinutes),end:Mi.hhmm(t.endHour,t.endMinutes)}}catch{return null}}static simplify(e){return Mi.ToString(Mi.MergeTimes(Mi.Parse(e)))}static Parse(e){if(e===void 0||e==="")return[];const t=[],i=e.split(";");for(const s of i)if(s!=="")try{const c=Mi.ParseRule(s);c!==null&&t.push(...c)}catch(c){console.error("Could not parse ",s,": ",c)}return t}static allChangeMoments(e){const t=[],i=[],s=[],c=[];for(const u of e)for(const o of u){if(!o.isOpen&&!o.isSpecial)continue;const p=new Date(o.startDate);p.setHours(0,0,0,0);const _=(o.startDate-p)/1e3;t.indexOf(_)<0&&(t.push(_),i.push(Mi.hhmm(o.startDate.getHours(),o.startDate.getMinutes())));let v=(o.endDate-p)/1e3;v>=24*60*60?s.indexOf(v)<0&&(s.push(v),c.push(Mi.hhmm(o.endDate.getHours(),o.endDate.getMinutes()))):t.indexOf(v)<0&&(t.push(v),i.push(Mi.hhmm(o.endDate.getHours(),o.endDate.getMinutes())))}return i.sort(),t.sort(),c.sort(),s.sort(),i.push(...c),t.push(...s),[t,i]}static CreateOhObjectStore(e,t="opening_hours",i,s){i??(i=""),s??(s="");const c=e.map(u=>u._country);return e.mapD(u=>{const o=u[t];if(o!==void 0)return(i||s)&&o.startsWith(i)&&o.endsWith(s)?o.substring(i.length,o.length-s.length).trim():o}).mapD(u=>{try{return Mi.CreateOhObject(e.data,u,c.data)}catch{return"error"}},[c])}static CreateOhObject(e,t,i){return new aw(t,{lat:e._lat,lon:e._lon,address:{country_code:i.toLowerCase(),state:void 0}},{tag_key:"opening_hours"})}static createRangesForApplicableWeek(e){const t=new Date;t.setHours(0,0,0,0);const i=Mi.getMondayBefore(t),s=new Date(i);if(s.setDate(s.getDate()+7),!e.getState()&&!e.getUnknown()){const c=e.getNextChange();s<c&&(t.getDay()==0||t.getDay()==6)&&(i.setDate(i.getDate()+7),s.setDate(s.getDate()+7))}return{startingMonday:i,ranges:Mi.GetRanges(e,i,s)}}static weekdaysIdentical(e,t=0,i=4){const s=e[t];for(let c=t+1;c<=i;c++){let u=e[c];if(u.length!==s.length)return!1;for(let o=0;o<u.length;o++){const p=u[o],_=s[o];if(p.isOpen!==_.isOpen&&p.isSpecial!==_.isSpecial&&p.comment!==_.comment||p.startDate.toTimeString()!==_.startDate.toTimeString()||p.endDate.toTimeString()!==_.endDate.toTimeString())return!1}}return!0}static GetRanges(e,t,i){const s=[[],[],[],[],[],[],[]],c=new Date(t);c.setDate(t.getDate()-1);const u=e.getIterator(c);let o;for(;u.advance(i);){o&&(o.endDate=u.getDate());const p=new Date(u.getDate());p.setHours(0,0,0,0),p.setDate(p.getDate()+1);const _={isSpecial:u.getUnknown(),isOpen:u.getState(),comment:u.getComment(),startDate:u.getDate(),endDate:p};o=_,!(_.comment===void 0&&!_.isOpen&&!_.isSpecial)&&(_.startDate<t||s[(_.startDate.getDay()+6)%7].push(_))}return s}static getMondayBefore(e){e=new Date(e);const t=e.getDay(),i=e.getDate()-t+(t==0?-6:1);return new Date(e.setDate(i))}static parseHHMM(e){if(e===void 0||e==null)return null;const t=e.trim().split(":");if(t.length!=2)return null;const i={hours:Number(t[0].trim()),minutes:Number(t[1].trim())};return isNaN(i.hours)||isNaN(i.minutes)?null:i}static ParseHhmmRanges(e){return e==="off"?[]:e.split(",").map(t=>t.trim()).filter(t=>t!=="").map(Mi.parseHHMMRange).filter(t=>t!=null)}static ParseWeekday(e){return Mi.daysIndexed[e.trim().toLowerCase()]}static ParseWeekdayRange(e){const t=e.split("-");if(t.length==1){const i=Mi.ParseWeekday(e);return i==null?null:[i]}else if(t.length==2){let i=Mi.ParseWeekday(t[0]),s=Mi.ParseWeekday(t[1]);if((i??null)===null||(s??null)===null)return null;let c=[];for(let u=i;u<=s;u++)c.push(u);return c}else return null}static ParseWeekdayRanges(e){let t=[],i=e.split(",");for(const s of i){const c=Mi.ParseWeekdayRange(s);if(c==null)return null;t.push(...c)}return t}static isSame(e,t){return e.weekday===t.weekday&&e.startHour===t.startHour&&e.startMinutes===t.startMinutes&&e.endHour===t.endHour&&e.endMinutes===t.endMinutes}static multiply(e,t){if((e??null)==null||(t??null)==null)return null;const i=[];for(const s of t){const c=!(s.endHour===0&&s.endMinutes===0)&&(s.endHour<s.startHour||s.endHour==s.startHour&&s.endMinutes<s.startMinutes);for(const u of e)c?(i.push({weekday:u,startHour:s.startHour,startMinutes:s.startMinutes,endHour:0,endMinutes:0}),i.push({weekday:(u+1)%7,startHour:0,startMinutes:0,endHour:s.endHour,endMinutes:s.endMinutes})):i.push({weekday:u,startHour:s.startHour,startMinutes:s.startMinutes,endHour:s.endHour,endMinutes:s.endMinutes})}return i}static rangeAs24Hr(e){return e.endHour===0?{...e,endHour:24}:e}};ft(Mi,"days",["Mo","Tu","We","Th","Fr","Sa","Su"]),ft(Mi,"daysIndexed",{mo:0,tu:1,we:2,th:3,fr:4,sa:5,su:6});let za=Mi;class Ps{static createTextualDescriptionFor(e,t){const i=yr.t.general.opening_hours;if(!t)return;if(!(t!=null&&t.some(o=>o.length>0))&&e.getNextChange()===void 0)return e.getComment()!==void 0?new ul({"*":e.getComment()}):e.getUnknown()?i.unknown:e.getState()?i.open_24_7:i.closed_permanently;if(za.weekdaysIdentical(t,0,6))return i.all_days_from.Subs({ranges:Ps.createRangesFor(t[0])});const s=[],c=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];function u(o,p){var _;for(let v=o;v<=p;v++){const M=c[v];((_=t[v])==null?void 0:_.length)>0&&s.push(i[M].Subs({ranges:Ps.createRangesFor(t[v])}))}}return za.weekdaysIdentical(t,0,4)?t[0].length>0&&s.push(i.on_weekdays.Subs({ranges:Ps.createRangesFor(t[0])})):u(0,4),za.weekdaysIdentical(t,5,6)?t[5].length>0&&s.push(i.on_weekdays.Subs({ranges:Ps.createRangesFor(t[5])})):u(5,6),Ps.chain(s)}static chain(e){const t={};for(const c of e)for(const u of c.SupportedLanguages())t[u]="{a}. {b}";let i=new Sx(t),s=e[0];for(let c=1;c<e.length;c++)s=i.PartialSubsTr("a",s).PartialSubsTr("b",e[c]);return s}static timeString(e){return za.hhmm(e.getHours(),e.getMinutes())}static createRangeFor(e){return yr.t.general.opening_hours.ranges.Subs({starttime:Ps.timeString(e.startDate),endtime:Ps.timeString(e.endDate)})}static createRangesFor(e){if(e.length===0)return;let t=Ps.createRangeFor(e[0]);for(let i=1;i<e.length;i++)t=yr.t.general.opening_hours.rangescombined.Subs({range0:t,range1:Ps.createRangeFor(e[i])});return t}}class aP extends dm{constructor(e){const t=yr.W(e)??yr.t.general.loading;t.SetClass("pl-2"),super([new zd(Ox).SetClass("animate-spin self-center").SetStyle("width: 1.5rem; height: 1.5rem; min-width: 1.5rem;"),t]),this.SetClass("flex p-1")}}/*!
 * Chart.js v3.9.1
 * https://www.chartjs.org
 * (c) 2022 Chart.js Contributors
 * Released under the MIT License
 */function Qs(){}const gk=function(){let n=0;return function(){return n++}}();function yn(n){return n===null||typeof n>"u"}function Xn(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function pn(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}const Pa=n=>(typeof n=="number"||n instanceof Number)&&isFinite(+n);function rs(n,e){return Pa(n)?n:e}function sn(n,e){return typeof n>"u"?e:n}const _k=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:n/e,gy=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function Jn(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function zn(n,e,t,i){let s,c,u;if(Xn(n))if(c=n.length,i)for(s=c-1;s>=0;s--)e.call(t,n[s],s);else for(s=0;s<c;s++)e.call(t,n[s],s);else if(pn(n))for(u=Object.keys(n),c=u.length,s=0;s<c;s++)e.call(t,n[u[s]],u[s])}function yd(n,e){let t,i,s,c;if(!n||!e||n.length!==e.length)return!1;for(t=0,i=n.length;t<i;++t)if(s=n[t],c=e[t],s.datasetIndex!==c.datasetIndex||s.index!==c.index)return!1;return!0}function bd(n){if(Xn(n))return n.map(bd);if(pn(n)){const e=Object.create(null),t=Object.keys(n),i=t.length;let s=0;for(;s<i;++s)e[t[s]]=bd(n[t[s]]);return e}return n}function _y(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function yk(n,e,t,i){if(!_y(n))return;const s=e[n],c=t[n];pn(s)&&pn(c)?Ru(s,c,i):e[n]=bd(c)}function Ru(n,e,t){const i=Xn(e)?e:[e],s=i.length;if(!pn(n))return n;t=t||{};const c=t.merger||yk;for(let u=0;u<s;++u){if(e=i[u],!pn(e))continue;const o=Object.keys(e);for(let p=0,_=o.length;p<_;++p)c(o[p],n,e,t)}return n}function Mu(n,e){return Ru(n,e,{merger:bk})}function bk(n,e,t){if(!_y(n))return;const i=e[n],s=t[n];pn(i)&&pn(s)?Mu(i,s):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=bd(s))}const w0={"":n=>n,x:n=>n.x,y:n=>n.y};function Bo(n,e){return(w0[e]||(w0[e]=vk(e)))(n)}function vk(n){const e=xk(n);return t=>{for(const i of e){if(i==="")break;t=t&&t[i]}return t}}function xk(n){const e=n.split("."),t=[];let i="";for(const s of e)i+=s,i.endsWith("\\")?i=i.slice(0,-1)+".":(t.push(i),i="");return t}function bm(n){return n.charAt(0).toUpperCase()+n.slice(1)}const os=n=>typeof n<"u",No=n=>typeof n=="function",k0=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function wk(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const oa=Math.PI,Nn=2*oa,kk=Nn+oa,vd=Number.POSITIVE_INFINITY,Sk=oa/180,ba=oa/2,pu=oa/4,S0=oa*2/3,ss=Math.log10,Rs=Math.sign;function M0(n){const e=Math.round(n);n=Du(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(ss(n))),i=n/t;return(i<=1?1:i<=2?2:i<=5?5:10)*t}function Mk(n){const e=[],t=Math.sqrt(n);let i;for(i=1;i<t;i++)n%i===0&&(e.push(i),e.push(n/i));return t===(t|0)&&e.push(t),e.sort((s,c)=>s-c).pop(),e}function nc(n){return!isNaN(parseFloat(n))&&isFinite(n)}function Du(n,e,t){return Math.abs(n-e)<t}function Dk(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function yy(n,e,t){let i,s,c;for(i=0,s=n.length;i<s;i++)c=n[i][t],isNaN(c)||(e.min=Math.min(e.min,c),e.max=Math.max(e.max,c))}function ys(n){return n*(oa/180)}function vm(n){return n*(180/oa)}function D0(n){if(!Pa(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function by(n,e){const t=e.x-n.x,i=e.y-n.y,s=Math.sqrt(t*t+i*i);let c=Math.atan2(i,t);return c<-.5*oa&&(c+=Nn),{angle:c,distance:s}}function Yp(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function Tk(n,e){return(n-e+kk)%Nn-oa}function qr(n){return(n%Nn+Nn)%Nn}function Fu(n,e,t,i){const s=qr(n),c=qr(e),u=qr(t),o=qr(c-s),p=qr(u-s),_=qr(s-c),v=qr(s-u);return s===c||s===u||i&&c===u||o>p&&_<v}function Ya(n,e,t){return Math.max(e,Math.min(t,n))}function Ck(n){return Ya(n,-32768,32767)}function ao(n,e,t,i=1e-6){return n>=Math.min(e,t)-i&&n<=Math.max(e,t)+i}function xm(n,e,t){t=t||(u=>n[u]<e);let i=n.length-1,s=0,c;for(;i-s>1;)c=s+i>>1,t(c)?s=c:i=c;return{lo:s,hi:i}}const ro=(n,e,t,i)=>xm(n,t,i?s=>n[s][e]<=t:s=>n[s][e]<t),Pk=(n,e,t)=>xm(n,t,i=>n[i][e]>=t);function Ak(n,e,t){let i=0,s=n.length;for(;i<s&&n[i]<e;)i++;for(;s>i&&n[s-1]>t;)s--;return i>0||s<n.length?n.slice(i,s):n}const vy=["push","pop","shift","splice","unshift"];function Ik(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),vy.forEach(t=>{const i="_onData"+bm(t),s=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...c){const u=s.apply(this,c);return n._chartjs.listeners.forEach(o=>{typeof o[i]=="function"&&o[i](...c)}),u}})})}function T0(n,e){const t=n._chartjs;if(!t)return;const i=t.listeners,s=i.indexOf(e);s!==-1&&i.splice(s,1),!(i.length>0)&&(vy.forEach(c=>{delete n[c]}),delete n._chartjs)}function xy(n){const e=new Set;let t,i;for(t=0,i=n.length;t<i;++t)e.add(n[t]);return e.size===i?n:Array.from(e)}const wy=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function ky(n,e,t){const i=t||(u=>Array.prototype.slice.call(u));let s=!1,c=[];return function(...u){c=i(u),s||(s=!0,wy.call(window,()=>{s=!1,n.apply(e,c)}))}}function Ek(n,e){let t;return function(...i){return e?(clearTimeout(t),t=setTimeout(n,e,i)):n.apply(this,i),e}}const wm=n=>n==="start"?"left":n==="end"?"right":"center",mr=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,Lk=(n,e,t,i)=>n===(i?"left":"right")?t:n==="center"?(e+t)/2:e;function Sy(n,e,t){const i=e.length;let s=0,c=i;if(n._sorted){const{iScale:u,_parsed:o}=n,p=u.axis,{min:_,max:v,minDefined:M,maxDefined:S}=u.getUserBounds();M&&(s=Ya(Math.min(ro(o,u.axis,_).lo,t?i:ro(e,p,u.getPixelForValue(_)).lo),0,i-1)),S?c=Ya(Math.max(ro(o,u.axis,v,!0).hi+1,t?0:ro(e,p,u.getPixelForValue(v),!0).hi+1),s,i)-s:c=i-s}return{start:s,count:c}}function My(n){const{xScale:e,yScale:t,_scaleRanges:i}=n,s={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!i)return n._scaleRanges=s,!0;const c=i.xmin!==e.min||i.xmax!==e.max||i.ymin!==t.min||i.ymax!==t.max;return Object.assign(i,s),c}const Yh=n=>n===0||n===1,C0=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*Nn/t)),P0=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*Nn/t)+1,Tu={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*ba)+1,easeOutSine:n=>Math.sin(n*ba),easeInOutSine:n=>-.5*(Math.cos(oa*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>Yh(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>Yh(n)?n:C0(n,.075,.3),easeOutElastic:n=>Yh(n)?n:P0(n,.075,.3),easeInOutElastic(n){return Yh(n)?n:n<.5?.5*C0(n*2,.1125,.45):.5+.5*P0(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-Tu.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Tu.easeInBounce(n*2)*.5:Tu.easeOutBounce(n*2-1)*.5+.5};/*!
 * @kurkle/color v0.2.1
 * https://github.com/kurkle/color#readme
 * (c) 2022 Jukka Kurkela
 * Released under the MIT License
 */function Uu(n){return n+.5|0}const Lo=(n,e,t)=>Math.max(Math.min(n,t),e);function xu(n){return Lo(Uu(n*2.55),0,255)}function Ro(n){return Lo(Uu(n*255),0,255)}function no(n){return Lo(Uu(n/2.55)/100,0,1)}function A0(n){return Lo(Uu(n*100),0,100)}const as={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Jp=[..."0123456789ABCDEF"],zk=n=>Jp[n&15],Rk=n=>Jp[(n&240)>>4]+Jp[n&15],Jh=n=>(n&240)>>4===(n&15),Fk=n=>Jh(n.r)&&Jh(n.g)&&Jh(n.b)&&Jh(n.a);function Ok(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&as[n[1]]*17,g:255&as[n[2]]*17,b:255&as[n[3]]*17,a:e===5?as[n[4]]*17:255}:(e===7||e===9)&&(t={r:as[n[1]]<<4|as[n[2]],g:as[n[3]]<<4|as[n[4]],b:as[n[5]]<<4|as[n[6]],a:e===9?as[n[7]]<<4|as[n[8]]:255})),t}const Bk=(n,e)=>n<255?e(n):"";function Nk(n){var e=Fk(n)?zk:Rk;return n?"#"+e(n.r)+e(n.g)+e(n.b)+Bk(n.a,e):void 0}const Vk=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Dy(n,e,t){const i=e*Math.min(t,1-t),s=(c,u=(c+n/30)%12)=>t-i*Math.max(Math.min(u-3,9-u,1),-1);return[s(0),s(8),s(4)]}function Hk(n,e,t){const i=(s,c=(s+n/60)%6)=>t-t*e*Math.max(Math.min(c,4-c,1),0);return[i(5),i(3),i(1)]}function jk(n,e,t){const i=Dy(n,1,.5);let s;for(e+t>1&&(s=1/(e+t),e*=s,t*=s),s=0;s<3;s++)i[s]*=1-e-t,i[s]+=e;return i}function Uk(n,e,t,i,s){return n===s?(e-t)/i+(e<t?6:0):e===s?(t-n)/i+2:(n-e)/i+4}function km(n){const t=n.r/255,i=n.g/255,s=n.b/255,c=Math.max(t,i,s),u=Math.min(t,i,s),o=(c+u)/2;let p,_,v;return c!==u&&(v=c-u,_=o>.5?v/(2-c-u):v/(c+u),p=Uk(t,i,s,v,c),p=p*60+.5),[p|0,_||0,o]}function Sm(n,e,t,i){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,i)).map(Ro)}function Mm(n,e,t){return Sm(Dy,n,e,t)}function Wk(n,e,t){return Sm(jk,n,e,t)}function qk(n,e,t){return Sm(Hk,n,e,t)}function Ty(n){return(n%360+360)%360}function Zk(n){const e=Vk.exec(n);let t=255,i;if(!e)return;e[5]!==i&&(t=e[6]?xu(+e[5]):Ro(+e[5]));const s=Ty(+e[2]),c=+e[3]/100,u=+e[4]/100;return e[1]==="hwb"?i=Wk(s,c,u):e[1]==="hsv"?i=qk(s,c,u):i=Mm(s,c,u),{r:i[0],g:i[1],b:i[2],a:t}}function Gk(n,e){var t=km(n);t[0]=Ty(t[0]+e),t=Mm(t),n.r=t[0],n.g=t[1],n.b=t[2]}function $k(n){if(!n)return;const e=km(n),t=e[0],i=A0(e[1]),s=A0(e[2]);return n.a<255?`hsla(${t}, ${i}%, ${s}%, ${no(n.a)})`:`hsl(${t}, ${i}%, ${s}%)`}const I0={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},E0={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Kk(){const n={},e=Object.keys(E0),t=Object.keys(I0);let i,s,c,u,o;for(i=0;i<e.length;i++){for(u=o=e[i],s=0;s<t.length;s++)c=t[s],o=o.replace(c,I0[c]);c=parseInt(E0[u],16),n[o]=[c>>16&255,c>>8&255,c&255]}return n}let Xh;function Yk(n){Xh||(Xh=Kk(),Xh.transparent=[0,0,0,0]);const e=Xh[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const Jk=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Xk(n){const e=Jk.exec(n);let t=255,i,s,c;if(e){if(e[7]!==i){const u=+e[7];t=e[8]?xu(u):Lo(u*255,0,255)}return i=+e[1],s=+e[3],c=+e[5],i=255&(e[2]?xu(i):Lo(i,0,255)),s=255&(e[4]?xu(s):Lo(s,0,255)),c=255&(e[6]?xu(c):Lo(c,0,255)),{r:i,g:s,b:c,a:t}}}function Qk(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${no(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const Dp=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,Kl=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function e4(n,e,t){const i=Kl(no(n.r)),s=Kl(no(n.g)),c=Kl(no(n.b));return{r:Ro(Dp(i+t*(Kl(no(e.r))-i))),g:Ro(Dp(s+t*(Kl(no(e.g))-s))),b:Ro(Dp(c+t*(Kl(no(e.b))-c))),a:n.a+t*(e.a-n.a)}}function Qh(n,e,t){if(n){let i=km(n);i[e]=Math.max(0,Math.min(i[e]+i[e]*t,e===0?360:1)),i=Mm(i),n.r=i[0],n.g=i[1],n.b=i[2]}}function Cy(n,e){return n&&Object.assign(e||{},n)}function L0(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=Ro(n[3]))):(e=Cy(n,{r:0,g:0,b:0,a:1}),e.a=Ro(e.a)),e}function t4(n){return n.charAt(0)==="r"?Xk(n):Zk(n)}class xd{constructor(e){if(e instanceof xd)return e;const t=typeof e;let i;t==="object"?i=L0(e):t==="string"&&(i=Ok(e)||Yk(e)||t4(e)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var e=Cy(this._rgb);return e&&(e.a=no(e.a)),e}set rgb(e){this._rgb=L0(e)}rgbString(){return this._valid?Qk(this._rgb):void 0}hexString(){return this._valid?Nk(this._rgb):void 0}hslString(){return this._valid?$k(this._rgb):void 0}mix(e,t){if(e){const i=this.rgb,s=e.rgb;let c;const u=t===c?.5:t,o=2*u-1,p=i.a-s.a,_=((o*p===-1?o:(o+p)/(1+o*p))+1)/2;c=1-_,i.r=255&_*i.r+c*s.r+.5,i.g=255&_*i.g+c*s.g+.5,i.b=255&_*i.b+c*s.b+.5,i.a=u*i.a+(1-u)*s.a,this.rgb=i}return this}interpolate(e,t){return e&&(this._rgb=e4(this._rgb,e._rgb,t)),this}clone(){return new xd(this.rgb)}alpha(e){return this._rgb.a=Ro(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=Uu(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Qh(this._rgb,2,e),this}darken(e){return Qh(this._rgb,2,-e),this}saturate(e){return Qh(this._rgb,1,e),this}desaturate(e){return Qh(this._rgb,1,-e),this}rotate(e){return Gk(this._rgb,e),this}}function Py(n){return new xd(n)}function Ay(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function z0(n){return Ay(n)?n:Py(n)}function Tp(n){return Ay(n)?n:Py(n).saturate(.5).darken(.1).hexString()}const fl=Object.create(null),Xp=Object.create(null);function Cu(n,e){if(!e)return n;const t=e.split(".");for(let i=0,s=t.length;i<s;++i){const c=t[i];n=n[c]||(n[c]=Object.create(null))}return n}function Cp(n,e,t){return typeof e=="string"?Ru(Cu(n,e),t):Ru(Cu(n,""),e)}class i4{constructor(e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=t=>t.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(t,i)=>Tp(i.backgroundColor),this.hoverBorderColor=(t,i)=>Tp(i.borderColor),this.hoverColor=(t,i)=>Tp(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e)}set(e,t){return Cp(this,e,t)}get(e){return Cu(this,e)}describe(e,t){return Cp(Xp,e,t)}override(e,t){return Cp(fl,e,t)}route(e,t,i,s){const c=Cu(this,e),u=Cu(this,i),o="_"+t;Object.defineProperties(c,{[o]:{value:c[t],writable:!0},[t]:{enumerable:!0,get(){const p=this[o],_=u[s];return pn(p)?Object.assign({},_,p):sn(p,_)},set(p){this[o]=p}}})}}var gn=new i4({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});function n4(n){return!n||yn(n.size)||yn(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function wd(n,e,t,i,s){let c=e[s];return c||(c=e[s]=n.measureText(s).width,t.push(s)),c>i&&(i=c),i}function a4(n,e,t,i){i=i||{};let s=i.data=i.data||{},c=i.garbageCollect=i.garbageCollect||[];i.font!==e&&(s=i.data={},c=i.garbageCollect=[],i.font=e),n.save(),n.font=e;let u=0;const o=t.length;let p,_,v,M,S;for(p=0;p<o;p++)if(M=t[p],M!=null&&Xn(M)!==!0)u=wd(n,s,c,u,M);else if(Xn(M))for(_=0,v=M.length;_<v;_++)S=M[_],S!=null&&!Xn(S)&&(u=wd(n,s,c,u,S));n.restore();const I=c.length/2;if(I>t.length){for(p=0;p<I;p++)delete s[c[p]];c.splice(0,I)}return u}function rl(n,e,t){const i=n.currentDevicePixelRatio,s=t!==0?Math.max(t/2,.5):0;return Math.round((e-s)*i)/i+s}function R0(n,e){e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore()}function Qp(n,e,t,i){Iy(n,e,t,i,null)}function Iy(n,e,t,i,s){let c,u,o,p,_,v;const M=e.pointStyle,S=e.rotation,I=e.radius;let R=(S||0)*Sk;if(M&&typeof M=="object"&&(c=M.toString(),c==="[object HTMLImageElement]"||c==="[object HTMLCanvasElement]")){n.save(),n.translate(t,i),n.rotate(R),n.drawImage(M,-M.width/2,-M.height/2,M.width,M.height),n.restore();return}if(!(isNaN(I)||I<=0)){switch(n.beginPath(),M){default:s?n.ellipse(t,i,s/2,I,0,0,Nn):n.arc(t,i,I,0,Nn),n.closePath();break;case"triangle":n.moveTo(t+Math.sin(R)*I,i-Math.cos(R)*I),R+=S0,n.lineTo(t+Math.sin(R)*I,i-Math.cos(R)*I),R+=S0,n.lineTo(t+Math.sin(R)*I,i-Math.cos(R)*I),n.closePath();break;case"rectRounded":_=I*.516,p=I-_,u=Math.cos(R+pu)*p,o=Math.sin(R+pu)*p,n.arc(t-u,i-o,_,R-oa,R-ba),n.arc(t+o,i-u,_,R-ba,R),n.arc(t+u,i+o,_,R,R+ba),n.arc(t-o,i+u,_,R+ba,R+oa),n.closePath();break;case"rect":if(!S){p=Math.SQRT1_2*I,v=s?s/2:p,n.rect(t-v,i-p,2*v,2*p);break}R+=pu;case"rectRot":u=Math.cos(R)*I,o=Math.sin(R)*I,n.moveTo(t-u,i-o),n.lineTo(t+o,i-u),n.lineTo(t+u,i+o),n.lineTo(t-o,i+u),n.closePath();break;case"crossRot":R+=pu;case"cross":u=Math.cos(R)*I,o=Math.sin(R)*I,n.moveTo(t-u,i-o),n.lineTo(t+u,i+o),n.moveTo(t+o,i-u),n.lineTo(t-o,i+u);break;case"star":u=Math.cos(R)*I,o=Math.sin(R)*I,n.moveTo(t-u,i-o),n.lineTo(t+u,i+o),n.moveTo(t+o,i-u),n.lineTo(t-o,i+u),R+=pu,u=Math.cos(R)*I,o=Math.sin(R)*I,n.moveTo(t-u,i-o),n.lineTo(t+u,i+o),n.moveTo(t+o,i-u),n.lineTo(t-o,i+u);break;case"line":u=s?s/2:Math.cos(R)*I,o=Math.sin(R)*I,n.moveTo(t-u,i-o),n.lineTo(t+u,i+o);break;case"dash":n.moveTo(t,i),n.lineTo(t+Math.cos(R)*I,i+Math.sin(R)*I);break}n.fill(),e.borderWidth>0&&n.stroke()}}function Ou(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function Ud(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function Wd(n){n.restore()}function r4(n,e,t,i,s){if(!e)return n.lineTo(t.x,t.y);if(s==="middle"){const c=(e.x+t.x)/2;n.lineTo(c,e.y),n.lineTo(c,t.y)}else s==="after"!=!!i?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function s4(n,e,t,i){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(i?e.cp1x:e.cp2x,i?e.cp1y:e.cp2y,i?t.cp2x:t.cp1x,i?t.cp2y:t.cp1y,t.x,t.y)}function pl(n,e,t,i,s,c={}){const u=Xn(e)?e:[e],o=c.strokeWidth>0&&c.strokeColor!=="";let p,_;for(n.save(),n.font=s.string,o4(n,c),p=0;p<u.length;++p)_=u[p],o&&(c.strokeColor&&(n.strokeStyle=c.strokeColor),yn(c.strokeWidth)||(n.lineWidth=c.strokeWidth),n.strokeText(_,t,i,c.maxWidth)),n.fillText(_,t,i,c.maxWidth),l4(n,t,i,_,c),i+=s.lineHeight;n.restore()}function o4(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),yn(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function l4(n,e,t,i,s){if(s.strikethrough||s.underline){const c=n.measureText(i),u=e-c.actualBoundingBoxLeft,o=e+c.actualBoundingBoxRight,p=t-c.actualBoundingBoxAscent,_=t+c.actualBoundingBoxDescent,v=s.strikethrough?(p+_)/2:_;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=s.decorationWidth||2,n.moveTo(u,v),n.lineTo(o,v),n.stroke()}}function Bu(n,e){const{x:t,y:i,w:s,h:c,radius:u}=e;n.arc(t+u.topLeft,i+u.topLeft,u.topLeft,-ba,oa,!0),n.lineTo(t,i+c-u.bottomLeft),n.arc(t+u.bottomLeft,i+c-u.bottomLeft,u.bottomLeft,oa,ba,!0),n.lineTo(t+s-u.bottomRight,i+c),n.arc(t+s-u.bottomRight,i+c-u.bottomRight,u.bottomRight,ba,0,!0),n.lineTo(t+s,i+u.topRight),n.arc(t+s-u.topRight,i+u.topRight,u.topRight,0,-ba,!0),n.lineTo(t+u.topLeft,i)}const c4=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),u4=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function h4(n,e){const t=(""+n).match(c4);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const d4=n=>+n||0;function Dm(n,e){const t={},i=pn(e),s=i?Object.keys(e):e,c=pn(n)?i?u=>sn(n[u],n[e[u]]):u=>n[u]:()=>n;for(const u of s)t[u]=d4(c(u));return t}function Ey(n){return Dm(n,{top:"y",right:"x",bottom:"y",left:"x"})}function hl(n){return Dm(n,["topLeft","topRight","bottomLeft","bottomRight"])}function vr(n){const e=Ey(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Ua(n,e){n=n||{},e=e||gn.font;let t=sn(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let i=sn(n.style,e.style);i&&!(""+i).match(u4)&&(console.warn('Invalid font style specified: "'+i+'"'),i="");const s={family:sn(n.family,e.family),lineHeight:h4(sn(n.lineHeight,e.lineHeight),t),size:t,style:i,weight:sn(n.weight,e.weight),string:""};return s.string=n4(s),s}function wu(n,e,t,i){let s=!0,c,u,o;for(c=0,u=n.length;c<u;++c)if(o=n[c],o!==void 0&&(e!==void 0&&typeof o=="function"&&(o=o(e),s=!1),t!==void 0&&Xn(o)&&(o=o[t%o.length],s=!1),o!==void 0))return i&&!s&&(i.cacheable=!1),o}function f4(n,e,t){const{min:i,max:s}=n,c=gy(e,(s-i)/2),u=(o,p)=>t&&o===0?0:o+p;return{min:u(i,-Math.abs(c)),max:u(s,c)}}function Ho(n,e){return Object.assign(Object.create(n),e)}function Tm(n,e=[""],t=n,i,s=()=>n[0]){os(i)||(i=Fy("_fallback",n));const c={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:t,_fallback:i,_getTarget:s,override:u=>Tm([u,...n],e,t,i)};return new Proxy(c,{deleteProperty(u,o){return delete u[o],delete u._keys,delete n[0][o],!0},get(u,o){return zy(u,o,()=>x4(o,e,n,u))},getOwnPropertyDescriptor(u,o){return Reflect.getOwnPropertyDescriptor(u._scopes[0],o)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(u,o){return O0(u).includes(o)},ownKeys(u){return O0(u)},set(u,o,p){const _=u._storage||(u._storage=s());return u[o]=_[o]=p,delete u._keys,!0}})}function ac(n,e,t,i){const s={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:Ly(n,i),setContext:c=>ac(n,c,t,i),override:c=>ac(n.override(c),e,t,i)};return new Proxy(s,{deleteProperty(c,u){return delete c[u],delete n[u],!0},get(c,u,o){return zy(c,u,()=>m4(c,u,o))},getOwnPropertyDescriptor(c,u){return c._descriptors.allKeys?Reflect.has(n,u)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,u)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(c,u){return Reflect.has(n,u)},ownKeys(){return Reflect.ownKeys(n)},set(c,u,o){return n[u]=o,delete c[u],!0}})}function Ly(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:i=e.indexable,_allKeys:s=e.allKeys}=n;return{allKeys:s,scriptable:t,indexable:i,isScriptable:No(t)?t:()=>t,isIndexable:No(i)?i:()=>i}}const p4=(n,e)=>n?n+bm(e):e,Cm=(n,e)=>pn(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function zy(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e))return n[e];const i=t();return n[e]=i,i}function m4(n,e,t){const{_proxy:i,_context:s,_subProxy:c,_descriptors:u}=n;let o=i[e];return No(o)&&u.isScriptable(e)&&(o=g4(e,o,n,t)),Xn(o)&&o.length&&(o=_4(e,o,n,u.isIndexable)),Cm(e,o)&&(o=ac(o,s,c&&c[e],u)),o}function g4(n,e,t,i){const{_proxy:s,_context:c,_subProxy:u,_stack:o}=t;if(o.has(n))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+n);return o.add(n),e=e(c,u||i),o.delete(n),Cm(n,e)&&(e=Pm(s._scopes,s,n,e)),e}function _4(n,e,t,i){const{_proxy:s,_context:c,_subProxy:u,_descriptors:o}=t;if(os(c.index)&&i(n))e=e[c.index%e.length];else if(pn(e[0])){const p=e,_=s._scopes.filter(v=>v!==p);e=[];for(const v of p){const M=Pm(_,s,n,v);e.push(ac(M,c,u&&u[n],o))}}return e}function Ry(n,e,t){return No(n)?n(e,t):n}const y4=(n,e)=>n===!0?e:typeof n=="string"?Bo(e,n):void 0;function b4(n,e,t,i,s){for(const c of e){const u=y4(t,c);if(u){n.add(u);const o=Ry(u._fallback,t,s);if(os(o)&&o!==t&&o!==i)return o}else if(u===!1&&os(i)&&t!==i)return null}return!1}function Pm(n,e,t,i){const s=e._rootScopes,c=Ry(e._fallback,t,i),u=[...n,...s],o=new Set;o.add(i);let p=F0(o,u,t,c||t,i);return p===null||os(c)&&c!==t&&(p=F0(o,u,c,p,i),p===null)?!1:Tm(Array.from(o),[""],s,c,()=>v4(e,t,i))}function F0(n,e,t,i,s){for(;t;)t=b4(n,e,t,i,s);return t}function v4(n,e,t){const i=n._getTarget();e in i||(i[e]={});const s=i[e];return Xn(s)&&pn(t)?t:s}function x4(n,e,t,i){let s;for(const c of e)if(s=Fy(p4(c,n),t),os(s))return Cm(n,s)?Pm(t,i,n,s):s}function Fy(n,e){for(const t of e){if(!t)continue;const i=t[n];if(os(i))return i}}function O0(n){let e=n._keys;return e||(e=n._keys=w4(n._scopes)),e}function w4(n){const e=new Set;for(const t of n)for(const i of Object.keys(t).filter(s=>!s.startsWith("_")))e.add(i);return Array.from(e)}function Oy(n,e,t,i){const{iScale:s}=n,{key:c="r"}=this._parsing,u=new Array(i);let o,p,_,v;for(o=0,p=i;o<p;++o)_=o+t,v=e[_],u[o]={r:s.parse(Bo(v,c),_)};return u}const k4=Number.EPSILON||1e-14,rc=(n,e)=>e<n.length&&!n[e].skip&&n[e],By=n=>n==="x"?"y":"x";function S4(n,e,t,i){const s=n.skip?e:n,c=e,u=t.skip?e:t,o=Yp(c,s),p=Yp(u,c);let _=o/(o+p),v=p/(o+p);_=isNaN(_)?0:_,v=isNaN(v)?0:v;const M=i*_,S=i*v;return{previous:{x:c.x-M*(u.x-s.x),y:c.y-M*(u.y-s.y)},next:{x:c.x+S*(u.x-s.x),y:c.y+S*(u.y-s.y)}}}function M4(n,e,t){const i=n.length;let s,c,u,o,p,_=rc(n,0);for(let v=0;v<i-1;++v)if(p=_,_=rc(n,v+1),!(!p||!_)){if(Du(e[v],0,k4)){t[v]=t[v+1]=0;continue}s=t[v]/e[v],c=t[v+1]/e[v],o=Math.pow(s,2)+Math.pow(c,2),!(o<=9)&&(u=3/Math.sqrt(o),t[v]=s*u*e[v],t[v+1]=c*u*e[v])}}function D4(n,e,t="x"){const i=By(t),s=n.length;let c,u,o,p=rc(n,0);for(let _=0;_<s;++_){if(u=o,o=p,p=rc(n,_+1),!o)continue;const v=o[t],M=o[i];u&&(c=(v-u[t])/3,o[`cp1${t}`]=v-c,o[`cp1${i}`]=M-c*e[_]),p&&(c=(p[t]-v)/3,o[`cp2${t}`]=v+c,o[`cp2${i}`]=M+c*e[_])}}function T4(n,e="x"){const t=By(e),i=n.length,s=Array(i).fill(0),c=Array(i);let u,o,p,_=rc(n,0);for(u=0;u<i;++u)if(o=p,p=_,_=rc(n,u+1),!!p){if(_){const v=_[e]-p[e];s[u]=v!==0?(_[t]-p[t])/v:0}c[u]=o?_?Rs(s[u-1])!==Rs(s[u])?0:(s[u-1]+s[u])/2:s[u-1]:s[u]}M4(n,s,c),D4(n,c,e)}function ed(n,e,t){return Math.max(Math.min(n,t),e)}function C4(n,e){let t,i,s,c,u,o=Ou(n[0],e);for(t=0,i=n.length;t<i;++t)u=c,c=o,o=t<i-1&&Ou(n[t+1],e),c&&(s=n[t],u&&(s.cp1x=ed(s.cp1x,e.left,e.right),s.cp1y=ed(s.cp1y,e.top,e.bottom)),o&&(s.cp2x=ed(s.cp2x,e.left,e.right),s.cp2y=ed(s.cp2y,e.top,e.bottom)))}function P4(n,e,t,i,s){let c,u,o,p;if(e.spanGaps&&(n=n.filter(_=>!_.skip)),e.cubicInterpolationMode==="monotone")T4(n,s);else{let _=i?n[n.length-1]:n[0];for(c=0,u=n.length;c<u;++c)o=n[c],p=S4(_,o,n[Math.min(c+1,u-(i?0:1))%u],e.tension),o.cp1x=p.previous.x,o.cp1y=p.previous.y,o.cp2x=p.next.x,o.cp2y=p.next.y,_=o}e.capBezierPoints&&C4(n,t)}function Ny(){return typeof window<"u"&&typeof document<"u"}function Am(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function kd(n,e,t){let i;return typeof n=="string"?(i=parseInt(n,10),n.indexOf("%")!==-1&&(i=i/100*e.parentNode[t])):i=n,i}const qd=n=>window.getComputedStyle(n,null);function A4(n,e){return qd(n).getPropertyValue(e)}const I4=["top","right","bottom","left"];function dl(n,e,t){const i={};t=t?"-"+t:"";for(let s=0;s<4;s++){const c=I4[s];i[c]=parseFloat(n[e+"-"+c+t])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const E4=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function L4(n,e){const t=n.touches,i=t&&t.length?t[0]:n,{offsetX:s,offsetY:c}=i;let u=!1,o,p;if(E4(s,c,n.target))o=s,p=c;else{const _=e.getBoundingClientRect();o=i.clientX-_.left,p=i.clientY-_.top,u=!0}return{x:o,y:p,box:u}}function ol(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:i}=e,s=qd(t),c=s.boxSizing==="border-box",u=dl(s,"padding"),o=dl(s,"border","width"),{x:p,y:_,box:v}=L4(n,t),M=u.left+(v&&o.left),S=u.top+(v&&o.top);let{width:I,height:R}=e;return c&&(I-=u.width+o.width,R-=u.height+o.height),{x:Math.round((p-M)/I*t.width/i),y:Math.round((_-S)/R*t.height/i)}}function z4(n,e,t){let i,s;if(e===void 0||t===void 0){const c=Am(n);if(!c)e=n.clientWidth,t=n.clientHeight;else{const u=c.getBoundingClientRect(),o=qd(c),p=dl(o,"border","width"),_=dl(o,"padding");e=u.width-_.width-p.width,t=u.height-_.height-p.height,i=kd(o.maxWidth,c,"clientWidth"),s=kd(o.maxHeight,c,"clientHeight")}}return{width:e,height:t,maxWidth:i||vd,maxHeight:s||vd}}const Pp=n=>Math.round(n*10)/10;function R4(n,e,t,i){const s=qd(n),c=dl(s,"margin"),u=kd(s.maxWidth,n,"clientWidth")||vd,o=kd(s.maxHeight,n,"clientHeight")||vd,p=z4(n,e,t);let{width:_,height:v}=p;if(s.boxSizing==="content-box"){const M=dl(s,"border","width"),S=dl(s,"padding");_-=S.width+M.width,v-=S.height+M.height}return _=Math.max(0,_-c.width),v=Math.max(0,i?Math.floor(_/i):v-c.height),_=Pp(Math.min(_,u,p.maxWidth)),v=Pp(Math.min(v,o,p.maxHeight)),_&&!v&&(v=Pp(_/2)),{width:_,height:v}}function B0(n,e,t){const i=e||1,s=Math.floor(n.height*i),c=Math.floor(n.width*i);n.height=s/i,n.width=c/i;const u=n.canvas;return u.style&&(t||!u.style.height&&!u.style.width)&&(u.style.height=`${n.height}px`,u.style.width=`${n.width}px`),n.currentDevicePixelRatio!==i||u.height!==s||u.width!==c?(n.currentDevicePixelRatio=i,u.height=s,u.width=c,n.ctx.setTransform(i,0,0,i,0,0),!0):!1}const F4=function(){let n=!1;try{const e={get passive(){return n=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch{}return n}();function N0(n,e){const t=A4(n,e),i=t&&t.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function ll(n,e,t,i){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function O4(n,e,t,i){return{x:n.x+t*(e.x-n.x),y:i==="middle"?t<.5?n.y:e.y:i==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function B4(n,e,t,i){const s={x:n.cp2x,y:n.cp2y},c={x:e.cp1x,y:e.cp1y},u=ll(n,s,t),o=ll(s,c,t),p=ll(c,e,t),_=ll(u,o,t),v=ll(o,p,t);return ll(_,v,t)}const V0=new Map;function N4(n,e){e=e||{};const t=n+JSON.stringify(e);let i=V0.get(t);return i||(i=new Intl.NumberFormat(n,e),V0.set(t,i)),i}function Wu(n,e,t){return N4(e,t).format(n)}const V4=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,i){return t-i},leftForLtr(t,i){return t-i}}},H4=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function Ql(n,e,t){return n?V4(e,t):H4()}function Vy(n,e){let t,i;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,i=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=i)}function Hy(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function jy(n){return n==="angle"?{between:Fu,compare:Tk,normalize:qr}:{between:ao,compare:(e,t)=>e-t,normalize:e=>e}}function H0({start:n,end:e,count:t,loop:i,style:s}){return{start:n%t,end:e%t,loop:i&&(e-n+1)%t===0,style:s}}function j4(n,e,t){const{property:i,start:s,end:c}=t,{between:u,normalize:o}=jy(i),p=e.length;let{start:_,end:v,loop:M}=n,S,I;if(M){for(_+=p,v+=p,S=0,I=p;S<I&&u(o(e[_%p][i]),s,c);++S)_--,v--;_%=p,v%=p}return v<_&&(v+=p),{start:_,end:v,loop:M,style:n.style}}function Uy(n,e,t){if(!t)return[n];const{property:i,start:s,end:c}=t,u=e.length,{compare:o,between:p,normalize:_}=jy(i),{start:v,end:M,loop:S,style:I}=j4(n,e,t),R=[];let G=!1,Y=null,X,oe,Q;const ce=()=>p(s,Q,X)&&o(s,Q)!==0,De=()=>o(c,X)===0||p(c,Q,X),Oe=()=>G||ce(),Pe=()=>!G||De();for(let Se=v,_e=v;Se<=M;++Se)oe=e[Se%u],!oe.skip&&(X=_(oe[i]),X!==Q&&(G=p(X,s,c),Y===null&&Oe()&&(Y=o(X,s)===0?Se:_e),Y!==null&&Pe()&&(R.push(H0({start:Y,end:Se,loop:S,count:u,style:I})),Y=null),_e=Se,Q=X));return Y!==null&&R.push(H0({start:Y,end:M,loop:S,count:u,style:I})),R}function Wy(n,e){const t=[],i=n.segments;for(let s=0;s<i.length;s++){const c=Uy(i[s],n.points,e);c.length&&t.push(...c)}return t}function U4(n,e,t,i){let s=0,c=e-1;if(t&&!i)for(;s<e&&!n[s].skip;)s++;for(;s<e&&n[s].skip;)s++;for(s%=e,t&&(c+=s);c>s&&n[c%e].skip;)c--;return c%=e,{start:s,end:c}}function W4(n,e,t,i){const s=n.length,c=[];let u=e,o=n[e],p;for(p=e+1;p<=t;++p){const _=n[p%s];_.skip||_.stop?o.skip||(i=!1,c.push({start:e%s,end:(p-1)%s,loop:i}),e=u=_.stop?p:null):(u=p,o.skip&&(e=p)),o=_}return u!==null&&c.push({start:e%s,end:u%s,loop:i}),c}function q4(n,e){const t=n.points,i=n.options.spanGaps,s=t.length;if(!s)return[];const c=!!n._loop,{start:u,end:o}=U4(t,s,c,i);if(i===!0)return j0(n,[{start:u,end:o,loop:c}],t,e);const p=o<u?o+s:o,_=!!n._fullLoop&&u===0&&o===s-1;return j0(n,W4(t,u,p,_),t,e)}function j0(n,e,t,i){return!i||!i.setContext||!t?e:Z4(n,e,t,i)}function Z4(n,e,t,i){const s=n._chart.getContext(),c=U0(n.options),{_datasetIndex:u,options:{spanGaps:o}}=n,p=t.length,_=[];let v=c,M=e[0].start,S=M;function I(R,G,Y,X){const oe=o?-1:1;if(R!==G){for(R+=p;t[R%p].skip;)R-=oe;for(;t[G%p].skip;)G+=oe;R%p!==G%p&&(_.push({start:R%p,end:G%p,loop:Y,style:X}),v=X,M=G%p)}}for(const R of e){M=o?M:R.start;let G=t[M%p],Y;for(S=M+1;S<=R.end;S++){const X=t[S%p];Y=U0(i.setContext(Ho(s,{type:"segment",p0:G,p1:X,p0DataIndex:(S-1)%p,p1DataIndex:S%p,datasetIndex:u}))),G4(Y,v)&&I(M,S-1,R.loop,v),G=X,v=Y}M<S-1&&I(M,S-1,R.loop,v)}return _}function U0(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function G4(n,e){return e&&JSON.stringify(n)!==JSON.stringify(e)}/*!
 * Chart.js v3.9.1
 * https://www.chartjs.org
 * (c) 2022 Chart.js Contributors
 * Released under the MIT License
 */class $4{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,i,s){const c=t.listeners[s],u=t.duration;c.forEach(o=>o({chart:e,initial:t.initial,numSteps:u,currentStep:Math.min(i-t.start,u)}))}_refresh(){this._request||(this._running=!0,this._request=wy.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((i,s)=>{if(!i.running||!i.items.length)return;const c=i.items;let u=c.length-1,o=!1,p;for(;u>=0;--u)p=c[u],p._active?(p._total>i.duration&&(i.duration=p._total),p.tick(e),o=!0):(c[u]=c[c.length-1],c.pop());o&&(s.draw(),this._notify(s,i,e,"progress")),c.length||(i.running=!1,this._notify(s,i,e,"complete"),i.initial=!1),t+=c.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let i=t.get(e);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,i)),i}listen(e,t,i){this._getAnims(e).listeners[t].push(i)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((i,s)=>Math.max(i,s._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const i=t.items;let s=i.length-1;for(;s>=0;--s)i[s].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var eo=new $4;const W0="transparent",K4={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const i=z0(n||W0),s=i.valid&&z0(e||W0);return s&&s.valid?s.mix(i,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class Y4{constructor(e,t,i,s){const c=t[i];s=wu([e.to,s,c,e.from]);const u=wu([e.from,c,s]);this._active=!0,this._fn=e.fn||K4[e.type||typeof u],this._easing=Tu[e.easing]||Tu.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=i,this._from=u,this._to=s,this._promises=void 0}active(){return this._active}update(e,t,i){if(this._active){this._notify(!1);const s=this._target[this._prop],c=i-this._start,u=this._duration-c;this._start=i,this._duration=Math.floor(Math.max(u,e.duration)),this._total+=c,this._loop=!!e.loop,this._to=wu([e.to,t,s,e.from]),this._from=wu([e.from,s,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,i=this._duration,s=this._prop,c=this._from,u=this._loop,o=this._to;let p;if(this._active=c!==o&&(u||t<i),!this._active){this._target[s]=o,this._notify(!0);return}if(t<0){this._target[s]=c;return}p=t/i%2,p=u&&p>1?2-p:p,p=this._easing(Math.min(1,Math.max(0,p))),this._target[s]=this._fn(c,o,p)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,i)=>{e.push({res:t,rej:i})})}_notify(e){const t=e?"res":"rej",i=this._promises||[];for(let s=0;s<i.length;s++)i[s][t]()}}const J4=["x","y","borderWidth","radius","tension"],X4=["color","borderColor","backgroundColor"];gn.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const Q4=Object.keys(gn.animation);gn.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:n=>n!=="onProgress"&&n!=="onComplete"&&n!=="fn"});gn.set("animations",{colors:{type:"color",properties:X4},numbers:{type:"number",properties:J4}});gn.describe("animations",{_fallback:"animation"});gn.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:n=>n|0}}}});class qy{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!pn(e))return;const t=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const s=e[i];if(!pn(s))return;const c={};for(const u of Q4)c[u]=s[u];(Xn(s.properties)&&s.properties||[i]).forEach(u=>{(u===i||!t.has(u))&&t.set(u,c)})})}_animateOptions(e,t){const i=t.options,s=tS(e,i);if(!s)return[];const c=this._createAnimations(s,i);return i.$shared&&eS(e.options.$animations,i).then(()=>{e.options=i},()=>{}),c}_createAnimations(e,t){const i=this._properties,s=[],c=e.$animations||(e.$animations={}),u=Object.keys(t),o=Date.now();let p;for(p=u.length-1;p>=0;--p){const _=u[p];if(_.charAt(0)==="$")continue;if(_==="options"){s.push(...this._animateOptions(e,t));continue}const v=t[_];let M=c[_];const S=i.get(_);if(M)if(S&&M.active()){M.update(S,v,o);continue}else M.cancel();if(!S||!S.duration){e[_]=v;continue}c[_]=M=new Y4(S,e,_,v),s.push(M)}return s}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const i=this._createAnimations(e,t);if(i.length)return eo.add(this._chart,i),!0}}function eS(n,e){const t=[],i=Object.keys(e);for(let s=0;s<i.length;s++){const c=n[i[s]];c&&c.active()&&t.push(c.wait())}return Promise.all(t)}function tS(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function q0(n,e){const t=n&&n.options||{},i=t.reverse,s=t.min===void 0?e:0,c=t.max===void 0?e:0;return{start:i?c:s,end:i?s:c}}function iS(n,e,t){if(t===!1)return!1;const i=q0(n,t),s=q0(e,t);return{top:s.end,right:i.end,bottom:s.start,left:i.start}}function nS(n){let e,t,i,s;return pn(n)?(e=n.top,t=n.right,i=n.bottom,s=n.left):e=t=i=s=n,{top:e,right:t,bottom:i,left:s,disabled:n===!1}}function Zy(n,e){const t=[],i=n._getSortedDatasetMetas(e);let s,c;for(s=0,c=i.length;s<c;++s)t.push(i[s].index);return t}function Z0(n,e,t,i={}){const s=n.keys,c=i.mode==="single";let u,o,p,_;if(e!==null){for(u=0,o=s.length;u<o;++u){if(p=+s[u],p===t){if(i.all)continue;break}_=n.values[p],Pa(_)&&(c||e===0||Rs(e)===Rs(_))&&(e+=_)}return e}}function aS(n){const e=Object.keys(n),t=new Array(e.length);let i,s,c;for(i=0,s=e.length;i<s;++i)c=e[i],t[i]={x:c,y:n[c]};return t}function G0(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function rS(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function sS(n){const{min:e,max:t,minDefined:i,maxDefined:s}=n.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:s?t:Number.POSITIVE_INFINITY}}function oS(n,e,t){const i=n[e]||(n[e]={});return i[t]||(i[t]={})}function $0(n,e,t,i){for(const s of e.getMatchingVisibleMetas(i).reverse()){const c=n[s.index];if(t&&c>0||!t&&c<0)return s.index}return null}function K0(n,e){const{chart:t,_cachedMeta:i}=n,s=t._stacks||(t._stacks={}),{iScale:c,vScale:u,index:o}=i,p=c.axis,_=u.axis,v=rS(c,u,i),M=e.length;let S;for(let I=0;I<M;++I){const R=e[I],{[p]:G,[_]:Y}=R,X=R._stacks||(R._stacks={});S=X[_]=oS(s,v,G),S[o]=Y,S._top=$0(S,u,!0,i.type),S._bottom=$0(S,u,!1,i.type)}}function Ap(n,e){const t=n.scales;return Object.keys(t).filter(i=>t[i].axis===e).shift()}function lS(n,e){return Ho(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function cS(n,e,t){return Ho(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function mu(n,e){const t=n.controller.index,i=n.vScale&&n.vScale.axis;if(i){e=e||n._parsed;for(const s of e){const c=s._stacks;if(!c||c[i]===void 0||c[i][t]===void 0)return;delete c[i][t]}}}const Ip=n=>n==="reset"||n==="none",Y0=(n,e)=>e?n:Object.assign({},n),uS=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:Zy(t,!0),values:null};class bs{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=G0(e.vScale,e),this.addElements()}updateIndex(e){this.index!==e&&mu(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,i=this.getDataset(),s=(M,S,I,R)=>M==="x"?S:M==="r"?R:I,c=t.xAxisID=sn(i.xAxisID,Ap(e,"x")),u=t.yAxisID=sn(i.yAxisID,Ap(e,"y")),o=t.rAxisID=sn(i.rAxisID,Ap(e,"r")),p=t.indexAxis,_=t.iAxisID=s(p,c,u,o),v=t.vAxisID=s(p,u,c,o);t.xScale=this.getScaleForId(c),t.yScale=this.getScaleForId(u),t.rScale=this.getScaleForId(o),t.iScale=this.getScaleForId(_),t.vScale=this.getScaleForId(v)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&T0(this._data,this),e._stacked&&mu(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),i=this._data;if(pn(t))this._data=aS(t);else if(i!==t){if(i){T0(i,this);const s=this._cachedMeta;mu(s),s._parsed=[]}t&&Object.isExtensible(t)&&Ik(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,i=this.getDataset();let s=!1;this._dataCheck();const c=t._stacked;t._stacked=G0(t.vScale,t),t.stack!==i.stack&&(s=!0,mu(t),t.stack=i.stack),this._resyncElements(e),(s||c!==t._stacked)&&K0(this,t._parsed)}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),i=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:i,_data:s}=this,{iScale:c,_stacked:u}=i,o=c.axis;let p=e===0&&t===s.length?!0:i._sorted,_=e>0&&i._parsed[e-1],v,M,S;if(this._parsing===!1)i._parsed=s,i._sorted=!0,S=s;else{Xn(s[e])?S=this.parseArrayData(i,s,e,t):pn(s[e])?S=this.parseObjectData(i,s,e,t):S=this.parsePrimitiveData(i,s,e,t);const I=()=>M[o]===null||_&&M[o]<_[o];for(v=0;v<t;++v)i._parsed[v+e]=M=S[v],p&&(I()&&(p=!1),_=M);i._sorted=p}u&&K0(this,S)}parsePrimitiveData(e,t,i,s){const{iScale:c,vScale:u}=e,o=c.axis,p=u.axis,_=c.getLabels(),v=c===u,M=new Array(s);let S,I,R;for(S=0,I=s;S<I;++S)R=S+i,M[S]={[o]:v||c.parse(_[R],R),[p]:u.parse(t[R],R)};return M}parseArrayData(e,t,i,s){const{xScale:c,yScale:u}=e,o=new Array(s);let p,_,v,M;for(p=0,_=s;p<_;++p)v=p+i,M=t[v],o[p]={x:c.parse(M[0],v),y:u.parse(M[1],v)};return o}parseObjectData(e,t,i,s){const{xScale:c,yScale:u}=e,{xAxisKey:o="x",yAxisKey:p="y"}=this._parsing,_=new Array(s);let v,M,S,I;for(v=0,M=s;v<M;++v)S=v+i,I=t[S],_[v]={x:c.parse(Bo(I,o),S),y:u.parse(Bo(I,p),S)};return _}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,i){const s=this.chart,c=this._cachedMeta,u=t[e.axis],o={keys:Zy(s,!0),values:t._stacks[e.axis]};return Z0(o,u,c.index,{mode:i})}updateRangeFromParsed(e,t,i,s){const c=i[t.axis];let u=c===null?NaN:c;const o=s&&i._stacks[t.axis];s&&o&&(s.values=o,u=Z0(s,c,this._cachedMeta.index)),e.min=Math.min(e.min,u),e.max=Math.max(e.max,u)}getMinMax(e,t){const i=this._cachedMeta,s=i._parsed,c=i._sorted&&e===i.iScale,u=s.length,o=this._getOtherScale(e),p=uS(t,i,this.chart),_={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:v,max:M}=sS(o);let S,I;function R(){I=s[S];const G=I[o.axis];return!Pa(I[e.axis])||v>G||M<G}for(S=0;S<u&&!(!R()&&(this.updateRangeFromParsed(_,e,I,p),c));++S);if(c){for(S=u-1;S>=0;--S)if(!R()){this.updateRangeFromParsed(_,e,I,p);break}}return _}getAllParsedValues(e){const t=this._cachedMeta._parsed,i=[];let s,c,u;for(s=0,c=t.length;s<c;++s)u=t[s][e.axis],Pa(u)&&i.push(u);return i}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,i=t.iScale,s=t.vScale,c=this.getParsed(e);return{label:i?""+i.getLabelForValue(c[i.axis]):"",value:s?""+s.getLabelForValue(c[s.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=nS(sn(this.options.clip,iS(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,i=this._cachedMeta,s=i.data||[],c=t.chartArea,u=[],o=this._drawStart||0,p=this._drawCount||s.length-o,_=this.options.drawActiveElementsOnTop;let v;for(i.dataset&&i.dataset.draw(e,c,o,p),v=o;v<o+p;++v){const M=s[v];M.hidden||(M.active&&_?u.push(M):M.draw(e,c))}for(v=0;v<u.length;++v)u[v].draw(e,c)}getStyle(e,t){const i=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(e||0,i)}getContext(e,t,i){const s=this.getDataset();let c;if(e>=0&&e<this._cachedMeta.data.length){const u=this._cachedMeta.data[e];c=u.$context||(u.$context=cS(this.getContext(),e,u)),c.parsed=this.getParsed(e),c.raw=s.data[e],c.index=c.dataIndex=e}else c=this.$context||(this.$context=lS(this.chart.getContext(),this.index)),c.dataset=s,c.index=c.datasetIndex=this.index;return c.active=!!t,c.mode=i,c}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",i){const s=t==="active",c=this._cachedDataOpts,u=e+"-"+t,o=c[u],p=this.enableOptionSharing&&os(i);if(o)return Y0(o,p);const _=this.chart.config,v=_.datasetElementScopeKeys(this._type,e),M=s?[`${e}Hover`,"hover",e,""]:[e,""],S=_.getOptionScopes(this.getDataset(),v),I=Object.keys(gn.elements[e]),R=()=>this.getContext(i,s),G=_.resolveNamedOptions(S,I,R,M);return G.$shared&&(G.$shared=p,c[u]=Object.freeze(Y0(G,p))),G}_resolveAnimations(e,t,i){const s=this.chart,c=this._cachedDataOpts,u=`animation-${t}`,o=c[u];if(o)return o;let p;if(s.options.animation!==!1){const v=this.chart.config,M=v.datasetAnimationScopeKeys(this._type,t),S=v.getOptionScopes(this.getDataset(),M);p=v.createResolver(S,this.getContext(e,i,t))}const _=new qy(s,p&&p.animations);return p&&p._cacheable&&(c[u]=Object.freeze(_)),_}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||Ip(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const i=this.resolveDataElementOptions(e,t),s=this._sharedOptions,c=this.getSharedOptions(i),u=this.includeOptions(t,c)||c!==s;return this.updateSharedOptions(c,t,i),{sharedOptions:c,includeOptions:u}}updateElement(e,t,i,s){Ip(s)?Object.assign(e,i):this._resolveAnimations(t,s).update(e,i)}updateSharedOptions(e,t,i){e&&!Ip(t)&&this._resolveAnimations(void 0,t).update(e,i)}_setStyle(e,t,i,s){e.active=s;const c=this.getStyle(t,s);this._resolveAnimations(t,i,s).update(e,{options:!s&&this.getSharedOptions(c)||c})}removeHoverStyle(e,t,i){this._setStyle(e,i,"active",!1)}setHoverStyle(e,t,i){this._setStyle(e,i,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,i=this._cachedMeta.data;for(const[o,p,_]of this._syncList)this[o](p,_);this._syncList=[];const s=i.length,c=t.length,u=Math.min(c,s);u&&this.parse(0,u),c>s?this._insertElements(s,c-s,e):c<s&&this._removeElements(c,s-c)}_insertElements(e,t,i=!0){const s=this._cachedMeta,c=s.data,u=e+t;let o;const p=_=>{for(_.length+=t,o=_.length-1;o>=u;o--)_[o]=_[o-t]};for(p(c),o=e;o<u;++o)c[o]=new this.dataElementType;this._parsing&&p(s._parsed),this.parse(e,t),i&&this.updateElements(c,e,t,"reset")}updateElements(e,t,i,s){}_removeElements(e,t){const i=this._cachedMeta;if(this._parsing){const s=i._parsed.splice(e,t);i._stacked&&mu(i,s)}i.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,i,s]=e;this[t](i,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const i=arguments.length-2;i&&this._sync(["_insertElements",e,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}bs.defaults={};bs.prototype.datasetElementType=null;bs.prototype.dataElementType=null;function hS(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let i=[];for(let s=0,c=t.length;s<c;s++)i=i.concat(t[s].controller.getAllParsedValues(n));n._cache.$bar=xy(i.sort((s,c)=>s-c))}return n._cache.$bar}function dS(n){const e=n.iScale,t=hS(e,n.type);let i=e._length,s,c,u,o;const p=()=>{u===32767||u===-32768||(os(o)&&(i=Math.min(i,Math.abs(u-o)||i)),o=u)};for(s=0,c=t.length;s<c;++s)u=e.getPixelForValue(t[s]),p();for(o=void 0,s=0,c=e.ticks.length;s<c;++s)u=e.getPixelForTick(s),p();return i}function fS(n,e,t,i){const s=t.barThickness;let c,u;return yn(s)?(c=e.min*t.categoryPercentage,u=t.barPercentage):(c=s*i,u=1),{chunk:c/i,ratio:u,start:e.pixels[n]-c/2}}function pS(n,e,t,i){const s=e.pixels,c=s[n];let u=n>0?s[n-1]:null,o=n<s.length-1?s[n+1]:null;const p=t.categoryPercentage;u===null&&(u=c-(o===null?e.end-e.start:o-c)),o===null&&(o=c+c-u);const _=c-(c-Math.min(u,o))/2*p;return{chunk:Math.abs(o-u)/2*p/i,ratio:t.barPercentage,start:_}}function mS(n,e,t,i){const s=t.parse(n[0],i),c=t.parse(n[1],i),u=Math.min(s,c),o=Math.max(s,c);let p=u,_=o;Math.abs(u)>Math.abs(o)&&(p=o,_=u),e[t.axis]=_,e._custom={barStart:p,barEnd:_,start:s,end:c,min:u,max:o}}function Gy(n,e,t,i){return Xn(n)?mS(n,e,t,i):e[t.axis]=t.parse(n,i),e}function J0(n,e,t,i){const s=n.iScale,c=n.vScale,u=s.getLabels(),o=s===c,p=[];let _,v,M,S;for(_=t,v=t+i;_<v;++_)S=e[_],M={},M[s.axis]=o||s.parse(u[_],_),p.push(Gy(S,M,c,_));return p}function Ep(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function gS(n,e,t){return n!==0?Rs(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function _S(n){let e,t,i,s,c;return n.horizontal?(e=n.base>n.x,t="left",i="right"):(e=n.base<n.y,t="bottom",i="top"),e?(s="end",c="start"):(s="start",c="end"),{start:t,end:i,reverse:e,top:s,bottom:c}}function yS(n,e,t,i){let s=e.borderSkipped;const c={};if(!s){n.borderSkipped=c;return}if(s===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:u,end:o,reverse:p,top:_,bottom:v}=_S(n);s==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===i?s=_:(t._bottom||0)===i?s=v:(c[X0(v,u,o,p)]=!0,s=_)),c[X0(s,u,o,p)]=!0,n.borderSkipped=c}function X0(n,e,t,i){return i?(n=bS(n,e,t),n=Q0(n,t,e)):n=Q0(n,e,t),n}function bS(n,e,t){return n===e?t:n===t?e:n}function Q0(n,e,t){return n==="start"?e:n==="end"?t:n}function vS(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class Zd extends bs{parsePrimitiveData(e,t,i,s){return J0(e,t,i,s)}parseArrayData(e,t,i,s){return J0(e,t,i,s)}parseObjectData(e,t,i,s){const{iScale:c,vScale:u}=e,{xAxisKey:o="x",yAxisKey:p="y"}=this._parsing,_=c.axis==="x"?o:p,v=u.axis==="x"?o:p,M=[];let S,I,R,G;for(S=i,I=i+s;S<I;++S)G=t[S],R={},R[c.axis]=c.parse(Bo(G,_),S),M.push(Gy(Bo(G,v),R,u,S));return M}updateRangeFromParsed(e,t,i,s){super.updateRangeFromParsed(e,t,i,s);const c=i._custom;c&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,c.min),e.max=Math.max(e.max,c.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:i,vScale:s}=t,c=this.getParsed(e),u=c._custom,o=Ep(u)?"["+u.start+", "+u.end+"]":""+s.getLabelForValue(c[s.axis]);return{label:""+i.getLabelForValue(c[i.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,i,s){const c=s==="reset",{index:u,_cachedMeta:{vScale:o}}=this,p=o.getBasePixel(),_=o.isHorizontal(),v=this._getRuler(),{sharedOptions:M,includeOptions:S}=this._getSharedOptions(t,s);for(let I=t;I<t+i;I++){const R=this.getParsed(I),G=c||yn(R[o.axis])?{base:p,head:p}:this._calculateBarValuePixels(I),Y=this._calculateBarIndexPixels(I,v),X=(R._stacks||{})[o.axis],oe={horizontal:_,base:G.base,enableBorderRadius:!X||Ep(R._custom)||u===X._top||u===X._bottom,x:_?G.head:Y.center,y:_?Y.center:G.head,height:_?Y.size:Math.abs(G.size),width:_?Math.abs(G.size):Y.size};S&&(oe.options=M||this.resolveDataElementOptions(I,e[I].active?"active":s));const Q=oe.options||e[I].options;yS(oe,Q,X,u),vS(oe,Q,v.ratio),this.updateElement(e[I],I,oe,s)}}_getStacks(e,t){const{iScale:i}=this._cachedMeta,s=i.getMatchingVisibleMetas(this._type).filter(p=>p.controller.options.grouped),c=i.options.stacked,u=[],o=p=>{const _=p.controller.getParsed(t),v=_&&_[p.vScale.axis];if(yn(v)||isNaN(v))return!0};for(const p of s)if(!(t!==void 0&&o(p))&&((c===!1||u.indexOf(p.stack)===-1||c===void 0&&p.stack===void 0)&&u.push(p.stack),p.index===e))break;return u.length||u.push(void 0),u}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,i){const s=this._getStacks(e,i),c=t!==void 0?s.indexOf(t):-1;return c===-1?s.length-1:c}_getRuler(){const e=this.options,t=this._cachedMeta,i=t.iScale,s=[];let c,u;for(c=0,u=t.data.length;c<u;++c)s.push(i.getPixelForValue(this.getParsed(c)[i.axis],c));const o=e.barThickness;return{min:o||dS(t),pixels:s,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:e.grouped,ratio:o?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:i},options:{base:s,minBarLength:c}}=this,u=s||0,o=this.getParsed(e),p=o._custom,_=Ep(p);let v=o[t.axis],M=0,S=i?this.applyStack(t,o,i):v,I,R;S!==v&&(M=S-v,S=v),_&&(v=p.barStart,S=p.barEnd-p.barStart,v!==0&&Rs(v)!==Rs(p.barEnd)&&(M=0),M+=v);const G=!yn(s)&&!_?s:M;let Y=t.getPixelForValue(G);if(this.chart.getDataVisibility(e)?I=t.getPixelForValue(M+S):I=Y,R=I-Y,Math.abs(R)<c){R=gS(R,t,u)*c,v===u&&(Y-=R/2);const X=t.getPixelForDecimal(0),oe=t.getPixelForDecimal(1),Q=Math.min(X,oe),ce=Math.max(X,oe);Y=Math.max(Math.min(Y,ce),Q),I=Y+R}if(Y===t.getPixelForValue(u)){const X=Rs(R)*t.getLineWidthForValue(u)/2;Y+=X,R-=X}return{size:R,base:Y,head:I,center:I+R/2}}_calculateBarIndexPixels(e,t){const i=t.scale,s=this.options,c=s.skipNull,u=sn(s.maxBarThickness,1/0);let o,p;if(t.grouped){const _=c?this._getStackCount(e):t.stackCount,v=s.barThickness==="flex"?pS(e,t,s,_):fS(e,t,s,_),M=this._getStackIndex(this.index,this._cachedMeta.stack,c?e:void 0);o=v.start+v.chunk*M+v.chunk/2,p=Math.min(u,v.chunk*v.ratio)}else o=i.getPixelForValue(this.getParsed(e)[i.axis],e),p=Math.min(u,t.min*t.ratio);return{base:o-p/2,head:o+p/2,center:o,size:p}}draw(){const e=this._cachedMeta,t=e.vScale,i=e.data,s=i.length;let c=0;for(;c<s;++c)this.getParsed(c)[t.axis]!==null&&i[c].draw(this._ctx)}}Zd.id="bar";Zd.defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};Zd.overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};class Gd extends bs{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,i,s){const c=super.parsePrimitiveData(e,t,i,s);for(let u=0;u<c.length;u++)c[u]._custom=this.resolveDataElementOptions(u+i).radius;return c}parseArrayData(e,t,i,s){const c=super.parseArrayData(e,t,i,s);for(let u=0;u<c.length;u++){const o=t[i+u];c[u]._custom=sn(o[2],this.resolveDataElementOptions(u+i).radius)}return c}parseObjectData(e,t,i,s){const c=super.parseObjectData(e,t,i,s);for(let u=0;u<c.length;u++){const o=t[i+u];c[u]._custom=sn(o&&o.r&&+o.r,this.resolveDataElementOptions(u+i).radius)}return c}getMaxOverflow(){const e=this._cachedMeta.data;let t=0;for(let i=e.length-1;i>=0;--i)t=Math.max(t,e[i].size(this.resolveDataElementOptions(i))/2);return t>0&&t}getLabelAndValue(e){const t=this._cachedMeta,{xScale:i,yScale:s}=t,c=this.getParsed(e),u=i.getLabelForValue(c.x),o=s.getLabelForValue(c.y),p=c._custom;return{label:t.label,value:"("+u+", "+o+(p?", "+p:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(e,t,i,s){const c=s==="reset",{iScale:u,vScale:o}=this._cachedMeta,{sharedOptions:p,includeOptions:_}=this._getSharedOptions(t,s),v=u.axis,M=o.axis;for(let S=t;S<t+i;S++){const I=e[S],R=!c&&this.getParsed(S),G={},Y=G[v]=c?u.getPixelForDecimal(.5):u.getPixelForValue(R[v]),X=G[M]=c?o.getBasePixel():o.getPixelForValue(R[M]);G.skip=isNaN(Y)||isNaN(X),_&&(G.options=p||this.resolveDataElementOptions(S,I.active?"active":s),c&&(G.options.radius=0)),this.updateElement(I,S,G,s)}}resolveDataElementOptions(e,t){const i=this.getParsed(e);let s=super.resolveDataElementOptions(e,t);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const c=s.radius;return t!=="active"&&(s.radius=0),s.radius+=sn(i&&i._custom,c),s}}Gd.id="bubble";Gd.defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};Gd.overrides={scales:{x:{type:"linear"},y:{type:"linear"}},plugins:{tooltip:{callbacks:{title(){return""}}}}};function xS(n,e,t){let i=1,s=1,c=0,u=0;if(e<Nn){const o=n,p=o+e,_=Math.cos(o),v=Math.sin(o),M=Math.cos(p),S=Math.sin(p),I=(Q,ce,De)=>Fu(Q,o,p,!0)?1:Math.max(ce,ce*t,De,De*t),R=(Q,ce,De)=>Fu(Q,o,p,!0)?-1:Math.min(ce,ce*t,De,De*t),G=I(0,_,M),Y=I(ba,v,S),X=R(oa,_,M),oe=R(oa+ba,v,S);i=(G-X)/2,s=(Y-oe)/2,c=-(G+X)/2,u=-(Y+oe)/2}return{ratioX:i,ratioY:s,offsetX:c,offsetY:u}}class oc extends bs{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const i=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=i;else{let c=p=>+i[p];if(pn(i[e])){const{key:p="value"}=this._parsing;c=_=>+Bo(i[_],p)}let u,o;for(u=e,o=e+t;u<o;++u)s._parsed[u]=c(u)}}_getRotation(){return ys(this.options.rotation-90)}_getCircumference(){return ys(this.options.circumference)}_getRotationExtents(){let e=Nn,t=-Nn;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)){const s=this.chart.getDatasetMeta(i).controller,c=s._getRotation(),u=s._getCircumference();e=Math.min(e,c),t=Math.max(t,c+u)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:i}=t,s=this._cachedMeta,c=s.data,u=this.getMaxBorderWidth()+this.getMaxOffset(c)+this.options.spacing,o=Math.max((Math.min(i.width,i.height)-u)/2,0),p=Math.min(_k(this.options.cutout,o),1),_=this._getRingWeight(this.index),{circumference:v,rotation:M}=this._getRotationExtents(),{ratioX:S,ratioY:I,offsetX:R,offsetY:G}=xS(M,v,p),Y=(i.width-u)/S,X=(i.height-u)/I,oe=Math.max(Math.min(Y,X)/2,0),Q=gy(this.options.radius,oe),ce=Math.max(Q*p,0),De=(Q-ce)/this._getVisibleDatasetWeightTotal();this.offsetX=R*Q,this.offsetY=G*Q,s.total=this.calculateTotal(),this.outerRadius=Q-De*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-De*_,0),this.updateElements(c,0,c.length,e)}_circumference(e,t){const i=this.options,s=this._cachedMeta,c=this._getCircumference();return t&&i.animation.animateRotate||!this.chart.getDataVisibility(e)||s._parsed[e]===null||s.data[e].hidden?0:this.calculateCircumference(s._parsed[e]*c/Nn)}updateElements(e,t,i,s){const c=s==="reset",u=this.chart,o=u.chartArea,_=u.options.animation,v=(o.left+o.right)/2,M=(o.top+o.bottom)/2,S=c&&_.animateScale,I=S?0:this.innerRadius,R=S?0:this.outerRadius,{sharedOptions:G,includeOptions:Y}=this._getSharedOptions(t,s);let X=this._getRotation(),oe;for(oe=0;oe<t;++oe)X+=this._circumference(oe,c);for(oe=t;oe<t+i;++oe){const Q=this._circumference(oe,c),ce=e[oe],De={x:v+this.offsetX,y:M+this.offsetY,startAngle:X,endAngle:X+Q,circumference:Q,outerRadius:R,innerRadius:I};Y&&(De.options=G||this.resolveDataElementOptions(oe,ce.active?"active":s)),X+=Q,this.updateElement(ce,oe,De,s)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let i=0,s;for(s=0;s<t.length;s++){const c=e._parsed[s];c!==null&&!isNaN(c)&&this.chart.getDataVisibility(s)&&!t[s].hidden&&(i+=Math.abs(c))}return i}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?Nn*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart,s=i.data.labels||[],c=Wu(t._parsed[e],i.options.locale);return{label:s[e]||"",value:c}}getMaxBorderWidth(e){let t=0;const i=this.chart;let s,c,u,o,p;if(!e){for(s=0,c=i.data.datasets.length;s<c;++s)if(i.isDatasetVisible(s)){u=i.getDatasetMeta(s),e=u.data,o=u.controller;break}}if(!e)return 0;for(s=0,c=e.length;s<c;++s)p=o.resolveDataElementOptions(s),p.borderAlign!=="inner"&&(t=Math.max(t,p.borderWidth||0,p.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let i=0,s=e.length;i<s;++i){const c=this.resolveDataElementOptions(i);t=Math.max(t,c.offset||0,c.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let i=0;i<e;++i)this.chart.isDatasetVisible(i)&&(t+=this._getRingWeight(i));return t}_getRingWeight(e){return Math.max(sn(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}oc.id="doughnut";oc.defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};oc.descriptors={_scriptable:n=>n!=="spacing",_indexable:n=>n!=="spacing"};oc.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(n){const e=n.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:t}}=n.legend.options;return e.labels.map((i,s)=>{const u=n.getDatasetMeta(0).controller.getStyle(s);return{text:i,fillStyle:u.backgroundColor,strokeStyle:u.borderColor,lineWidth:u.borderWidth,pointStyle:t,hidden:!n.getDataVisibility(s),index:s}})}return[]}},onClick(n,e,t){t.chart.toggleDataVisibility(e.index),t.chart.update()}},tooltip:{callbacks:{title(){return""},label(n){let e=n.label;const t=": "+n.formattedValue;return Xn(e)?(e=e.slice(),e[0]+=t):e+=t,e}}}}};class $d extends bs{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:i,data:s=[],_dataset:c}=t,u=this.chart._animationsDisabled;let{start:o,count:p}=Sy(t,s,u);this._drawStart=o,this._drawCount=p,My(t)&&(o=0,p=s.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!c._decimated,i.points=s;const _=this.resolveDatasetElementOptions(e);this.options.showLine||(_.borderWidth=0),_.segment=this.options.segment,this.updateElement(i,void 0,{animated:!u,options:_},e),this.updateElements(s,o,p,e)}updateElements(e,t,i,s){const c=s==="reset",{iScale:u,vScale:o,_stacked:p,_dataset:_}=this._cachedMeta,{sharedOptions:v,includeOptions:M}=this._getSharedOptions(t,s),S=u.axis,I=o.axis,{spanGaps:R,segment:G}=this.options,Y=nc(R)?R:Number.POSITIVE_INFINITY,X=this.chart._animationsDisabled||c||s==="none";let oe=t>0&&this.getParsed(t-1);for(let Q=t;Q<t+i;++Q){const ce=e[Q],De=this.getParsed(Q),Oe=X?ce:{},Pe=yn(De[I]),Se=Oe[S]=u.getPixelForValue(De[S],Q),_e=Oe[I]=c||Pe?o.getBasePixel():o.getPixelForValue(p?this.applyStack(o,De,p):De[I],Q);Oe.skip=isNaN(Se)||isNaN(_e)||Pe,Oe.stop=Q>0&&Math.abs(De[S]-oe[S])>Y,G&&(Oe.parsed=De,Oe.raw=_.data[Q]),M&&(Oe.options=v||this.resolveDataElementOptions(Q,ce.active?"active":s)),X||this.updateElement(ce,Q,Oe,s),oe=De}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,i=t.options&&t.options.borderWidth||0,s=e.data||[];if(!s.length)return i;const c=s[0].size(this.resolveDataElementOptions(0)),u=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(i,c,u)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}$d.id="line";$d.defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};$d.overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};class Kd extends bs{constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart,s=i.data.labels||[],c=Wu(t._parsed[e].r,i.options.locale);return{label:s[e]||"",value:c}}parseObjectData(e,t,i,s){return Oy.bind(this)(e,t,i,s)}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){const e=this._cachedMeta,t={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((i,s)=>{const c=this.getParsed(s).r;!isNaN(c)&&this.chart.getDataVisibility(s)&&(c<t.min&&(t.min=c),c>t.max&&(t.max=c))}),t}_updateRadius(){const e=this.chart,t=e.chartArea,i=e.options,s=Math.min(t.right-t.left,t.bottom-t.top),c=Math.max(s/2,0),u=Math.max(i.cutoutPercentage?c/100*i.cutoutPercentage:1,0),o=(c-u)/e.getVisibleDatasetCount();this.outerRadius=c-o*this.index,this.innerRadius=this.outerRadius-o}updateElements(e,t,i,s){const c=s==="reset",u=this.chart,p=u.options.animation,_=this._cachedMeta.rScale,v=_.xCenter,M=_.yCenter,S=_.getIndexAngle(0)-.5*oa;let I=S,R;const G=360/this.countVisibleElements();for(R=0;R<t;++R)I+=this._computeAngle(R,s,G);for(R=t;R<t+i;R++){const Y=e[R];let X=I,oe=I+this._computeAngle(R,s,G),Q=u.getDataVisibility(R)?_.getDistanceFromCenterForValue(this.getParsed(R).r):0;I=oe,c&&(p.animateScale&&(Q=0),p.animateRotate&&(X=oe=S));const ce={x:v,y:M,innerRadius:0,outerRadius:Q,startAngle:X,endAngle:oe,options:this.resolveDataElementOptions(R,Y.active?"active":s)};this.updateElement(Y,R,ce,s)}}countVisibleElements(){const e=this._cachedMeta;let t=0;return e.data.forEach((i,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&t++}),t}_computeAngle(e,t,i){return this.chart.getDataVisibility(e)?ys(this.resolveDataElementOptions(e,t).angle||i):0}}Kd.id="polarArea";Kd.defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};Kd.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(n){const e=n.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:t}}=n.legend.options;return e.labels.map((i,s)=>{const u=n.getDatasetMeta(0).controller.getStyle(s);return{text:i,fillStyle:u.backgroundColor,strokeStyle:u.borderColor,lineWidth:u.borderWidth,pointStyle:t,hidden:!n.getDataVisibility(s),index:s}})}return[]}},onClick(n,e,t){t.chart.toggleDataVisibility(e.index),t.chart.update()}},tooltip:{callbacks:{title(){return""},label(n){return n.chart.data.labels[n.dataIndex]+": "+n.formattedValue}}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};class Im extends oc{}Im.id="pie";Im.defaults={cutout:0,rotation:0,circumference:360,radius:"100%"};class Yd extends bs{getLabelAndValue(e){const t=this._cachedMeta.vScale,i=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(i[t.axis])}}parseObjectData(e,t,i,s){return Oy.bind(this)(e,t,i,s)}update(e){const t=this._cachedMeta,i=t.dataset,s=t.data||[],c=t.iScale.getLabels();if(i.points=s,e!=="resize"){const u=this.resolveDatasetElementOptions(e);this.options.showLine||(u.borderWidth=0);const o={_loop:!0,_fullLoop:c.length===s.length,options:u};this.updateElement(i,void 0,o,e)}this.updateElements(s,0,s.length,e)}updateElements(e,t,i,s){const c=this._cachedMeta.rScale,u=s==="reset";for(let o=t;o<t+i;o++){const p=e[o],_=this.resolveDataElementOptions(o,p.active?"active":s),v=c.getPointPositionForValue(o,this.getParsed(o).r),M=u?c.xCenter:v.x,S=u?c.yCenter:v.y,I={x:M,y:S,angle:v.angle,skip:isNaN(M)||isNaN(S),options:_};this.updateElement(p,o,I,s)}}}Yd.id="radar";Yd.defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};Yd.overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};let vs=class{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}hasValue(){return nc(this.x)&&nc(this.y)}getProps(e,t){const i=this.$animations;if(!t||!i)return this;const s={};return e.forEach(c=>{s[c]=i[c]&&i[c].active()?i[c]._to:this[c]}),s}};vs.defaults={};vs.defaultRoutes=void 0;const $y={values(n){return Xn(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const i=this.chart.options.locale;let s,c=n;if(t.length>1){const _=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(_<1e-4||_>1e15)&&(s="scientific"),c=wS(n,t)}const u=ss(Math.abs(c)),o=Math.max(Math.min(-1*Math.floor(u),20),0),p={notation:s,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(p,this.options.ticks.format),Wu(n,i,p)},logarithmic(n,e,t){if(n===0)return"0";const i=n/Math.pow(10,Math.floor(ss(n)));return i===1||i===2||i===5?$y.numeric.call(this,n,e,t):""}};function wS(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var Jd={formatters:$y};gn.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(n,e)=>e.lineWidth,tickColor:(n,e)=>e.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Jd.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}});gn.route("scale.ticks","color","","color");gn.route("scale.grid","color","","borderColor");gn.route("scale.grid","borderColor","","borderColor");gn.route("scale.title","color","","color");gn.describe("scale",{_fallback:!1,_scriptable:n=>!n.startsWith("before")&&!n.startsWith("after")&&n!=="callback"&&n!=="parser",_indexable:n=>n!=="borderDash"&&n!=="tickBorderDash"});gn.describe("scales",{_fallback:"scale"});gn.describe("scale.ticks",{_scriptable:n=>n!=="backdropPadding"&&n!=="callback",_indexable:n=>n!=="backdropPadding"});function kS(n,e){const t=n.options.ticks,i=t.maxTicksLimit||SS(n),s=t.major.enabled?DS(e):[],c=s.length,u=s[0],o=s[c-1],p=[];if(c>i)return TS(e,p,s,c/i),p;const _=MS(s,e,i);if(c>0){let v,M;const S=c>1?Math.round((o-u)/(c-1)):null;for(td(e,p,_,yn(S)?0:u-S,u),v=0,M=c-1;v<M;v++)td(e,p,_,s[v],s[v+1]);return td(e,p,_,o,yn(S)?e.length:o+S),p}return td(e,p,_),p}function SS(n){const e=n.options.offset,t=n._tickSize(),i=n._length/t+(e?0:1),s=n._maxLength/t;return Math.floor(Math.min(i,s))}function MS(n,e,t){const i=CS(n),s=e.length/t;if(!i)return Math.max(s,1);const c=Mk(i);for(let u=0,o=c.length-1;u<o;u++){const p=c[u];if(p>s)return p}return Math.max(s,1)}function DS(n){const e=[];let t,i;for(t=0,i=n.length;t<i;t++)n[t].major&&e.push(t);return e}function TS(n,e,t,i){let s=0,c=t[0],u;for(i=Math.ceil(i),u=0;u<n.length;u++)u===c&&(e.push(n[u]),s++,c=t[s*i])}function td(n,e,t,i,s){const c=sn(i,0),u=Math.min(sn(s,n.length),n.length);let o=0,p,_,v;for(t=Math.ceil(t),s&&(p=s-i,t=p/Math.floor(p/t)),v=c;v<0;)o++,v=Math.round(c+o*t);for(_=Math.max(c,0);_<u;_++)_===v&&(e.push(n[_]),o++,v=Math.round(c+o*t))}function CS(n){const e=n.length;let t,i;if(e<2)return!1;for(i=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==i)return!1;return i}const PS=n=>n==="left"?"right":n==="right"?"left":n,e_=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t;function t_(n,e){const t=[],i=n.length/e,s=n.length;let c=0;for(;c<s;c+=i)t.push(n[Math.floor(c)]);return t}function AS(n,e,t){const i=n.ticks.length,s=Math.min(e,i-1),c=n._startPixel,u=n._endPixel,o=1e-6;let p=n.getPixelForTick(s),_;if(!(t&&(i===1?_=Math.max(p-c,u-p):e===0?_=(n.getPixelForTick(1)-p)/2:_=(p-n.getPixelForTick(s-1))/2,p+=s<e?_:-_,p<c-o||p>u+o)))return p}function IS(n,e){zn(n,t=>{const i=t.gc,s=i.length/2;let c;if(s>e){for(c=0;c<s;++c)delete t.data[i[c]];i.splice(0,s)}})}function gu(n){return n.drawTicks?n.tickLength:0}function i_(n,e){if(!n.display)return 0;const t=Ua(n.font,e),i=vr(n.padding);return(Xn(n.text)?n.text.length:1)*t.lineHeight+i.height}function ES(n,e){return Ho(n,{scale:e,type:"scale"})}function LS(n,e,t){return Ho(n,{tick:t,index:e,type:"tick"})}function zS(n,e,t){let i=wm(n);return(t&&e!=="right"||!t&&e==="right")&&(i=PS(i)),i}function RS(n,e,t,i){const{top:s,left:c,bottom:u,right:o,chart:p}=n,{chartArea:_,scales:v}=p;let M=0,S,I,R;const G=u-s,Y=o-c;if(n.isHorizontal()){if(I=mr(i,c,o),pn(t)){const X=Object.keys(t)[0],oe=t[X];R=v[X].getPixelForValue(oe)+G-e}else t==="center"?R=(_.bottom+_.top)/2+G-e:R=e_(n,t,e);S=o-c}else{if(pn(t)){const X=Object.keys(t)[0],oe=t[X];I=v[X].getPixelForValue(oe)-Y+e}else t==="center"?I=(_.left+_.right)/2-Y+e:I=e_(n,t,e);R=mr(i,u,s),M=t==="left"?-ba:ba}return{titleX:I,titleY:R,maxWidth:S,rotation:M}}class gl extends vs{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:i,_suggestedMax:s}=this;return e=rs(e,Number.POSITIVE_INFINITY),t=rs(t,Number.NEGATIVE_INFINITY),i=rs(i,Number.POSITIVE_INFINITY),s=rs(s,Number.NEGATIVE_INFINITY),{min:rs(e,i),max:rs(t,s),minDefined:Pa(e),maxDefined:Pa(t)}}getMinMax(e){let{min:t,max:i,minDefined:s,maxDefined:c}=this.getUserBounds(),u;if(s&&c)return{min:t,max:i};const o=this.getMatchingVisibleMetas();for(let p=0,_=o.length;p<_;++p)u=o[p].controller.getMinMax(this,e),s||(t=Math.min(t,u.min)),c||(i=Math.max(i,u.max));return t=c&&t>i?i:t,i=s&&t>i?t:i,{min:rs(t,rs(i,t)),max:rs(i,rs(t,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Jn(this.options.beforeUpdate,[this])}update(e,t,i){const{beginAtZero:s,grace:c,ticks:u}=this.options,o=u.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=f4(this,c,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const p=o<this.ticks.length;this._convertTicksToLabels(p?t_(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),u.display&&(u.autoSkip||u.source==="auto")&&(this.ticks=kS(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),p&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,i;this.isHorizontal()?(t=this.left,i=this.right):(t=this.top,i=this.bottom,e=!e),this._startPixel=t,this._endPixel=i,this._reversePixels=e,this._length=i-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Jn(this.options.afterUpdate,[this])}beforeSetDimensions(){Jn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Jn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Jn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Jn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let i,s,c;for(i=0,s=e.length;i<s;i++)c=e[i],c.label=Jn(t.callback,[c.value,i,e],this)}afterTickToLabelConversion(){Jn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Jn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,i=this.ticks.length,s=t.minRotation||0,c=t.maxRotation;let u=s,o,p,_;if(!this._isVisible()||!t.display||s>=c||i<=1||!this.isHorizontal()){this.labelRotation=s;return}const v=this._getLabelSizes(),M=v.widest.width,S=v.highest.height,I=Ya(this.chart.width-M,0,this.maxWidth);o=e.offset?this.maxWidth/i:I/(i-1),M+6>o&&(o=I/(i-(e.offset?.5:1)),p=this.maxHeight-gu(e.grid)-t.padding-i_(e.title,this.chart.options.font),_=Math.sqrt(M*M+S*S),u=vm(Math.min(Math.asin(Ya((v.highest.height+6)/o,-1,1)),Math.asin(Ya(p/_,-1,1))-Math.asin(Ya(S/_,-1,1)))),u=Math.max(s,Math.min(c,u))),this.labelRotation=u}afterCalculateLabelRotation(){Jn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Jn(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:i,title:s,grid:c}}=this,u=this._isVisible(),o=this.isHorizontal();if(u){const p=i_(s,t.options.font);if(o?(e.width=this.maxWidth,e.height=gu(c)+p):(e.height=this.maxHeight,e.width=gu(c)+p),i.display&&this.ticks.length){const{first:_,last:v,widest:M,highest:S}=this._getLabelSizes(),I=i.padding*2,R=ys(this.labelRotation),G=Math.cos(R),Y=Math.sin(R);if(o){const X=i.mirror?0:Y*M.width+G*S.height;e.height=Math.min(this.maxHeight,e.height+X+I)}else{const X=i.mirror?0:G*M.width+Y*S.height;e.width=Math.min(this.maxWidth,e.width+X+I)}this._calculatePadding(_,v,Y,G)}}this._handleMargins(),o?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,i,s){const{ticks:{align:c,padding:u},position:o}=this.options,p=this.labelRotation!==0,_=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const v=this.getPixelForTick(0)-this.left,M=this.right-this.getPixelForTick(this.ticks.length-1);let S=0,I=0;p?_?(S=s*e.width,I=i*t.height):(S=i*e.height,I=s*t.width):c==="start"?I=t.width:c==="end"?S=e.width:c!=="inner"&&(S=e.width/2,I=t.width/2),this.paddingLeft=Math.max((S-v+u)*this.width/(this.width-v),0),this.paddingRight=Math.max((I-M+u)*this.width/(this.width-M),0)}else{let v=t.height/2,M=e.height/2;c==="start"?(v=0,M=e.height):c==="end"&&(v=t.height,M=0),this.paddingTop=v+u,this.paddingBottom=M+u}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Jn(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,i;for(t=0,i=e.length;t<i;t++)yn(e[t].label)&&(e.splice(t,1),i--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let i=this.ticks;t<i.length&&(i=t_(i,t)),this._labelSizes=e=this._computeLabelSizes(i,i.length)}return e}_computeLabelSizes(e,t){const{ctx:i,_longestTextCache:s}=this,c=[],u=[];let o=0,p=0,_,v,M,S,I,R,G,Y,X,oe,Q;for(_=0;_<t;++_){if(S=e[_].label,I=this._resolveTickFontOptions(_),i.font=R=I.string,G=s[R]=s[R]||{data:{},gc:[]},Y=I.lineHeight,X=oe=0,!yn(S)&&!Xn(S))X=wd(i,G.data,G.gc,X,S),oe=Y;else if(Xn(S))for(v=0,M=S.length;v<M;++v)Q=S[v],!yn(Q)&&!Xn(Q)&&(X=wd(i,G.data,G.gc,X,Q),oe+=Y);c.push(X),u.push(oe),o=Math.max(X,o),p=Math.max(oe,p)}IS(s,t);const ce=c.indexOf(o),De=u.indexOf(p),Oe=Pe=>({width:c[Pe]||0,height:u[Pe]||0});return{first:Oe(0),last:Oe(t-1),widest:Oe(ce),highest:Oe(De),widths:c,heights:u}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return Ck(this._alignToPixels?rl(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const i=t[e];return i.$context||(i.$context=LS(this.getContext(),e,i))}return this.$context||(this.$context=ES(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=ys(this.labelRotation),i=Math.abs(Math.cos(t)),s=Math.abs(Math.sin(t)),c=this._getLabelSizes(),u=e.autoSkipPadding||0,o=c?c.widest.width+u:0,p=c?c.highest.height+u:0;return this.isHorizontal()?p*i>o*s?o/i:p/s:p*s<o*i?p/i:o/s}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,i=this.chart,s=this.options,{grid:c,position:u}=s,o=c.offset,p=this.isHorizontal(),v=this.ticks.length+(o?1:0),M=gu(c),S=[],I=c.setContext(this.getContext()),R=I.drawBorder?I.borderWidth:0,G=R/2,Y=function(Bt){return rl(i,Bt,R)};let X,oe,Q,ce,De,Oe,Pe,Se,_e,ze,Re,Ye;if(u==="top")X=Y(this.bottom),Oe=this.bottom-M,Se=X-G,ze=Y(e.top)+G,Ye=e.bottom;else if(u==="bottom")X=Y(this.top),ze=e.top,Ye=Y(e.bottom)-G,Oe=X+G,Se=this.top+M;else if(u==="left")X=Y(this.right),De=this.right-M,Pe=X-G,_e=Y(e.left)+G,Re=e.right;else if(u==="right")X=Y(this.left),_e=e.left,Re=Y(e.right)-G,De=X+G,Pe=this.left+M;else if(t==="x"){if(u==="center")X=Y((e.top+e.bottom)/2+.5);else if(pn(u)){const Bt=Object.keys(u)[0],bi=u[Bt];X=Y(this.chart.scales[Bt].getPixelForValue(bi))}ze=e.top,Ye=e.bottom,Oe=X+G,Se=Oe+M}else if(t==="y"){if(u==="center")X=Y((e.left+e.right)/2);else if(pn(u)){const Bt=Object.keys(u)[0],bi=u[Bt];X=Y(this.chart.scales[Bt].getPixelForValue(bi))}De=X-G,Pe=De-M,_e=e.left,Re=e.right}const Xe=sn(s.ticks.maxTicksLimit,v),si=Math.max(1,Math.ceil(v/Xe));for(oe=0;oe<v;oe+=si){const Bt=c.setContext(this.getContext(oe)),bi=Bt.lineWidth,Et=Bt.color,Vt=Bt.borderDash||[],Ki=Bt.borderDashOffset,zt=Bt.tickWidth,_t=Bt.tickColor,Dt=Bt.tickBorderDash||[],Ft=Bt.tickBorderDashOffset;Q=AS(this,oe,o),Q!==void 0&&(ce=rl(i,Q,bi),p?De=Pe=_e=Re=ce:Oe=Se=ze=Ye=ce,S.push({tx1:De,ty1:Oe,tx2:Pe,ty2:Se,x1:_e,y1:ze,x2:Re,y2:Ye,width:bi,color:Et,borderDash:Vt,borderDashOffset:Ki,tickWidth:zt,tickColor:_t,tickBorderDash:Dt,tickBorderDashOffset:Ft}))}return this._ticksLength=v,this._borderValue=X,S}_computeLabelItems(e){const t=this.axis,i=this.options,{position:s,ticks:c}=i,u=this.isHorizontal(),o=this.ticks,{align:p,crossAlign:_,padding:v,mirror:M}=c,S=gu(i.grid),I=S+v,R=M?-v:I,G=-ys(this.labelRotation),Y=[];let X,oe,Q,ce,De,Oe,Pe,Se,_e,ze,Re,Ye,Xe="middle";if(s==="top")Oe=this.bottom-R,Pe=this._getXAxisLabelAlignment();else if(s==="bottom")Oe=this.top+R,Pe=this._getXAxisLabelAlignment();else if(s==="left"){const Bt=this._getYAxisLabelAlignment(S);Pe=Bt.textAlign,De=Bt.x}else if(s==="right"){const Bt=this._getYAxisLabelAlignment(S);Pe=Bt.textAlign,De=Bt.x}else if(t==="x"){if(s==="center")Oe=(e.top+e.bottom)/2+I;else if(pn(s)){const Bt=Object.keys(s)[0],bi=s[Bt];Oe=this.chart.scales[Bt].getPixelForValue(bi)+I}Pe=this._getXAxisLabelAlignment()}else if(t==="y"){if(s==="center")De=(e.left+e.right)/2-I;else if(pn(s)){const Bt=Object.keys(s)[0],bi=s[Bt];De=this.chart.scales[Bt].getPixelForValue(bi)}Pe=this._getYAxisLabelAlignment(S).textAlign}t==="y"&&(p==="start"?Xe="top":p==="end"&&(Xe="bottom"));const si=this._getLabelSizes();for(X=0,oe=o.length;X<oe;++X){Q=o[X],ce=Q.label;const Bt=c.setContext(this.getContext(X));Se=this.getPixelForTick(X)+c.labelOffset,_e=this._resolveTickFontOptions(X),ze=_e.lineHeight,Re=Xn(ce)?ce.length:1;const bi=Re/2,Et=Bt.color,Vt=Bt.textStrokeColor,Ki=Bt.textStrokeWidth;let zt=Pe;u?(De=Se,Pe==="inner"&&(X===oe-1?zt=this.options.reverse?"left":"right":X===0?zt=this.options.reverse?"right":"left":zt="center"),s==="top"?_==="near"||G!==0?Ye=-Re*ze+ze/2:_==="center"?Ye=-si.highest.height/2-bi*ze+ze:Ye=-si.highest.height+ze/2:_==="near"||G!==0?Ye=ze/2:_==="center"?Ye=si.highest.height/2-bi*ze:Ye=si.highest.height-Re*ze,M&&(Ye*=-1)):(Oe=Se,Ye=(1-Re)*ze/2);let _t;if(Bt.showLabelBackdrop){const Dt=vr(Bt.backdropPadding),Ft=si.heights[X],oi=si.widths[X];let pi=Oe+Ye-Dt.top,vi=De-Dt.left;switch(Xe){case"middle":pi-=Ft/2;break;case"bottom":pi-=Ft;break}switch(Pe){case"center":vi-=oi/2;break;case"right":vi-=oi;break}_t={left:vi,top:pi,width:oi+Dt.width,height:Ft+Dt.height,color:Bt.backdropColor}}Y.push({rotation:G,label:ce,font:_e,color:Et,strokeColor:Vt,strokeWidth:Ki,textOffset:Ye,textAlign:zt,textBaseline:Xe,translation:[De,Oe],backdrop:_t})}return Y}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-ys(this.labelRotation))return e==="top"?"left":"right";let s="center";return t.align==="start"?s="left":t.align==="end"?s="right":t.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:i,mirror:s,padding:c}}=this.options,u=this._getLabelSizes(),o=e+c,p=u.widest.width;let _,v;return t==="left"?s?(v=this.right+c,i==="near"?_="left":i==="center"?(_="center",v+=p/2):(_="right",v+=p)):(v=this.right-o,i==="near"?_="right":i==="center"?(_="center",v-=p/2):(_="left",v=this.left)):t==="right"?s?(v=this.left+c,i==="near"?_="right":i==="center"?(_="center",v-=p/2):(_="left",v-=p)):(v=this.left+o,i==="near"?_="left":i==="center"?(_="center",v+=p/2):(_="right",v=this.right)):_="right",{textAlign:_,x:v}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:i,top:s,width:c,height:u}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(i,s,c,u),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const s=this.ticks.findIndex(c=>c.value===e);return s>=0?t.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const t=this.options.grid,i=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let c,u;const o=(p,_,v)=>{!v.width||!v.color||(i.save(),i.lineWidth=v.width,i.strokeStyle=v.color,i.setLineDash(v.borderDash||[]),i.lineDashOffset=v.borderDashOffset,i.beginPath(),i.moveTo(p.x,p.y),i.lineTo(_.x,_.y),i.stroke(),i.restore())};if(t.display)for(c=0,u=s.length;c<u;++c){const p=s[c];t.drawOnChartArea&&o({x:p.x1,y:p.y1},{x:p.x2,y:p.y2},p),t.drawTicks&&o({x:p.tx1,y:p.ty1},{x:p.tx2,y:p.ty2},{color:p.tickColor,width:p.tickWidth,borderDash:p.tickBorderDash,borderDashOffset:p.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{grid:i}}=this,s=i.setContext(this.getContext()),c=i.drawBorder?s.borderWidth:0;if(!c)return;const u=i.setContext(this.getContext(0)).lineWidth,o=this._borderValue;let p,_,v,M;this.isHorizontal()?(p=rl(e,this.left,c)-c/2,_=rl(e,this.right,u)+u/2,v=M=o):(v=rl(e,this.top,c)-c/2,M=rl(e,this.bottom,u)+u/2,p=_=o),t.save(),t.lineWidth=s.borderWidth,t.strokeStyle=s.borderColor,t.beginPath(),t.moveTo(p,v),t.lineTo(_,M),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const i=this.ctx,s=this._computeLabelArea();s&&Ud(i,s);const c=this._labelItems||(this._labelItems=this._computeLabelItems(e));let u,o;for(u=0,o=c.length;u<o;++u){const p=c[u],_=p.font,v=p.label;p.backdrop&&(i.fillStyle=p.backdrop.color,i.fillRect(p.backdrop.left,p.backdrop.top,p.backdrop.width,p.backdrop.height));let M=p.textOffset;pl(i,v,0,M,_,p)}s&&Wd(i)}drawTitle(){const{ctx:e,options:{position:t,title:i,reverse:s}}=this;if(!i.display)return;const c=Ua(i.font),u=vr(i.padding),o=i.align;let p=c.lineHeight/2;t==="bottom"||t==="center"||pn(t)?(p+=u.bottom,Xn(i.text)&&(p+=c.lineHeight*(i.text.length-1))):p+=u.top;const{titleX:_,titleY:v,maxWidth:M,rotation:S}=RS(this,p,t,o);pl(e,i.text,0,0,c,{color:i.color,maxWidth:M,rotation:S,textAlign:zS(o,t,s),textBaseline:"middle",translation:[_,v]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,i=sn(e.grid&&e.grid.z,-1);return!this._isVisible()||this.draw!==gl.prototype.draw?[{z:t,draw:s=>{this.draw(s)}}]:[{z:i,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:i+1,draw:()=>{this.drawBorder()}},{z:t,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",s=[];let c,u;for(c=0,u=t.length;c<u;++c){const o=t[c];o[i]===this.id&&(!e||o.type===e)&&s.push(o)}return s}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return Ua(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class id{constructor(e,t,i){this.type=e,this.scope=t,this.override=i,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let i;BS(t)&&(i=this.register(t));const s=this.items,c=e.id,u=this.scope+"."+c;if(!c)throw new Error("class does not have id: "+e);return c in s||(s[c]=e,FS(e,u,i),this.override&&gn.override(e.id,e.overrides)),u}get(e){return this.items[e]}unregister(e){const t=this.items,i=e.id,s=this.scope;i in t&&delete t[i],s&&i in gn[s]&&(delete gn[s][i],this.override&&delete fl[i])}}function FS(n,e,t){const i=Ru(Object.create(null),[t?gn.get(t):{},gn.get(e),n.defaults]);gn.set(e,i),n.defaultRoutes&&OS(e,n.defaultRoutes),n.descriptors&&gn.describe(e,n.descriptors)}function OS(n,e){Object.keys(e).forEach(t=>{const i=t.split("."),s=i.pop(),c=[n].concat(i).join("."),u=e[t].split("."),o=u.pop(),p=u.join(".");gn.route(c,s,p,o)})}function BS(n){return"id"in n&&"defaults"in n}class NS{constructor(){this.controllers=new id(bs,"datasets",!0),this.elements=new id(vs,"elements"),this.plugins=new id(Object,"plugins"),this.scales=new id(gl,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,i){[...t].forEach(s=>{const c=i||this._getRegistryForType(s);i||c.isForType(s)||c===this.plugins&&s.id?this._exec(e,c,s):zn(s,u=>{const o=i||this._getRegistryForType(u);this._exec(e,o,u)})})}_exec(e,t,i){const s=bm(e);Jn(i["before"+s],[],i),t[e](i),Jn(i["after"+s],[],i)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const i=this._typedRegistries[t];if(i.isForType(e))return i}return this.plugins}_get(e,t,i){const s=t.get(e);if(s===void 0)throw new Error('"'+e+'" is not a registered '+i+".");return s}}var Es=new NS;class Xd extends bs{update(e){const t=this._cachedMeta,{data:i=[]}=t,s=this.chart._animationsDisabled;let{start:c,count:u}=Sy(t,i,s);if(this._drawStart=c,this._drawCount=u,My(t)&&(c=0,u=i.length),this.options.showLine){const{dataset:o,_dataset:p}=t;o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!p._decimated,o.points=i;const _=this.resolveDatasetElementOptions(e);_.segment=this.options.segment,this.updateElement(o,void 0,{animated:!s,options:_},e)}this.updateElements(i,c,u,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=Es.getElement("line")),super.addElements()}updateElements(e,t,i,s){const c=s==="reset",{iScale:u,vScale:o,_stacked:p,_dataset:_}=this._cachedMeta,v=this.resolveDataElementOptions(t,s),M=this.getSharedOptions(v),S=this.includeOptions(s,M),I=u.axis,R=o.axis,{spanGaps:G,segment:Y}=this.options,X=nc(G)?G:Number.POSITIVE_INFINITY,oe=this.chart._animationsDisabled||c||s==="none";let Q=t>0&&this.getParsed(t-1);for(let ce=t;ce<t+i;++ce){const De=e[ce],Oe=this.getParsed(ce),Pe=oe?De:{},Se=yn(Oe[R]),_e=Pe[I]=u.getPixelForValue(Oe[I],ce),ze=Pe[R]=c||Se?o.getBasePixel():o.getPixelForValue(p?this.applyStack(o,Oe,p):Oe[R],ce);Pe.skip=isNaN(_e)||isNaN(ze)||Se,Pe.stop=ce>0&&Math.abs(Oe[I]-Q[I])>X,Y&&(Pe.parsed=Oe,Pe.raw=_.data[ce]),S&&(Pe.options=M||this.resolveDataElementOptions(ce,De.active?"active":s)),oe||this.updateElement(De,ce,Pe,s),Q=Oe}this.updateSharedOptions(M,s,v)}getMaxOverflow(){const e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){let o=0;for(let p=t.length-1;p>=0;--p)o=Math.max(o,t[p].size(this.resolveDataElementOptions(p))/2);return o>0&&o}const i=e.dataset,s=i.options&&i.options.borderWidth||0;if(!t.length)return s;const c=t[0].size(this.resolveDataElementOptions(0)),u=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(s,c,u)/2}}Xd.id="scatter";Xd.defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};Xd.overrides={interaction:{mode:"point"},plugins:{tooltip:{callbacks:{title(){return""},label(n){return"("+n.label+", "+n.formattedValue+")"}}}},scales:{x:{type:"linear"},y:{type:"linear"}}};var VS=Object.freeze({__proto__:null,BarController:Zd,BubbleController:Gd,DoughnutController:oc,LineController:$d,PolarAreaController:Kd,PieController:Im,RadarController:Yd,ScatterController:Xd});function sl(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class em{constructor(e){this.options=e||{}}init(e){}formats(){return sl()}parse(e,t){return sl()}format(e,t){return sl()}add(e,t,i){return sl()}diff(e,t,i){return sl()}startOf(e,t,i){return sl()}endOf(e,t){return sl()}}em.override=function(n){Object.assign(em.prototype,n)};var HS={_date:em};function jS(n,e,t,i){const{controller:s,data:c,_sorted:u}=n,o=s._cachedMeta.iScale;if(o&&e===o.axis&&e!=="r"&&u&&c.length){const p=o._reversePixels?Pk:ro;if(i){if(s._sharedOptions){const _=c[0],v=typeof _.getRange=="function"&&_.getRange(e);if(v){const M=p(c,e,t-v),S=p(c,e,t+v);return{lo:M.lo,hi:S.hi}}}}else return p(c,e,t)}return{lo:0,hi:c.length-1}}function qu(n,e,t,i,s){const c=n.getSortedVisibleDatasetMetas(),u=t[e];for(let o=0,p=c.length;o<p;++o){const{index:_,data:v}=c[o],{lo:M,hi:S}=jS(c[o],e,u,s);for(let I=M;I<=S;++I){const R=v[I];R.skip||i(R,_,I)}}}function US(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(i,s){const c=e?Math.abs(i.x-s.x):0,u=t?Math.abs(i.y-s.y):0;return Math.sqrt(Math.pow(c,2)+Math.pow(u,2))}}function Lp(n,e,t,i,s){const c=[];return!s&&!n.isPointInArea(e)||qu(n,t,e,function(o,p,_){!s&&!Ou(o,n.chartArea,0)||o.inRange(e.x,e.y,i)&&c.push({element:o,datasetIndex:p,index:_})},!0),c}function WS(n,e,t,i){let s=[];function c(u,o,p){const{startAngle:_,endAngle:v}=u.getProps(["startAngle","endAngle"],i),{angle:M}=by(u,{x:e.x,y:e.y});Fu(M,_,v)&&s.push({element:u,datasetIndex:o,index:p})}return qu(n,t,e,c),s}function qS(n,e,t,i,s,c){let u=[];const o=US(t);let p=Number.POSITIVE_INFINITY;function _(v,M,S){const I=v.inRange(e.x,e.y,s);if(i&&!I)return;const R=v.getCenterPoint(s);if(!(!!c||n.isPointInArea(R))&&!I)return;const Y=o(e,R);Y<p?(u=[{element:v,datasetIndex:M,index:S}],p=Y):Y===p&&u.push({element:v,datasetIndex:M,index:S})}return qu(n,t,e,_),u}function zp(n,e,t,i,s,c){return!c&&!n.isPointInArea(e)?[]:t==="r"&&!i?WS(n,e,t,s):qS(n,e,t,i,s,c)}function n_(n,e,t,i,s){const c=[],u=t==="x"?"inXRange":"inYRange";let o=!1;return qu(n,t,e,(p,_,v)=>{p[u](e[t],s)&&(c.push({element:p,datasetIndex:_,index:v}),o=o||p.inRange(e.x,e.y,s))}),i&&!o?[]:c}var ZS={evaluateInteractionItems:qu,modes:{index(n,e,t,i){const s=ol(e,n),c=t.axis||"x",u=t.includeInvisible||!1,o=t.intersect?Lp(n,s,c,i,u):zp(n,s,c,!1,i,u),p=[];return o.length?(n.getSortedVisibleDatasetMetas().forEach(_=>{const v=o[0].index,M=_.data[v];M&&!M.skip&&p.push({element:M,datasetIndex:_.index,index:v})}),p):[]},dataset(n,e,t,i){const s=ol(e,n),c=t.axis||"xy",u=t.includeInvisible||!1;let o=t.intersect?Lp(n,s,c,i,u):zp(n,s,c,!1,i,u);if(o.length>0){const p=o[0].datasetIndex,_=n.getDatasetMeta(p).data;o=[];for(let v=0;v<_.length;++v)o.push({element:_[v],datasetIndex:p,index:v})}return o},point(n,e,t,i){const s=ol(e,n),c=t.axis||"xy",u=t.includeInvisible||!1;return Lp(n,s,c,i,u)},nearest(n,e,t,i){const s=ol(e,n),c=t.axis||"xy",u=t.includeInvisible||!1;return zp(n,s,c,t.intersect,i,u)},x(n,e,t,i){const s=ol(e,n);return n_(n,s,"x",t.intersect,i)},y(n,e,t,i){const s=ol(e,n);return n_(n,s,"y",t.intersect,i)}}};const Ky=["left","top","right","bottom"];function _u(n,e){return n.filter(t=>t.pos===e)}function a_(n,e){return n.filter(t=>Ky.indexOf(t.pos)===-1&&t.box.axis===e)}function yu(n,e){return n.sort((t,i)=>{const s=e?i:t,c=e?t:i;return s.weight===c.weight?s.index-c.index:s.weight-c.weight})}function GS(n){const e=[];let t,i,s,c,u,o;for(t=0,i=(n||[]).length;t<i;++t)s=n[t],{position:c,options:{stack:u,stackWeight:o=1}}=s,e.push({index:t,box:s,pos:c,horizontal:s.isHorizontal(),weight:s.weight,stack:u&&c+u,stackWeight:o});return e}function $S(n){const e={};for(const t of n){const{stack:i,pos:s,stackWeight:c}=t;if(!i||!Ky.includes(s))continue;const u=e[i]||(e[i]={count:0,placed:0,weight:0,size:0});u.count++,u.weight+=c}return e}function KS(n,e){const t=$S(n),{vBoxMaxWidth:i,hBoxMaxHeight:s}=e;let c,u,o;for(c=0,u=n.length;c<u;++c){o=n[c];const{fullSize:p}=o.box,_=t[o.stack],v=_&&o.stackWeight/_.weight;o.horizontal?(o.width=v?v*i:p&&e.availableWidth,o.height=s):(o.width=i,o.height=v?v*s:p&&e.availableHeight)}return t}function YS(n){const e=GS(n),t=yu(e.filter(_=>_.box.fullSize),!0),i=yu(_u(e,"left"),!0),s=yu(_u(e,"right")),c=yu(_u(e,"top"),!0),u=yu(_u(e,"bottom")),o=a_(e,"x"),p=a_(e,"y");return{fullSize:t,leftAndTop:i.concat(c),rightAndBottom:s.concat(p).concat(u).concat(o),chartArea:_u(e,"chartArea"),vertical:i.concat(s).concat(p),horizontal:c.concat(u).concat(o)}}function r_(n,e,t,i){return Math.max(n[t],e[t])+Math.max(n[i],e[i])}function Yy(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function JS(n,e,t,i){const{pos:s,box:c}=t,u=n.maxPadding;if(!pn(s)){t.size&&(n[s]-=t.size);const M=i[t.stack]||{size:0,count:1};M.size=Math.max(M.size,t.horizontal?c.height:c.width),t.size=M.size/M.count,n[s]+=t.size}c.getPadding&&Yy(u,c.getPadding());const o=Math.max(0,e.outerWidth-r_(u,n,"left","right")),p=Math.max(0,e.outerHeight-r_(u,n,"top","bottom")),_=o!==n.w,v=p!==n.h;return n.w=o,n.h=p,t.horizontal?{same:_,other:v}:{same:v,other:_}}function XS(n){const e=n.maxPadding;function t(i){const s=Math.max(e[i]-n[i],0);return n[i]+=s,s}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function QS(n,e){const t=e.maxPadding;function i(s){const c={left:0,top:0,right:0,bottom:0};return s.forEach(u=>{c[u]=Math.max(e[u],t[u])}),c}return i(n?["left","right"]:["top","bottom"])}function ku(n,e,t,i){const s=[];let c,u,o,p,_,v;for(c=0,u=n.length,_=0;c<u;++c){o=n[c],p=o.box,p.update(o.width||e.w,o.height||e.h,QS(o.horizontal,e));const{same:M,other:S}=JS(e,t,o,i);_|=M&&s.length,v=v||S,p.fullSize||s.push(o)}return _&&ku(s,e,t,i)||v}function nd(n,e,t,i,s){n.top=t,n.left=e,n.right=e+i,n.bottom=t+s,n.width=i,n.height=s}function s_(n,e,t,i){const s=t.padding;let{x:c,y:u}=e;for(const o of n){const p=o.box,_=i[o.stack]||{count:1,placed:0,weight:1},v=o.stackWeight/_.weight||1;if(o.horizontal){const M=e.w*v,S=_.size||p.height;os(_.start)&&(u=_.start),p.fullSize?nd(p,s.left,u,t.outerWidth-s.right-s.left,S):nd(p,e.left+_.placed,u,M,S),_.start=u,_.placed+=M,u=p.bottom}else{const M=e.h*v,S=_.size||p.width;os(_.start)&&(c=_.start),p.fullSize?nd(p,c,s.top,S,t.outerHeight-s.bottom-s.top):nd(p,c,e.top+_.placed,S,M),_.start=c,_.placed+=M,c=p.right}}e.x=c,e.y=u}gn.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}});var _r={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,i){if(!n)return;const s=vr(n.options.layout.padding),c=Math.max(e-s.width,0),u=Math.max(t-s.height,0),o=YS(n.boxes),p=o.vertical,_=o.horizontal;zn(n.boxes,G=>{typeof G.beforeLayout=="function"&&G.beforeLayout()});const v=p.reduce((G,Y)=>Y.box.options&&Y.box.options.display===!1?G:G+1,0)||1,M=Object.freeze({outerWidth:e,outerHeight:t,padding:s,availableWidth:c,availableHeight:u,vBoxMaxWidth:c/2/v,hBoxMaxHeight:u/2}),S=Object.assign({},s);Yy(S,vr(i));const I=Object.assign({maxPadding:S,w:c,h:u,x:s.left,y:s.top},s),R=KS(p.concat(_),M);ku(o.fullSize,I,M,R),ku(p,I,M,R),ku(_,I,M,R)&&ku(p,I,M,R),XS(I),s_(o.leftAndTop,I,M,R),I.x+=I.w,I.y+=I.h,s_(o.rightAndBottom,I,M,R),n.chartArea={left:I.left,top:I.top,right:I.left+I.w,bottom:I.top+I.h,height:I.h,width:I.w},zn(o.chartArea,G=>{const Y=G.box;Object.assign(Y,n.chartArea),Y.update(I.w,I.h,{left:0,top:0,right:0,bottom:0})})}};class Jy{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,i){}removeEventListener(e,t,i){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,i,s){return t=Math.max(0,t||e.width),i=i||e.height,{width:t,height:Math.max(0,s?Math.floor(t/s):i)}}isAttached(e){return!0}updateConfig(e){}}class eM extends Jy{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const hd="$chartjs",tM={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},o_=n=>n===null||n==="";function iM(n,e){const t=n.style,i=n.getAttribute("height"),s=n.getAttribute("width");if(n[hd]={initial:{height:i,width:s,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",o_(s)){const c=N0(n,"width");c!==void 0&&(n.width=c)}if(o_(i))if(n.style.height==="")n.height=n.width/(e||2);else{const c=N0(n,"height");c!==void 0&&(n.height=c)}return n}const Xy=F4?{passive:!0}:!1;function nM(n,e,t){n.addEventListener(e,t,Xy)}function aM(n,e,t){n.canvas.removeEventListener(e,t,Xy)}function rM(n,e){const t=tM[n.type]||n.type,{x:i,y:s}=ol(n,e);return{type:t,chart:e,native:n,x:i!==void 0?i:null,y:s!==void 0?s:null}}function Sd(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function sM(n,e,t){const i=n.canvas,s=new MutationObserver(c=>{let u=!1;for(const o of c)u=u||Sd(o.addedNodes,i),u=u&&!Sd(o.removedNodes,i);u&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}function oM(n,e,t){const i=n.canvas,s=new MutationObserver(c=>{let u=!1;for(const o of c)u=u||Sd(o.removedNodes,i),u=u&&!Sd(o.addedNodes,i);u&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}const Nu=new Map;let l_=0;function Qy(){const n=window.devicePixelRatio;n!==l_&&(l_=n,Nu.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function lM(n,e){Nu.size||window.addEventListener("resize",Qy),Nu.set(n,e)}function cM(n){Nu.delete(n),Nu.size||window.removeEventListener("resize",Qy)}function uM(n,e,t){const i=n.canvas,s=i&&Am(i);if(!s)return;const c=ky((o,p)=>{const _=s.clientWidth;t(o,p),_<s.clientWidth&&t()},window),u=new ResizeObserver(o=>{const p=o[0],_=p.contentRect.width,v=p.contentRect.height;_===0&&v===0||c(_,v)});return u.observe(s),lM(n,c),u}function Rp(n,e,t){t&&t.disconnect(),e==="resize"&&cM(n)}function hM(n,e,t){const i=n.canvas,s=ky(c=>{n.ctx!==null&&t(rM(c,n))},n,c=>{const u=c[0];return[u,u.offsetX,u.offsetY]});return nM(i,e,s),s}class dM extends Jy{acquireContext(e,t){const i=e&&e.getContext&&e.getContext("2d");return i&&i.canvas===e?(iM(e,t),i):null}releaseContext(e){const t=e.canvas;if(!t[hd])return!1;const i=t[hd].initial;["height","width"].forEach(c=>{const u=i[c];yn(u)?t.removeAttribute(c):t.setAttribute(c,u)});const s=i.style||{};return Object.keys(s).forEach(c=>{t.style[c]=s[c]}),t.width=t.width,delete t[hd],!0}addEventListener(e,t,i){this.removeEventListener(e,t);const s=e.$proxies||(e.$proxies={}),u={attach:sM,detach:oM,resize:uM}[t]||hM;s[t]=u(e,t,i)}removeEventListener(e,t){const i=e.$proxies||(e.$proxies={}),s=i[t];if(!s)return;({attach:Rp,detach:Rp,resize:Rp}[t]||aM)(e,t,s),i[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,i,s){return R4(e,t,i,s)}isAttached(e){const t=Am(e);return!!(t&&t.isConnected)}}function fM(n){return!Ny()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?eM:dM}class pM{constructor(){this._init=[]}notify(e,t,i,s){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const c=s?this._descriptors(e).filter(s):this._descriptors(e),u=this._notify(c,e,t,i);return t==="afterDestroy"&&(this._notify(c,e,"stop"),this._notify(this._init,e,"uninstall")),u}_notify(e,t,i,s){s=s||{};for(const c of e){const u=c.plugin,o=u[i],p=[t,s,c.options];if(Jn(o,p,u)===!1&&s.cancelable)return!1}return!0}invalidate(){yn(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const i=e&&e.config,s=sn(i.options&&i.options.plugins,{}),c=mM(i);return s===!1&&!t?[]:_M(e,c,s,t)}_notifyStateChanges(e){const t=this._oldCache||[],i=this._cache,s=(c,u)=>c.filter(o=>!u.some(p=>o.plugin.id===p.plugin.id));this._notify(s(t,i),e,"stop"),this._notify(s(i,t),e,"start")}}function mM(n){const e={},t=[],i=Object.keys(Es.plugins.items);for(let c=0;c<i.length;c++)t.push(Es.getPlugin(i[c]));const s=n.plugins||[];for(let c=0;c<s.length;c++){const u=s[c];t.indexOf(u)===-1&&(t.push(u),e[u.id]=!0)}return{plugins:t,localIds:e}}function gM(n,e){return!e&&n===!1?null:n===!0?{}:n}function _M(n,{plugins:e,localIds:t},i,s){const c=[],u=n.getContext();for(const o of e){const p=o.id,_=gM(i[p],s);_!==null&&c.push({plugin:o,options:yM(n.config,{plugin:o,local:t[p]},_,u)})}return c}function yM(n,{plugin:e,local:t},i,s){const c=n.pluginScopeKeys(e),u=n.getOptionScopes(i,c);return t&&e.defaults&&u.push(e.defaults),n.createResolver(u,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function tm(n,e){const t=gn.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function bM(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function vM(n,e){return n===e?"_index_":"_value_"}function xM(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function im(n,e){return n==="x"||n==="y"?n:e.axis||xM(e.position)||n.charAt(0).toLowerCase()}function wM(n,e){const t=fl[n.type]||{scales:{}},i=e.scales||{},s=tm(n.type,e),c=Object.create(null),u=Object.create(null);return Object.keys(i).forEach(o=>{const p=i[o];if(!pn(p))return console.error(`Invalid scale configuration for scale: ${o}`);if(p._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const _=im(o,p),v=vM(_,s),M=t.scales||{};c[_]=c[_]||o,u[o]=Mu(Object.create(null),[{axis:_},p,M[_],M[v]])}),n.data.datasets.forEach(o=>{const p=o.type||n.type,_=o.indexAxis||tm(p,e),M=(fl[p]||{}).scales||{};Object.keys(M).forEach(S=>{const I=bM(S,_),R=o[I+"AxisID"]||c[I]||I;u[R]=u[R]||Object.create(null),Mu(u[R],[{axis:I},i[R],M[S]])})}),Object.keys(u).forEach(o=>{const p=u[o];Mu(p,[gn.scales[p.type],gn.scale])}),u}function eb(n){const e=n.options||(n.options={});e.plugins=sn(e.plugins,{}),e.scales=wM(n,e)}function tb(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function kM(n){return n=n||{},n.data=tb(n.data),eb(n),n}const c_=new Map,ib=new Set;function ad(n,e){let t=c_.get(n);return t||(t=e(),c_.set(n,t),ib.add(t)),t}const bu=(n,e,t)=>{const i=Bo(e,t);i!==void 0&&n.add(i)};class SM{constructor(e){this._config=kM(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=tb(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),eb(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return ad(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return ad(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return ad(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,i=this.type;return ad(`${i}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const i=this._scopeCache;let s=i.get(e);return(!s||t)&&(s=new Map,i.set(e,s)),s}getOptionScopes(e,t,i){const{options:s,type:c}=this,u=this._cachedScopes(e,i),o=u.get(t);if(o)return o;const p=new Set;t.forEach(v=>{e&&(p.add(e),v.forEach(M=>bu(p,e,M))),v.forEach(M=>bu(p,s,M)),v.forEach(M=>bu(p,fl[c]||{},M)),v.forEach(M=>bu(p,gn,M)),v.forEach(M=>bu(p,Xp,M))});const _=Array.from(p);return _.length===0&&_.push(Object.create(null)),ib.has(t)&&u.set(t,_),_}chartOptionScopes(){const{options:e,type:t}=this;return[e,fl[t]||{},gn.datasets[t]||{},{type:t},gn,Xp]}resolveNamedOptions(e,t,i,s=[""]){const c={$shared:!0},{resolver:u,subPrefixes:o}=u_(this._resolverCache,e,s);let p=u;if(DM(u,t)){c.$shared=!1,i=No(i)?i():i;const _=this.createResolver(e,i,o);p=ac(u,i,_)}for(const _ of t)c[_]=p[_];return c}createResolver(e,t,i=[""],s){const{resolver:c}=u_(this._resolverCache,e,i);return pn(t)?ac(c,t,void 0,s):c}}function u_(n,e,t){let i=n.get(e);i||(i=new Map,n.set(e,i));const s=t.join();let c=i.get(s);return c||(c={resolver:Tm(e,t),subPrefixes:t.filter(o=>!o.toLowerCase().includes("hover"))},i.set(s,c)),c}const MM=n=>pn(n)&&Object.getOwnPropertyNames(n).reduce((e,t)=>e||No(n[t]),!1);function DM(n,e){const{isScriptable:t,isIndexable:i}=Ly(n);for(const s of e){const c=t(s),u=i(s),o=(u||c)&&n[s];if(c&&(No(o)||MM(o))||u&&Xn(o))return!0}return!1}var TM="3.9.1";const CM=["top","bottom","left","right","chartArea"];function h_(n,e){return n==="top"||n==="bottom"||CM.indexOf(n)===-1&&e==="x"}function d_(n,e){return function(t,i){return t[n]===i[n]?t[e]-i[e]:t[n]-i[n]}}function f_(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),Jn(t&&t.onComplete,[n],e)}function PM(n){const e=n.chart,t=e.options.animation;Jn(t&&t.onProgress,[n],e)}function nb(n){return Ny()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const Md={},ab=n=>{const e=nb(n);return Object.values(Md).filter(t=>t.canvas===e).pop()};function AM(n,e,t){const i=Object.keys(n);for(const s of i){const c=+s;if(c>=e){const u=n[s];delete n[s],(t>0||c>e)&&(n[c+t]=u)}}}function IM(n,e,t,i){return!t||n.type==="mouseout"?null:i?e:n}class ec{constructor(e,t){const i=this.config=new SM(t),s=nb(e),c=ab(s);if(c)throw new Error("Canvas is already in use. Chart with ID '"+c.id+"' must be destroyed before the canvas with ID '"+c.canvas.id+"' can be reused.");const u=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||fM(s)),this.platform.updateConfig(i);const o=this.platform.acquireContext(s,u.aspectRatio),p=o&&o.canvas,_=p&&p.height,v=p&&p.width;if(this.id=gk(),this.ctx=o,this.canvas=p,this.width=v,this.height=_,this._options=u,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new pM,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Ek(M=>this.update(M),u.resizeDelay||0),this._dataChanges=[],Md[this.id]=this,!o||!p){console.error("Failed to create chart: can't acquire context from the given item");return}eo.listen(this,"complete",f_),eo.listen(this,"progress",PM),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:i,height:s,_aspectRatio:c}=this;return yn(e)?t&&c?c:s?i/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():B0(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return R0(this.canvas,this.ctx),this}stop(){return eo.stop(this),this}resize(e,t){eo.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const i=this.options,s=this.canvas,c=i.maintainAspectRatio&&this.aspectRatio,u=this.platform.getMaximumSize(s,e,t,c),o=i.devicePixelRatio||this.platform.getDevicePixelRatio(),p=this.width?"resize":"attach";this.width=u.width,this.height=u.height,this._aspectRatio=this.aspectRatio,B0(this,o,!0)&&(this.notifyPlugins("resize",{size:u}),Jn(i.onResize,[this,u],this),this.attached&&this._doResize(p)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};zn(t,(i,s)=>{i.id=s})}buildOrUpdateScales(){const e=this.options,t=e.scales,i=this.scales,s=Object.keys(i).reduce((u,o)=>(u[o]=!1,u),{});let c=[];t&&(c=c.concat(Object.keys(t).map(u=>{const o=t[u],p=im(u,o),_=p==="r",v=p==="x";return{options:o,dposition:_?"chartArea":v?"bottom":"left",dtype:_?"radialLinear":v?"category":"linear"}}))),zn(c,u=>{const o=u.options,p=o.id,_=im(p,o),v=sn(o.type,u.dtype);(o.position===void 0||h_(o.position,_)!==h_(u.dposition))&&(o.position=u.dposition),s[p]=!0;let M=null;if(p in i&&i[p].type===v)M=i[p];else{const S=Es.getScale(v);M=new S({id:p,type:v,ctx:this.ctx,chart:this}),i[M.id]=M}M.init(o,e)}),zn(s,(u,o)=>{u||delete i[o]}),zn(i,u=>{_r.configure(this,u,u.options),_r.addBox(this,u)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,i=e.length;if(e.sort((s,c)=>s.index-c.index),i>t){for(let s=t;s<i;++s)this._destroyDatasetMeta(s);e.splice(t,i-t)}this._sortedMetasets=e.slice(0).sort(d_("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((i,s)=>{t.filter(c=>c===i._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let i,s;for(this._removeUnreferencedMetasets(),i=0,s=t.length;i<s;i++){const c=t[i];let u=this.getDatasetMeta(i);const o=c.type||this.config.type;if(u.type&&u.type!==o&&(this._destroyDatasetMeta(i),u=this.getDatasetMeta(i)),u.type=o,u.indexAxis=c.indexAxis||tm(o,this.options),u.order=c.order||0,u.index=i,u.label=""+c.label,u.visible=this.isDatasetVisible(i),u.controller)u.controller.updateIndex(i),u.controller.linkScales();else{const p=Es.getController(o),{datasetElementType:_,dataElementType:v}=gn.datasets[o];Object.assign(p.prototype,{dataElementType:Es.getElement(v),datasetElementType:_&&Es.getElement(_)}),u.controller=new p(this,i),e.push(u.controller)}}return this._updateMetasets(),e}_resetElements(){zn(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const i=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const c=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let u=0;for(let _=0,v=this.data.datasets.length;_<v;_++){const{controller:M}=this.getDatasetMeta(_),S=!s&&c.indexOf(M)===-1;M.buildOrUpdateElements(S),u=Math.max(+M.getMaxOverflow(),u)}u=this._minPadding=i.layout.autoPadding?u:0,this._updateLayout(u),s||zn(c,_=>{_.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(d_("z","_idx"));const{_active:o,_lastEvent:p}=this;p?this._eventHandler(p,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){zn(this.scales,e=>{_r.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),i=new Set(e.events);(!k0(t,i)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:i,start:s,count:c}of t){const u=i==="_removeElements"?-c:c;AM(e,s,u)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,i=c=>new Set(e.filter(u=>u[0]===c).map((u,o)=>o+","+u.splice(1).join(","))),s=i(0);for(let c=1;c<t;c++)if(!k0(s,i(c)))return;return Array.from(s).map(c=>c.split(",")).map(c=>({method:c[1],start:+c[2],count:+c[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;_r.update(this,this.width,this.height,e);const t=this.chartArea,i=t.width<=0||t.height<=0;this._layers=[],zn(this.boxes,s=>{i&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,c)=>{s._idx=c}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,i=this.data.datasets.length;t<i;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,i=this.data.datasets.length;t<i;++t)this._updateDataset(t,No(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const i=this.getDatasetMeta(e),s={meta:i,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(i.controller._update(t),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(eo.has(this)?this.attached&&!eo.running(this)&&eo.start(this):(this.draw(),f_({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:i,height:s}=this._resizeBeforeDraw;this._resize(i,s),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,i=[];let s,c;for(s=0,c=t.length;s<c;++s){const u=t[s];(!e||u.visible)&&i.push(u)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,i=e._clip,s=!i.disabled,c=this.chartArea,u={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",u)!==!1&&(s&&Ud(t,{left:i.left===!1?0:c.left-i.left,right:i.right===!1?this.width:c.right+i.right,top:i.top===!1?0:c.top-i.top,bottom:i.bottom===!1?this.height:c.bottom+i.bottom}),e.controller.draw(),s&&Wd(t),u.cancelable=!1,this.notifyPlugins("afterDatasetDraw",u))}isPointInArea(e){return Ou(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,i,s){const c=ZS.modes[t];return typeof c=="function"?c(this,e,i,s):[]}getDatasetMeta(e){const t=this.data.datasets[e],i=this._metasets;let s=i.filter(c=>c&&c._dataset===t).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},i.push(s)),s}getContext(){return this.$context||(this.$context=Ho(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const i=this.getDatasetMeta(e);return typeof i.hidden=="boolean"?!i.hidden:!t.hidden}setDatasetVisibility(e,t){const i=this.getDatasetMeta(e);i.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,i){const s=i?"show":"hide",c=this.getDatasetMeta(e),u=c.controller._resolveAnimations(void 0,s);os(t)?(c.data[t].hidden=!i,this.update()):(this.setDatasetVisibility(e,i),u.update(c,{visible:i}),this.update(o=>o.datasetIndex===e?s:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),eo.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),R0(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),this.notifyPlugins("destroy"),delete Md[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,i=(c,u)=>{t.addEventListener(this,c,u),e[c]=u},s=(c,u,o)=>{c.offsetX=u,c.offsetY=o,this._eventHandler(c)};zn(this.options.events,c=>i(c,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,i=(p,_)=>{t.addEventListener(this,p,_),e[p]=_},s=(p,_)=>{e[p]&&(t.removeEventListener(this,p,_),delete e[p])},c=(p,_)=>{this.canvas&&this.resize(p,_)};let u;const o=()=>{s("attach",o),this.attached=!0,this.resize(),i("resize",c),i("detach",u)};u=()=>{this.attached=!1,s("resize",c),this._stop(),this._resize(0,0),i("attach",o)},t.isAttached(this.canvas)?o():u()}unbindEvents(){zn(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},zn(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,i){const s=i?"set":"remove";let c,u,o,p;for(t==="dataset"&&(c=this.getDatasetMeta(e[0].datasetIndex),c.controller["_"+s+"DatasetHoverStyle"]()),o=0,p=e.length;o<p;++o){u=e[o];const _=u&&this.getDatasetMeta(u.datasetIndex).controller;_&&_[s+"HoverStyle"](u.element,u.datasetIndex,u.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],i=e.map(({datasetIndex:c,index:u})=>{const o=this.getDatasetMeta(c);if(!o)throw new Error("No dataset found at index "+c);return{datasetIndex:c,element:o.data[u],index:u}});!yd(i,t)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,t))}notifyPlugins(e,t,i){return this._plugins.notify(this,e,t,i)}_updateHoverStyles(e,t,i){const s=this.options.hover,c=(p,_)=>p.filter(v=>!_.some(M=>v.datasetIndex===M.datasetIndex&&v.index===M.index)),u=c(t,e),o=i?e:c(e,t);u.length&&this.updateHoverStyle(u,s.mode,!1),o.length&&s.mode&&this.updateHoverStyle(o,s.mode,!0)}_eventHandler(e,t){const i={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},s=u=>(u.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",i,s)===!1)return;const c=this._handleEvent(e,t,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,s),(c||i.changed)&&this.render(),this}_handleEvent(e,t,i){const{_active:s=[],options:c}=this,u=t,o=this._getActiveElements(e,s,i,u),p=wk(e),_=IM(e,this._lastEvent,i,p);i&&(this._lastEvent=null,Jn(c.onHover,[e,o,this],this),p&&Jn(c.onClick,[e,o,this],this));const v=!yd(o,s);return(v||t)&&(this._active=o,this._updateHoverStyles(o,s,t)),this._lastEvent=_,v}_getActiveElements(e,t,i,s){if(e.type==="mouseout")return[];if(!i)return t;const c=this.options.hover;return this.getElementsAtEventForMode(e,c.mode,c,s)}}const p_=()=>zn(ec.instances,n=>n._plugins.invalidate()),Io=!0;Object.defineProperties(ec,{defaults:{enumerable:Io,value:gn},instances:{enumerable:Io,value:Md},overrides:{enumerable:Io,value:fl},registry:{enumerable:Io,value:Es},version:{enumerable:Io,value:TM},getChart:{enumerable:Io,value:ab},register:{enumerable:Io,value:(...n)=>{Es.add(...n),p_()}},unregister:{enumerable:Io,value:(...n)=>{Es.remove(...n),p_()}}});function rb(n,e,t){const{startAngle:i,pixelMargin:s,x:c,y:u,outerRadius:o,innerRadius:p}=e;let _=s/o;n.beginPath(),n.arc(c,u,o,i-_,t+_),p>s?(_=s/p,n.arc(c,u,p,t+_,i-_,!0)):n.arc(c,u,s,t+ba,i-ba),n.closePath(),n.clip()}function EM(n){return Dm(n,["outerStart","outerEnd","innerStart","innerEnd"])}function LM(n,e,t,i){const s=EM(n.options.borderRadius),c=(t-e)/2,u=Math.min(c,i*e/2),o=p=>{const _=(t-Math.min(c,p))*i/2;return Ya(p,0,Math.min(c,_))};return{outerStart:o(s.outerStart),outerEnd:o(s.outerEnd),innerStart:Ya(s.innerStart,0,u),innerEnd:Ya(s.innerEnd,0,u)}}function Yl(n,e,t,i){return{x:t+n*Math.cos(e),y:i+n*Math.sin(e)}}function nm(n,e,t,i,s,c){const{x:u,y:o,startAngle:p,pixelMargin:_,innerRadius:v}=e,M=Math.max(e.outerRadius+i+t-_,0),S=v>0?v+i+t+_:0;let I=0;const R=s-p;if(i){const Bt=v>0?v-i:0,bi=M>0?M-i:0,Et=(Bt+bi)/2,Vt=Et!==0?R*Et/(Et+i):R;I=(R-Vt)/2}const G=Math.max(.001,R*M-t/oa)/M,Y=(R-G)/2,X=p+Y+I,oe=s-Y-I,{outerStart:Q,outerEnd:ce,innerStart:De,innerEnd:Oe}=LM(e,S,M,oe-X),Pe=M-Q,Se=M-ce,_e=X+Q/Pe,ze=oe-ce/Se,Re=S+De,Ye=S+Oe,Xe=X+De/Re,si=oe-Oe/Ye;if(n.beginPath(),c){if(n.arc(u,o,M,_e,ze),ce>0){const Et=Yl(Se,ze,u,o);n.arc(Et.x,Et.y,ce,ze,oe+ba)}const Bt=Yl(Ye,oe,u,o);if(n.lineTo(Bt.x,Bt.y),Oe>0){const Et=Yl(Ye,si,u,o);n.arc(Et.x,Et.y,Oe,oe+ba,si+Math.PI)}if(n.arc(u,o,S,oe-Oe/S,X+De/S,!0),De>0){const Et=Yl(Re,Xe,u,o);n.arc(Et.x,Et.y,De,Xe+Math.PI,X-ba)}const bi=Yl(Pe,X,u,o);if(n.lineTo(bi.x,bi.y),Q>0){const Et=Yl(Pe,_e,u,o);n.arc(Et.x,Et.y,Q,X-ba,_e)}}else{n.moveTo(u,o);const Bt=Math.cos(_e)*M+u,bi=Math.sin(_e)*M+o;n.lineTo(Bt,bi);const Et=Math.cos(ze)*M+u,Vt=Math.sin(ze)*M+o;n.lineTo(Et,Vt)}n.closePath()}function zM(n,e,t,i,s){const{fullCircles:c,startAngle:u,circumference:o}=e;let p=e.endAngle;if(c){nm(n,e,t,i,u+Nn,s);for(let _=0;_<c;++_)n.fill();isNaN(o)||(p=u+o%Nn,o%Nn===0&&(p+=Nn))}return nm(n,e,t,i,p,s),n.fill(),p}function RM(n,e,t){const{x:i,y:s,startAngle:c,pixelMargin:u,fullCircles:o}=e,p=Math.max(e.outerRadius-u,0),_=e.innerRadius+u;let v;for(t&&rb(n,e,c+Nn),n.beginPath(),n.arc(i,s,_,c+Nn,c,!0),v=0;v<o;++v)n.stroke();for(n.beginPath(),n.arc(i,s,p,c,c+Nn),v=0;v<o;++v)n.stroke()}function FM(n,e,t,i,s,c){const{options:u}=e,{borderWidth:o,borderJoinStyle:p}=u,_=u.borderAlign==="inner";o&&(_?(n.lineWidth=o*2,n.lineJoin=p||"round"):(n.lineWidth=o,n.lineJoin=p||"bevel"),e.fullCircles&&RM(n,e,_),_&&rb(n,e,s),nm(n,e,t,i,s,c),n.stroke())}class Qd extends vs{constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,i){const s=this.getProps(["x","y"],i),{angle:c,distance:u}=by(s,{x:e,y:t}),{startAngle:o,endAngle:p,innerRadius:_,outerRadius:v,circumference:M}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),S=this.options.spacing/2,R=sn(M,p-o)>=Nn||Fu(c,o,p),G=ao(u,_+S,v+S);return R&&G}getCenterPoint(e){const{x:t,y:i,startAngle:s,endAngle:c,innerRadius:u,outerRadius:o}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],e),{offset:p,spacing:_}=this.options,v=(s+c)/2,M=(u+o+_+p)/2;return{x:t+Math.cos(v)*M,y:i+Math.sin(v)*M}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:i}=this,s=(t.offset||0)/2,c=(t.spacing||0)/2,u=t.circular;if(this.pixelMargin=t.borderAlign==="inner"?.33:0,this.fullCircles=i>Nn?Math.floor(i/Nn):0,i===0||this.innerRadius<0||this.outerRadius<0)return;e.save();let o=0;if(s){o=s/2;const _=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(_)*o,Math.sin(_)*o),this.circumference>=oa&&(o=s)}e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor;const p=zM(e,this,o,c,u);FM(e,this,o,c,p,u),e.restore()}}Qd.id="arc";Qd.defaults={borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};Qd.defaultRoutes={backgroundColor:"backgroundColor"};function sb(n,e,t=e){n.lineCap=sn(t.borderCapStyle,e.borderCapStyle),n.setLineDash(sn(t.borderDash,e.borderDash)),n.lineDashOffset=sn(t.borderDashOffset,e.borderDashOffset),n.lineJoin=sn(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=sn(t.borderWidth,e.borderWidth),n.strokeStyle=sn(t.borderColor,e.borderColor)}function OM(n,e,t){n.lineTo(t.x,t.y)}function BM(n){return n.stepped?r4:n.tension||n.cubicInterpolationMode==="monotone"?s4:OM}function ob(n,e,t={}){const i=n.length,{start:s=0,end:c=i-1}=t,{start:u,end:o}=e,p=Math.max(s,u),_=Math.min(c,o),v=s<u&&c<u||s>o&&c>o;return{count:i,start:p,loop:e.loop,ilen:_<p&&!v?i+_-p:_-p}}function NM(n,e,t,i){const{points:s,options:c}=e,{count:u,start:o,loop:p,ilen:_}=ob(s,t,i),v=BM(c);let{move:M=!0,reverse:S}=i||{},I,R,G;for(I=0;I<=_;++I)R=s[(o+(S?_-I:I))%u],!R.skip&&(M?(n.moveTo(R.x,R.y),M=!1):v(n,G,R,S,c.stepped),G=R);return p&&(R=s[(o+(S?_:0))%u],v(n,G,R,S,c.stepped)),!!p}function VM(n,e,t,i){const s=e.points,{count:c,start:u,ilen:o}=ob(s,t,i),{move:p=!0,reverse:_}=i||{};let v=0,M=0,S,I,R,G,Y,X;const oe=ce=>(u+(_?o-ce:ce))%c,Q=()=>{G!==Y&&(n.lineTo(v,Y),n.lineTo(v,G),n.lineTo(v,X))};for(p&&(I=s[oe(0)],n.moveTo(I.x,I.y)),S=0;S<=o;++S){if(I=s[oe(S)],I.skip)continue;const ce=I.x,De=I.y,Oe=ce|0;Oe===R?(De<G?G=De:De>Y&&(Y=De),v=(M*v+ce)/++M):(Q(),n.lineTo(ce,De),R=Oe,M=0,G=Y=De),X=De}Q()}function am(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?VM:NM}function HM(n){return n.stepped?O4:n.tension||n.cubicInterpolationMode==="monotone"?B4:ll}function jM(n,e,t,i){let s=e._path;s||(s=e._path=new Path2D,e.path(s,t,i)&&s.closePath()),sb(n,e.options),n.stroke(s)}function UM(n,e,t,i){const{segments:s,options:c}=e,u=am(e);for(const o of s)sb(n,c,o.style),n.beginPath(),u(n,e,o,{start:t,end:t+i-1})&&n.closePath(),n.stroke()}const WM=typeof Path2D=="function";function qM(n,e,t,i){WM&&!e.options.segment?jM(n,e,t,i):UM(n,e,t,i)}class jo extends vs{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const s=i.spanGaps?this._loop:this._fullLoop;P4(this._points,i,e,s,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=q4(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,i=e.length;return i&&t[e[i-1].end]}interpolate(e,t){const i=this.options,s=e[t],c=this.points,u=Wy(this,{property:t,start:s,end:s});if(!u.length)return;const o=[],p=HM(i);let _,v;for(_=0,v=u.length;_<v;++_){const{start:M,end:S}=u[_],I=c[M],R=c[S];if(I===R){o.push(I);continue}const G=Math.abs((s-I[t])/(R[t]-I[t])),Y=p(I,R,G,i.stepped);Y[t]=e[t],o.push(Y)}return o.length===1?o[0]:o}pathSegment(e,t,i){return am(this)(e,this,t,i)}path(e,t,i){const s=this.segments,c=am(this);let u=this._loop;t=t||0,i=i||this.points.length-t;for(const o of s)u&=c(e,this,o,{start:t,end:t+i-1});return!!u}draw(e,t,i,s){const c=this.options||{};(this.points||[]).length&&c.borderWidth&&(e.save(),qM(e,this,i,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}jo.id="line";jo.defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};jo.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};jo.descriptors={_scriptable:!0,_indexable:n=>n!=="borderDash"&&n!=="fill"};function m_(n,e,t,i){const s=n.options,{[t]:c}=n.getProps([t],i);return Math.abs(e-c)<s.radius+s.hitRadius}class ef extends vs{constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,i){const s=this.options,{x:c,y:u}=this.getProps(["x","y"],i);return Math.pow(e-c,2)+Math.pow(t-u,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(e,t){return m_(this,e,"x",t)}inYRange(e,t){return m_(this,e,"y",t)}getCenterPoint(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}size(e){e=e||this.options||{};let t=e.radius||0;t=Math.max(t,t&&e.hoverRadius||0);const i=t&&e.borderWidth||0;return(t+i)*2}draw(e,t){const i=this.options;this.skip||i.radius<.1||!Ou(this,t,this.size(i)/2)||(e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.fillStyle=i.backgroundColor,Qp(e,i,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}ef.id="point";ef.defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};ef.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};function lb(n,e){const{x:t,y:i,base:s,width:c,height:u}=n.getProps(["x","y","base","width","height"],e);let o,p,_,v,M;return n.horizontal?(M=u/2,o=Math.min(t,s),p=Math.max(t,s),_=i-M,v=i+M):(M=c/2,o=t-M,p=t+M,_=Math.min(i,s),v=Math.max(i,s)),{left:o,top:_,right:p,bottom:v}}function zo(n,e,t,i){return n?0:Ya(e,t,i)}function ZM(n,e,t){const i=n.options.borderWidth,s=n.borderSkipped,c=Ey(i);return{t:zo(s.top,c.top,0,t),r:zo(s.right,c.right,0,e),b:zo(s.bottom,c.bottom,0,t),l:zo(s.left,c.left,0,e)}}function GM(n,e,t){const{enableBorderRadius:i}=n.getProps(["enableBorderRadius"]),s=n.options.borderRadius,c=hl(s),u=Math.min(e,t),o=n.borderSkipped,p=i||pn(s);return{topLeft:zo(!p||o.top||o.left,c.topLeft,0,u),topRight:zo(!p||o.top||o.right,c.topRight,0,u),bottomLeft:zo(!p||o.bottom||o.left,c.bottomLeft,0,u),bottomRight:zo(!p||o.bottom||o.right,c.bottomRight,0,u)}}function $M(n){const e=lb(n),t=e.right-e.left,i=e.bottom-e.top,s=ZM(n,t/2,i/2),c=GM(n,t/2,i/2);return{outer:{x:e.left,y:e.top,w:t,h:i,radius:c},inner:{x:e.left+s.l,y:e.top+s.t,w:t-s.l-s.r,h:i-s.t-s.b,radius:{topLeft:Math.max(0,c.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,c.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,c.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,c.bottomRight-Math.max(s.b,s.r))}}}}function Fp(n,e,t,i){const s=e===null,c=t===null,o=n&&!(s&&c)&&lb(n,i);return o&&(s||ao(e,o.left,o.right))&&(c||ao(t,o.top,o.bottom))}function KM(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function YM(n,e){n.rect(e.x,e.y,e.w,e.h)}function Op(n,e,t={}){const i=n.x!==t.x?-e:0,s=n.y!==t.y?-e:0,c=(n.x+n.w!==t.x+t.w?e:0)-i,u=(n.y+n.h!==t.y+t.h?e:0)-s;return{x:n.x+i,y:n.y+s,w:n.w+c,h:n.h+u,radius:n.radius}}class tf extends vs{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:i,backgroundColor:s}}=this,{inner:c,outer:u}=$M(this),o=KM(u.radius)?Bu:YM;e.save(),(u.w!==c.w||u.h!==c.h)&&(e.beginPath(),o(e,Op(u,t,c)),e.clip(),o(e,Op(c,-t,u)),e.fillStyle=i,e.fill("evenodd")),e.beginPath(),o(e,Op(c,t)),e.fillStyle=s,e.fill(),e.restore()}inRange(e,t,i){return Fp(this,e,t,i)}inXRange(e,t){return Fp(this,e,null,t)}inYRange(e,t){return Fp(this,null,e,t)}getCenterPoint(e){const{x:t,y:i,base:s,horizontal:c}=this.getProps(["x","y","base","horizontal"],e);return{x:c?(t+s)/2:t,y:c?i:(i+s)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}tf.id="bar";tf.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};tf.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};var JM=Object.freeze({__proto__:null,ArcElement:Qd,LineElement:jo,PointElement:ef,BarElement:tf});function XM(n,e,t,i,s){const c=s.samples||i;if(c>=t)return n.slice(e,e+t);const u=[],o=(t-2)/(c-2);let p=0;const _=e+t-1;let v=e,M,S,I,R,G;for(u[p++]=n[v],M=0;M<c-2;M++){let Y=0,X=0,oe;const Q=Math.floor((M+1)*o)+1+e,ce=Math.min(Math.floor((M+2)*o)+1,t)+e,De=ce-Q;for(oe=Q;oe<ce;oe++)Y+=n[oe].x,X+=n[oe].y;Y/=De,X/=De;const Oe=Math.floor(M*o)+1+e,Pe=Math.min(Math.floor((M+1)*o)+1,t)+e,{x:Se,y:_e}=n[v];for(I=R=-1,oe=Oe;oe<Pe;oe++)R=.5*Math.abs((Se-Y)*(n[oe].y-_e)-(Se-n[oe].x)*(X-_e)),R>I&&(I=R,S=n[oe],G=oe);u[p++]=S,v=G}return u[p++]=n[_],u}function QM(n,e,t,i){let s=0,c=0,u,o,p,_,v,M,S,I,R,G;const Y=[],X=e+t-1,oe=n[e].x,ce=n[X].x-oe;for(u=e;u<e+t;++u){o=n[u],p=(o.x-oe)/ce*i,_=o.y;const De=p|0;if(De===v)_<R?(R=_,M=u):_>G&&(G=_,S=u),s=(c*s+o.x)/++c;else{const Oe=u-1;if(!yn(M)&&!yn(S)){const Pe=Math.min(M,S),Se=Math.max(M,S);Pe!==I&&Pe!==Oe&&Y.push({...n[Pe],x:s}),Se!==I&&Se!==Oe&&Y.push({...n[Se],x:s})}u>0&&Oe!==I&&Y.push(n[Oe]),Y.push(o),v=De,c=0,R=G=_,M=S=I=u}}return Y}function cb(n){if(n._decimated){const e=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{value:e})}}function g_(n){n.data.datasets.forEach(e=>{cb(e)})}function e6(n,e){const t=e.length;let i=0,s;const{iScale:c}=n,{min:u,max:o,minDefined:p,maxDefined:_}=c.getUserBounds();return p&&(i=Ya(ro(e,c.axis,u).lo,0,t-1)),_?s=Ya(ro(e,c.axis,o).hi+1,i,t)-i:s=t-i,{start:i,count:s}}var t6={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,e,t)=>{if(!t.enabled){g_(n);return}const i=n.width;n.data.datasets.forEach((s,c)=>{const{_data:u,indexAxis:o}=s,p=n.getDatasetMeta(c),_=u||s.data;if(wu([o,n.options.indexAxis])==="y"||!p.controller.supportsDecimation)return;const v=n.scales[p.xAxisID];if(v.type!=="linear"&&v.type!=="time"||n.options.parsing)return;let{start:M,count:S}=e6(p,_);const I=t.threshold||4*i;if(S<=I){cb(s);return}yn(u)&&(s._data=_,delete s.data,Object.defineProperty(s,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(G){this._data=G}}));let R;switch(t.algorithm){case"lttb":R=XM(_,M,S,i,t);break;case"min-max":R=QM(_,M,S,i);break;default:throw new Error(`Unsupported decimation algorithm '${t.algorithm}'`)}s._decimated=R})},destroy(n){g_(n)}};function i6(n,e,t){const i=n.segments,s=n.points,c=e.points,u=[];for(const o of i){let{start:p,end:_}=o;_=Em(p,_,s);const v=rm(t,s[p],s[_],o.loop);if(!e.segments){u.push({source:o,target:v,start:s[p],end:s[_]});continue}const M=Wy(e,v);for(const S of M){const I=rm(t,c[S.start],c[S.end],S.loop),R=Uy(o,s,I);for(const G of R)u.push({source:G,target:S,start:{[t]:__(v,I,"start",Math.max)},end:{[t]:__(v,I,"end",Math.min)}})}}return u}function rm(n,e,t,i){if(i)return;let s=e[n],c=t[n];return n==="angle"&&(s=qr(s),c=qr(c)),{property:n,start:s,end:c}}function n6(n,e){const{x:t=null,y:i=null}=n||{},s=e.points,c=[];return e.segments.forEach(({start:u,end:o})=>{o=Em(u,o,s);const p=s[u],_=s[o];i!==null?(c.push({x:p.x,y:i}),c.push({x:_.x,y:i})):t!==null&&(c.push({x:t,y:p.y}),c.push({x:t,y:_.y}))}),c}function Em(n,e,t){for(;e>n;e--){const i=t[e];if(!isNaN(i.x)&&!isNaN(i.y))break}return e}function __(n,e,t,i){return n&&e?i(n[t],e[t]):n?n[t]:e?e[t]:0}function ub(n,e){let t=[],i=!1;return Xn(n)?(i=!0,t=n):t=n6(n,e),t.length?new jo({points:t,options:{tension:0},_loop:i,_fullLoop:i}):null}function y_(n){return n&&n.fill!==!1}function a6(n,e,t){let s=n[e].fill;const c=[e];let u;if(!t)return s;for(;s!==!1&&c.indexOf(s)===-1;){if(!Pa(s))return s;if(u=n[s],!u)return!1;if(u.visible)return s;c.push(s),s=u.fill}return!1}function r6(n,e,t){const i=c6(n);if(pn(i))return isNaN(i.value)?!1:i;let s=parseFloat(i);return Pa(s)&&Math.floor(s)===s?s6(i[0],e,s,t):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function s6(n,e,t,i){return(n==="-"||n==="+")&&(t=e+t),t===e||t<0||t>=i?!1:t}function o6(n,e){let t=null;return n==="start"?t=e.bottom:n==="end"?t=e.top:pn(n)?t=e.getPixelForValue(n.value):e.getBasePixel&&(t=e.getBasePixel()),t}function l6(n,e,t){let i;return n==="start"?i=t:n==="end"?i=e.options.reverse?e.min:e.max:pn(n)?i=n.value:i=e.getBaseValue(),i}function c6(n){const e=n.options,t=e.fill;let i=sn(t&&t.target,t);return i===void 0&&(i=!!e.backgroundColor),i===!1||i===null?!1:i===!0?"origin":i}function u6(n){const{scale:e,index:t,line:i}=n,s=[],c=i.segments,u=i.points,o=h6(e,t);o.push(ub({x:null,y:e.bottom},i));for(let p=0;p<c.length;p++){const _=c[p];for(let v=_.start;v<=_.end;v++)d6(s,u[v],o)}return new jo({points:s,options:{}})}function h6(n,e){const t=[],i=n.getMatchingVisibleMetas("line");for(let s=0;s<i.length;s++){const c=i[s];if(c.index===e)break;c.hidden||t.unshift(c.dataset)}return t}function d6(n,e,t){const i=[];for(let s=0;s<t.length;s++){const c=t[s],{first:u,last:o,point:p}=f6(c,e,"x");if(!(!p||u&&o)){if(u)i.unshift(p);else if(n.push(p),!o)break}}n.push(...i)}function f6(n,e,t){const i=n.interpolate(e,t);if(!i)return{};const s=i[t],c=n.segments,u=n.points;let o=!1,p=!1;for(let _=0;_<c.length;_++){const v=c[_],M=u[v.start][t],S=u[v.end][t];if(ao(s,M,S)){o=s===M,p=s===S;break}}return{first:o,last:p,point:i}}class hb{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,i){const{x:s,y:c,radius:u}=this;return t=t||{start:0,end:Nn},e.arc(s,c,u,t.end,t.start,!0),!i.bounds}interpolate(e){const{x:t,y:i,radius:s}=this,c=e.angle;return{x:t+Math.cos(c)*s,y:i+Math.sin(c)*s,angle:c}}}function p6(n){const{chart:e,fill:t,line:i}=n;if(Pa(t))return m6(e,t);if(t==="stack")return u6(n);if(t==="shape")return!0;const s=g6(n);return s instanceof hb?s:ub(s,i)}function m6(n,e){const t=n.getDatasetMeta(e);return t&&n.isDatasetVisible(e)?t.dataset:null}function g6(n){return(n.scale||{}).getPointPositionForValue?y6(n):_6(n)}function _6(n){const{scale:e={},fill:t}=n,i=o6(t,e);if(Pa(i)){const s=e.isHorizontal();return{x:s?i:null,y:s?null:i}}return null}function y6(n){const{scale:e,fill:t}=n,i=e.options,s=e.getLabels().length,c=i.reverse?e.max:e.min,u=l6(t,e,c),o=[];if(i.grid.circular){const p=e.getPointPositionForValue(0,c);return new hb({x:p.x,y:p.y,radius:e.getDistanceFromCenterForValue(u)})}for(let p=0;p<s;++p)o.push(e.getPointPositionForValue(p,u));return o}function Bp(n,e,t){const i=p6(e),{line:s,scale:c,axis:u}=e,o=s.options,p=o.fill,_=o.backgroundColor,{above:v=_,below:M=_}=p||{};i&&s.points.length&&(Ud(n,t),b6(n,{line:s,target:i,above:v,below:M,area:t,scale:c,axis:u}),Wd(n))}function b6(n,e){const{line:t,target:i,above:s,below:c,area:u,scale:o}=e,p=t._loop?"angle":e.axis;n.save(),p==="x"&&c!==s&&(b_(n,i,u.top),v_(n,{line:t,target:i,color:s,scale:o,property:p}),n.restore(),n.save(),b_(n,i,u.bottom)),v_(n,{line:t,target:i,color:c,scale:o,property:p}),n.restore()}function b_(n,e,t){const{segments:i,points:s}=e;let c=!0,u=!1;n.beginPath();for(const o of i){const{start:p,end:_}=o,v=s[p],M=s[Em(p,_,s)];c?(n.moveTo(v.x,v.y),c=!1):(n.lineTo(v.x,t),n.lineTo(v.x,v.y)),u=!!e.pathSegment(n,o,{move:u}),u?n.closePath():n.lineTo(M.x,t)}n.lineTo(e.first().x,t),n.closePath(),n.clip()}function v_(n,e){const{line:t,target:i,property:s,color:c,scale:u}=e,o=i6(t,i,s);for(const{source:p,target:_,start:v,end:M}of o){const{style:{backgroundColor:S=c}={}}=p,I=i!==!0;n.save(),n.fillStyle=S,v6(n,u,I&&rm(s,v,M)),n.beginPath();const R=!!t.pathSegment(n,p);let G;if(I){R?n.closePath():x_(n,i,M,s);const Y=!!i.pathSegment(n,_,{move:R,reverse:!0});G=R&&Y,G||x_(n,i,v,s)}n.closePath(),n.fill(G?"evenodd":"nonzero"),n.restore()}}function v6(n,e,t){const{top:i,bottom:s}=e.chart.chartArea,{property:c,start:u,end:o}=t||{};c==="x"&&(n.beginPath(),n.rect(u,i,o-u,s-i),n.clip())}function x_(n,e,t,i){const s=e.interpolate(t,i);s&&n.lineTo(s.x,s.y)}var x6={id:"filler",afterDatasetsUpdate(n,e,t){const i=(n.data.datasets||[]).length,s=[];let c,u,o,p;for(u=0;u<i;++u)c=n.getDatasetMeta(u),o=c.dataset,p=null,o&&o.options&&o instanceof jo&&(p={visible:n.isDatasetVisible(u),index:u,fill:r6(o,u,i),chart:n,axis:c.controller.options.indexAxis,scale:c.vScale,line:o}),c.$filler=p,s.push(p);for(u=0;u<i;++u)p=s[u],!(!p||p.fill===!1)&&(p.fill=a6(s,u,t.propagate))},beforeDraw(n,e,t){const i=t.drawTime==="beforeDraw",s=n.getSortedVisibleDatasetMetas(),c=n.chartArea;for(let u=s.length-1;u>=0;--u){const o=s[u].$filler;o&&(o.line.updateControlPoints(c,o.axis),i&&o.fill&&Bp(n.ctx,o,c))}},beforeDatasetsDraw(n,e,t){if(t.drawTime!=="beforeDatasetsDraw")return;const i=n.getSortedVisibleDatasetMetas();for(let s=i.length-1;s>=0;--s){const c=i[s].$filler;y_(c)&&Bp(n.ctx,c,n.chartArea)}},beforeDatasetDraw(n,e,t){const i=e.meta.$filler;!y_(i)||t.drawTime!=="beforeDatasetDraw"||Bp(n.ctx,i,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const w_=(n,e)=>{let{boxHeight:t=e,boxWidth:i=e}=n;return n.usePointStyle&&(t=Math.min(t,e),i=n.pointStyleWidth||Math.min(i,e)),{boxWidth:i,boxHeight:t,itemHeight:Math.max(e,t)}},w6=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class k_ extends vs{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,i){this.maxWidth=e,this.maxHeight=t,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Jn(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(i=>e.filter(i,this.chart.data))),e.sort&&(t=t.sort((i,s)=>e.sort(i,s,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const i=e.labels,s=Ua(i.font),c=s.size,u=this._computeTitleHeight(),{boxWidth:o,itemHeight:p}=w_(i,c);let _,v;t.font=s.string,this.isHorizontal()?(_=this.maxWidth,v=this._fitRows(u,c,o,p)+10):(v=this.maxHeight,_=this._fitCols(u,c,o,p)+10),this.width=Math.min(_,e.maxWidth||this.maxWidth),this.height=Math.min(v,e.maxHeight||this.maxHeight)}_fitRows(e,t,i,s){const{ctx:c,maxWidth:u,options:{labels:{padding:o}}}=this,p=this.legendHitBoxes=[],_=this.lineWidths=[0],v=s+o;let M=e;c.textAlign="left",c.textBaseline="middle";let S=-1,I=-v;return this.legendItems.forEach((R,G)=>{const Y=i+t/2+c.measureText(R.text).width;(G===0||_[_.length-1]+Y+2*o>u)&&(M+=v,_[_.length-(G>0?0:1)]=0,I+=v,S++),p[G]={left:0,top:I,row:S,width:Y,height:s},_[_.length-1]+=Y+o}),M}_fitCols(e,t,i,s){const{ctx:c,maxHeight:u,options:{labels:{padding:o}}}=this,p=this.legendHitBoxes=[],_=this.columnSizes=[],v=u-e;let M=o,S=0,I=0,R=0,G=0;return this.legendItems.forEach((Y,X)=>{const oe=i+t/2+c.measureText(Y.text).width;X>0&&I+s+2*o>v&&(M+=S+o,_.push({width:S,height:I}),R+=S+o,G++,S=I=0),p[X]={left:R,top:I,col:G,width:oe,height:s},S=Math.max(S,oe),I+=s+o}),M+=S,_.push({width:S,height:I}),M}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:i,labels:{padding:s},rtl:c}}=this,u=Ql(c,this.left,this.width);if(this.isHorizontal()){let o=0,p=mr(i,this.left+s,this.right-this.lineWidths[o]);for(const _ of t)o!==_.row&&(o=_.row,p=mr(i,this.left+s,this.right-this.lineWidths[o])),_.top+=this.top+e+s,_.left=u.leftForLtr(u.x(p),_.width),p+=_.width+s}else{let o=0,p=mr(i,this.top+e+s,this.bottom-this.columnSizes[o].height);for(const _ of t)_.col!==o&&(o=_.col,p=mr(i,this.top+e+s,this.bottom-this.columnSizes[o].height)),_.top=p,_.left+=this.left+s,_.left=u.leftForLtr(u.x(_.left),_.width),p+=_.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Ud(e,this),this._draw(),Wd(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:i,ctx:s}=this,{align:c,labels:u}=e,o=gn.color,p=Ql(e.rtl,this.left,this.width),_=Ua(u.font),{color:v,padding:M}=u,S=_.size,I=S/2;let R;this.drawTitle(),s.textAlign=p.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=_.string;const{boxWidth:G,boxHeight:Y,itemHeight:X}=w_(u,S),oe=function(Pe,Se,_e){if(isNaN(G)||G<=0||isNaN(Y)||Y<0)return;s.save();const ze=sn(_e.lineWidth,1);if(s.fillStyle=sn(_e.fillStyle,o),s.lineCap=sn(_e.lineCap,"butt"),s.lineDashOffset=sn(_e.lineDashOffset,0),s.lineJoin=sn(_e.lineJoin,"miter"),s.lineWidth=ze,s.strokeStyle=sn(_e.strokeStyle,o),s.setLineDash(sn(_e.lineDash,[])),u.usePointStyle){const Re={radius:Y*Math.SQRT2/2,pointStyle:_e.pointStyle,rotation:_e.rotation,borderWidth:ze},Ye=p.xPlus(Pe,G/2),Xe=Se+I;Iy(s,Re,Ye,Xe,u.pointStyleWidth&&G)}else{const Re=Se+Math.max((S-Y)/2,0),Ye=p.leftForLtr(Pe,G),Xe=hl(_e.borderRadius);s.beginPath(),Object.values(Xe).some(si=>si!==0)?Bu(s,{x:Ye,y:Re,w:G,h:Y,radius:Xe}):s.rect(Ye,Re,G,Y),s.fill(),ze!==0&&s.stroke()}s.restore()},Q=function(Pe,Se,_e){pl(s,_e.text,Pe,Se+X/2,_,{strikethrough:_e.hidden,textAlign:p.textAlign(_e.textAlign)})},ce=this.isHorizontal(),De=this._computeTitleHeight();ce?R={x:mr(c,this.left+M,this.right-i[0]),y:this.top+M+De,line:0}:R={x:this.left+M,y:mr(c,this.top+De+M,this.bottom-t[0].height),line:0},Vy(this.ctx,e.textDirection);const Oe=X+M;this.legendItems.forEach((Pe,Se)=>{s.strokeStyle=Pe.fontColor||v,s.fillStyle=Pe.fontColor||v;const _e=s.measureText(Pe.text).width,ze=p.textAlign(Pe.textAlign||(Pe.textAlign=u.textAlign)),Re=G+I+_e;let Ye=R.x,Xe=R.y;p.setWidth(this.width),ce?Se>0&&Ye+Re+M>this.right&&(Xe=R.y+=Oe,R.line++,Ye=R.x=mr(c,this.left+M,this.right-i[R.line])):Se>0&&Xe+Oe>this.bottom&&(Ye=R.x=Ye+t[R.line].width+M,R.line++,Xe=R.y=mr(c,this.top+De+M,this.bottom-t[R.line].height));const si=p.x(Ye);oe(si,Xe,Pe),Ye=Lk(ze,Ye+G+I,ce?Ye+Re:this.right,e.rtl),Q(p.x(Ye),Xe,Pe),ce?R.x+=Re+M:R.y+=Oe}),Hy(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,i=Ua(t.font),s=vr(t.padding);if(!t.display)return;const c=Ql(e.rtl,this.left,this.width),u=this.ctx,o=t.position,p=i.size/2,_=s.top+p;let v,M=this.left,S=this.width;if(this.isHorizontal())S=Math.max(...this.lineWidths),v=this.top+_,M=mr(e.align,M,this.right-S);else{const R=this.columnSizes.reduce((G,Y)=>Math.max(G,Y.height),0);v=_+mr(e.align,this.top,this.bottom-R-e.labels.padding-this._computeTitleHeight())}const I=mr(o,M,M+S);u.textAlign=c.textAlign(wm(o)),u.textBaseline="middle",u.strokeStyle=t.color,u.fillStyle=t.color,u.font=i.string,pl(u,t.text,I,v,i)}_computeTitleHeight(){const e=this.options.title,t=Ua(e.font),i=vr(e.padding);return e.display?t.lineHeight+i.height:0}_getLegendItemAt(e,t){let i,s,c;if(ao(e,this.left,this.right)&&ao(t,this.top,this.bottom)){for(c=this.legendHitBoxes,i=0;i<c.length;++i)if(s=c[i],ao(e,s.left,s.left+s.width)&&ao(t,s.top,s.top+s.height))return this.legendItems[i]}return null}handleEvent(e){const t=this.options;if(!k6(e.type,t))return;const i=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const s=this._hoveredItem,c=w6(s,i);s&&!c&&Jn(t.onLeave,[e,s,this],this),this._hoveredItem=i,i&&!c&&Jn(t.onHover,[e,i,this],this)}else i&&Jn(t.onClick,[e,i,this],this)}}function k6(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var S6={id:"legend",_element:k_,start(n,e,t){const i=n.legend=new k_({ctx:n.ctx,options:t,chart:n});_r.configure(n,i,t),_r.addBox(n,i)},stop(n){_r.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const i=n.legend;_r.configure(n,i,t),i.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const i=e.datasetIndex,s=t.chart;s.isDatasetVisible(i)?(s.hide(i),e.hidden=!0):(s.show(i),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:i,textAlign:s,color:c}}=n.legend.options;return n._getSortedDatasetMetas().map(u=>{const o=u.controller.getStyle(t?0:void 0),p=vr(o.borderWidth);return{text:e[u.index].label,fillStyle:o.backgroundColor,fontColor:c,hidden:!u.visible,lineCap:o.borderCapStyle,lineDash:o.borderDash,lineDashOffset:o.borderDashOffset,lineJoin:o.borderJoinStyle,lineWidth:(p.width+p.height)/4,strokeStyle:o.borderColor,pointStyle:i||o.pointStyle,rotation:o.rotation,textAlign:s||o.textAlign,borderRadius:0,datasetIndex:u.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class Lm extends vs{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const s=Xn(i.text)?i.text.length:1;this._padding=vr(i.padding);const c=s*Ua(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=c:this.width=c}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:i,bottom:s,right:c,options:u}=this,o=u.align;let p=0,_,v,M;return this.isHorizontal()?(v=mr(o,i,c),M=t+e,_=c-i):(u.position==="left"?(v=i+e,M=mr(o,s,t),p=oa*-.5):(v=c-e,M=mr(o,t,s),p=oa*.5),_=s-t),{titleX:v,titleY:M,maxWidth:_,rotation:p}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const i=Ua(t.font),c=i.lineHeight/2+this._padding.top,{titleX:u,titleY:o,maxWidth:p,rotation:_}=this._drawArgs(c);pl(e,t.text,0,0,i,{color:t.color,maxWidth:p,rotation:_,textAlign:wm(t.align),textBaseline:"middle",translation:[u,o]})}}function M6(n,e){const t=new Lm({ctx:n.ctx,options:e,chart:n});_r.configure(n,t,e),_r.addBox(n,t),n.titleBlock=t}var D6={id:"title",_element:Lm,start(n,e,t){M6(n,t)},stop(n){const e=n.titleBlock;_r.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,t){const i=n.titleBlock;_r.configure(n,i,t),i.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const rd=new WeakMap;var T6={id:"subtitle",start(n,e,t){const i=new Lm({ctx:n.ctx,options:t,chart:n});_r.configure(n,i,t),_r.addBox(n,i),rd.set(n,i)},stop(n){_r.removeBox(n,rd.get(n)),rd.delete(n)},beforeUpdate(n,e,t){const i=rd.get(n);_r.configure(n,i,t),i.options=t},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Pu={average(n){if(!n.length)return!1;let e,t,i=0,s=0,c=0;for(e=0,t=n.length;e<t;++e){const u=n[e].element;if(u&&u.hasValue()){const o=u.tooltipPosition();i+=o.x,s+=o.y,++c}}return{x:i/c,y:s/c}},nearest(n,e){if(!n.length)return!1;let t=e.x,i=e.y,s=Number.POSITIVE_INFINITY,c,u,o;for(c=0,u=n.length;c<u;++c){const p=n[c].element;if(p&&p.hasValue()){const _=p.getCenterPoint(),v=Yp(e,_);v<s&&(s=v,o=p)}}if(o){const p=o.tooltipPosition();t=p.x,i=p.y}return{x:t,y:i}}};function As(n,e){return e&&(Xn(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function to(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function C6(n,e){const{element:t,datasetIndex:i,index:s}=e,c=n.getDatasetMeta(i).controller,{label:u,value:o}=c.getLabelAndValue(s);return{chart:n,label:u,parsed:c.getParsed(s),raw:n.data.datasets[i].data[s],formattedValue:o,dataset:c.getDataset(),dataIndex:s,datasetIndex:i,element:t}}function S_(n,e){const t=n.chart.ctx,{body:i,footer:s,title:c}=n,{boxWidth:u,boxHeight:o}=e,p=Ua(e.bodyFont),_=Ua(e.titleFont),v=Ua(e.footerFont),M=c.length,S=s.length,I=i.length,R=vr(e.padding);let G=R.height,Y=0,X=i.reduce((ce,De)=>ce+De.before.length+De.lines.length+De.after.length,0);if(X+=n.beforeBody.length+n.afterBody.length,M&&(G+=M*_.lineHeight+(M-1)*e.titleSpacing+e.titleMarginBottom),X){const ce=e.displayColors?Math.max(o,p.lineHeight):p.lineHeight;G+=I*ce+(X-I)*p.lineHeight+(X-1)*e.bodySpacing}S&&(G+=e.footerMarginTop+S*v.lineHeight+(S-1)*e.footerSpacing);let oe=0;const Q=function(ce){Y=Math.max(Y,t.measureText(ce).width+oe)};return t.save(),t.font=_.string,zn(n.title,Q),t.font=p.string,zn(n.beforeBody.concat(n.afterBody),Q),oe=e.displayColors?u+2+e.boxPadding:0,zn(i,ce=>{zn(ce.before,Q),zn(ce.lines,Q),zn(ce.after,Q)}),oe=0,t.font=v.string,zn(n.footer,Q),t.restore(),Y+=R.width,{width:Y,height:G}}function P6(n,e){const{y:t,height:i}=e;return t<i/2?"top":t>n.height-i/2?"bottom":"center"}function A6(n,e,t,i){const{x:s,width:c}=i,u=t.caretSize+t.caretPadding;if(n==="left"&&s+c+u>e.width||n==="right"&&s-c-u<0)return!0}function I6(n,e,t,i){const{x:s,width:c}=t,{width:u,chartArea:{left:o,right:p}}=n;let _="center";return i==="center"?_=s<=(o+p)/2?"left":"right":s<=c/2?_="left":s>=u-c/2&&(_="right"),A6(_,n,e,t)&&(_="center"),_}function M_(n,e,t){const i=t.yAlign||e.yAlign||P6(n,t);return{xAlign:t.xAlign||e.xAlign||I6(n,e,t,i),yAlign:i}}function E6(n,e){let{x:t,width:i}=n;return e==="right"?t-=i:e==="center"&&(t-=i/2),t}function L6(n,e,t){let{y:i,height:s}=n;return e==="top"?i+=t:e==="bottom"?i-=s+t:i-=s/2,i}function D_(n,e,t,i){const{caretSize:s,caretPadding:c,cornerRadius:u}=n,{xAlign:o,yAlign:p}=t,_=s+c,{topLeft:v,topRight:M,bottomLeft:S,bottomRight:I}=hl(u);let R=E6(e,o);const G=L6(e,p,_);return p==="center"?o==="left"?R+=_:o==="right"&&(R-=_):o==="left"?R-=Math.max(v,S)+s:o==="right"&&(R+=Math.max(M,I)+s),{x:Ya(R,0,i.width-e.width),y:Ya(G,0,i.height-e.height)}}function sd(n,e,t){const i=vr(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-i.right:n.x+i.left}function T_(n){return As([],to(n))}function z6(n,e,t){return Ho(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function C_(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}class sm extends vs{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart||e._chart,this._chart=this.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,i=this.options.setContext(this.getContext()),s=i.enabled&&t.options.animation&&i.animations,c=new qy(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(c)),c}getContext(){return this.$context||(this.$context=z6(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:i}=t,s=i.beforeTitle.apply(this,[e]),c=i.title.apply(this,[e]),u=i.afterTitle.apply(this,[e]);let o=[];return o=As(o,to(s)),o=As(o,to(c)),o=As(o,to(u)),o}getBeforeBody(e,t){return T_(t.callbacks.beforeBody.apply(this,[e]))}getBody(e,t){const{callbacks:i}=t,s=[];return zn(e,c=>{const u={before:[],lines:[],after:[]},o=C_(i,c);As(u.before,to(o.beforeLabel.call(this,c))),As(u.lines,o.label.call(this,c)),As(u.after,to(o.afterLabel.call(this,c))),s.push(u)}),s}getAfterBody(e,t){return T_(t.callbacks.afterBody.apply(this,[e]))}getFooter(e,t){const{callbacks:i}=t,s=i.beforeFooter.apply(this,[e]),c=i.footer.apply(this,[e]),u=i.afterFooter.apply(this,[e]);let o=[];return o=As(o,to(s)),o=As(o,to(c)),o=As(o,to(u)),o}_createItems(e){const t=this._active,i=this.chart.data,s=[],c=[],u=[];let o=[],p,_;for(p=0,_=t.length;p<_;++p)o.push(C6(this.chart,t[p]));return e.filter&&(o=o.filter((v,M,S)=>e.filter(v,M,S,i))),e.itemSort&&(o=o.sort((v,M)=>e.itemSort(v,M,i))),zn(o,v=>{const M=C_(e.callbacks,v);s.push(M.labelColor.call(this,v)),c.push(M.labelPointStyle.call(this,v)),u.push(M.labelTextColor.call(this,v))}),this.labelColors=s,this.labelPointStyles=c,this.labelTextColors=u,this.dataPoints=o,o}update(e,t){const i=this.options.setContext(this.getContext()),s=this._active;let c,u=[];if(!s.length)this.opacity!==0&&(c={opacity:0});else{const o=Pu[i.position].call(this,s,this._eventPosition);u=this._createItems(i),this.title=this.getTitle(u,i),this.beforeBody=this.getBeforeBody(u,i),this.body=this.getBody(u,i),this.afterBody=this.getAfterBody(u,i),this.footer=this.getFooter(u,i);const p=this._size=S_(this,i),_=Object.assign({},o,p),v=M_(this.chart,i,_),M=D_(i,_,v,this.chart);this.xAlign=v.xAlign,this.yAlign=v.yAlign,c={opacity:1,x:M.x,y:M.y,width:p.width,height:p.height,caretX:o.x,caretY:o.y}}this._tooltipItems=u,this.$context=void 0,c&&this._resolveAnimations().update(this,c),e&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,i,s){const c=this.getCaretPosition(e,i,s);t.lineTo(c.x1,c.y1),t.lineTo(c.x2,c.y2),t.lineTo(c.x3,c.y3)}getCaretPosition(e,t,i){const{xAlign:s,yAlign:c}=this,{caretSize:u,cornerRadius:o}=i,{topLeft:p,topRight:_,bottomLeft:v,bottomRight:M}=hl(o),{x:S,y:I}=e,{width:R,height:G}=t;let Y,X,oe,Q,ce,De;return c==="center"?(ce=I+G/2,s==="left"?(Y=S,X=Y-u,Q=ce+u,De=ce-u):(Y=S+R,X=Y+u,Q=ce-u,De=ce+u),oe=Y):(s==="left"?X=S+Math.max(p,v)+u:s==="right"?X=S+R-Math.max(_,M)-u:X=this.caretX,c==="top"?(Q=I,ce=Q-u,Y=X-u,oe=X+u):(Q=I+G,ce=Q+u,Y=X+u,oe=X-u),De=Q),{x1:Y,x2:X,x3:oe,y1:Q,y2:ce,y3:De}}drawTitle(e,t,i){const s=this.title,c=s.length;let u,o,p;if(c){const _=Ql(i.rtl,this.x,this.width);for(e.x=sd(this,i.titleAlign,i),t.textAlign=_.textAlign(i.titleAlign),t.textBaseline="middle",u=Ua(i.titleFont),o=i.titleSpacing,t.fillStyle=i.titleColor,t.font=u.string,p=0;p<c;++p)t.fillText(s[p],_.x(e.x),e.y+u.lineHeight/2),e.y+=u.lineHeight+o,p+1===c&&(e.y+=i.titleMarginBottom-o)}}_drawColorBox(e,t,i,s,c){const u=this.labelColors[i],o=this.labelPointStyles[i],{boxHeight:p,boxWidth:_,boxPadding:v}=c,M=Ua(c.bodyFont),S=sd(this,"left",c),I=s.x(S),R=p<M.lineHeight?(M.lineHeight-p)/2:0,G=t.y+R;if(c.usePointStyle){const Y={radius:Math.min(_,p)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},X=s.leftForLtr(I,_)+_/2,oe=G+p/2;e.strokeStyle=c.multiKeyBackground,e.fillStyle=c.multiKeyBackground,Qp(e,Y,X,oe),e.strokeStyle=u.borderColor,e.fillStyle=u.backgroundColor,Qp(e,Y,X,oe)}else{e.lineWidth=pn(u.borderWidth)?Math.max(...Object.values(u.borderWidth)):u.borderWidth||1,e.strokeStyle=u.borderColor,e.setLineDash(u.borderDash||[]),e.lineDashOffset=u.borderDashOffset||0;const Y=s.leftForLtr(I,_-v),X=s.leftForLtr(s.xPlus(I,1),_-v-2),oe=hl(u.borderRadius);Object.values(oe).some(Q=>Q!==0)?(e.beginPath(),e.fillStyle=c.multiKeyBackground,Bu(e,{x:Y,y:G,w:_,h:p,radius:oe}),e.fill(),e.stroke(),e.fillStyle=u.backgroundColor,e.beginPath(),Bu(e,{x:X,y:G+1,w:_-2,h:p-2,radius:oe}),e.fill()):(e.fillStyle=c.multiKeyBackground,e.fillRect(Y,G,_,p),e.strokeRect(Y,G,_,p),e.fillStyle=u.backgroundColor,e.fillRect(X,G+1,_-2,p-2))}e.fillStyle=this.labelTextColors[i]}drawBody(e,t,i){const{body:s}=this,{bodySpacing:c,bodyAlign:u,displayColors:o,boxHeight:p,boxWidth:_,boxPadding:v}=i,M=Ua(i.bodyFont);let S=M.lineHeight,I=0;const R=Ql(i.rtl,this.x,this.width),G=function(Se){t.fillText(Se,R.x(e.x+I),e.y+S/2),e.y+=S+c},Y=R.textAlign(u);let X,oe,Q,ce,De,Oe,Pe;for(t.textAlign=u,t.textBaseline="middle",t.font=M.string,e.x=sd(this,Y,i),t.fillStyle=i.bodyColor,zn(this.beforeBody,G),I=o&&Y!=="right"?u==="center"?_/2+v:_+2+v:0,ce=0,Oe=s.length;ce<Oe;++ce){for(X=s[ce],oe=this.labelTextColors[ce],t.fillStyle=oe,zn(X.before,G),Q=X.lines,o&&Q.length&&(this._drawColorBox(t,e,ce,R,i),S=Math.max(M.lineHeight,p)),De=0,Pe=Q.length;De<Pe;++De)G(Q[De]),S=M.lineHeight;zn(X.after,G)}I=0,S=M.lineHeight,zn(this.afterBody,G),e.y-=c}drawFooter(e,t,i){const s=this.footer,c=s.length;let u,o;if(c){const p=Ql(i.rtl,this.x,this.width);for(e.x=sd(this,i.footerAlign,i),e.y+=i.footerMarginTop,t.textAlign=p.textAlign(i.footerAlign),t.textBaseline="middle",u=Ua(i.footerFont),t.fillStyle=i.footerColor,t.font=u.string,o=0;o<c;++o)t.fillText(s[o],p.x(e.x),e.y+u.lineHeight/2),e.y+=u.lineHeight+i.footerSpacing}}drawBackground(e,t,i,s){const{xAlign:c,yAlign:u}=this,{x:o,y:p}=e,{width:_,height:v}=i,{topLeft:M,topRight:S,bottomLeft:I,bottomRight:R}=hl(s.cornerRadius);t.fillStyle=s.backgroundColor,t.strokeStyle=s.borderColor,t.lineWidth=s.borderWidth,t.beginPath(),t.moveTo(o+M,p),u==="top"&&this.drawCaret(e,t,i,s),t.lineTo(o+_-S,p),t.quadraticCurveTo(o+_,p,o+_,p+S),u==="center"&&c==="right"&&this.drawCaret(e,t,i,s),t.lineTo(o+_,p+v-R),t.quadraticCurveTo(o+_,p+v,o+_-R,p+v),u==="bottom"&&this.drawCaret(e,t,i,s),t.lineTo(o+I,p+v),t.quadraticCurveTo(o,p+v,o,p+v-I),u==="center"&&c==="left"&&this.drawCaret(e,t,i,s),t.lineTo(o,p+M),t.quadraticCurveTo(o,p,o+M,p),t.closePath(),t.fill(),s.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,i=this.$animations,s=i&&i.x,c=i&&i.y;if(s||c){const u=Pu[e.position].call(this,this._active,this._eventPosition);if(!u)return;const o=this._size=S_(this,e),p=Object.assign({},u,this._size),_=M_(t,e,p),v=D_(e,p,_,t);(s._to!==v.x||c._to!==v.y)&&(this.xAlign=_.xAlign,this.yAlign=_.yAlign,this.width=o.width,this.height=o.height,this.caretX=u.x,this.caretY=u.y,this._resolveAnimations().update(this,v))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(t);const s={width:this.width,height:this.height},c={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const u=vr(t.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&o&&(e.save(),e.globalAlpha=i,this.drawBackground(c,e,s,t),Vy(e,t.textDirection),c.y+=u.top,this.drawTitle(c,e,t),this.drawBody(c,e,t),this.drawFooter(c,e,t),Hy(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const i=this._active,s=e.map(({datasetIndex:o,index:p})=>{const _=this.chart.getDatasetMeta(o);if(!_)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:_.data[p],index:p}}),c=!yd(i,s),u=this._positionChanged(s,t);(c||u)&&(this._active=s,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,i=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,c=this._active||[],u=this._getActiveElements(e,c,t,i),o=this._positionChanged(u,e),p=t||!yd(u,c)||o;return p&&(this._active=u,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),p}_getActiveElements(e,t,i,s){const c=this.options;if(e.type==="mouseout")return[];if(!s)return t;const u=this.chart.getElementsAtEventForMode(e,c.mode,c,i);return c.reverse&&u.reverse(),u}_positionChanged(e,t){const{caretX:i,caretY:s,options:c}=this,u=Pu[c.position].call(this,e,t);return u!==!1&&(i!==u.x||s!==u.y)}}sm.positioners=Pu;var R6={id:"tooltip",_element:sm,positioners:Pu,afterInit(n,e,t){t&&(n.tooltip=new sm({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",t)===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:{beforeTitle:Qs,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,i=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return t[e.dataIndex]}return""},afterTitle:Qs,beforeBody:Qs,beforeLabel:Qs,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return yn(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:Qs,afterBody:Qs,beforeFooter:Qs,footer:Qs,afterFooter:Qs}},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},F6=Object.freeze({__proto__:null,Decimation:t6,Filler:x6,Legend:S6,SubTitle:T6,Title:D6,Tooltip:R6});const O6=(n,e,t,i)=>(typeof e=="string"?(t=n.push(e)-1,i.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function B6(n,e,t,i){const s=n.indexOf(e);if(s===-1)return O6(n,e,t,i);const c=n.lastIndexOf(e);return s!==c?t:s}const N6=(n,e)=>n===null?null:Ya(Math.round(n),0,e);class Dd extends gl{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const i=this.getLabels();for(const{index:s,label:c}of t)i[s]===c&&i.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(yn(e))return null;const i=this.getLabels();return t=isFinite(t)&&i[t]===e?t:B6(i,e,sn(t,e),this._addedLabels),N6(t,i.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:i,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(i=0),t||(s=this.getLabels().length-1)),this.min=i,this.max=s}buildTicks(){const e=this.min,t=this.max,i=this.options.offset,s=[];let c=this.getLabels();c=e===0&&t===c.length-1?c:c.slice(e,t+1),this._valueRange=Math.max(c.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let u=e;u<=t;u++)s.push({value:u});return s}getLabelForValue(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}Dd.id="category";Dd.defaults={ticks:{callback:Dd.prototype.getLabelForValue}};function V6(n,e){const t=[],{bounds:s,step:c,min:u,max:o,precision:p,count:_,maxTicks:v,maxDigits:M,includeBounds:S}=n,I=c||1,R=v-1,{min:G,max:Y}=e,X=!yn(u),oe=!yn(o),Q=!yn(_),ce=(Y-G)/(M+1);let De=M0((Y-G)/R/I)*I,Oe,Pe,Se,_e;if(De<1e-14&&!X&&!oe)return[{value:G},{value:Y}];_e=Math.ceil(Y/De)-Math.floor(G/De),_e>R&&(De=M0(_e*De/R/I)*I),yn(p)||(Oe=Math.pow(10,p),De=Math.ceil(De*Oe)/Oe),s==="ticks"?(Pe=Math.floor(G/De)*De,Se=Math.ceil(Y/De)*De):(Pe=G,Se=Y),X&&oe&&c&&Dk((o-u)/c,De/1e3)?(_e=Math.round(Math.min((o-u)/De,v)),De=(o-u)/_e,Pe=u,Se=o):Q?(Pe=X?u:Pe,Se=oe?o:Se,_e=_-1,De=(Se-Pe)/_e):(_e=(Se-Pe)/De,Du(_e,Math.round(_e),De/1e3)?_e=Math.round(_e):_e=Math.ceil(_e));const ze=Math.max(D0(De),D0(Pe));Oe=Math.pow(10,yn(p)?ze:p),Pe=Math.round(Pe*Oe)/Oe,Se=Math.round(Se*Oe)/Oe;let Re=0;for(X&&(S&&Pe!==u?(t.push({value:u}),Pe<u&&Re++,Du(Math.round((Pe+Re*De)*Oe)/Oe,u,P_(u,ce,n))&&Re++):Pe<u&&Re++);Re<_e;++Re)t.push({value:Math.round((Pe+Re*De)*Oe)/Oe});return oe&&S&&Se!==o?t.length&&Du(t[t.length-1].value,o,P_(o,ce,n))?t[t.length-1].value=o:t.push({value:o}):(!oe||Se===o)&&t.push({value:Se}),t}function P_(n,e,{horizontal:t,minRotation:i}){const s=ys(i),c=(t?Math.sin(s):Math.cos(s))||.001,u=.75*e*(""+n).length;return Math.min(e/c,u)}class Td extends gl{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return yn(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:i}=this.getUserBounds();let{min:s,max:c}=this;const u=p=>s=t?s:p,o=p=>c=i?c:p;if(e){const p=Rs(s),_=Rs(c);p<0&&_<0?o(0):p>0&&_>0&&u(0)}if(s===c){let p=1;(c>=Number.MAX_SAFE_INTEGER||s<=Number.MIN_SAFE_INTEGER)&&(p=Math.abs(c*.05)),o(c+p),e||u(s-p)}this.min=s,this.max=c}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:i}=e,s;return i?(s=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),t=t||11),t&&(s=Math.min(t,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let i=this.getTickLimit();i=Math.max(2,i);const s={maxTicks:i,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},c=this._range||this,u=V6(s,c);return e.bounds==="ticks"&&yy(u,this,"value"),e.reverse?(u.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),u}configure(){const e=this.ticks;let t=this.min,i=this.max;if(super.configure(),this.options.offset&&e.length){const s=(i-t)/Math.max(e.length-1,1)/2;t-=s,i+=s}this._startValue=t,this._endValue=i,this._valueRange=i-t}getLabelForValue(e){return Wu(e,this.chart.options.locale,this.options.ticks.format)}}class zm extends Td{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Pa(e)?e:0,this.max=Pa(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,i=ys(this.options.ticks.minRotation),s=(e?Math.sin(i):Math.cos(i))||.001,c=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,c.lineHeight/s))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}zm.id="linear";zm.defaults={ticks:{callback:Jd.formatters.numeric}};function A_(n){return n/Math.pow(10,Math.floor(ss(n)))===1}function H6(n,e){const t=Math.floor(ss(e.max)),i=Math.ceil(e.max/Math.pow(10,t)),s=[];let c=rs(n.min,Math.pow(10,Math.floor(ss(e.min)))),u=Math.floor(ss(c)),o=Math.floor(c/Math.pow(10,u)),p=u<0?Math.pow(10,Math.abs(u)):1;do s.push({value:c,major:A_(c)}),++o,o===10&&(o=1,++u,p=u>=0?1:p),c=Math.round(o*Math.pow(10,u)*p)/p;while(u<t||u===t&&o<i);const _=rs(n.max,c);return s.push({value:_,major:A_(c)}),s}class Rm extends gl{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const i=Td.prototype.parse.apply(this,[e,t]);if(i===0){this._zero=!0;return}return Pa(i)&&i>0?i:null}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Pa(e)?Math.max(0,e):null,this.max=Pa(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let i=this.min,s=this.max;const c=p=>i=e?i:p,u=p=>s=t?s:p,o=(p,_)=>Math.pow(10,Math.floor(ss(p))+_);i===s&&(i<=0?(c(1),u(10)):(c(o(i,-1)),u(o(s,1)))),i<=0&&c(o(s,-1)),s<=0&&u(o(i,1)),this._zero&&this.min!==this._suggestedMin&&i===o(this.min,0)&&c(o(i,-1)),this.min=i,this.max=s}buildTicks(){const e=this.options,t={min:this._userMin,max:this._userMax},i=H6(t,this);return e.bounds==="ticks"&&yy(i,this,"value"),e.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(e){return e===void 0?"0":Wu(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=ss(e),this._valueRange=ss(this.max)-ss(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(ss(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}Rm.id="logarithmic";Rm.defaults={ticks:{callback:Jd.formatters.logarithmic,major:{enabled:!0}}};function om(n){const e=n.ticks;if(e.display&&n.display){const t=vr(e.backdropPadding);return sn(e.font&&e.font.size,gn.font.size)+t.height}return 0}function j6(n,e,t){return t=Xn(t)?t:[t],{w:a4(n,e.string,t),h:t.length*e.lineHeight}}function I_(n,e,t,i,s){return n===i||n===s?{start:e-t/2,end:e+t/2}:n<i||n>s?{start:e-t,end:e}:{start:e,end:e+t}}function U6(n){const e={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},t=Object.assign({},e),i=[],s=[],c=n._pointLabels.length,u=n.options.pointLabels,o=u.centerPointLabels?oa/c:0;for(let p=0;p<c;p++){const _=u.setContext(n.getPointLabelContext(p));s[p]=_.padding;const v=n.getPointPosition(p,n.drawingArea+s[p],o),M=Ua(_.font),S=j6(n.ctx,M,n._pointLabels[p]);i[p]=S;const I=qr(n.getIndexAngle(p)+o),R=Math.round(vm(I)),G=I_(R,v.x,S.w,0,180),Y=I_(R,v.y,S.h,90,270);W6(t,e,I,G,Y)}n.setCenterPoint(e.l-t.l,t.r-e.r,e.t-t.t,t.b-e.b),n._pointLabelItems=q6(n,i,s)}function W6(n,e,t,i,s){const c=Math.abs(Math.sin(t)),u=Math.abs(Math.cos(t));let o=0,p=0;i.start<e.l?(o=(e.l-i.start)/c,n.l=Math.min(n.l,e.l-o)):i.end>e.r&&(o=(i.end-e.r)/c,n.r=Math.max(n.r,e.r+o)),s.start<e.t?(p=(e.t-s.start)/u,n.t=Math.min(n.t,e.t-p)):s.end>e.b&&(p=(s.end-e.b)/u,n.b=Math.max(n.b,e.b+p))}function q6(n,e,t){const i=[],s=n._pointLabels.length,c=n.options,u=om(c)/2,o=n.drawingArea,p=c.pointLabels.centerPointLabels?oa/s:0;for(let _=0;_<s;_++){const v=n.getPointPosition(_,o+u+t[_],p),M=Math.round(vm(qr(v.angle+ba))),S=e[_],I=$6(v.y,S.h,M),R=Z6(M),G=G6(v.x,S.w,R);i.push({x:v.x,y:I,textAlign:R,left:G,top:I,right:G+S.w,bottom:I+S.h})}return i}function Z6(n){return n===0||n===180?"center":n<180?"left":"right"}function G6(n,e,t){return t==="right"?n-=e:t==="center"&&(n-=e/2),n}function $6(n,e,t){return t===90||t===270?n-=e/2:(t>270||t<90)&&(n-=e),n}function K6(n,e){const{ctx:t,options:{pointLabels:i}}=n;for(let s=e-1;s>=0;s--){const c=i.setContext(n.getPointLabelContext(s)),u=Ua(c.font),{x:o,y:p,textAlign:_,left:v,top:M,right:S,bottom:I}=n._pointLabelItems[s],{backdropColor:R}=c;if(!yn(R)){const G=hl(c.borderRadius),Y=vr(c.backdropPadding);t.fillStyle=R;const X=v-Y.left,oe=M-Y.top,Q=S-v+Y.width,ce=I-M+Y.height;Object.values(G).some(De=>De!==0)?(t.beginPath(),Bu(t,{x:X,y:oe,w:Q,h:ce,radius:G}),t.fill()):t.fillRect(X,oe,Q,ce)}pl(t,n._pointLabels[s],o,p+u.lineHeight/2,u,{color:c.color,textAlign:_,textBaseline:"middle"})}}function db(n,e,t,i){const{ctx:s}=n;if(t)s.arc(n.xCenter,n.yCenter,e,0,Nn);else{let c=n.getPointPosition(0,e);s.moveTo(c.x,c.y);for(let u=1;u<i;u++)c=n.getPointPosition(u,e),s.lineTo(c.x,c.y)}}function Y6(n,e,t,i){const s=n.ctx,c=e.circular,{color:u,lineWidth:o}=e;!c&&!i||!u||!o||t<0||(s.save(),s.strokeStyle=u,s.lineWidth=o,s.setLineDash(e.borderDash),s.lineDashOffset=e.borderDashOffset,s.beginPath(),db(n,t,c,i),s.closePath(),s.stroke(),s.restore())}function J6(n,e,t){return Ho(n,{label:t,index:e,type:"pointLabel"})}class Zu extends Td{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=vr(om(this.options)/2),t=this.width=this.maxWidth-e.width,i=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+i/2+e.top),this.drawingArea=Math.floor(Math.min(t,i)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=Pa(e)&&!isNaN(e)?e:0,this.max=Pa(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/om(this.options))}generateTickLabels(e){Td.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((t,i)=>{const s=Jn(this.options.pointLabels.callback,[t,i],this);return s||s===0?s:""}).filter((t,i)=>this.chart.getDataVisibility(i))}fit(){const e=this.options;e.display&&e.pointLabels.display?U6(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,i,s){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((i-s)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,i,s))}getIndexAngle(e){const t=Nn/(this._pointLabels.length||1),i=this.options.startAngle||0;return qr(e*t+ys(i))}getDistanceFromCenterForValue(e){if(yn(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(yn(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const i=t[e];return J6(this.getContext(),e,i)}}getPointPosition(e,t,i=0){const s=this.getIndexAngle(e)-ba+i;return{x:Math.cos(s)*t+this.xCenter,y:Math.sin(s)*t+this.yCenter,angle:s}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:i,right:s,bottom:c}=this._pointLabelItems[e];return{left:t,top:i,right:s,bottom:c}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const i=this.ctx;i.save(),i.beginPath(),db(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),i.closePath(),i.fillStyle=e,i.fill(),i.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:i,grid:s}=t,c=this._pointLabels.length;let u,o,p;if(t.pointLabels.display&&K6(this,c),s.display&&this.ticks.forEach((_,v)=>{if(v!==0){o=this.getDistanceFromCenterForValue(_.value);const M=s.setContext(this.getContext(v-1));Y6(this,M,o,c)}}),i.display){for(e.save(),u=c-1;u>=0;u--){const _=i.setContext(this.getPointLabelContext(u)),{color:v,lineWidth:M}=_;!M||!v||(e.lineWidth=M,e.strokeStyle=v,e.setLineDash(_.borderDash),e.lineDashOffset=_.borderDashOffset,o=this.getDistanceFromCenterForValue(t.ticks.reverse?this.min:this.max),p=this.getPointPosition(u,o),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(p.x,p.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,i=t.ticks;if(!i.display)return;const s=this.getIndexAngle(0);let c,u;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(s),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((o,p)=>{if(p===0&&!t.reverse)return;const _=i.setContext(this.getContext(p)),v=Ua(_.font);if(c=this.getDistanceFromCenterForValue(this.ticks[p].value),_.showLabelBackdrop){e.font=v.string,u=e.measureText(o.label).width,e.fillStyle=_.backdropColor;const M=vr(_.backdropPadding);e.fillRect(-u/2-M.left,-c-v.size/2-M.top,u+M.width,v.size+M.height)}pl(e,o.label,0,-c,v,{color:_.color})}),e.restore()}drawTitle(){}}Zu.id="radialLinear";Zu.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Jd.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(n){return n},padding:5,centerPointLabels:!1}};Zu.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};Zu.descriptors={angleLines:{_fallback:"grid"}};const nf={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Lr=Object.keys(nf);function X6(n,e){return n-e}function E_(n,e){if(yn(e))return null;const t=n._adapter,{parser:i,round:s,isoWeekday:c}=n._parseOpts;let u=e;return typeof i=="function"&&(u=i(u)),Pa(u)||(u=typeof i=="string"?t.parse(u,i):t.parse(u)),u===null?null:(s&&(u=s==="week"&&(nc(c)||c===!0)?t.startOf(u,"isoWeek",c):t.startOf(u,s)),+u)}function L_(n,e,t,i){const s=Lr.length;for(let c=Lr.indexOf(n);c<s-1;++c){const u=nf[Lr[c]],o=u.steps?u.steps:Number.MAX_SAFE_INTEGER;if(u.common&&Math.ceil((t-e)/(o*u.size))<=i)return Lr[c]}return Lr[s-1]}function Q6(n,e,t,i,s){for(let c=Lr.length-1;c>=Lr.indexOf(t);c--){const u=Lr[c];if(nf[u].common&&n._adapter.diff(s,i,u)>=e-1)return u}return Lr[t?Lr.indexOf(t):0]}function eD(n){for(let e=Lr.indexOf(n)+1,t=Lr.length;e<t;++e)if(nf[Lr[e]].common)return Lr[e]}function z_(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:i,hi:s}=xm(t,e),c=t[i]>=e?t[i]:t[s];n[c]=!0}}function tD(n,e,t,i){const s=n._adapter,c=+s.startOf(e[0].value,i),u=e[e.length-1].value;let o,p;for(o=c;o<=u;o=+s.add(o,1,i))p=t[o],p>=0&&(e[p].major=!0);return e}function R_(n,e,t){const i=[],s={},c=e.length;let u,o;for(u=0;u<c;++u)o=e[u],s[o]=u,i.push({value:o,major:!1});return c===0||!t?i:tD(n,i,s,t)}class Gu extends gl{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t){const i=e.time||(e.time={}),s=this._adapter=new HS._date(e.adapters.date);s.init(t),Mu(i.displayFormats,s.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:E_(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,i=e.time.unit||"day";let{min:s,max:c,minDefined:u,maxDefined:o}=this.getUserBounds();function p(_){!u&&!isNaN(_.min)&&(s=Math.min(s,_.min)),!o&&!isNaN(_.max)&&(c=Math.max(c,_.max))}(!u||!o)&&(p(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&p(this.getMinMax(!1))),s=Pa(s)&&!isNaN(s)?s:+t.startOf(Date.now(),i),c=Pa(c)&&!isNaN(c)?c:+t.endOf(Date.now(),i)+1,this.min=Math.min(s,c-1),this.max=Math.max(s+1,c)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],i=e[e.length-1]),{min:t,max:i}}buildTicks(){const e=this.options,t=e.time,i=e.ticks,s=i.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const c=this.min,u=this.max,o=Ak(s,c,u);return this._unit=t.unit||(i.autoSkip?L_(t.minUnit,this.min,this.max,this._getLabelCapacity(c)):Q6(this,o.length,t.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:eD(this._unit),this.initOffsets(s),e.reverse&&o.reverse(),R_(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e){let t=0,i=0,s,c;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?t=1-s:t=(this.getDecimalForValue(e[1])-s)/2,c=this.getDecimalForValue(e[e.length-1]),e.length===1?i=c:i=(c-this.getDecimalForValue(e[e.length-2]))/2);const u=e.length<3?.5:.25;t=Ya(t,0,u),i=Ya(i,0,u),this._offsets={start:t,end:i,factor:1/(t+1+i)}}_generate(){const e=this._adapter,t=this.min,i=this.max,s=this.options,c=s.time,u=c.unit||L_(c.minUnit,t,i,this._getLabelCapacity(t)),o=sn(c.stepSize,1),p=u==="week"?c.isoWeekday:!1,_=nc(p)||p===!0,v={};let M=t,S,I;if(_&&(M=+e.startOf(M,"isoWeek",p)),M=+e.startOf(M,_?"day":u),e.diff(i,t,u)>1e5*o)throw new Error(t+" and "+i+" are too far apart with stepSize of "+o+" "+u);const R=s.ticks.source==="data"&&this.getDataTimestamps();for(S=M,I=0;S<i;S=+e.add(S,o,u),I++)z_(v,S,R);return(S===i||s.bounds==="ticks"||I===1)&&z_(v,S,R),Object.keys(v).sort((G,Y)=>G-Y).map(G=>+G)}getLabelForValue(e){const t=this._adapter,i=this.options.time;return i.tooltipFormat?t.format(e,i.tooltipFormat):t.format(e,i.displayFormats.datetime)}_tickFormatFunction(e,t,i,s){const c=this.options,u=c.time.displayFormats,o=this._unit,p=this._majorUnit,_=o&&u[o],v=p&&u[p],M=i[t],S=p&&v&&M&&M.major,I=this._adapter.format(e,s||(S?v:_)),R=c.ticks.callback;return R?Jn(R,[I,t,i],this):I}generateTickLabels(e){let t,i,s;for(t=0,i=e.length;t<i;++t)s=e[t],s.label=this._tickFormatFunction(s.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,i=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+i)*t.factor)}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+i*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,i=this.ctx.measureText(e).width,s=ys(this.isHorizontal()?t.maxRotation:t.minRotation),c=Math.cos(s),u=Math.sin(s),o=this._resolveTickFontOptions(0).size;return{w:i*c+o*u,h:i*u+o*c}}_getLabelCapacity(e){const t=this.options.time,i=t.displayFormats,s=i[t.unit]||i.millisecond,c=this._tickFormatFunction(e,0,R_(this,[e],this._majorUnit),s),u=this._getLabelSize(c),o=Math.floor(this.isHorizontal()?this.width/u.w:this.height/u.h)-1;return o>0?o:1}getDataTimestamps(){let e=this._cache.data||[],t,i;if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(t=0,i=s.length;t<i;++t)e=e.concat(s[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,i;if(e.length)return e;const s=this.getLabels();for(t=0,i=s.length;t<i;++t)e.push(E_(this,s[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return xy(e.sort(X6))}}Gu.id="time";Gu.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}};function od(n,e,t){let i=0,s=n.length-1,c,u,o,p;t?(e>=n[i].pos&&e<=n[s].pos&&({lo:i,hi:s}=ro(n,"pos",e)),{pos:c,time:o}=n[i],{pos:u,time:p}=n[s]):(e>=n[i].time&&e<=n[s].time&&({lo:i,hi:s}=ro(n,"time",e)),{time:c,pos:o}=n[i],{time:u,pos:p}=n[s]);const _=u-c;return _?o+(p-o)*(e-c)/_:o}class Fm extends Gu{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=od(t,this.min),this._tableRange=od(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:i}=this,s=[],c=[];let u,o,p,_,v;for(u=0,o=e.length;u<o;++u)_=e[u],_>=t&&_<=i&&s.push(_);if(s.length<2)return[{time:t,pos:0},{time:i,pos:1}];for(u=0,o=s.length;u<o;++u)v=s[u+1],p=s[u-1],_=s[u],Math.round((v+p)/2)!==_&&c.push({time:_,pos:u/(o-1)});return c}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),i=this.getLabelTimestamps();return t.length&&i.length?e=this.normalize(t.concat(i)):e=t.length?t:i,e=this._cache.all=e,e}getDecimalForValue(e){return(od(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return od(this._table,i*this._tableRange+this._minPos,!0)}}Fm.id="timeseries";Fm.defaults=Gu.defaults;var iD=Object.freeze({__proto__:null,CategoryScale:Dd,LinearScale:zm,LogarithmicScale:Rm,RadialLinearScale:Zu,TimeScale:Gu,TimeSeriesScale:Fm});const nD=[VS,JM,F6,iD];ec==null||ec.register(...nD??[]);class sa{}ft(sa,"unknownColor","rgba(128, 128, 128, 0.2)"),ft(sa,"unknownBorderColor","rgba(128, 128, 128, 0.2)"),ft(sa,"otherColor","rgba(128, 128, 128, 0.2)"),ft(sa,"otherBorderColor","rgba(128, 128, 255)"),ft(sa,"notApplicableColor","rgba(128, 128, 128, 0.2)"),ft(sa,"notApplicableBorderColor","rgba(255, 0, 0)"),ft(sa,"backgroundColors",["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)"]),ft(sa,"borderColors",["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"]);class af extends Hu{constructor(t){super();ft(this,"_config");this._config=t}static ConstructDoughnut(t){const i=[],s=[];let c=0;const u=sa.borderColors,o=sa.backgroundColors;for(const _ in t)_===""?(i.push(sa.unknownBorderColor),s.push(sa.unknownColor)):(i.push(u[c%u.length]),s.push(o[c%o.length]),c++);const p={type:"doughnut",data:{labels:Object.keys(t),datasets:[{data:Object.values(t),backgroundColor:s,borderColor:i,borderWidth:1,label:void 0}]},options:{plugins:{legend:{display:!1}}}};return new af(p)}InnerConstructElement(){var i;const t=document.createElement("canvas");if(this.style!==void 0&&(t.style.cssText=this.style),((i=this.clss)==null?void 0:i.size)>0)try{t.classList.add(...Array.from(this.clss))}catch(s){console.error("Invalid class name detected in:",Array.from(this.clss).join(" "),`
Err msg is `,s)}return new ec(t,this._config),t}}class fb extends af{constructor(e,t,i){var M;const{labels:s,data:c}=Om.extractDataAndLabels(e,t,{sort:!0,groupToOtherCutoff:i==null?void 0:i.groupToOtherCutoff,hideNotApplicable:i==null?void 0:i.hideNotApplicable,hideUnkown:i==null?void 0:i.hideUnknown});if(s===void 0||c===void 0)throw console.error("Could not extract data and labels for ",e," with features",t,": no labels or no data"),"No labels or data given...";for(let S=s.length;S>=0;S--)((M=c[S])==null?void 0:M.length)==0&&(c.splice(S,1),s.splice(S,1));const u=[];let p=fb.getAllDays(t).map(S=>S.substr(0,10));(i==null?void 0:i.period)==="month"&&(p=p.map(S=>S.substr(0,7))),p=Gn.Dedup(p);for(let S=0;S<s.length;S++){const I=s[S],R=c[S],G={};for(const oe of R){const Q=new Date(oe.properties.date);Gn.SetMidnight(Q);let ce=Q.toISOString();ce=ce.substr(0,10),(i==null?void 0:i.period)==="month"&&(ce=ce.substr(0,7)),G[ce]===void 0?G[ce]=[oe]:G[ce].push(oe)}const Y=[];for(let oe=0;oe<p.length;oe++){const Q=p[oe],ce=G[Q];if(ce)if(i.sumFields!==void 0){let De=0;for(const Oe of ce){const Pe=Oe.properties;for(const Se of i.sumFields){if(!Pe[Se])continue;const _e=Number(Pe[Se]);isNaN(_e)||(De+=_e)}}Y[oe]=De}else Y[oe]=(ce==null?void 0:ce.length)??0}let X=sa.borderColors[S%sa.borderColors.length];I==="Unknown"&&(X=sa.unknownBorderColor),I==="Other"&&(X=sa.otherBorderColor),u.push({data:Y,backgroundColor:X,label:I})}const v={type:"bar",data:{labels:p,datasets:u},options:{responsive:!0,legend:{display:!1},scales:{x:{stacked:!0},y:{stacked:!0}}}};super(v)}static getAllDays(e){let t,i,s=new Set;for(e.forEach(u=>{const o=new Date(u.properties.date);Gn.SetMidnight(o),(t===void 0||o<t)&&(t=o),(i===void 0||o>i)&&(i=o),s.add(o.toISOString())});t<i;)t.setDate(t.getDate()+1),s.add(t.toISOString());const c=Array.from(s);return c.sort(),c}}class Om extends dm{constructor(e,t,i){var M,S,I;if(((M=t.mappings)==null?void 0:M.length)===0&&((S=t.freeform)==null?void 0:S.key)===void 0){super([]),this.SetClass("hidden");return}const{labels:s,data:c}=Om.extractDataAndLabels(t,e,i);if(s===void 0||c===void 0){super([]),this.SetClass("hidden");return}const u=[sa.unknownBorderColor,sa.otherBorderColor,sa.notApplicableBorderColor],o=[sa.unknownColor,sa.otherColor,sa.notApplicableColor];for(;u.length<c.length;)u.push(...sa.borderColors),o.push(...sa.backgroundColors);for(let R=c.length;R>=0;R--)((I=c[R])==null?void 0:I.length)===0&&(s.splice(R,1),c.splice(R,1),u.splice(R,1),o.splice(R,1));let p=t.multiAnswer;s.length>9&&(p=!0);const _={type:i.chartType??(p?"bar":"doughnut"),data:{labels:s,datasets:[{data:c.map(R=>R.length),backgroundColor:o,borderColor:u,borderWidth:1,label:void 0}]},options:{plugins:{legend:{display:!p}}}},v=new af(_).SetClass((i==null?void 0:i.chartclasses)??"w-32 h-32");i.chartstyle!==void 0&&v.SetStyle(i.chartstyle),super([i!=null&&i.includeTitle?t.question.Clone()??t.id:void 0,v]),this.SetClass("block")}static extractDataAndLabels(e,t,i){var G;const s=e.mappings??[];i=i??{};let c=[];const u=s.map(Y=>[]),o={};let p=[];for(const Y of t){const X=Y.properties;if(e.condition!==void 0&&!e.condition.matchesProperties(X)){p.push(Y);continue}if(!e.IsKnown(X)){c.push(Y);continue}let oe=!1;if(e.multiAnswer)for(let Q=0;Q<s.length;Q++){const ce=s[Q];_s.MatchesMultiAnswer(ce.if,X)&&(u[Q].push(Y),oe=!0)}else for(let Q=0;Q<s.length;Q++)if(s[Q].if.matchesProperties(X)){u[Q].push(Y),oe=!0;break}if(!oe)if(((G=e.freeform)==null?void 0:G.key)!==void 0&&X[e.freeform.key]!==void 0){const Q=X[e.freeform.key];o[Q]=o[Q]??[],o[Q].push(Y)}else c.push(Y)}if(c.length+p.length===t.length)return console.log("Returning no label nor data: all features are unkown or notApplicable"),{labels:void 0,data:void 0};let _=[];const v=[],M=[],S=[];for(const Y in o)S.push([Y,o[Y]]);i!=null&&i.sort&&S.sort((Y,X)=>X[1].length-Y[1].length);for(const[Y,X]of S)X.length>=(i.groupToOtherCutoff??3)?(v.push(Y),M.push(o[Y])):_.push(...X);const I=[],R=[];return i.hideUnkown||(R.push(c),I.push("Unknown")),R.push(_),I.push("Other"),i.hideNotApplicable||(R.push(p),I.push("Not applicable")),R.push(...u,...M),I.push(...(s==null?void 0:s.map(Y=>Y.then.txt))??[],...v),{labels:I,data:R}}}function F_(n,e,t){const i=n.slice();return i[9]=e[t],i}function O_(n){let e;return{c(){e=mt("div"),e.textContent="/",he(e,"class","bold px-2")},m(t,i){at(t,e,i)},d(t){t&&nt(e)}}}function aD(n){let e,t;return e=new fa({props:{t:n[9].human.Subs({quantity:""})}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s&1&&(c.t=i[9].human.Subs({quantity:""})),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function rD(n){let e,t;return e=new fa({props:{t:n[9].humanSingular}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s&1&&(c.t=i[9].humanSingular),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function B_(n,e){let t,i,s,c,u,o;const p=[rD,aD],_=[];function v(M,S){return M[3]||M[0].inverted?0:1}return i=v(e),s=_[i]=p[i](e),{key:n,first:null,c(){t=mt("option"),s.c(),c=Jt(),t.__value=u=e[9].canonical,t.value=t.__value,this.first=t},m(M,S){at(M,t,S),_[i].m(t,null),ve(t,c),o=!0},p(M,S){e=M;let I=i;i=v(e),i===I?_[i].p(e,S):(Qi(),He(_[I],1,1,()=>{_[I]=null}),en(),s=_[i],s?s.p(e,S):(s=_[i]=p[i](e),s.c()),Fe(s,1),s.m(t,c)),(!o||S&1&&u!==(u=e[9].canonical))&&(t.__value=u,t.value=t.__value)},i(M){o||(Fe(s),o=!0)},o(M){He(s),o=!1},d(M){M&&nt(t),_[i].d()}}}function sD(n){let e,t,i=[],s=new Map,c,u,o,p=n[0].inverted&&O_(),_=n[0].denominations;const v=M=>M[9].canonical;for(let M=0;M<_.length;M+=1){let S=F_(n,_,M),I=v(S);s.set(I,i[M]=B_(I,S))}return{c(){p&&p.c(),e=Jt(),t=mt("select");for(let M=0;M<i.length;M+=1)i[M].c();n[2]===void 0&&Od(()=>n[8].call(t))},m(M,S){p&&p.m(M,S),at(M,e,S),at(M,t,S);for(let I=0;I<i.length;I+=1)i[I]&&i[I].m(t,null);Fo(t,n[2],!0),c=!0,u||(o=xt(t,"change",n[8]),u=!0)},p(M,[S]){M[0].inverted?p||(p=O_(),p.c(),p.m(e.parentNode,e)):p&&(p.d(1),p=null),S&9&&(_=M[0].denominations,Qi(),i=B2(i,S,v,1,M,_,s,t,N2,B_,null,F_),en()),S&5&&Fo(t,M[2])},i(M){if(!c){for(let S=0;S<_.length;S+=1)Fe(i[S]);c=!0}},o(M){for(let S=0;S<i.length;S+=1)He(i[S]);c=!1},d(M){p&&p.d(M),M&&nt(e),M&&nt(t);for(let S=0;S<i.length;S+=1)i[S].d();u=!1,o()}}}function oD(n,e,t){let i,s=ci,c=()=>(s(),s=Vo(M,R=>t(2,i=R)),M),u;n.$$.on_destroy.push(()=>s());let{unit:o}=e,{textValue:p}=e,{upstreamValue:_}=e,v=p.map(R=>Number(R)===1);ya(n,v,R=>t(3,u=R));let{selectedUnit:M=new ki(void 0)}=e;c();let{getCountry:S=()=>"?"}=e;sc(()=>{if(console.log("Setting selected unit based on country",S(),_.data),_.data===void 0||_.data===""){let R=o.getDefaultDenomination(S);console.log("Found denom",R.canonical),M.setData(R.canonical)}}),$r(_.addCallbackAndRun(R=>{if(R===void 0||R==="")return;let G=o.getDefaultDenomination(S);const Y=o.findDenomination(R,S);Y&&(G=Y[1]),M.setData(G.canonical)})),$r(p.addCallbackAndRunD(R=>{const[G,Y]=o.findDenomination(R,S);G===void 0||Y===void 0||G!==R&&(p.setData(G),M.setData(Y.canonical))}));function I(){i=Bd(this),M.set(i),t(0,o)}return n.$$set=R=>{"unit"in R&&t(0,o=R.unit),"textValue"in R&&t(5,p=R.textValue),"upstreamValue"in R&&t(6,_=R.upstreamValue),"selectedUnit"in R&&c(t(1,M=R.selectedUnit)),"getCountry"in R&&t(7,S=R.getCountry)},[o,M,i,u,v,p,_,S,I]}class lD extends Zi{constructor(e){super(),Gi(this,e,oD,sD,$i,{unit:0,textValue:5,upstreamValue:6,selectedUnit:1,getCountry:7})}}function cD(n){let e,t,i,s,c,u,o,p,_,v=!n[9]&&N_(),M=n[2]!==void 0&&V_(n);return{c(){var S;e=mt("div"),t=mt("input"),s=Jt(),v&&v.c(),c=Jt(),M&&M.c(),he(t,"class","w-full"),he(t,"inputmode",i=((S=n[5])==null?void 0:S.inputmode)??"text"),he(t,"placeholder",n[7]),he(e,"class",u=tc("inline-flex",n[0]))},m(S,I){at(S,e,I),ve(e,t),n[19](t),Oo(t,n[8]),ve(e,s),v&&v.m(e,null),ve(e,c),M&&M.m(e,null),o=!0,p||(_=[xt(t,"input",n[20]),xt(t,"keypress",n[11])],p=!0)},p(S,I){var R;(!o||I&32&&i!==(i=((R=S[5])==null?void 0:R.inputmode)??"text"))&&he(t,"inputmode",i),(!o||I&128)&&he(t,"placeholder",S[7]),I&256&&t.value!==S[8]&&Oo(t,S[8]),S[9]?v&&(Qi(),He(v,1,1,()=>{v=null}),en()):v?I&512&&Fe(v,1):(v=N_(),v.c(),Fe(v,1),v.m(e,c)),S[2]!==void 0?M?(M.p(S,I),I&4&&Fe(M,1)):(M=V_(S),M.c(),Fe(M,1),M.m(e,null)):M&&(Qi(),He(M,1,1,()=>{M=null}),en()),(!o||I&1&&u!==(u=tc("inline-flex",S[0])))&&he(e,"class",u)},i(S){o||(Fe(v),Fe(M),o=!0)},o(S){He(v),He(M),o=!1},d(S){S&&nt(e),n[19](null),v&&v.d(),M&&M.d(),p=!1,rr(_)}}}function uD(n){let e,t,i,s;return{c(){var c;e=mt("textarea"),he(e,"class","w-full"),he(e,"inputmode",t=((c=n[5])==null?void 0:c.inputmode)??"text"),he(e,"placeholder",n[7])},m(c,u){at(c,e,u),Oo(e,n[8]),n[18](e),i||(s=[xt(e,"input",n[17]),xt(e,"keypress",n[11])],i=!0)},p(c,u){var o;u&32&&t!==(t=((o=c[5])==null?void 0:o.inputmode)??"text")&&he(e,"inputmode",t),u&128&&he(e,"placeholder",c[7]),u&256&&Oo(e,c[8])},i:ci,o:ci,d(c){c&&nt(e),n[18](null),i=!1,rr(s)}}}function N_(n){let e,t;return e=new Bx({props:{class:"-ml-6 h-6 w-6"}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function V_(n){let e,t;return e=new lD({props:{unit:n[2],selectedUnit:n[10],textValue:n[4],upstreamValue:n[3],getCountry:n[1]}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s&4&&(c.unit=i[2]),s&16&&(c.textValue=i[4]),s&8&&(c.upstreamValue=i[3]),s&2&&(c.getCountry=i[1]),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function hD(n){let e,t,i,s;const c=[uD,cD],u=[];function o(p,_){var v;return(v=p[5])!=null&&v.textArea?0:1}return e=o(n),t=u[e]=c[e](n),{c(){t.c(),i=$n()},m(p,_){u[e].m(p,_),at(p,i,_),s=!0},p(p,[_]){let v=e;e=o(p),e===v?u[e].p(p,_):(Qi(),He(u[v],1,1,()=>{u[v]=null}),en(),t=u[e],t?t.p(p,_):(t=u[e]=c[e](p),t.c()),Fe(t,1),t.m(i.parentNode,i))},i(p){s||(Fe(t),s=!0)},o(p){He(t),s=!1},d(p){u[e].d(p),p&&nt(i)}}}function dD(n,e,t){let i,s=ci,c=()=>(s(),s=Vo(G,Xe=>t(8,i=Xe)),G),u;n.$$.on_destroy.push(()=>s());let{type:o}=e,{feedback:p=void 0}=e,{cls:_=void 0}=e,{getCountry:v=void 0}=e,{placeholder:M=void 0}=e,{autofocus:S=!1}=e,{unit:I=void 0}=e,{value:R}=e,{unvalidatedText:G=new ki(R.data??"")}=e;if(c(),G==R)throw"Value and unvalidatedText may not be the same store!";let Y=np.get(o??"string");Y===void 0&&console.warn("Didn't find a validator for type",o);let X=new ki(void 0),oe=M??(Y==null?void 0:Y.getPlaceholder())??o;function Q(){if(I&&R.data){const[Xe,si]=I==null?void 0:I.findDenomination(R.data,v);si?(G.setData(Xe),X.setData(si.canonical)):G.setData(R.data??"")}else G.setData(R.data??"")}function ce(Xe){Xe.key==="Enter"&&(!Y.textArea||Xe.ctrlKey)&&(Xe.stopPropagation(),Xe.preventDefault(),Se("submit"))}Q();function De(){const Xe=G.data;if(Xe===""){R.setData(void 0),p==null||p.setData(void 0);return}if(p==null||p.setData(Y==null?void 0:Y.getFeedback(Xe,v)),!(Y!=null&&Y.isValid(Xe,v))){R.setData(void 0);return}X.data?R.setData(I.toOsm(Xe,X.data)):R.setData(Xe)}if($r(G.addCallbackAndRun(Xe=>De())),I===void 0&&$r(R.addCallbackAndRunD(Xe=>{G.data!==Xe&&Xe!==""&&G.setData(Xe)})),$r(X.addCallback(Xe=>De())),Y===void 0)throw"Not a valid type (no validator found) for type '"+o+"'; did you perhaps mean one of: "+Gn.sortedByLevenshteinDistance(o,np.AllValidators.map(Xe=>Xe.name),Xe=>Xe).slice(0,5).join(", ");const Oe=G.map(Xe=>(Y==null?void 0:Y.isValid(Xe,v))??!0);ya(n,Oe,Xe=>t(9,u=Xe));let Pe,Se=Fd();function _e(){i=this.value,G.set(i)}function ze(Xe){Fs[Xe?"unshift":"push"](()=>{Pe=Xe,t(6,Pe),t(23,Se),t(16,S)})}function Re(Xe){Fs[Xe?"unshift":"push"](()=>{Pe=Xe,t(6,Pe),t(23,Se),t(16,S)})}function Ye(){i=this.value,G.set(i)}return n.$$set=Xe=>{"type"in Xe&&t(13,o=Xe.type),"feedback"in Xe&&t(14,p=Xe.feedback),"cls"in Xe&&t(0,_=Xe.cls),"getCountry"in Xe&&t(1,v=Xe.getCountry),"placeholder"in Xe&&t(15,M=Xe.placeholder),"autofocus"in Xe&&t(16,S=Xe.autofocus),"unit"in Xe&&t(2,I=Xe.unit),"value"in Xe&&t(3,R=Xe.value),"unvalidatedText"in Xe&&c(t(4,G=Xe.unvalidatedText))},n.$$.update=()=>{var Xe;n.$$.dirty&57394&&(t(5,Y=np.get(o??"string")),t(7,oe=M??(Y==null?void 0:Y.getPlaceholder())??o),((Xe=G.data)==null?void 0:Xe.length)>0?p==null||p.setData(Y==null?void 0:Y.getFeedback(G.data,v)):p==null||p.setData(void 0),Q()),n.$$.dirty&65600&&Pe!==void 0&&(t(6,Pe.onfocus=()=>Se("selected"),Pe),S&&Gn.focusOn(Pe))},[_,v,I,R,G,Y,Pe,oe,i,u,X,ce,Oe,o,p,M,S,_e,ze,Re,Ye]}class lm extends Zi{constructor(e){super(),Gi(this,e,dD,hD,$i,{type:13,feedback:14,cls:0,getCountry:1,placeholder:15,autofocus:16,unit:2,value:3,unvalidatedText:4})}}class cm{static constructMapProperties(e){var c,u;let t=(c=e==null?void 0:e.mapProperties)==null?void 0:c.location;if(!t){const[o,p]=F2.centerpointCoordinates(e.feature);t=new ki({lon:o,lat:p})}let i=(e==null?void 0:e.mapProperties)??{location:t};i.location||(i={...i,location:t});let s=17;if(((u=e==null?void 0:e.args)==null?void 0:u[0])!==void 0&&(s=Number(e.args[0]),isNaN(s)))throw"Invalid zoom level for argument at 'length'-input";return i.zoom||(i={...i,zoom:new ki(s)}),i.rasterLayer,i}}ft(cm,"hideInputField",["translation","simple_tag","tag"]);function fD(n){let e,t;return{c(){e=mt("img"),Vp(e.src,t=n[1])||he(e,"src",t)},m(i,s){at(i,e,s)},p(i,[s]){s&2&&!Vp(e.src,t=i[1])&&he(e,"src",t)},i:ci,o:ci,d(i){i&&nt(e)}}}function pD(n,e,t){let i,s=ci,c=()=>(s(),s=Vo(u,o=>t(1,i=o)),u);n.$$.on_destroy.push(()=>s());let{value:u}=e;return c(),n.$$set=o=>{"value"in o&&c(t(0,u=o.value))},[u,i]}class mD extends Zi{constructor(e){super(),Gi(this,e,pD,fD,$i,{value:0})}}function H_(n,e,t){const i=n.slice();return i[16]=e[t],i}function j_(n,e,t){const i=n.slice();return i[19]=e[t],i}function U_(n){let e;return{c(){e=Sn("*")},m(t,i){at(t,e,i)},d(t){t&&nt(e)}}}function W_(n){var o;let e,t=n[19]+"",i,s,c,u=((o=n[2])==null?void 0:o[n[19]])!==void 0&&U_();return{c(){e=mt("option"),i=Sn(t),s=Jt(),u&&u.c(),c=Jt(),e.__value=n[19],e.value=e.__value},m(p,_){at(p,e,_),ve(e,i),ve(e,s),u&&u.m(e,null),ve(e,c)},p(p,_){var v;((v=p[2])==null?void 0:v[p[19]])!==void 0?u||(u=U_(),u.c(),u.m(e,c)):u&&(u.d(1),u=null)},d(p){p&&nt(e),u&&u.d()}}}function q_(n){let e,t,i,s=n[16]+"",c,u,o,p=n[2][n[16]]+"",_,v,M,S;function I(){return n[14](n[16])}return{c(){e=mt("li"),t=mt("button"),i=mt("b"),c=Sn(s),u=Sn(":"),o=Jt(),_=Sn(p),v=Jt(),he(t,"class","small")},m(R,G){at(R,e,G),ve(e,t),ve(t,i),ve(i,c),ve(i,u),ve(t,o),ve(t,_),ve(e,v),M||(S=xt(t,"click",I),M=!0)},p(R,G){n=R,G&4&&s!==(s=n[16]+"")&&br(c,s),G&4&&p!==(p=n[2][n[16]]+"")&&br(_,p)},d(R){R&&nt(e),M=!1,S()}}}function gD(n){let e,t,i,s,c,u,o,p,_,v,M,S,I,R,G=n[5],Y=[];for(let Q=0;Q<G.length;Q+=1)Y[Q]=W_(j_(n,G,Q));o=new lm({props:{type:"string",cls:"w-full",value:n[7],unvalidatedText:n[8]}}),o.$on("submit",n[13]);let X=Object.keys(n[2]),oe=[];for(let Q=0;Q<X.length;Q+=1)oe[Q]=q_(H_(n,X,Q));return{c(){e=mt("div"),t=mt("div"),i=mt("span"),i.textContent=`${n[3]}`,s=Jt(),c=mt("select");for(let Q=0;Q<Y.length;Q+=1)Y[Q].c();u=Jt(),jt(o.$$.fragment),p=Jt(),_=mt("span"),_.textContent=`${n[4]}`,v=Sn(`
  You have currently set translations for
  `),M=mt("ul");for(let Q=0;Q<oe.length;Q+=1)oe[Q].c();n[1]===void 0&&Od(()=>n[12].call(c)),he(t,"class","interactive m-1 mt-2 flex space-x-1 font-bold"),he(e,"class","flex flex-col gap-y-1")},m(Q,ce){at(Q,e,ce),ve(e,t),ve(t,i),ve(t,s),ve(t,c);for(let De=0;De<Y.length;De+=1)Y[De]&&Y[De].m(c,null);Fo(c,n[1],!0),ve(t,u),Ut(o,t,null),ve(t,p),ve(t,_),ve(e,v),ve(e,M);for(let De=0;De<oe.length;De+=1)oe[De]&&oe[De].m(M,null);S=!0,I||(R=xt(c,"change",n[12]),I=!0)},p(Q,[ce]){if(ce&36){G=Q[5];let De;for(De=0;De<G.length;De+=1){const Oe=j_(Q,G,De);Y[De]?Y[De].p(Oe,ce):(Y[De]=W_(Oe),Y[De].c(),Y[De].m(c,null))}for(;De<Y.length;De+=1)Y[De].d(1);Y.length=G.length}if(ce&34&&Fo(c,Q[1]),ce&68){X=Object.keys(Q[2]);let De;for(De=0;De<X.length;De+=1){const Oe=H_(Q,X,De);oe[De]?oe[De].p(Oe,ce):(oe[De]=q_(Oe),oe[De].c(),oe[De].m(M,null))}for(;De<oe.length;De+=1)oe[De].d(1);oe.length=X.length}},i(Q){S||(Fe(o.$$.fragment,Q),S=!0)},o(Q){He(o.$$.fragment,Q),S=!1},d(Q){Q&&nt(e),Kr(Y,Q),Wt(o),Kr(oe,Q),I=!1,R()}}}function _D(n,e,t){let i,s,{value:c=new ki({})}=e,{args:u=[]}=e,o=u[0]??"",p=u[1]??"",_=c;ya(n,_,Q=>t(2,s=Q));const v=Mx.usedLanguagesSorted;let M=new ki("en");ya(n,M,Q=>t(1,i=Q));const S=new ki(""),I=new ki("");let R=Fd();function G(){let Q=I.data;const ce=M.data;if(console.log("Updating translation input for value",Q," and language",ce),(_.data===""||_.data===void 0)&&t(0,_.data={},_),Q===""){delete _.data[ce],_.ping();return}_.data[ce]!==Q&&(t(0,_.data[ce]=Q,_),_.ping())}$r(M.addCallbackAndRunD(Q=>{_.data||t(0,_.data={},_),t(0,_.data[Q]=_.data[Q]??"",_),_.data[Q]===""&&delete _.data[Q],S.setData(_.data[Q]??""),I.setData(_.data[Q])})),$r(I.addCallbackAndRunD(()=>{G()}));function Y(){i=Bd(this),M.set(i),t(5,v)}const X=()=>R("submit"),oe=Q=>M.setData(Q);return n.$$set=Q=>{"value"in Q&&t(10,c=Q.value),"args"in Q&&t(11,u=Q.args)},[_,i,s,o,p,v,M,S,I,R,c,u,Y,X,oe]}class yD extends Zi{constructor(e){super(),Gi(this,e,_D,gD,$i,{value:10,args:11})}}const Er=class Er{constructor(e="https://taginfo.openstreetmap.org/"){ft(this,"_backend");this._backend=e}async getStats(e,t){let i;return t?i=`${this._backend}api/4/tag/stats?key=${encodeURIComponent(e)}&value=${encodeURIComponent(t)}`:i=`${this._backend}api/4/key/stats?key=${encodeURIComponent(e)}`,await Gn.downloadJsonCached(i,1e3*60*60)}webUrl(e,t){return t?`${this._backend}/tags/${e}=${t}#overview`:`${this._backend}/keys/${e}#overview`}static async geofabrikCountries(){if(Er._geofabrikCountries)return Er._geofabrikCountries;const e=await Gn.downloadJsonCached("https://download.geofabrik.de/index-v1-nogeom.json",24*1e3*60*60);return Er._geofabrikCountries=e.features.map(t=>t.properties),Er._geofabrikCountries}static async getInstanceFor(e){const t=await this.geofabrikCountries();e=e.toUpperCase();const i=t.find(c=>{var u;return((u=c["iso3166-1:alpha2"])==null?void 0:u.indexOf(e))>=0});if(!i||!(i!=null&&i.parent)||!(i!=null&&i.id))return;const s=`https://taginfo.geofabrik.de/${i.parent}:${i.id}/`;return new Er(s)}static async getDistributionsFor(e,t,i){if(!e)return;const s=await Er.getInstanceFor(e);if(s)try{return await s.getStats(t,i)}catch(c){console.warn("Could not fetch info for",e,t,i,"due to",c);return}}static async getGlobalDistributionsFor(e,t){const s=(await this.geofabrikCountries()).map(o=>{var p;return(p=o["iso3166-1:alpha2"])==null?void 0:p[0]}).filter(o=>!!o&&Er.blacklist.indexOf(o)<0),c={},u=await Promise.all(s.map(o=>Er.getDistributionsFor(o,e,t)));for(let o=0;o<s.length;o++){const p=s[o];u[o]&&(c[p]=u[o])}return c}};ft(Er,"global",new Er),ft(Er,"_geofabrikCountries"),ft(Er,"blacklist",["VI","GF","PR"]);let Cd=Er;function bD(n){let e,t,i,s,c,u;return{c(){e=mt("a"),t=Sn(n[5]),i=Sn(` features have
    `),s=mt("span"),c=Sn(n[3]),he(s,"class","literal-code"),he(e,"href",n[6]),he(e,"target","_blank"),he(e,"class",u=tc(n[5]<250?"alert":"thanks","link-underline w-fit"))},m(o,p){at(o,e,p),ve(e,t),ve(e,i),ve(e,s),ve(s,c)},p(o,p){p&32&&br(t,o[5]),p&8&&br(c,o[3]),p&64&&he(e,"href",o[6]),p&32&&u!==(u=tc(o[5]<250?"alert":"thanks","link-underline w-fit"))&&he(e,"class",u)},i:ci,o:ci,d(o){o&&nt(e)}}}function vD(n){let e,t,i=!n[0]&&Z_();return{c(){i&&i.c(),e=$n()},m(s,c){i&&i.m(s,c),at(s,e,c),t=!0},p(s,c){s[0]?i&&(Qi(),He(i,1,1,()=>{i=null}),en()):i?c&1&&Fe(i,1):(i=Z_(),i.c(),Fe(i,1),i.m(e.parentNode,e))},i(s){t||(Fe(i),t=!0)},o(s){He(i),t=!1},d(s){i&&i.d(s),s&&nt(e)}}}function Z_(n){let e,t;return e=new H2({}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function xD(n){let e,t,i,s;const c=[vD,bD],u=[];function o(p,_){return p[2]!==p[3]?0:p[4]&&(!p[0]||p[5]<250)?1:-1}return~(e=o(n))&&(t=u[e]=c[e](n)),{c(){t&&t.c(),i=$n()},m(p,_){~e&&u[e].m(p,_),at(p,i,_),s=!0},p(p,[_]){let v=e;e=o(p),e===v?~e&&u[e].p(p,_):(t&&(Qi(),He(u[v],1,1,()=>{u[v]=null}),en()),~e?(t=u[e],t?t.p(p,_):(t=u[e]=c[e](p),t.c()),Fe(t,1),t.m(i.parentNode,i)):t=null)},i(p){s||(Fe(t),s=!0)},o(p){He(t),s=!1},d(p){~e&&u[e].d(p),p&&nt(i)}}}function wD(n,e,t){let i,s,c=ci,u=()=>(c(),c=Vo(M,Y=>t(3,s=Y)),M),o,p,_;n.$$.on_destroy.push(()=>c());let{silent:v=!1}=e,{tag:M}=e;u();const S=M.stabilized(500);ya(n,S,Y=>t(2,i=Y));const I=S.bind(Y=>{if(Y)try{const X=_s.Tag(Y),oe=X.key;let Q=X.value;return typeof Q!="string"&&(Q=void 0),oe?ki.FromPromise(Cd.global.getStats(oe,Q)):void 0}catch{return}});ya(n,I,Y=>t(4,o=Y));const R=S.mapD(Y=>{try{const X=_s.Tag(Y),oe=X.key;let Q=X.value;return typeof Q!="string"&&(Q=void 0),oe?Cd.global.webUrl(oe,Q):void 0}catch{return}});ya(n,R,Y=>t(6,_=Y));const G=I.mapD(Y=>Y.data.find(X=>X.type==="all").count);return ya(n,G,Y=>t(5,p=Y)),n.$$set=Y=>{"silent"in Y&&t(0,v=Y.silent),"tag"in Y&&u(t(1,M=Y.tag))},[v,M,i,s,o,p,_,S,I,R,G]}class kD extends Zi{constructor(e){super(),Gi(this,e,wD,xD,$i,{silent:0,tag:1})}}function G_(n,e,t){const i=n.slice();return i[22]=e[t],i}function $_(n){let e,t=n[22]+"",i,s;return{c(){e=mt("option"),i=Sn(t),s=Jt(),e.__value=n[22],e.value=e.__value},m(c,u){at(c,e,u),ve(e,i),ve(e,s)},p:ci,d(c){c&&nt(e)}}}function SD(n){let e,t;return e=new fa({props:{cls:"alert",t:n[6]}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s&64&&(c.t=i[6]),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function MD(n){let e,t;return e=new fa({props:{cls:"alert",t:n[5]}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s&32&&(c.t=i[5]),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function DD(n){let e,t;return e=new fa({props:{cls:"alert",t:n[4]}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s&16&&(c.t=i[4]),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function TD(n){let e,t,i,s,c,u,o,p,_,v,M,S,I,R,G,Y,X,oe;i=new lm({props:{feedback:n[8],placeholder:"The key of the tag",type:"key",value:n[9],autofocus:!0}}),i.$on("submit",n[16]);let Q=n[12],ce=[];for(let Se=0;Se<Q.length;Se+=1)ce[Se]=$_(G_(n,Q,Se));o=new lm({props:{feedback:n[10],placeholder:"The value of the tag",type:"string",value:n[11]}}),o.$on("submit",n[20]),v=new B5({props:{class:"h-6 w-6"}});const De=[DD,MD,SD],Oe=[];function Pe(Se,_e){return Se[4]?0:Se[5]?1:Se[6]?2:-1}return~(S=Pe(n))&&(I=Oe[S]=De[S](n)),G=new kD({props:{silent:n[3],tag:n[1]}}),{c(){e=mt("div"),t=mt("div"),jt(i.$$.fragment),s=Jt(),c=mt("select");for(let Se=0;Se<ce.length;Se+=1)ce[Se].c();u=Jt(),jt(o.$$.fragment),p=Jt(),_=mt("a"),jt(v.$$.fragment),M=Jt(),I&&I.c(),R=Jt(),jt(G.$$.fragment),n[0]===void 0&&Od(()=>n[17].call(c)),he(t,"class","flex h-fit"),he(_,"target","_blank"),he(_,"href","https://github.com/pietervdvn/MapComplete/blob/develop/Docs/Tags_format.md"),he(e,"class","flex items-center")},m(Se,_e){at(Se,e,_e),ve(e,t),Ut(i,t,null),ve(t,s),ve(t,c);for(let ze=0;ze<ce.length;ze+=1)ce[ze]&&ce[ze].m(c,null);Fo(c,n[0],!0),ve(t,u),Ut(o,t,null),ve(e,p),ve(e,_),Ut(v,_,null),ve(e,M),~S&&Oe[S].m(e,null),ve(e,R),Ut(G,e,null),Y=!0,X||(oe=[xt(c,"change",n[17]),xt(c,"focusin",n[18]),xt(c,"focusout",n[19])],X=!0)},p(Se,[_e]){if(_e&4096){Q=Se[12];let Ye;for(Ye=0;Ye<Q.length;Ye+=1){const Xe=G_(Se,Q,Ye);ce[Ye]?ce[Ye].p(Xe,_e):(ce[Ye]=$_(Xe),ce[Ye].c(),ce[Ye].m(c,null))}for(;Ye<ce.length;Ye+=1)ce[Ye].d(1);ce.length=Q.length}_e&4097&&Fo(c,Se[0]);let ze=S;S=Pe(Se),S===ze?~S&&Oe[S].p(Se,_e):(I&&(Qi(),He(Oe[ze],1,1,()=>{Oe[ze]=null}),en()),~S?(I=Oe[S],I?I.p(Se,_e):(I=Oe[S]=De[S](Se),I.c()),Fe(I,1),I.m(e,R)):I=null);const Re={};_e&8&&(Re.silent=Se[3]),_e&2&&(Re.tag=Se[1]),G.$set(Re)},i(Se){Y||(Fe(i.$$.fragment,Se),Fe(o.$$.fragment,Se),Fe(v.$$.fragment,Se),Fe(I),Fe(G.$$.fragment,Se),Y=!0)},o(Se){He(i.$$.fragment,Se),He(o.$$.fragment,Se),He(v.$$.fragment,Se),He(I),He(G.$$.fragment,Se),Y=!1},d(Se){Se&&nt(e),Wt(i),Kr(ce,Se),Wt(o),Wt(v),~S&&Oe[S].d(),Wt(G),X=!1,rr(oe)}}}function CD(n,e,t){let i,s,c,{tag:u=new ki(void 0)}=e,{uploadableOnly:o}=e,{overpassSupportNeeded:p}=e,{dropdownFocussed:_=new ki(!1)}=e,{silent:v=!1}=e,{selected:M=new ki(!1)}=e,S=u.map(_e=>{if(_e)try{_s.Tag(_e);return}catch(ze){return ze}});ya(n,S,_e=>t(6,c=_e));let I=new ki(void 0);ya(n,I,_e=>t(4,i=_e));let R=new ki(void 0),G=new ki(void 0);ya(n,G,_e=>t(5,s=_e));let Y=new ki(void 0),{mode:X="="}=e,oe=[];for(const _e in _s.modeDocumentation){const ze=_s.modeDocumentation[_e];p&&!ze.overpassSupport||o&&!ze.uploadable||oe.push(_e)}if(!o&&!p&&oe.push(..._s.comparators.map(_e=>_e[0])),u.data){const _e=[...oe];_e.sort((Re,Ye)=>Ye.length-Re.length);const ze=u.data;console.log(ze);for(const Re of _e)if(ze.indexOf(Re)>=0){const[Ye,Xe]=ze.split(Re);R.setData(Ye),Y.setData(Xe),X=Re;break}}$r(Y.addCallbackAndRun(Q)),$r(R.addCallbackAndRun(Q));function Q(_e){const ze=R.data,Re=Y.data??"";if(ze===void 0||ze===""){u.setData(void 0);return}const Ye=ze+X+Re;try{_s.Tag(Ye),u.setData(Ye)}catch{u.setData(void 0)}}function ce(_e){ei.call(this,n,_e)}function De(){X=Bd(this),t(0,X),t(12,oe)}const Oe=()=>_.setData(!0),Pe=()=>_.setData(!1);function Se(_e){ei.call(this,n,_e)}return n.$$set=_e=>{"tag"in _e&&t(1,u=_e.tag),"uploadableOnly"in _e&&t(13,o=_e.uploadableOnly),"overpassSupportNeeded"in _e&&t(14,p=_e.overpassSupportNeeded),"dropdownFocussed"in _e&&t(2,_=_e.dropdownFocussed),"silent"in _e&&t(3,v=_e.silent),"selected"in _e&&t(15,M=_e.selected),"mode"in _e&&t(0,X=_e.mode)},n.$$.update=()=>{n.$$.dirty&1&&Q()},[X,u,_,v,i,s,c,S,I,R,G,Y,oe,o,p,M,ce,De,Oe,Pe,Se]}class pb extends Zi{constructor(e){super(),Gi(this,e,CD,TD,$i,{tag:1,uploadableOnly:13,overpassSupportNeeded:14,dropdownFocussed:2,silent:3,selected:15,mode:0})}}const PD=n=>({}),K_=n=>({});function Y_(n,e,t){const i=n.slice();return i[24]=e[t],i}function J_(n,e,t){const i=n.slice();return i[27]=e[t],i}function X_(n){let e,t,i,s,c;return{c(){e=mt("select"),t=mt("option"),t.textContent="and",i=mt("option"),i.textContent="or",t.__value="and",t.value=t.__value,i.__value="or",i.value=i.__value,n[3]===void 0&&Od(()=>n[14].call(e))},m(u,o){at(u,e,o),ve(e,t),ve(e,i),Fo(e,n[3],!0),s||(c=xt(e,"change",n[14]),s=!0)},p(u,o){o&8&&Fo(e,u[3])},d(u){u&&nt(e),s=!1,c()}}}function Q_(n){let e,t,i,s,c;t=new Hd({props:{class:"h-4 w-4 p-1"}});function u(){return n[16](n[27])}return{c(){e=mt("button"),jt(t.$$.fragment),he(e,"class","h-fit w-fit rounded-full border border-black p-0")},m(o,p){at(o,e,p),Ut(t,e,null),i=!0,s||(c=xt(e,"click",u),s=!0)},p(o,p){n=o},i(o){i||(Fe(t.$$.fragment,o),i=!0)},o(o){He(t.$$.fragment,o),i=!1},d(o){o&&nt(e),Wt(t),s=!1,c()}}}function e2(n,e){let t,i,s,c;i=new pb({props:{silent:e[2],overpassSupportNeeded:e[1],uploadableOnly:e[0],tag:e[27]}}),i.$on("submit",e[15]);let u=e[4].length+e[5].length>1&&Q_(e);return{key:n,first:null,c(){t=mt("div"),jt(i.$$.fragment),s=Jt(),u&&u.c(),he(t,"class","flex"),this.first=t},m(o,p){at(o,t,p),Ut(i,t,null),ve(t,s),u&&u.m(t,null),c=!0},p(o,p){e=o;const _={};p&4&&(_.silent=e[2]),p&2&&(_.overpassSupportNeeded=e[1]),p&1&&(_.uploadableOnly=e[0]),p&16&&(_.tag=e[27]),i.$set(_),e[4].length+e[5].length>1?u?(u.p(e,p),p&48&&Fe(u,1)):(u=Q_(e),u.c(),Fe(u,1),u.m(t,null)):u&&(Qi(),He(u,1,1,()=>{u=null}),en())},i(o){c||(Fe(i.$$.fragment,o),Fe(u),c=!0)},o(o){He(i.$$.fragment,o),He(u),c=!1},d(o){o&&nt(t),Wt(i),u&&u.d()}}}function AD(n){let e,t,i,s,c,u;t=new Hd({props:{class:"h-3 w-3 p-0"}});function o(){return n[17](n[24])}return{c(){e=mt("button"),jt(t.$$.fragment),i=Sn(`
          Delete subexpression`),he(e,"class","small"),he(e,"slot","delete")},m(p,_){at(p,e,_),Ut(t,e,null),ve(e,i),s=!0,c||(u=xt(e,"click",o),c=!0)},p(p,_){n=p},i(p){s||(Fe(t.$$.fragment,p),s=!0)},o(p){He(t.$$.fragment,p),s=!1},d(p){p&&nt(e),Wt(t),c=!1,u()}}}function t2(n){let e,t;return e=new mb({props:{silent:n[2],overpassSupportNeeded:n[1],uploadableOnly:n[0],tag:n[24],$$slots:{delete:[AD]},$$scope:{ctx:n}}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s&4&&(c.silent=i[2]),s&2&&(c.overpassSupportNeeded=i[1]),s&1&&(c.uploadableOnly=i[0]),s&32&&(c.tag=i[24]),s&1048608&&(c.$$scope={dirty:s,ctx:i}),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function i2(n){let e,t,i;return{c(){e=mt("button"),e.textContent="Add an expression",he(e,"class","small w-fit")},m(s,c){at(s,e,c),t||(i=xt(e,"click",n[19]),t=!0)},p:ci,d(s){s&&nt(e),t=!1,i()}}}function ID(n){let e,t,i,s=[],c=new Map,u,o,p,_,v,M,S,I,R,G=!n[0]&&X_(n),Y=n[4];const X=Se=>Se[27];for(let Se=0;Se<Y.length;Se+=1){let _e=J_(n,Y,Se),ze=X(_e);c.set(ze,s[Se]=e2(ze,_e))}let oe=n[5],Q=[];for(let Se=0;Se<oe.length;Se+=1)Q[Se]=t2(Y_(n,oe,Se));const ce=Se=>He(Q[Se],1,1,()=>{Q[Se]=null});let De=!n[0]&&i2(n);const Oe=n[13].delete,Pe=Ra(Oe,n,n[20],K_);return{c(){e=mt("div"),G&&G.c(),t=Jt(),i=mt("div");for(let Se=0;Se<s.length;Se+=1)s[Se].c();u=Jt();for(let Se=0;Se<Q.length;Se+=1)Q[Se].c();o=Jt(),p=mt("div"),_=mt("button"),_.textContent="Add a tag",v=Jt(),De&&De.c(),M=Jt(),Pe&&Pe.c(),he(_,"class","small w-fit"),he(p,"class","flex"),he(i,"class","ml-1 flex flex-col border-l-4 border-black pl-1"),he(e,"class","flex items-center")},m(Se,_e){at(Se,e,_e),G&&G.m(e,null),ve(e,t),ve(e,i);for(let ze=0;ze<s.length;ze+=1)s[ze]&&s[ze].m(i,null);ve(i,u);for(let ze=0;ze<Q.length;ze+=1)Q[ze]&&Q[ze].m(i,null);ve(i,o),ve(i,p),ve(p,_),ve(p,v),De&&De.m(p,null),ve(p,M),Pe&&Pe.m(p,null),S=!0,I||(R=xt(_,"click",n[18]),I=!0)},p(Se,[_e]){if(Se[0]?G&&(G.d(1),G=null):G?G.p(Se,_e):(G=X_(Se),G.c(),G.m(e,t)),_e&567&&(Y=Se[4],Qi(),s=B2(s,_e,X,1,Se,Y,c,i,N2,e2,u,J_),en()),_e&1063){oe=Se[5];let ze;for(ze=0;ze<oe.length;ze+=1){const Re=Y_(Se,oe,ze);Q[ze]?(Q[ze].p(Re,_e),Fe(Q[ze],1)):(Q[ze]=t2(Re),Q[ze].c(),Fe(Q[ze],1),Q[ze].m(i,o))}for(Qi(),ze=oe.length;ze<Q.length;ze+=1)ce(ze);en()}Se[0]?De&&(De.d(1),De=null):De?De.p(Se,_e):(De=i2(Se),De.c(),De.m(p,M)),Pe&&Pe.p&&(!S||_e&1048576)&&Fa(Pe,Oe,Se,Se[20],S?Ba(Oe,Se[20],_e,PD):Oa(Se[20]),K_)},i(Se){if(!S){for(let _e=0;_e<Y.length;_e+=1)Fe(s[_e]);for(let _e=0;_e<oe.length;_e+=1)Fe(Q[_e]);Fe(Pe,Se),S=!0}},o(Se){for(let _e=0;_e<s.length;_e+=1)He(s[_e]);Q=Q.filter(Boolean);for(let _e=0;_e<Q.length;_e+=1)He(Q[_e]);He(Pe,Se),S=!1},d(Se){Se&&nt(e),G&&G.d();for(let _e=0;_e<s.length;_e+=1)s[_e].d();Kr(Q,Se),De&&De.d(),Pe&&Pe.d(Se),I=!1,R()}}}function ED(n,e,t){let i,s,{$$slots:c={},$$scope:u}=e,{tag:o}=e,p="and",_=new ki([]);ya(n,_,Re=>t(4,i=Re));let v=new ki([]);ya(n,v,Re=>t(5,s=Re));let{uploadableOnly:M}=e,{overpassSupportNeeded:S}=e,{silent:I}=e;function R(Re){let Ye={};if(!p)return;const Xe=[],si=_.data.concat(v.data);for(const Bt of si){const bi=Bt.data;if(!bi){o.setData(void 0);return}Xe.push(bi)}Xe.length===1?o.setData(Xe[0]):(Ye[p]=Xe,o.setData(Ye))}function G(Re){const Ye=new ki(Re);_.data.push(Ye),_.ping(),Ye.addCallbackAndRunD(Xe=>R())}function Y(Re){const Ye=_.data.indexOf(Re);console.log("Removing",Ye,Re),Ye>=0&&(Re.setData(void 0),_.data.splice(Ye,1),_.ping())}function X(Re){const Ye=v.data.indexOf(Re);Ye>=0&&(Re.setData(void 0),v.data.splice(Ye,1),v.ping())}function oe(Re){const Ye=new ki(Re);v.data.push(Ye),v.ping(),Ye.addCallbackAndRunD(Xe=>R())}v.addCallback(Re=>R()),_.addCallback(Re=>R());let Q=o.data;function ce(Re){if(typeof Re=="string")if(Re.startsWith("{"))Re=JSON.parse(Re);else{G(Re);return}t(3,p=Object.keys(Re)[0]);const Ye=Re[p];if(!(!Ye||Ye.length==0)){if(Ye.length==1){ce(Ye[0]);return}for(const Xe of Ye)typeof Xe=="string"?G(Xe):oe(Xe)}}Q?ce(Q):G();function De(){p=Bd(this),t(3,p)}function Oe(Re){ei.call(this,n,Re)}const Pe=Re=>Y(Re),Se=Re=>X(Re),_e=()=>G(),ze=()=>oe();return n.$$set=Re=>{"tag"in Re&&t(12,o=Re.tag),"uploadableOnly"in Re&&t(0,M=Re.uploadableOnly),"overpassSupportNeeded"in Re&&t(1,S=Re.overpassSupportNeeded),"silent"in Re&&t(2,I=Re.silent),"$$scope"in Re&&t(20,u=Re.$$scope)},n.$$.update=()=>{n.$$.dirty&8&&R()},[M,S,I,p,i,s,_,v,G,Y,X,oe,o,c,De,Oe,Pe,Se,_e,ze,u]}class LD extends Zi{constructor(e){super(),Gi(this,e,ED,ID,$i,{tag:12,uploadableOnly:0,overpassSupportNeeded:1,silent:2})}}const zD=n=>({}),n2=n=>({slot:"delete"});function RD(n){let e;const t=n[4].delete,i=Ra(t,n,n[6],n2);return{c(){i&&i.c()},m(s,c){i&&i.m(s,c),e=!0},p(s,c){i&&i.p&&(!e||c&64)&&Fa(i,t,s,s[6],e?Ba(t,s[6],c,zD):Oa(s[6]),n2)},i(s){e||(Fe(i,s),e=!0)},o(s){He(i,s),e=!1},d(s){i&&i.d(s)}}}function FD(n){let e,t,i;return t=new LD({props:{silent:n[3],overpassSupportNeeded:n[2],tag:n[0],uploadableOnly:n[1],$$slots:{delete:[RD]},$$scope:{ctx:n}}}),t.$on("submit",n[5]),{c(){e=mt("div"),jt(t.$$.fragment),he(e,"class","m-2")},m(s,c){at(s,e,c),Ut(t,e,null),i=!0},p(s,[c]){const u={};c&8&&(u.silent=s[3]),c&4&&(u.overpassSupportNeeded=s[2]),c&1&&(u.tag=s[0]),c&2&&(u.uploadableOnly=s[1]),c&64&&(u.$$scope={dirty:c,ctx:s}),t.$set(u)},i(s){i||(Fe(t.$$.fragment,s),i=!0)},o(s){He(t.$$.fragment,s),i=!1},d(s){s&&nt(e),Wt(t)}}}function OD(n,e,t){let{$$slots:i={},$$scope:s}=e,{tag:c}=e,{uploadableOnly:u}=e,{overpassSupportNeeded:o}=e,{silent:p}=e;function _(v){ei.call(this,n,v)}return n.$$set=v=>{"tag"in v&&t(0,c=v.tag),"uploadableOnly"in v&&t(1,u=v.uploadableOnly),"overpassSupportNeeded"in v&&t(2,o=v.overpassSupportNeeded),"silent"in v&&t(3,p=v.silent),"$$scope"in v&&t(6,s=v.$$scope)},[c,u,o,p,i,_,s]}class mb extends Zi{constructor(e){super(),Gi(this,e,OD,FD,$i,{tag:0,uploadableOnly:1,overpassSupportNeeded:2,silent:3})}}function BD(n){let e,t;return e=new mb({props:{overpassSupportNeeded:n[1],silent:n[2],tag:n[3],uploadableOnly:n[0]}}),e.$on("submit",n[5]),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,[s]){const c={};s&2&&(c.overpassSupportNeeded=i[1]),s&4&&(c.silent=i[2]),s&1&&(c.uploadableOnly=i[0]),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function ND(n,e,t){let{value:i}=e,{uploadableOnly:s}=e,{overpassSupportNeeded:c}=e,{silent:u=!1}=e,o=i;function p(_){ei.call(this,n,_)}return n.$$set=_=>{"value"in _&&t(4,i=_.value),"uploadableOnly"in _&&t(0,s=_.uploadableOnly),"overpassSupportNeeded"in _&&t(1,c=_.overpassSupportNeeded),"silent"in _&&t(2,u=_.silent)},[s,c,u,o,i,p]}class VD extends Zi{constructor(e){super(),Gi(this,e,ND,BD,$i,{value:4,uploadableOnly:0,overpassSupportNeeded:1,silent:2})}}function Bm(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let _l=Bm();function gb(n){_l=n}const _b=/[&<>"']/,HD=new RegExp(_b.source,"g"),yb=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,jD=new RegExp(yb.source,"g"),UD={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},a2=n=>UD[n];function Zr(n,e){if(e){if(_b.test(n))return n.replace(HD,a2)}else if(yb.test(n))return n.replace(jD,a2);return n}const WD=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function qD(n){return n.replace(WD,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const ZD=/(^|[^\[])\^/g;function Hn(n,e){let t=typeof n=="string"?n:n.source;e=e||"";const i={replace:(s,c)=>{let u=typeof c=="string"?c:c.source;return u=u.replace(ZD,"$1"),t=t.replace(s,u),i},getRegex:()=>new RegExp(t,e)};return i}function r2(n){try{n=encodeURI(n).replace(/%25/g,"%")}catch{return null}return n}const Au={exec:()=>null};function s2(n,e){const t=n.replace(/\|/g,(c,u,o)=>{let p=!1,_=u;for(;--_>=0&&o[_]==="\\";)p=!p;return p?"|":" |"}),i=t.split(/ \|/);let s=0;if(i[0].trim()||i.shift(),i.length>0&&!i[i.length-1].trim()&&i.pop(),e)if(i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;s<i.length;s++)i[s]=i[s].trim().replace(/\\\|/g,"|");return i}function ld(n,e,t){const i=n.length;if(i===0)return"";let s=0;for(;s<i;){const c=n.charAt(i-s-1);if(c===e&&!t)s++;else if(c!==e&&t)s++;else break}return n.slice(0,i-s)}function GD(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let i=0;i<n.length;i++)if(n[i]==="\\")i++;else if(n[i]===e[0])t++;else if(n[i]===e[1]&&(t--,t<0))return i;return-1}function o2(n,e,t,i){const s=e.href,c=e.title?Zr(e.title):null,u=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){i.state.inLink=!0;const o={type:"link",raw:t,href:s,title:c,text:u,tokens:i.inlineTokens(u)};return i.state.inLink=!1,o}return{type:"image",raw:t,href:s,title:c,text:Zr(u)}}function $D(n,e){const t=n.match(/^(\s+)(?:```)/);if(t===null)return e;const i=t[1];return e.split(`
`).map(s=>{const c=s.match(/^\s+/);if(c===null)return s;const[u]=c;return u.length>=i.length?s.slice(i.length):s}).join(`
`)}class Pd{constructor(e){ft(this,"options");ft(this,"rules");ft(this,"lexer");this.options=e||_l}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:ld(i,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const i=t[0],s=$D(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:s}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(/#$/.test(i)){const s=ld(i,"#");(this.options.pedantic||!s||/ $/.test(s))&&(i=s.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:this.lexer.inline(i)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let i=t[0].replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`);i=ld(i.replace(/^ *>[ \t]?/gm,""),`
`);const s=this.lexer.state.top;this.lexer.state.top=!0;const c=this.lexer.blockTokens(i);return this.lexer.state.top=s,{type:"blockquote",raw:t[0],tokens:c,text:i}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i=t[1].trim();const s=i.length>1,c={type:"list",raw:"",ordered:s,start:s?+i.slice(0,-1):"",loose:!1,items:[]};i=s?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=s?i:"[*+-]");const u=new RegExp(`^( {0,3}${i})((?:[	 ][^\\n]*)?(?:\\n|$))`);let o="",p="",_=!1;for(;e;){let v=!1;if(!(t=u.exec(e))||this.rules.block.hr.test(e))break;o=t[0],e=e.substring(o.length);let M=t[2].split(`
`,1)[0].replace(/^\t+/,X=>" ".repeat(3*X.length)),S=e.split(`
`,1)[0],I=0;this.options.pedantic?(I=2,p=M.trimStart()):(I=t[2].search(/[^ ]/),I=I>4?1:I,p=M.slice(I),I+=t[1].length);let R=!1;if(!M&&/^ *$/.test(S)&&(o+=S+`
`,e=e.substring(S.length+1),v=!0),!v){const X=new RegExp(`^ {0,${Math.min(3,I-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),oe=new RegExp(`^ {0,${Math.min(3,I-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),Q=new RegExp(`^ {0,${Math.min(3,I-1)}}(?:\`\`\`|~~~)`),ce=new RegExp(`^ {0,${Math.min(3,I-1)}}#`);for(;e;){const De=e.split(`
`,1)[0];if(S=De,this.options.pedantic&&(S=S.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),Q.test(S)||ce.test(S)||X.test(S)||oe.test(e))break;if(S.search(/[^ ]/)>=I||!S.trim())p+=`
`+S.slice(I);else{if(R||M.search(/[^ ]/)>=4||Q.test(M)||ce.test(M)||oe.test(M))break;p+=`
`+S}!R&&!S.trim()&&(R=!0),o+=De+`
`,e=e.substring(De.length+1),M=S.slice(I)}}c.loose||(_?c.loose=!0:/\n *\n *$/.test(o)&&(_=!0));let G=null,Y;this.options.gfm&&(G=/^\[[ xX]\] /.exec(p),G&&(Y=G[0]!=="[ ] ",p=p.replace(/^\[[ xX]\] +/,""))),c.items.push({type:"list_item",raw:o,task:!!G,checked:Y,loose:!1,text:p,tokens:[]}),c.raw+=o}c.items[c.items.length-1].raw=o.trimEnd(),c.items[c.items.length-1].text=p.trimEnd(),c.raw=c.raw.trimEnd();for(let v=0;v<c.items.length;v++)if(this.lexer.state.top=!1,c.items[v].tokens=this.lexer.blockTokens(c.items[v].text,[]),!c.loose){const M=c.items[v].tokens.filter(I=>I.type==="space"),S=M.length>0&&M.some(I=>/\n.*\n/.test(I.raw));c.loose=S}if(c.loose)for(let v=0;v<c.items.length;v++)c.items[v].loose=!0;return c}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const i=t[1].toLowerCase().replace(/\s+/g," "),s=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",c=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:i,raw:t[0],href:s,title:c}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const i=s2(t[1]),s=t[2].replace(/^\||\| *$/g,"").split("|"),c=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],u={type:"table",raw:t[0],header:[],align:[],rows:[]};if(i.length===s.length){for(const o of s)/^ *-+: *$/.test(o)?u.align.push("right"):/^ *:-+: *$/.test(o)?u.align.push("center"):/^ *:-+ *$/.test(o)?u.align.push("left"):u.align.push(null);for(const o of i)u.header.push({text:o,tokens:this.lexer.inline(o)});for(const o of c)u.rows.push(s2(o,u.header.length).map(p=>({text:p,tokens:this.lexer.inline(p)})));return u}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const i=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:i,tokens:this.lexer.inline(i)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:Zr(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const u=ld(i.slice(0,-1),"\\");if((i.length-u.length)%2===0)return}else{const u=GD(t[2],"()");if(u>-1){const p=(t[0].indexOf("!")===0?5:4)+t[1].length+u;t[2]=t[2].substring(0,u),t[0]=t[0].substring(0,p).trim(),t[3]=""}}let s=t[2],c="";if(this.options.pedantic){const u=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);u&&(s=u[1],c=u[3])}else c=t[3]?t[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(this.options.pedantic&&!/>$/.test(i)?s=s.slice(1):s=s.slice(1,-1)),o2(t,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:c&&c.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){const s=(i[2]||i[1]).replace(/\s+/g," "),c=t[s.toLowerCase()];if(!c){const u=i[0].charAt(0);return{type:"text",raw:u,text:u}}return o2(i,c,i[0],this.lexer)}}emStrong(e,t,i=""){let s=this.rules.inline.emStrongLDelim.exec(e);if(!s||s[3]&&i.match(/[\p{L}\p{N}]/u))return;if(!(s[1]||s[2]||"")||!i||this.rules.inline.punctuation.exec(i)){const u=[...s[0]].length-1;let o,p,_=u,v=0;const M=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(M.lastIndex=0,t=t.slice(-1*e.length+u);(s=M.exec(t))!=null;){if(o=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!o)continue;if(p=[...o].length,s[3]||s[4]){_+=p;continue}else if((s[5]||s[6])&&u%3&&!((u+p)%3)){v+=p;continue}if(_-=p,_>0)continue;p=Math.min(p,p+_+v);const S=[...s[0]][0].length,I=e.slice(0,u+s.index+S+p);if(Math.min(u,p)%2){const G=I.slice(1,-1);return{type:"em",raw:I,text:G,tokens:this.lexer.inlineTokens(G)}}const R=I.slice(2,-2);return{type:"strong",raw:I,text:R,tokens:this.lexer.inlineTokens(R)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(/\n/g," ");const s=/[^ ]/.test(i),c=/^ /.test(i)&&/ $/.test(i);return s&&c&&(i=i.substring(1,i.length-1)),i=Zr(i,!0),{type:"codespan",raw:t[0],text:i}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let i,s;return t[2]==="@"?(i=Zr(t[1]),s="mailto:"+i):(i=Zr(t[1]),s=i),{type:"link",raw:t[0],text:i,href:s,tokens:[{type:"text",raw:i,text:i}]}}}url(e){var i;let t;if(t=this.rules.inline.url.exec(e)){let s,c;if(t[2]==="@")s=Zr(t[0]),c="mailto:"+s;else{let u;do u=t[0],t[0]=((i=this.rules.inline._backpedal.exec(t[0]))==null?void 0:i[0])??"";while(u!==t[0]);s=Zr(t[0]),t[1]==="www."?c="http://"+t[0]:c=t[0]}return{type:"link",raw:t[0],text:s,href:c,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let i;return this.lexer.state.inRawBlock?i=t[0]:i=Zr(t[0]),{type:"text",raw:t[0],text:i}}}}const KD=/^(?: *(?:\n|$))+/,YD=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,JD=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,$u=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,XD=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,bb=/(?:[*+-]|\d{1,9}[.)])/,vb=Hn(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,bb).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),Nm=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,QD=/^[^\n]+/,Vm=/(?!\s*\])(?:\\.|[^\[\]\\])+/,eT=Hn(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",Vm).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),tT=Hn(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,bb).getRegex(),rf="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Hm=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,iT=Hn("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",Hm).replace("tag",rf).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),xb=Hn(Nm).replace("hr",$u).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",rf).getRegex(),nT=Hn(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",xb).getRegex(),jm={blockquote:nT,code:YD,def:eT,fences:JD,heading:XD,hr:$u,html:iT,lheading:vb,list:tT,newline:KD,paragraph:xb,table:Au,text:QD},l2=Hn("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",$u).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",rf).getRegex(),aT={...jm,table:l2,paragraph:Hn(Nm).replace("hr",$u).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",l2).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",rf).getRegex()},rT={...jm,html:Hn(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Hm).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Au,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Hn(Nm).replace("hr",$u).replace("heading",` *#{1,6} *[^
]`).replace("lheading",vb).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},wb=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,sT=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,kb=/^( {2,}|\\)\n(?!\s*$)/,oT=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Ku="\\p{P}\\p{S}",lT=Hn(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,Ku).getRegex(),cT=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,uT=Hn(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,Ku).getRegex(),hT=Hn("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,Ku).getRegex(),dT=Hn("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,Ku).getRegex(),fT=Hn(/\\([punct])/,"gu").replace(/punct/g,Ku).getRegex(),pT=Hn(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),mT=Hn(Hm).replace("(?:-->|$)","-->").getRegex(),gT=Hn("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",mT).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Ad=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,_T=Hn(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Ad).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Sb=Hn(/^!?\[(label)\]\[(ref)\]/).replace("label",Ad).replace("ref",Vm).getRegex(),Mb=Hn(/^!?\[(ref)\](?:\[\])?/).replace("ref",Vm).getRegex(),yT=Hn("reflink|nolink(?!\\()","g").replace("reflink",Sb).replace("nolink",Mb).getRegex(),Um={_backpedal:Au,anyPunctuation:fT,autolink:pT,blockSkip:cT,br:kb,code:sT,del:Au,emStrongLDelim:uT,emStrongRDelimAst:hT,emStrongRDelimUnd:dT,escape:wb,link:_T,nolink:Mb,punctuation:lT,reflink:Sb,reflinkSearch:yT,tag:gT,text:oT,url:Au},bT={...Um,link:Hn(/^!?\[(label)\]\((.*?)\)/).replace("label",Ad).getRegex(),reflink:Hn(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ad).getRegex()},um={...Um,escape:Hn(wb).replace("])","~|])").getRegex(),url:Hn(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},vT={...um,br:Hn(kb).replace("{2,}","*").getRegex(),text:Hn(um.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},cd={normal:jm,gfm:aT,pedantic:rT},vu={normal:Um,gfm:um,breaks:vT,pedantic:bT};class Ls{constructor(e){ft(this,"tokens");ft(this,"options");ft(this,"state");ft(this,"tokenizer");ft(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||_l,this.options.tokenizer=this.options.tokenizer||new Pd,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:cd.normal,inline:vu.normal};this.options.pedantic?(t.block=cd.pedantic,t.inline=vu.pedantic):this.options.gfm&&(t.block=cd.gfm,this.options.breaks?t.inline=vu.breaks:t.inline=vu.gfm),this.tokenizer.rules=t}static get rules(){return{block:cd,inline:vu}}static lex(e,t){return new Ls(t).lex(e)}static lexInline(e,t){return new Ls(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const i=this.inlineQueue[t];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(o,p,_)=>p+"    ".repeat(_.length));let i,s,c,u;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(o=>(i=o.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.space(e)){e=e.substring(i.raw.length),i.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(i);continue}if(i=this.tokenizer.code(e)){e=e.substring(i.raw.length),s=t[t.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+i.raw,s.text+=`
`+i.text,this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(i);continue}if(i=this.tokenizer.fences(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.heading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.hr(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.blockquote(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.list(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.html(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.def(e)){e=e.substring(i.raw.length),s=t[t.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+i.raw,s.text+=`
`+i.raw,this.inlineQueue[this.inlineQueue.length-1].src=s.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title});continue}if(i=this.tokenizer.table(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.lheading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(c=e,this.options.extensions&&this.options.extensions.startBlock){let o=1/0;const p=e.slice(1);let _;this.options.extensions.startBlock.forEach(v=>{_=v.call({lexer:this},p),typeof _=="number"&&_>=0&&(o=Math.min(o,_))}),o<1/0&&o>=0&&(c=e.substring(0,o+1))}if(this.state.top&&(i=this.tokenizer.paragraph(c))){s=t[t.length-1],u&&s.type==="paragraph"?(s.raw+=`
`+i.raw,s.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(i),u=c.length!==e.length,e=e.substring(i.raw.length);continue}if(i=this.tokenizer.text(e)){e=e.substring(i.raw.length),s=t[t.length-1],s&&s.type==="text"?(s.raw+=`
`+i.raw,s.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(i);continue}if(e){const o="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(o);break}else throw new Error(o)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let i,s,c,u=e,o,p,_;if(this.tokens.links){const v=Object.keys(this.tokens.links);if(v.length>0)for(;(o=this.tokenizer.rules.inline.reflinkSearch.exec(u))!=null;)v.includes(o[0].slice(o[0].lastIndexOf("[")+1,-1))&&(u=u.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+u.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(o=this.tokenizer.rules.inline.blockSkip.exec(u))!=null;)u=u.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+u.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(o=this.tokenizer.rules.inline.anyPunctuation.exec(u))!=null;)u=u.slice(0,o.index)+"++"+u.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(p||(_=""),p=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(v=>(i=v.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.escape(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.tag(e)){e=e.substring(i.raw.length),s=t[t.length-1],s&&i.type==="text"&&s.type==="text"?(s.raw+=i.raw,s.text+=i.text):t.push(i);continue}if(i=this.tokenizer.link(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(i.raw.length),s=t[t.length-1],s&&i.type==="text"&&s.type==="text"?(s.raw+=i.raw,s.text+=i.text):t.push(i);continue}if(i=this.tokenizer.emStrong(e,u,_)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.codespan(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.br(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.del(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.autolink(e)){e=e.substring(i.raw.length),t.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(e))){e=e.substring(i.raw.length),t.push(i);continue}if(c=e,this.options.extensions&&this.options.extensions.startInline){let v=1/0;const M=e.slice(1);let S;this.options.extensions.startInline.forEach(I=>{S=I.call({lexer:this},M),typeof S=="number"&&S>=0&&(v=Math.min(v,S))}),v<1/0&&v>=0&&(c=e.substring(0,v+1))}if(i=this.tokenizer.inlineText(c)){e=e.substring(i.raw.length),i.raw.slice(-1)!=="_"&&(_=i.raw.slice(-1)),p=!0,s=t[t.length-1],s&&s.type==="text"?(s.raw+=i.raw,s.text+=i.text):t.push(i);continue}if(e){const v="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(v);break}else throw new Error(v)}}return t}}class Id{constructor(e){ft(this,"options");this.options=e||_l}code(e,t,i){var c;const s=(c=(t||"").match(/^\S*/))==null?void 0:c[0];return e=e.replace(/\n$/,"")+`
`,s?'<pre><code class="language-'+Zr(s)+'">'+(i?e:Zr(e,!0))+`</code></pre>
`:"<pre><code>"+(i?e:Zr(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e,t){return e}heading(e,t,i){return`<h${t}>${e}</h${t}>
`}hr(){return`<hr>
`}list(e,t,i){const s=t?"ol":"ul",c=t&&i!==1?' start="'+i+'"':"";return"<"+s+c+`>
`+e+"</"+s+`>
`}listitem(e,t,i){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(e){return`<p>${e}</p>
`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,t){const i=t.header?"th":"td";return(t.align?`<${i} align="${t.align}">`:`<${i}>`)+e+`</${i}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return"<br>"}del(e){return`<del>${e}</del>`}link(e,t,i){const s=r2(e);if(s===null)return i;e=s;let c='<a href="'+e+'"';return t&&(c+=' title="'+t+'"'),c+=">"+i+"</a>",c}image(e,t,i){const s=r2(e);if(s===null)return i;e=s;let c=`<img src="${e}" alt="${i}"`;return t&&(c+=` title="${t}"`),c+=">",c}text(e){return e}}class Wm{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,i){return""+i}image(e,t,i){return""+i}br(){return""}}class zs{constructor(e){ft(this,"options");ft(this,"renderer");ft(this,"textRenderer");this.options=e||_l,this.options.renderer=this.options.renderer||new Id,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Wm}static parse(e,t){return new zs(t).parse(e)}static parseInline(e,t){return new zs(t).parseInline(e)}parse(e,t=!0){let i="";for(let s=0;s<e.length;s++){const c=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[c.type]){const u=c,o=this.options.extensions.renderers[u.type].call({parser:this},u);if(o!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(u.type)){i+=o||"";continue}}switch(c.type){case"space":continue;case"hr":{i+=this.renderer.hr();continue}case"heading":{const u=c;i+=this.renderer.heading(this.parseInline(u.tokens),u.depth,qD(this.parseInline(u.tokens,this.textRenderer)));continue}case"code":{const u=c;i+=this.renderer.code(u.text,u.lang,!!u.escaped);continue}case"table":{const u=c;let o="",p="";for(let v=0;v<u.header.length;v++)p+=this.renderer.tablecell(this.parseInline(u.header[v].tokens),{header:!0,align:u.align[v]});o+=this.renderer.tablerow(p);let _="";for(let v=0;v<u.rows.length;v++){const M=u.rows[v];p="";for(let S=0;S<M.length;S++)p+=this.renderer.tablecell(this.parseInline(M[S].tokens),{header:!1,align:u.align[S]});_+=this.renderer.tablerow(p)}i+=this.renderer.table(o,_);continue}case"blockquote":{const u=c,o=this.parse(u.tokens);i+=this.renderer.blockquote(o);continue}case"list":{const u=c,o=u.ordered,p=u.start,_=u.loose;let v="";for(let M=0;M<u.items.length;M++){const S=u.items[M],I=S.checked,R=S.task;let G="";if(S.task){const Y=this.renderer.checkbox(!!I);_?S.tokens.length>0&&S.tokens[0].type==="paragraph"?(S.tokens[0].text=Y+" "+S.tokens[0].text,S.tokens[0].tokens&&S.tokens[0].tokens.length>0&&S.tokens[0].tokens[0].type==="text"&&(S.tokens[0].tokens[0].text=Y+" "+S.tokens[0].tokens[0].text)):S.tokens.unshift({type:"text",text:Y+" "}):G+=Y+" "}G+=this.parse(S.tokens,_),v+=this.renderer.listitem(G,R,!!I)}i+=this.renderer.list(v,o,p);continue}case"html":{const u=c;i+=this.renderer.html(u.text,u.block);continue}case"paragraph":{const u=c;i+=this.renderer.paragraph(this.parseInline(u.tokens));continue}case"text":{let u=c,o=u.tokens?this.parseInline(u.tokens):u.text;for(;s+1<e.length&&e[s+1].type==="text";)u=e[++s],o+=`
`+(u.tokens?this.parseInline(u.tokens):u.text);i+=t?this.renderer.paragraph(o):o;continue}default:{const u='Token with "'+c.type+'" type was not found.';if(this.options.silent)return console.error(u),"";throw new Error(u)}}}return i}parseInline(e,t){t=t||this.renderer;let i="";for(let s=0;s<e.length;s++){const c=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[c.type]){const u=this.options.extensions.renderers[c.type].call({parser:this},c);if(u!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(c.type)){i+=u||"";continue}}switch(c.type){case"escape":{const u=c;i+=t.text(u.text);break}case"html":{const u=c;i+=t.html(u.text);break}case"link":{const u=c;i+=t.link(u.href,u.title,this.parseInline(u.tokens,t));break}case"image":{const u=c;i+=t.image(u.href,u.title,u.text);break}case"strong":{const u=c;i+=t.strong(this.parseInline(u.tokens,t));break}case"em":{const u=c;i+=t.em(this.parseInline(u.tokens,t));break}case"codespan":{const u=c;i+=t.codespan(u.text);break}case"br":{i+=t.br();break}case"del":{const u=c;i+=t.del(this.parseInline(u.tokens,t));break}case"text":{const u=c;i+=t.text(u.text);break}default:{const u='Token with "'+c.type+'" type was not found.';if(this.options.silent)return console.error(u),"";throw new Error(u)}}}return i}}class Iu{constructor(e){ft(this,"options");this.options=e||_l}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}ft(Iu,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));var Vu,hm,Ld,Db;class xT{constructor(...e){ip(this,Vu);ip(this,Ld);ft(this,"defaults",Bm());ft(this,"options",this.setOptions);ft(this,"parse",$h(this,Vu,hm).call(this,Ls.lex,zs.parse));ft(this,"parseInline",$h(this,Vu,hm).call(this,Ls.lexInline,zs.parseInline));ft(this,"Parser",zs);ft(this,"Renderer",Id);ft(this,"TextRenderer",Wm);ft(this,"Lexer",Ls);ft(this,"Tokenizer",Pd);ft(this,"Hooks",Iu);this.use(...e)}walkTokens(e,t){var s,c;let i=[];for(const u of e)switch(i=i.concat(t.call(this,u)),u.type){case"table":{const o=u;for(const p of o.header)i=i.concat(this.walkTokens(p.tokens,t));for(const p of o.rows)for(const _ of p)i=i.concat(this.walkTokens(_.tokens,t));break}case"list":{const o=u;i=i.concat(this.walkTokens(o.items,t));break}default:{const o=u;(c=(s=this.defaults.extensions)==null?void 0:s.childTokens)!=null&&c[o.type]?this.defaults.extensions.childTokens[o.type].forEach(p=>{const _=o[p].flat(1/0);i=i.concat(this.walkTokens(_,t))}):o.tokens&&(i=i.concat(this.walkTokens(o.tokens,t)))}}return i}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(i=>{const s={...i};if(s.async=this.defaults.async||s.async||!1,i.extensions&&(i.extensions.forEach(c=>{if(!c.name)throw new Error("extension name required");if("renderer"in c){const u=t.renderers[c.name];u?t.renderers[c.name]=function(...o){let p=c.renderer.apply(this,o);return p===!1&&(p=u.apply(this,o)),p}:t.renderers[c.name]=c.renderer}if("tokenizer"in c){if(!c.level||c.level!=="block"&&c.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const u=t[c.level];u?u.unshift(c.tokenizer):t[c.level]=[c.tokenizer],c.start&&(c.level==="block"?t.startBlock?t.startBlock.push(c.start):t.startBlock=[c.start]:c.level==="inline"&&(t.startInline?t.startInline.push(c.start):t.startInline=[c.start]))}"childTokens"in c&&c.childTokens&&(t.childTokens[c.name]=c.childTokens)}),s.extensions=t),i.renderer){const c=this.defaults.renderer||new Id(this.defaults);for(const u in i.renderer){if(!(u in c))throw new Error(`renderer '${u}' does not exist`);if(u==="options")continue;const o=u,p=i.renderer[o],_=c[o];c[o]=(...v)=>{let M=p.apply(c,v);return M===!1&&(M=_.apply(c,v)),M||""}}s.renderer=c}if(i.tokenizer){const c=this.defaults.tokenizer||new Pd(this.defaults);for(const u in i.tokenizer){if(!(u in c))throw new Error(`tokenizer '${u}' does not exist`);if(["options","rules","lexer"].includes(u))continue;const o=u,p=i.tokenizer[o],_=c[o];c[o]=(...v)=>{let M=p.apply(c,v);return M===!1&&(M=_.apply(c,v)),M}}s.tokenizer=c}if(i.hooks){const c=this.defaults.hooks||new Iu;for(const u in i.hooks){if(!(u in c))throw new Error(`hook '${u}' does not exist`);if(u==="options")continue;const o=u,p=i.hooks[o],_=c[o];Iu.passThroughHooks.has(u)?c[o]=v=>{if(this.defaults.async)return Promise.resolve(p.call(c,v)).then(S=>_.call(c,S));const M=p.call(c,v);return _.call(c,M)}:c[o]=(...v)=>{let M=p.apply(c,v);return M===!1&&(M=_.apply(c,v)),M}}s.hooks=c}if(i.walkTokens){const c=this.defaults.walkTokens,u=i.walkTokens;s.walkTokens=function(o){let p=[];return p.push(u.call(this,o)),c&&(p=p.concat(c.call(this,o))),p}}this.defaults={...this.defaults,...s}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Ls.lex(e,t??this.defaults)}parser(e,t){return zs.parse(e,t??this.defaults)}}Vu=new WeakSet,hm=function(e,t){return(i,s)=>{const c={...s},u={...this.defaults,...c};this.defaults.async===!0&&c.async===!1&&(u.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),u.async=!0);const o=$h(this,Ld,Db).call(this,!!u.silent,!!u.async);if(typeof i>"u"||i===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof i!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(i)+", string expected"));if(u.hooks&&(u.hooks.options=u),u.async)return Promise.resolve(u.hooks?u.hooks.preprocess(i):i).then(p=>e(p,u)).then(p=>u.hooks?u.hooks.processAllTokens(p):p).then(p=>u.walkTokens?Promise.all(this.walkTokens(p,u.walkTokens)).then(()=>p):p).then(p=>t(p,u)).then(p=>u.hooks?u.hooks.postprocess(p):p).catch(o);try{u.hooks&&(i=u.hooks.preprocess(i));let p=e(i,u);u.hooks&&(p=u.hooks.processAllTokens(p)),u.walkTokens&&this.walkTokens(p,u.walkTokens);let _=t(p,u);return u.hooks&&(_=u.hooks.postprocess(_)),_}catch(p){return o(p)}}},Ld=new WeakSet,Db=function(e,t){return i=>{if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const s="<p>An error occurred:</p><pre>"+Zr(i.message+"",!0)+"</pre>";return t?Promise.resolve(s):s}if(t)return Promise.reject(i);throw i}};const ml=new xT;function An(n,e){return ml.parse(n,e)}An.options=An.setOptions=function(n){return ml.setOptions(n),An.defaults=ml.defaults,gb(An.defaults),An};An.getDefaults=Bm;An.defaults=_l;An.use=function(...n){return ml.use(...n),An.defaults=ml.defaults,gb(An.defaults),An};An.walkTokens=function(n,e){return ml.walkTokens(n,e)};An.parseInline=ml.parseInline;An.Parser=zs;An.parser=zs.parse;An.Renderer=Id;An.TextRenderer=Wm;An.Lexer=Ls;An.lexer=Ls.lex;An.Tokenizer=Pd;An.Hooks=Iu;An.parse=An;An.options;An.setOptions;An.use;An.walkTokens;An.parseInline;zs.parse;Ls.lex;function c2(n){let e,t=An.parse(n[0])+"",i;return{c(){e=new Lx(!1),i=$n(),e.a=i},m(s,c){e.m(t,s,c),at(s,i,c)},p(s,c){c&1&&t!==(t=An.parse(s[0])+"")&&e.p(t)},d(s){s&&nt(i),s&&e.d()}}}function wT(n){var i;let e,t=((i=n[0])==null?void 0:i.length)>0&&c2(n);return{c(){t&&t.c(),e=$n()},m(s,c){t&&t.m(s,c),at(s,e,c)},p(s,[c]){var u;((u=s[0])==null?void 0:u.length)>0?t?t.p(s,c):(t=c2(s),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:ci,o:ci,d(s){t&&t.d(s),s&&nt(e)}}}function kT(n,e,t){let{src:i=void 0}=e,{srcWritable:s=void 0}=e;if(s==null||s.addCallbackAndRunD(c=>{t(0,i=c)}),i!==void 0&&typeof i!="string")throw console.trace("Got a non-string object in Markdown",i),"Markdown.svelte got a non-string object";return n.$$set=c=>{"src"in c&&t(0,i=c.src),"srcWritable"in c&&t(1,s=c.srcWritable)},[i,s]}class ST extends Zi{constructor(e){super(),Gi(this,e,kT,wT,$i,{src:0,srcWritable:1})}}function u2(n){let e,t,i=n[4].name+"",s,c,u,o;return u=new ST({props:{src:n[4].docs}}),{c(){e=mt("div"),t=mt("b"),s=Sn(i),c=Jt(),jt(u.$$.fragment),he(e,"class","m-2 border border-dashed border-black p-2")},m(p,_){at(p,e,_),ve(e,t),ve(t,s),ve(e,c),Ut(u,e,null),o=!0},p(p,_){(!o||_&16)&&i!==(i=p[4].name+"")&&br(s,i);const v={};_&16&&(v.src=p[4].docs),u.$set(v)},i(p){o||(Fe(u.$$.fragment,p),o=!0)},o(p){He(u.$$.fragment,p),o=!1},d(p){p&&nt(e),Wt(u)}}}function MT(n){let e,t,i,s,c;function u(_){n[9](_)}let o={dropdownFocussed:n[7],overpassSupportNeeded:n[1],silent:n[2],tag:n[0],uploadableOnly:n[6]};n[3]!==void 0&&(o.mode=n[3]),e=new pb({props:o}),Fs.push(()=>zx(e,"mode",u)),e.$on("submit",n[10]);let p=n[5]&&u2(n);return{c(){jt(e.$$.fragment),i=Jt(),p&&p.c(),s=$n()},m(_,v){Ut(e,_,v),at(_,i,v),p&&p.m(_,v),at(_,s,v),c=!0},p(_,[v]){const M={};v&2&&(M.overpassSupportNeeded=_[1]),v&4&&(M.silent=_[2]),v&1&&(M.tag=_[0]),!t&&v&8&&(t=!0,M.mode=_[3],Rx(()=>t=!1)),e.$set(M),_[5]?p?(p.p(_,v),v&32&&Fe(p,1)):(p=u2(_),p.c(),Fe(p,1),p.m(s.parentNode,s)):p&&(Qi(),He(p,1,1,()=>{p=null}),en())},i(_){c||(Fe(e.$$.fragment,_),Fe(p),c=!0)},o(_){He(e.$$.fragment,_),He(p),c=!1},d(_){Wt(e,_),_&&nt(i),p&&p.d(_),_&&nt(s)}}}function DT(n,e,t){let i,{value:s}=e,{args:c=[]}=e,u=c[0]==="uploadableOnly",{overpassSupportNeeded:o}=e,{silent:p=!1}=e,_="=",v=new ki(!1);ya(n,v,R=>t(5,i=R));let M=_s.modeDocumentation[_];function S(R){_=R,t(3,_)}function I(R){ei.call(this,n,R)}return n.$$set=R=>{"value"in R&&t(0,s=R.value),"args"in R&&t(8,c=R.args),"overpassSupportNeeded"in R&&t(1,o=R.overpassSupportNeeded),"silent"in R&&t(2,p=R.silent)},n.$$.update=()=>{n.$$.dirty&8&&t(4,M=_s.modeDocumentation[_])},[s,o,p,_,M,i,u,v,c,S,I]}class TT extends Zi{constructor(e){super(),Gi(this,e,DT,MT,$i,{value:0,args:8,overpassSupportNeeded:1,silent:2})}}function CT(n){let e,t,i,s,c,u,o,p,_=[n[1],{xmlns:"http://www.w3.org/2000/svg"},{width:"375px"},{height:"375px"},{viewBox:"0 0 375 375"},{version:"1.1"}],v={};for(let M=0;M<_.length;M+=1)v=Wi(v,_[M]);return{c(){e=et("svg"),t=et("g"),i=et("path"),s=et("path"),c=et("path"),u=et("path"),Ke(i,"fill","none",1),Ke(i,"stroke-width","6"),Ke(i,"stroke-linecap","round"),Ke(i,"stroke-linejoin","round"),Ke(i,"stroke","rgb(97.254902%,100%,96.078432%)"),Ke(i,"stroke-opacity","1"),Ke(i,"stroke-miterlimit","4"),he(i,"d","M -177.48351 -16.993714 C -177.484166 101.48875 -226.288922 214.739751 -312.411923 296.10684 C -398.528411 377.467771 -514.363074 419.770216 -632.651731 413.060164 "),he(i,"transform","matrix(-0.316636,-0.299423,0.299423,-0.316636,0,0)"),Ke(s,"fill","none",1),Ke(s,"stroke-width","6"),Ke(s,"stroke-linecap","butt"),Ke(s,"stroke-linejoin","miter"),Ke(s,"stroke","rgb(100%,100%,100%)"),Ke(s,"stroke-opacity","1"),Ke(s,"stroke-miterlimit","4"),he(s,"d","M 743.478328 134.561833 L 430.253662 430.253662 L 117.002105 134.508051 "),he(s,"transform","matrix(0.435789,0,0,0.435789,0,0)"),Ke(c,"fill","none",1),Ke(c,"stroke-width","3"),Ke(c,"stroke-linecap","round"),Ke(c,"stroke-linejoin","round"),Ke(c,"stroke",n[0]),Ke(c,"stroke-opacity","1"),Ke(c,"stroke-miterlimit","4"),he(c,"d","M -177.48351 -16.993714 C -177.484166 101.48875 -226.288922 214.739751 -312.411923 296.10684 C -398.528411 377.467771 -514.363074 419.770216 -632.651731 413.060164 "),he(c,"transform","matrix(-0.316636,-0.299423,0.299423,-0.316636,0,0)"),Ke(u,"fill","none",1),Ke(u,"stroke-width","3"),Ke(u,"stroke-linecap","butt"),Ke(u,"stroke-linejoin","miter"),Ke(u,"stroke",n[0]),Ke(u,"stroke-opacity","1"),Ke(u,"stroke-miterlimit","4"),he(u,"d","M 743.478328 134.561833 L 430.253662 430.253662 L 117.002105 134.508051 "),he(u,"transform","matrix(0.435789,0,0,0.435789,0,0)"),he(t,"id","surface1"),va(e,v)},m(M,S){at(M,e,S),ve(e,t),ve(t,i),ve(t,s),ve(t,c),ve(t,u),o||(p=[xt(e,"click",n[2]),xt(e,"mouseover",n[3]),xt(e,"mouseenter",n[4]),xt(e,"mouseleave",n[5]),xt(e,"keydown",n[6]),xt(e,"focus",n[7])],o=!0)},p(M,[S]){S&1&&Ke(c,"stroke",M[0]),S&1&&Ke(u,"stroke",M[0]),va(e,v=ar(_,[S&2&&M[1],{xmlns:"http://www.w3.org/2000/svg"},{width:"375px"},{height:"375px"},{viewBox:"0 0 375 375"},{version:"1.1"}]))},i:ci,o:ci,d(M){M&&nt(e),o=!1,rr(p)}}}function PT(n,e,t){const i=["color"];let s=Vn(e,i),{color:c="#000000"}=e;function u(S){ei.call(this,n,S)}function o(S){ei.call(this,n,S)}function p(S){ei.call(this,n,S)}function _(S){ei.call(this,n,S)}function v(S){ei.call(this,n,S)}function M(S){ei.call(this,n,S)}return n.$$set=S=>{e=Wi(Wi({},e),nr(S)),t(1,s=Vn(e,i)),"color"in S&&t(0,c=S.color)},[c,s,u,o,p,_,v,M]}class AT extends Zi{constructor(e){super(),Gi(this,e,PT,CT,$i,{color:0})}}function IT(n){let e,t,i,s,c,u,o,p,_;return i=new G2({props:{mapProperties:n[4],map:n[3]}}),u=new AT({}),{c(){e=mt("div"),t=mt("div"),jt(i.$$.fragment),s=Jt(),c=mt("div"),jt(u.$$.fragment),he(t,"class","absolute top-0 left-0 h-full w-full cursor-pointer"),he(c,"class","absolute top-0 left-0 h-full w-full"),he(e,"class","relative h-48 w-48 cursor-pointer overflow-hidden")},m(v,M){at(v,e,M),ve(e,t),Ut(i,t,null),ve(e,s),ve(e,c),Ut(u,c,null),n[9](c),n[10](e),o=!0,p||(_=[xt(e,"click",n[11]),xt(e,"mousedown",n[12]),xt(e,"mousemove",n[13]),xt(e,"mouseup",n[14]),xt(e,"touchmove",n[15]),xt(e,"touchstart",n[16])],p=!0)},p:ci,i(v){o||(Fe(i.$$.fragment,v),Fe(u.$$.fragment,v),o=!0)},o(v){He(i.$$.fragment,v),He(u.$$.fragment,v),o=!1},d(v){v&&nt(e),Wt(i),Wt(u),n[9](null),n[10](null),p=!1,rr(_)}}}function ET(n,e,t){var ce,De;let{value:i}=e,{state:s=void 0}=e,{mapProperties:c}=e,u=new ki(void 0),o=new Gp(u,c);o.allowMoving.setData(!1),o.allowZooming.setData(!1),(De=(ce=s==null?void 0:s.mapProperties)==null?void 0:ce.rasterLayer)==null||De.addCallbackAndRunD(Oe=>o.rasterLayer.set(Oe));let p,_;function v(Oe,Pe){const Se=_.getBoundingClientRect(),_e=-(Se.left+Se.right)/2+Oe,ze=(Se.top+Se.bottom)/2-Pe,Re=180*Math.atan2(ze,_e)/Math.PI,Ye=Math.floor((450-Re)%360);i.setData(""+Ye)}let M=!1;function S(Oe){Fs[Oe?"unshift":"push"](()=>{p=Oe,t(0,p),t(6,i)})}function I(Oe){Fs[Oe?"unshift":"push"](()=>{_=Oe,t(1,_)})}const R=Oe=>v(Oe.x,Oe.y),G=Oe=>{t(2,M=!0),v(Oe.clientX,Oe.clientY)},Y=Oe=>{M&&(v(Oe.clientX,Oe.clientY),Oe.preventDefault())},X=()=>{t(2,M=!1)},oe=Oe=>{v(Oe.touches[0].clientX,Oe.touches[0].clientY),Oe.preventDefault()},Q=Oe=>v(Oe.touches[0].clientX,Oe.touches[0].clientY);return n.$$set=Oe=>{"value"in Oe&&t(6,i=Oe.value),"state"in Oe&&t(7,s=Oe.state),"mapProperties"in Oe&&t(8,c=Oe.mapProperties)},n.$$.update=()=>{n.$$.dirty&65&&i.addCallbackAndRunD(Oe=>{p!==void 0&&t(0,p.style.rotate=Oe+"deg",p)})},[p,_,M,u,o,v,i,s,c,S,I,R,G,Y,X,oe,Q]}class LT extends Zi{constructor(e){super(),Gi(this,e,ET,IT,$i,{value:6,state:7,mapProperties:8})}}function zT(n){let e,t,i;return{c(){e=mt("input"),he(e,"type","date")},m(s,c){at(s,e,c),Oo(e,n[1]),t||(i=xt(e,"input",n[2]),t=!0)},p(s,[c]){c&2&&Oo(e,s[1])},i:ci,o:ci,d(s){s&&nt(e),t=!1,i()}}}function RT(n,e,t){let i,s=ci,c=()=>(s(),s=Vo(u,p=>t(1,i=p)),u);n.$$.on_destroy.push(()=>s());let{value:u}=e;c();function o(){i=this.value,u.set(i)}return n.$$set=p=>{"value"in p&&c(t(0,u=p.value))},[u,i,o]}class FT extends Zi{constructor(e){super(),Gi(this,e,RT,zT,$i,{value:0})}}function OT(n){let e,t,i;return{c(){e=mt("input"),he(e,"type","color")},m(s,c){at(s,e,c),Oo(e,n[1]),t||(i=xt(e,"input",n[2]),t=!0)},p(s,[c]){c&2&&Oo(e,s[1])},i:ci,o:ci,d(s){s&&nt(e),t=!1,i()}}}function BT(n,e,t){let i,s=ci,c=()=>(s(),s=Vo(u,p=>t(1,i=p)),u);n.$$.on_destroy.push(()=>s());let{value:u}=e;c();function o(){i=this.value,u.set(i)}return n.$$set=p=>{"value"in p&&c(t(0,u=p.value))},[u,i,o]}class NT extends Zi{constructor(e){super(),Gi(this,e,BT,OT,$i,{value:0})}}class VT extends Hu{}class Ed extends VT{constructor(t){super();ft(this,"enterPressed",new ki(void 0));ft(this,"value");ft(this,"_actualField");ft(this,"_isValid");ft(this,"_rawValue");ft(this,"_isFocused",!1);ft(this,"_options");this._options=t??{},t=t??{},this.value=(t==null?void 0:t.value)??new ki(void 0),this._rawValue=new ki(""),this._isValid=t.isValid??(i=>!0)}static SetCursorPosition(t,i){t!=null&&(i===-1&&(i=t.value.length),t.focus(),t.setSelectionRange(i,i))}GetValue(){return this.value}IsValid(t){return t==null?!1:this._isValid(t)}InnerConstructElement(){const t=this._options,i=this;let s,c="";t.placeholder&&(typeof t.placeholder=="string"?(c=t.placeholder,s=void 0):(t.placeholder instanceof xx&&t.placeholder.data!==void 0?s=t.placeholder:t.placeholder instanceof ul&&t.placeholder.translations!==void 0&&(s=fm.language.map(_=>t.placeholder.textFor(_))),c=(s==null?void 0:s.data)??c??"")),this.SetClass("form-text-field");let u;if(t.htmlType==="area"){this.SetClass("w-full box-border max-w-full");const _=document.createElement("textarea");_.placeholder=c,_.rows=t.textAreaRows,_.cols=50,_.style.width="100%",_.dir="auto",u=_,s&&s.addCallbackAndRunD(v=>_.placeholder=v)}else{const _=document.createElement("input");_.type=t.htmlType??"text",_.inputMode=t.inputMode,_.placeholder=c,_.style.cssText=t.inputStyle??"width: 100%;",_.dir="auto",u=_,s&&s.addCallbackAndRunD(v=>_.placeholder=v)}const o=document.createElement("form");o.appendChild(u),o.onsubmit=()=>!1,t.label&&o.appendChild(t.label.ConstructElement());const p=u;return this.value.addCallbackAndRunD(_=>{p.value=_}),p.oninput=()=>{const _=p.value.substring(p.selectionEnd).replace(/ /g,"").length;let v=p.value;i._rawValue.setData(v),i.IsValid(v)?i.value.setData(v):i.value.setData(void 0),v=p.value;let M=v.length-_;for(;M>=0&&v.substr(M).replace(/ /g,"").length<_;)M--;Ed.SetCursorPosition(p,M)},p.addEventListener("keyup",function(_){_.key==="Enter"&&i.enterPressed.setData(p.value)}),this._isFocused&&p.focus(),this._actualField=p,o}focus(){this._actualField===void 0?this._isFocused=!0:this._actualField.focus()}}function HT(n){let e,t,i,s,c,u,o,p,_,v,M,S;return t=new fa({props:{t:n[3].ph_not_known}}),c=new fa({props:{t:n[3].ph_closed}}),p=new fa({props:{t:n[3].ph_open_as_usual}}),M=new fa({props:{t:n[3].ph_open}}),{c(){e=mt("option"),jt(t.$$.fragment),i=Jt(),s=mt("option"),jt(c.$$.fragment),u=Jt(),o=mt("option"),jt(p.$$.fragment),_=Jt(),v=mt("option"),jt(M.$$.fragment),e.__value="",e.value=e.__value,s.__value="off",s.value=s.__value,o.__value="open",o.value=o.__value,v.__value=" ",v.value=v.__value},m(I,R){at(I,e,R),Ut(t,e,null),at(I,i,R),at(I,s,R),Ut(c,s,null),at(I,u,R),at(I,o,R),Ut(p,o,null),at(I,_,R),at(I,v,R),Ut(M,v,null),S=!0},p:ci,i(I){S||(Fe(t.$$.fragment,I),Fe(c.$$.fragment,I),Fe(p.$$.fragment,I),Fe(M.$$.fragment,I),S=!0)},o(I){He(t.$$.fragment,I),He(c.$$.fragment,I),He(p.$$.fragment,I),He(M.$$.fragment,I),S=!1},d(I){I&&nt(e),Wt(t),I&&nt(i),I&&nt(s),Wt(c),I&&nt(u),I&&nt(o),Wt(p),I&&nt(_),I&&nt(v),Wt(M)}}}function h2(n){let e,t,i,s,c,u,o,p,_;return t=new fa({props:{t:n[3].opensAt}}),s=new Xg({props:{construct:new Ed({value:n[1],placeholder:"starthour",htmlType:"time"}).SetClass("inline-block")}}),u=new fa({props:{t:n[3].openTill}}),p=new Xg({props:{construct:new Ed({value:n[2],placeholder:"endhour",htmlType:"time"}).SetClass("inline-block")}}),{c(){e=mt("div"),jt(t.$$.fragment),i=Jt(),jt(s.$$.fragment),c=Jt(),jt(u.$$.fragment),o=Jt(),jt(p.$$.fragment),he(e,"class","flex")},m(v,M){at(v,e,M),Ut(t,e,null),ve(e,i),Ut(s,e,null),ve(e,c),Ut(u,e,null),ve(e,o),Ut(p,e,null),_=!0},p:ci,i(v){_||(Fe(t.$$.fragment,v),Fe(s.$$.fragment,v),Fe(u.$$.fragment,v),Fe(p.$$.fragment,v),_=!0)},o(v){He(t.$$.fragment,v),He(s.$$.fragment,v),He(u.$$.fragment,v),He(p.$$.fragment,v),_=!1},d(v){v&&nt(e),Wt(t),Wt(s),Wt(u),Wt(p)}}}function jT(n){let e,t,i,s,c,u,o;t=new fa({props:{t:n[3].open_during_ph}}),s=new Vx({props:{value:n[4],$$slots:{default:[HT]},$$scope:{ctx:n}}});let p=n[0]===" "&&h2(n);return{c(){e=mt("label"),jt(t.$$.fragment),i=Jt(),jt(s.$$.fragment),c=Jt(),p&&p.c(),u=$n()},m(_,v){at(_,e,v),Ut(t,e,null),ve(e,i),Ut(s,e,null),at(_,c,v),p&&p.m(_,v),at(_,u,v),o=!0},p(_,[v]){const M={};v&128&&(M.$$scope={dirty:v,ctx:_}),s.$set(M),_[0]===" "?p?(p.p(_,v),v&1&&Fe(p,1)):(p=h2(_),p.c(),Fe(p,1),p.m(u.parentNode,u)):p&&(Qi(),He(p,1,1,()=>{p=null}),en())},i(_){o||(Fe(t.$$.fragment,_),Fe(s.$$.fragment,_),Fe(p),o=!0)},o(_){He(t.$$.fragment,_),He(s.$$.fragment,_),He(p),o=!1},d(_){_&&nt(e),Wt(t),Wt(s),_&&nt(c),p&&p.d(_),_&&nt(u)}}}function UT(n,e,t){let i,{value:s}=e,c=new ki(void 0),u=new ki(void 0);const o=yr.t.general.opening_hours;let p=new ki("");ya(n,p,v=>t(0,i=v)),s.map(v=>za.ParsePHRule(v)).addCallbackAndRunD(v=>{v!==null&&(p.setData(v.mode),c.setData(v.start),u.setData(v.end))});function _(){p.data===void 0||p.data===""?s.setData(""):p.data==="off"?s.setData("PH off"):p.data==="open"?s.setData("PH open"):c.data===void 0||u.data===void 0?s.setData(void 0):s.setData(`PH ${c.data}-${u.data}`)}return c.addCallbackAndRunD(()=>_()),u.addCallbackAndRunD(()=>_()),p.addCallbackAndRunD(()=>_()),n.$$set=v=>{"value"in v&&t(5,s=v.value)},[i,c,u,o,p,s]}class WT extends Zi{constructor(e){super(),Gi(this,e,UT,jT,$i,{value:5})}}function qT(n){let e,t,i;return{c(){e=mt("td"),he(e,"id",t="oh-"+n[2]+"-"+n[1]+"-"+n[0]),he(e,"class",i=`oh-timecell oh-timecell-${n[2]} oh-timecell-${n[0]} `),Is(e,"border-black",(n[1]+1)%6===0)},m(s,c){at(s,e,c),n[4](e)},p(s,[c]){c&7&&t!==(t="oh-"+s[2]+"-"+s[1]+"-"+s[0])&&he(e,"id",t),c&5&&i!==(i=`oh-timecell oh-timecell-${s[2]} oh-timecell-${s[0]} `)&&he(e,"class",i),c&7&&Is(e,"border-black",(s[1]+1)%6===0)},i:ci,o:ci,d(s){s&&nt(e),n[4](null)}}}function ZT(n,e,t){let{wd:i}=e,{h:s}=e,{type:c}=e,u=Fd(),o;function p(S,I){return I==null||I.preventDefault(),u(S),!0}let _;function v(S){for(const I in S.targetTouches){const R=S.targetTouches[I];if(R.clientX===void 0||R.clientY===void 0)continue;const G=document.elementFromPoint(R.clientX,R.clientY);if(!(!G||!G.classList.contains("oh-timecell")))return _=G,G}return _}sc(()=>{o.addEventListener("mousedown",S=>p("start",S)),t(3,o.onmouseenter=S=>p("move",S),o),t(3,o.onmouseup=S=>p("end",S),o),o.addEventListener("touchstart",S=>u("start",S)),o.addEventListener("touchend",S=>{const I=v(S);I!=null&&I.onmouseup?I==null||I.onmouseup(S):u("clear")}),o.addEventListener("touchmove",S=>{const I=v(S);typeof(I==null?void 0:I.onmouseenter)=="function"&&I.onmouseenter(S)})});function M(S){Fs[S?"unshift":"push"](()=>{o=S,t(3,o)})}return n.$$set=S=>{"wd"in S&&t(0,i=S.wd),"h"in S&&t(1,s=S.h),"type"in S&&t(2,c=S.type)},[i,s,c,o,M]}class Tb extends Zi{constructor(e){super(),Gi(this,e,ZT,qT,$i,{wd:0,h:1,type:2})}}function d2(n,e,t){const i=n.slice();return i[28]=e[t],i}function f2(n,e,t){const i=n.slice();return i[10]=e[t],i}function p2(n,e,t){const i=n.slice();return i[10]=e[t],i}function m2(n,e,t){const i=n.slice();return i[10]=e[t],i}function g2(n,e,t){const i=n.slice();return i[11]=e[t],i}function _2(n,e,t){const i=n.slice();return i[10]=e[t],i}const GT=n=>({}),y2=n=>({});function $T(n){let e,t,i,s,c;return t=new Hd({props:{class:"w-5 h-5"}}),{c(){e=mt("button"),jt(t.$$.fragment),he(e,"class","absolute top-0 left-0 p-1 rounded-full"),Ke(e,"z-index","10")},m(u,o){at(u,e,o),Ut(t,e,null),i=!0,s||(c=xt(e,"click",n[14]),s=!0)},p:ci,i(u){i||(Fe(t.$$.fragment,u),i=!0)},o(u){He(t.$$.fragment,u),i=!1},d(u){u&&nt(e),Wt(t),s=!1,c()}}}function b2(n){let e,t,i,s;return t=new fa({props:{cls:"w-full",t:n[10]}}),{c(){e=mt("th"),jt(t.$$.fragment),i=Jt(),Ke(e,"width","13%"),he(e,"class","svelte-17qtwci")},m(c,u){at(c,e,u),Ut(t,e,null),ve(e,i),s=!0},p:ci,i(c){s||(Fe(t.$$.fragment,c),s=!0)},o(c){He(t.$$.fragment,c),s=!1},d(c){c&&nt(e),Wt(t)}}}function v2(n){let e,t,i,s=za.hhmm(n[11].startHour,n[11].startMinutes)+"",c,u,o,p,_,v,M=za.hhmm(n[11].endHour,n[11].endMinutes)+"",S,I,R,G,Y,X;p=new Hd({props:{class:"w-6 h-6"}});function oe(){return n[17](n[11])}return{c(){e=mt("div"),t=mt("div"),i=mt("div"),c=Sn(s),u=Jt(),o=mt("button"),jt(p.$$.fragment),_=Jt(),v=mt("div"),S=Sn(M),I=Jt(),Is(i,"hidden",n[11].endHour-n[11].startHour<3),he(o,"class","w-fit rounded-full p-1 self-center pointer-events-auto"),Is(v,"hidden",n[11].endHour-n[11].startHour<3),he(t,"class","rounded-xl border-interactive h-full low-interaction flex flex-col justify-between"),he(e,"class","absolute pointer-events-none px-1 md:px-2 w-full "),he(e,"style",R=D2(n[11],n[3]))},m(Q,ce){at(Q,e,ce),ve(e,t),ve(t,i),ve(i,c),ve(t,u),ve(t,o),Ut(p,o,null),ve(t,_),ve(t,v),ve(v,S),ve(e,I),G=!0,Y||(X=xt(o,"click",oe),Y=!0)},p(Q,ce){n=Q,(!G||ce[0]&16)&&s!==(s=za.hhmm(n[11].startHour,n[11].startMinutes)+"")&&br(c,s),(!G||ce[0]&2064)&&Is(i,"hidden",n[11].endHour-n[11].startHour<3),(!G||ce[0]&16)&&M!==(M=za.hhmm(n[11].endHour,n[11].endMinutes)+"")&&br(S,M),(!G||ce[0]&2064)&&Is(v,"hidden",n[11].endHour-n[11].startHour<3),(!G||ce[0]&24&&R!==(R=D2(n[11],n[3])))&&he(e,"style",R)},i(Q){G||(Fe(p.$$.fragment,Q),G=!0)},o(Q){He(p.$$.fragment,Q),G=!1},d(Q){Q&&nt(e),Wt(p),Y=!1,X()}}}function x2(n){let e,t,i,s;function c(..._){return n[15](n[10],..._)}let u=n[4].filter(c).map(n[16]),o=[];for(let _=0;_<u.length;_+=1)o[_]=v2(g2(n,u,_));const p=_=>He(o[_],1,1,()=>{o[_]=null});return{c(){e=mt("td"),t=mt("div");for(let _=0;_<o.length;_+=1)o[_].c();i=Jt(),he(t,"class","h-0 pointer-events-none"),Ke(t,"z-index","10"),Ke(e,"width","13%"),Ke(e,"position","relative")},m(_,v){at(_,e,v),ve(e,t);for(let M=0;M<o.length;M+=1)o[M]&&o[M].m(t,null);ve(e,i),s=!0},p(_,v){if(n=_,v[0]&2073){u=n[4].filter(c).map(n[16]);let M;for(M=0;M<u.length;M+=1){const S=g2(n,u,M);o[M]?(o[M].p(S,v),Fe(o[M],1)):(o[M]=v2(S),o[M].c(),Fe(o[M],1),o[M].m(t,null))}for(Qi(),M=u.length;M<o.length;M+=1)p(M);en()}},i(_){if(!s){for(let v=0;v<u.length;v+=1)Fe(o[v]);s=!0}},o(_){o=o.filter(Boolean);for(let v=0;v<o.length;v+=1)He(o[v]);s=!1},d(_){_&&nt(e),Kr(o,_)}}}function KT(n){let e,t=n[28]+"",i,s;return{c(){e=mt("span"),i=Sn(t),s=Sn(":00"),he(e,"class","hour-header w-full svelte-17qtwci")},m(c,u){at(c,e,u),ve(e,i),ve(e,s)},p:ci,d(c){c&&nt(e)}}}function w2(n){let e,t;function i(){return n[18](n[10],n[28])}function s(){return n[19](n[10],n[28])}function c(){return n[20](n[10],n[28])}return e=new Tb({props:{type:"full",h:n[28],wd:n[10]}}),e.$on("start",i),e.$on("end",s),e.$on("move",c),e.$on("clear",n[21]),{c(){jt(e.$$.fragment)},m(u,o){Ut(e,u,o),t=!0},p(u,o){n=u},i(u){t||(Fe(e.$$.fragment,u),t=!0)},o(u){He(e.$$.fragment,u),t=!1},d(u){Wt(e,u)}}}function YT(n){let e;return{c(){e=mt("td")},m(t,i){at(t,e,i)},d(t){t&&nt(e)}}}function k2(n){let e,t;function i(){return n[22](n[10],n[28])}function s(){return n[23](n[10],n[28])}function c(){return n[24](n[10],n[28])}return e=new Tb({props:{type:"half",h:n[28],wd:n[10]}}),e.$on("start",i),e.$on("end",s),e.$on("move",c),e.$on("clear",n[25]),{c(){jt(e.$$.fragment)},m(u,o){Ut(e,u,o),t=!0},p(u,o){n=u},i(u){t||(Fe(e.$$.fragment,u),t=!0)},o(u){He(e.$$.fragment,u),t=!1},d(u){Wt(e,u)}}}function S2(n){let e,t,i,s,c,u,o,p,_=n[28]>0&&KT(n),v=n[11](7),M=[];for(let X=0;X<v.length;X+=1)M[X]=w2(p2(n,v,X));const S=X=>He(M[X],1,1,()=>{M[X]=null});let I=n[28]===0&&YT(),R=n[11](7),G=[];for(let X=0;X<R.length;X+=1)G[X]=k2(f2(n,R,X));const Y=X=>He(G[X],1,1,()=>{G[X]=null});return{c(){e=mt("tr"),t=mt("td"),_&&_.c(),i=Jt();for(let X=0;X<M.length;X+=1)M[X].c();s=Jt(),c=mt("tr"),I&&I.c(),u=Jt();for(let X=0;X<G.length;X+=1)G[X].c();o=Jt(),he(t,"rowspan",n[28]>0?2:1),he(t,"class","relative text-sm sm:text-base oh-left-col oh-timecell-full border-box interactive "),he(t,"style",n[28]>0?"top: -0.75rem":"height:0; top: -0.75rem"),Ke(e,"height","0.75rem"),Ke(e,"width","9%"),he(e,"class","svelte-17qtwci"),Ke(c,"height","calc( 0.75rem - 1px) "),he(c,"class","svelte-17qtwci")},m(X,oe){at(X,e,oe),ve(e,t),_&&_.m(t,null),ve(e,i);for(let Q=0;Q<M.length;Q+=1)M[Q]&&M[Q].m(e,null);at(X,s,oe),at(X,c,oe),I&&I.m(c,null),ve(c,u);for(let Q=0;Q<G.length;Q+=1)G[Q]&&G[Q].m(c,null);ve(c,o),p=!0},p(X,oe){if(X[28]>0&&_.p(X,oe),oe[0]&2496){v=X[11](7);let Q;for(Q=0;Q<v.length;Q+=1){const ce=p2(X,v,Q);M[Q]?(M[Q].p(ce,oe),Fe(M[Q],1)):(M[Q]=w2(ce),M[Q].c(),Fe(M[Q],1),M[Q].m(e,null))}for(Qi(),Q=v.length;Q<M.length;Q+=1)S(Q);en()}if(oe[0]&2496){R=X[11](7);let Q;for(Q=0;Q<R.length;Q+=1){const ce=f2(X,R,Q);G[Q]?(G[Q].p(ce,oe),Fe(G[Q],1)):(G[Q]=k2(ce),G[Q].c(),Fe(G[Q],1),G[Q].m(c,o))}for(Qi(),Q=R.length;Q<G.length;Q+=1)Y(Q);en()}},i(X){if(!p){for(let oe=0;oe<v.length;oe+=1)Fe(M[oe]);for(let oe=0;oe<R.length;oe+=1)Fe(G[oe]);p=!0}},o(X){M=M.filter(Boolean);for(let oe=0;oe<M.length;oe+=1)He(M[oe]);G=G.filter(Boolean);for(let oe=0;oe<G.length;oe+=1)He(G[oe]);p=!1},d(X){X&&nt(e),_&&_.d(),Kr(M,X),X&&nt(s),X&&nt(c),I&&I.d(),Kr(G,X)}}}function JT(n){let e,t,i,s,c,u,o,p,_,v,M,S;const I=n[13]["top-left"],R=Ra(I,n,n[12],y2),G=R||$T(n);let Y=n[5],X=[];for(let _e=0;_e<Y.length;_e+=1)X[_e]=b2(_2(n,Y,_e));const oe=_e=>He(X[_e],1,1,()=>{X[_e]=null});let Q=n[11](7),ce=[];for(let _e=0;_e<Q.length;_e+=1)ce[_e]=x2(m2(n,Q,_e));const De=_e=>He(ce[_e],1,1,()=>{ce[_e]=null});let Oe=n[11](24),Pe=[];for(let _e=0;_e<Oe.length;_e+=1)Pe[_e]=S2(d2(n,Oe,_e));const Se=_e=>He(Pe[_e],1,1,()=>{Pe[_e]=null});return{c(){e=mt("table"),t=mt("tr"),i=mt("th"),G&&G.c(),s=Jt();for(let _e=0;_e<X.length;_e+=1)X[_e].c();c=Jt(),u=mt("tr"),o=mt("td"),p=Jt();for(let _e=0;_e<ce.length;_e+=1)ce[_e].c();_=Jt();for(let _e=0;_e<Pe.length;_e+=1)Pe[_e].c();Ke(i,"width","9%"),he(i,"class","svelte-17qtwci"),he(t,"class","svelte-17qtwci"),Ke(o,"width","9%"),he(u,"class","h-0 nobold svelte-17qtwci"),he(e,"class","oh-table no-weblate w-full svelte-17qtwci"),he(e,"cellspacing","0"),he(e,"cellpadding","0"),Is(e,"hasselection",n[2]!==void 0),Is(e,"hasnoselection",n[2]===void 0)},m(_e,ze){at(_e,e,ze),ve(e,t),ve(t,i),G&&G.m(i,null),ve(t,s);for(let Re=0;Re<X.length;Re+=1)X[Re]&&X[Re].m(t,null);ve(e,c),ve(e,u),ve(u,o),ve(u,p);for(let Re=0;Re<ce.length;Re+=1)ce[Re]&&ce[Re].m(u,null);ve(e,_);for(let Re=0;Re<Pe.length;Re+=1)Pe[Re]&&Pe[Re].m(e,null);n[26](e),v=!0,M||(S=xt(e,"mouseleave",n[9]),M=!0)},p(_e,ze){if(R?R.p&&(!v||ze[0]&4096)&&Fa(R,I,_e,_e[12],v?Ba(I,_e[12],ze,GT):Oa(_e[12]),y2):G&&G.p&&(!v||ze[0]&1)&&G.p(_e,v?ze:[-1,-1]),ze[0]&32){Y=_e[5];let Re;for(Re=0;Re<Y.length;Re+=1){const Ye=_2(_e,Y,Re);X[Re]?(X[Re].p(Ye,ze),Fe(X[Re],1)):(X[Re]=b2(Ye),X[Re].c(),Fe(X[Re],1),X[Re].m(t,null))}for(Qi(),Re=Y.length;Re<X.length;Re+=1)oe(Re);en()}if(ze[0]&2073){Q=_e[11](7);let Re;for(Re=0;Re<Q.length;Re+=1){const Ye=m2(_e,Q,Re);ce[Re]?(ce[Re].p(Ye,ze),Fe(ce[Re],1)):(ce[Re]=x2(Ye),ce[Re].c(),Fe(ce[Re],1),ce[Re].m(u,null))}for(Qi(),Re=Q.length;Re<ce.length;Re+=1)De(Re);en()}if(ze[0]&2496){Oe=_e[11](24);let Re;for(Re=0;Re<Oe.length;Re+=1){const Ye=d2(_e,Oe,Re);Pe[Re]?(Pe[Re].p(Ye,ze),Fe(Pe[Re],1)):(Pe[Re]=S2(Ye),Pe[Re].c(),Fe(Pe[Re],1),Pe[Re].m(e,null))}for(Qi(),Re=Oe.length;Re<Pe.length;Re+=1)Se(Re);en()}(!v||ze[0]&4)&&Is(e,"hasselection",_e[2]!==void 0),(!v||ze[0]&4)&&Is(e,"hasnoselection",_e[2]===void 0)},i(_e){if(!v){Fe(G,_e);for(let ze=0;ze<Y.length;ze+=1)Fe(X[ze]);for(let ze=0;ze<Q.length;ze+=1)Fe(ce[ze]);for(let ze=0;ze<Oe.length;ze+=1)Fe(Pe[ze]);v=!0}},o(_e){He(G,_e),X=X.filter(Boolean);for(let ze=0;ze<X.length;ze+=1)He(X[ze]);ce=ce.filter(Boolean);for(let ze=0;ze<ce.length;ze+=1)He(ce[ze]);Pe=Pe.filter(Boolean);for(let ze=0;ze<Pe.length;ze+=1)He(Pe[ze]);v=!1},d(_e){_e&&nt(e),G&&G.d(_e),Kr(X,_e),Kr(ce,_e),Kr(Pe,_e),n[26](null),M=!1,S()}}}function ud(){const n=Array.from(document.getElementsByClassName("oh-timecell"));for(const e of n)e.classList.remove("oh-timecell-selected")}function XT(n,e,t,i){var s,c;for(let u=n;u<=e;u++)for(let o=t;o<i;o++){if(o=Math.floor(o),o>=t&&o<i){const p=document.getElementById("oh-full-"+o+"-"+u);(s=p==null?void 0:p.classList)==null||s.add("oh-timecell-selected")}if(o+.5<i){const p=document.getElementById("oh-half-"+o+"-"+u);(c=p==null?void 0:p.classList)==null||c.add("oh-timecell-selected")}}}function M2(n,e,t,i){let s=t,c=i;s>c&&(s=i-.5,c=t+.5),s==c&&(s-=.5,c+=.5),XT(Math.min(n,e),Math.max(n,e),s,c)}function D2(n,e){const t=(n.startHour+n.startMinutes/60)*e/24,i=(n.endHour-n.startHour+(n.endMinutes-n.startMinutes)/60)*e/24;return`top: ${t}px; height: ${i}px; z-index: 20`}function QT(n,e,t){let i,s=ci,c=()=>(s(),s=Vo(p,Et=>t(4,i=Et)),p);n.$$.on_destroy.push(()=>s());let{$$slots:u={},$$scope:o}=e,{value:p}=e;c();const _=yr.t.general.weekdays.abbreviations,v=[_.monday,_.tuesday,_.wednesday,_.thursday,_.friday,_.saturday,_.sunday];let M;function S(Et){return Gn.TimesT(Et,Vt=>Vt)}let I;function R(Et,Vt){t(2,I=[Et,Vt])}function G(Et,Vt){if(!I)return;M2(I[0],Et,I[1],Vt+.5),Vt+=.5;let Ki=Math.min(I[1],Vt),zt=Math.max(I[1],Vt);I[1]>Vt&&(zt+=.5,Ki-=.5),zt===Ki&&(zt+=.5,Ki-=.5);let _t=Math.round(Ki*60%60),Dt=Math.round(zt*60%60),Ft=[...p.data];for(let oi=Math.min(I[0],Et);oi<=Math.max(I[0],Et);oi++){const pi={startHour:Math.floor(Ki),endHour:Math.floor(zt),startMinutes:_t,endMinutes:Dt,weekday:oi};Ft.push(pi)}p.set(za.MergeTimes(Ft)),t(2,I=void 0),ud()}let Y;function X(Et,Vt){var Dt,Ft;Y=[Et,Vt],I&&(ud(),M2(I[0],Et,I[1],Vt+.5));const Ki=Array.from(M.getElementsByTagName("tr"));for(const oi of Ki)oi.classList.remove("hover"),oi.classList.remove("hovernext");const zt=Ki[Vt*2+2];(Dt=zt==null?void 0:zt.classList)==null||Dt.add("hover");const _t=Ki[Vt*2+3];(Ft=_t==null?void 0:_t.classList)==null||Ft.add("hovernext")}function oe(){G(...Y)}let Q=0;sc(()=>{requestAnimationFrame(()=>{const Et=document.getElementById("oh-full-0-0"),Vt=document.getElementById("oh-half-23-6"),Ki=Et.getBoundingClientRect().top,zt=Vt.getBoundingClientRect().bottom;t(3,Q=zt-Ki)})});const ce=()=>p.set([]),De=(Et,Vt)=>Vt.weekday===Et,Oe=Et=>za.rangeAs24Hr(Et),Pe=Et=>{const Vt=p.data.filter(Ki=>!za.isSame(Ki,Et));console.log("Cleaned",Vt,za.ToString(p.data)),p.set(Vt)},Se=(Et,Vt)=>R(Et,Vt),_e=(Et,Vt)=>G(Et,Vt),ze=(Et,Vt)=>X(Et,Vt),Re=()=>ud(),Ye=(Et,Vt)=>R(Et,Vt+.5),Xe=(Et,Vt)=>G(Et,Vt+.5),si=(Et,Vt)=>X(Et,Vt+.5),Bt=()=>ud();function bi(Et){Fs[Et?"unshift":"push"](()=>{M=Et,t(1,M)})}return n.$$set=Et=>{"value"in Et&&c(t(0,p=Et.value)),"$$scope"in Et&&t(12,o=Et.$$scope)},[p,M,I,Q,i,v,R,G,X,oe,_,S,o,u,ce,De,Oe,Pe,Se,_e,ze,Re,Ye,Xe,si,Bt,bi]}class eC extends Zi{constructor(e){super(),Gi(this,e,QT,JT,$i,{value:0},null,[-1,-1])}}class tC{constructor(e=new ki(""),t="",i=""){ft(this,"normalOhs");ft(this,"leftoverRules");ft(this,"phSelectorValue");var o;let s=e;t!==""&&i!==""&&(s=e.sync(p=>{if(p!==void 0)return p===""?"":p.startsWith(t)&&p.endsWith(i)?p.substring(t.length,p.length-i.length):p},[],p=>{if(p!==void 0)return p===""?"":p.startsWith(t)&&p.endsWith(i)?p:t+p+i})),this.leftoverRules=s.map(p=>{if(p===void 0)return[];const _=[],v=p.split(";");for(const M of v)za.ParseRule(M)===null&&za.ParsePHRule(M)===null&&(_.indexOf(M)>=0||_.push(M));return _});let c="";const u=((o=s.data)==null?void 0:o.split(";"))??[];for(const p of u)if(za.ParsePHRule(p)!==null){c=p;break}this.phSelectorValue=new ki(c??""),this.normalOhs=s.sync(p=>za.Parse(p),[this.leftoverRules,this.phSelectorValue],(p,_)=>{let v=za.ToString(p)+";";const M=this.phSelectorValue.data;for(M&&(v+=M+";"),v+=this.leftoverRules.data.join(";")+";",v=v.trim();v.endsWith(";");)v=v.substring(0,v.length-1);return v.startsWith(";")&&(v=v.substring(1)),v.trim(),v===_?_:v})}}function iC(n){let e,t,i,s,c,u,o;return e=new eC({props:{value:n[0].normalOhs}}),s=new H5({props:{class:"shrink-0 w-6 h-6 m-0 p-0",color:"white"}}),{c(){jt(e.$$.fragment),t=Jt(),i=mt("button"),jt(s.$$.fragment),he(i,"class","absolute left-0 bottom-0 primary pointer-events-auto h-8 w-10 rounded-full")},m(p,_){Ut(e,p,_),at(p,t,_),at(p,i,_),Ut(s,i,null),c=!0,u||(o=xt(i,"click",n[4]),u=!0)},p:ci,i(p){c||(Fe(e.$$.fragment,p),Fe(s.$$.fragment,p),c=!0)},o(p){He(e.$$.fragment,p),He(s.$$.fragment,p),c=!1},d(p){Wt(e,p),p&&nt(t),p&&nt(i),Wt(s),u=!1,o()}}}function nC(n){let e,t,i,s,c,u,o,p;return e=new mk({props:{bodyPadding:"p-0",shown:n[1],$$slots:{default:[iC]},$$scope:{ctx:n}}}),c=new WT({props:{value:n[0].phSelectorValue}}),{c(){jt(e.$$.fragment),t=Jt(),i=mt("button"),i.textContent="Pick opening hours",s=Jt(),jt(c.$$.fragment)},m(_,v){Ut(e,_,v),at(_,t,v),at(_,i,v),at(_,s,v),Ut(c,_,v),u=!0,o||(p=xt(i,"click",n[5]),o=!0)},p(_,[v]){const M={};v&256&&(M.$$scope={dirty:v,ctx:_}),e.$set(M)},i(_){u||(Fe(e.$$.fragment,_),Fe(c.$$.fragment,_),u=!0)},o(_){He(e.$$.fragment,_),He(c.$$.fragment,_),u=!1},d(_){Wt(e,_),_&&nt(t),_&&nt(i),_&&nt(s),Wt(c,_),o=!1,p()}}}function aC(n,e,t){let{value:i}=e,{args:s}=e,c="",u="";if(s)try{const M=JSON.stringify(s);M.prefix&&(c=M.prefix),M.postfix&&(u=M.postfix)}catch{console.error("Could not parse arguments")}const o=new tC(i,c,u);let p=new ki(!1);const _=()=>p.set(!1),v=()=>p.set(!0);return n.$$set=M=>{"value"in M&&t(2,i=M.value),"args"in M&&t(3,s=M.args)},[o,p,i,s,_,v]}class rC extends Zi{constructor(e){super(),Gi(this,e,aC,nC,$i,{value:2,args:3})}}function T2(n){var Q;let e,t,i,s,c,u,o,p,_,v,M,S,I,R,G,Y,X,oe;return I=new fa({props:{t:yr.t.validation.slope.inputExplanation}}),G=new l3({props:{condition:((Q=n[0])==null?void 0:Q.featureSwitchIsTesting)??new fd(!0),$$slots:{default:[lC]},$$scope:{ctx:n}}}),{c(){e=mt("div"),t=mt("div"),i=mt("div"),s=mt("div"),c=Sn(n[3]),u=Jt(),o=mt("div"),p=Sn(n[4]),_=Jt(),v=mt("button"),v.textContent="Select this incline",M=Jt(),S=mt("div"),jt(I.$$.fragment),R=Jt(),jt(G.$$.fragment),he(i,"class","flex w-full items-center justify-around text-5xl font-bold"),he(t,"class","flex w-full"),he(v,"class","primary"),he(e,"class","m-2 flex flex-col")},m(ce,De){at(ce,e,De),ve(e,t),ve(t,i),ve(i,s),ve(s,c),ve(i,u),ve(i,o),ve(o,p),ve(e,_),ve(e,v),ve(e,M),ve(e,S),Ut(I,S,null),ve(e,R),Ut(G,e,null),Y=!0,X||(oe=xt(v,"click",n[16]),X=!0)},p(ce,De){var Pe;(!Y||De&8)&&br(c,ce[3]),(!Y||De&16)&&br(p,ce[4]);const Oe={};De&1&&(Oe.condition=((Pe=ce[0])==null?void 0:Pe.featureSwitchIsTesting)??new fd(!0)),De&1048674&&(Oe.$$scope={dirty:De,ctx:ce}),G.$set(Oe)},i(ce){Y||(Fe(I.$$.fragment,ce),Fe(G.$$.fragment,ce),Y=!0)},o(ce){He(I.$$.fragment,ce),He(G.$$.fragment,ce),Y=!1},d(ce){ce&&nt(e),Wt(I),Wt(G),X=!1,oe()}}}function sC(n){let e;return{c(){e=Sn("Backward")},m(t,i){at(t,e,i)},d(t){t&&nt(e)}}}function oC(n){let e;return{c(){e=Sn("Forward")},m(t,i){at(t,e,i)},d(t){t&&nt(e)}}}function lC(n){let e,t,i,s,c,u,o=n[1]-n[5]+"",p,_;function v(I,R){return I[6]===1?oC:sC}let M=v(n),S=M(n);return{c(){e=mt("span"),t=Sn("Way: "),i=Sn(n[1]),s=Sn("°, compass: "),c=Sn(n[5]),u=Sn("°, diff: "),p=Sn(o),_=Jt(),S.c(),he(e,"class","subtle")},m(I,R){at(I,e,R),ve(e,t),ve(e,i),ve(e,s),ve(e,c),ve(e,u),ve(e,p),ve(e,_),S.m(e,null)},p(I,R){R&2&&br(i,I[1]),R&32&&br(c,I[5]),R&34&&o!==(o=I[1]-I[5]+"")&&br(p,o),M!==(M=v(I))&&(S.d(1),S=M(I),S&&(S.c(),S.m(e,null)))},d(I){I&&nt(e),S.d()}}}function cC(n){let e,t,i=n[2]&&T2(n);return{c(){i&&i.c(),e=$n()},m(s,c){i&&i.m(s,c),at(s,e,c),t=!0},p(s,[c]){s[2]?i?(i.p(s,c),c&4&&Fe(i,1)):(i=T2(s),i.c(),Fe(i,1),i.m(e.parentNode,e)):i&&(Qi(),He(i,1,1,()=>{i=null}),en())},i(s){t||(Fe(i),t=!0)},o(s){He(i),t=!1},d(s){i&&i.d(s),s&&nt(e)}}}function C2(n){const e=Math.tan(n*Math.PI/180)*100;return Math.round(e/2.5)*2.5+"%"}function uC(n,e,t){var Pe;let i,s,c,u,o,{value:p=new ki(void 0)}=e,_=new ki(void 0),{mode:v="percentage"}=e,{feature:M=void 0}=e,{state:S=void 0}=e,I=45;((Pe=M==null?void 0:M.geometry)==null?void 0:Pe.type)==="LineString"&&(I=Math.round(F2.bearing(M.geometry.coordinates[0],M.geometry.coordinates.at(-1))));let R=new ki(void 0);ya(n,R,Se=>t(3,s=Se));let G=new ki(void 0);ya(n,G,Se=>t(4,c=Se));const Y=Px.singleton;Y.startMeasurements();const X=Y.alpha;ya(n,X,Se=>t(5,u=Se));const oe=Y.beta;let Q=Y.gotMeasurement;ya(n,Q,Se=>t(2,i=Se));let ce=X.map(Se=>{if(I===void 0)return 1;I<0&&t(1,I+=360);let _e=Math.abs(I-Se)%360;return _e<90||_e>270?1:-1});ya(n,ce,Se=>t(6,o=Se)),oe.map(Se=>{let _e=ce.data;v==="degrees"?_.setData(_e*Se+"°"):_.setData(C2(_e*Se)),R.setData(Se+"°"),G.setData(C2(Se))},[ce,oe]);function De(){_.data&&p.setData(_.data)}const Oe=()=>De();return n.$$set=Se=>{"value"in Se&&t(13,p=Se.value),"mode"in Se&&t(14,v=Se.mode),"feature"in Se&&t(15,M=Se.feature),"state"in Se&&t(0,S=Se.state)},[S,I,i,s,c,u,o,R,G,X,Q,ce,De,p,v,M,Oe]}class hC extends Zi{constructor(e){super(),Gi(this,e,uC,cC,$i,{value:13,mode:14,feature:15,state:0})}}function P2(n,e,t){const i=n.slice();return i[21]=e[t],i[22]=e,i[23]=t,i}function A2(n,e,t){const i=n.slice();return i[21]=e[t],i[24]=e,i[25]=t,i}function dC(n){let e,t,i,s;const c=[yC,_C],u=[];function o(p,_){return p[6].success.length===0?0:1}return e=o(n),t=u[e]=c[e](n),{c(){t.c(),i=$n()},m(p,_){u[e].m(p,_),at(p,i,_),s=!0},p(p,_){let v=e;e=o(p),e===v?u[e].p(p,_):(Qi(),He(u[v],1,1,()=>{u[v]=null}),en(),t=u[e],t?t.p(p,_):(t=u[e]=c[e](p),t.c()),Fe(t,1),t.m(i.parentNode,i))},i(p){s||(Fe(t),s=!0)},o(p){He(t),s=!1},d(p){u[e].d(p),p&&nt(i)}}}function fC(n){let e,t,i;return t=new fa({props:{cls:"alert",t:n[8].failed}}),{c(){e=mt("div"),jt(t.$$.fragment),he(e,"class","flex w-full justify-center p-4")},m(s,c){at(s,e,c),Ut(t,e,null),i=!0},p:ci,i(s){i||(Fe(t.$$.fragment,s),i=!0)},o(s){He(t.$$.fragment,s),i=!1},d(s){s&&nt(e),Wt(t)}}}function pC(n){let e,t,i;return t=new H2({props:{$$slots:{default:[xC]},$$scope:{ctx:n}}}),{c(){e=mt("div"),jt(t.$$.fragment),he(e,"class","flex w-full justify-center p-4")},m(s,c){at(s,e,c),Ut(t,e,null),i=!0},p(s,c){const u={};c&67108864&&(u.$$scope={dirty:c,ctx:s}),t.$set(u)},i(s){i||(Fe(t.$$.fragment,s),i=!0)},o(s){He(t.$$.fragment,s),i=!1},d(s){s&&nt(e),Wt(t)}}}function mC(n){let e,t;return e=new fa({props:{t:n[8].searchToShort}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p:ci,i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function gC(n){let e,t;return e=new fa({props:{cls:"w-full flex justify-center p-4",t:n[8].doSearch}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p:ci,i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function _C(n){let e,t,i=n[6].success,s=[];for(let u=0;u<i.length;u+=1)s[u]=I2(A2(n,i,u));const c=u=>He(s[u],1,1,()=>{s[u]=null});return{c(){for(let u=0;u<s.length;u+=1)s[u].c();e=$n()},m(u,o){for(let p=0;p<s.length;p+=1)s[p]&&s[p].m(u,o);at(u,e,o),t=!0},p(u,o){if(o&92){i=u[6].success;let p;for(p=0;p<i.length;p+=1){const _=A2(u,i,p);s[p]?(s[p].p(_,o),Fe(s[p],1)):(s[p]=I2(_),s[p].c(),Fe(s[p],1),s[p].m(e.parentNode,e))}for(Qi(),p=i.length;p<s.length;p+=1)c(p);en()}},i(u){if(!t){for(let o=0;o<i.length;o+=1)Fe(s[o]);t=!0}},o(u){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)He(s[o]);t=!1},d(u){Kr(s,u),u&&nt(e)}}}function yC(n){let e,t;return e=new fa({props:{cls:"w-full flex justify-center p-4",t:n[8].noResults.Subs({search:n[5]})}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s&32&&(c.t=i[8].noResults.Subs({search:i[5]})),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function bC(n){let e,t,i=!1,s,c,u;return s=V2(n[16][0]),{c(){e=mt("input"),he(e,"type","radio"),he(e,"name","selectedWikidata"),e.__value=t=n[21],e.value=e.__value,s.p(e)},m(o,p){at(o,e,p),e.checked=e.__value===n[3],c||(u=xt(e,"change",n[15]),c=!0)},p(o,p){p&64&&t!==(t=o[21])&&(e.__value=t,e.value=e.__value,i=!0),(i||p&136)&&(e.checked=e.__value===o[3])},d(o){o&&nt(e),s.r(),c=!1,u()}}}function vC(n){let e,t,i;function s(){n[14].call(e,n[21])}return{c(){e=mt("input"),he(e,"type","checkbox")},m(c,u){at(c,e,u),e.checked=n[4][n[21].id],t||(i=xt(e,"change",s),t=!0)},p(c,u){n=c,u&80&&(e.checked=n[4][n[21].id])},d(c){c&&nt(e),t=!1,i()}}}function I2(n){let e,t,i,s,c;function u(_,v){return _[2]?vC:bC}let o=u(n),p=o(n);return i=new py({props:{wikidata:n[21]}}),{c(){e=mt("label"),p.c(),t=Jt(),jt(i.$$.fragment),s=Jt(),he(e,"class","low-interaction m-4 flex items-center rounded-xl p-2")},m(_,v){at(_,e,v),p.m(e,null),ve(e,t),Ut(i,e,null),ve(e,s),c=!0},p(_,v){o===(o=u(_))&&p?p.p(_,v):(p.d(1),p=o(_),p&&(p.c(),p.m(e,t)));const M={};v&64&&(M.wikidata=_[21]),i.$set(M)},i(_){c||(Fe(i.$$.fragment,_),c=!0)},o(_){He(i.$$.fragment,_),c=!1},d(_){_&&nt(e),p.d(),Wt(i)}}}function xC(n){let e,t;return e=new fa({props:{t:yr.t.general.loading}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p:ci,i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function wC(n){let e,t,i=!1,s,c,u;return s=V2(n[16][0]),{c(){e=mt("input"),he(e,"type","radio"),he(e,"name","selectedWikidata"),e.__value=t=n[21],e.value=e.__value,s.p(e)},m(o,p){at(o,e,p),e.checked=e.__value===n[3],c||(u=xt(e,"change",n[18]),c=!0)},p(o,p){p&128&&t!==(t=o[21])&&(e.__value=t,e.value=e.__value,i=!0),(i||p&136)&&(e.checked=e.__value===o[3])},d(o){o&&nt(e),s.r(),c=!1,u()}}}function kC(n){let e,t,i;function s(){n[17].call(e,n[21])}return{c(){e=mt("input"),he(e,"type","checkbox")},m(c,u){at(c,e,u),e.checked=n[4][n[21].id],t||(i=xt(e,"change",s),t=!0)},p(c,u){n=c,u&144&&(e.checked=n[4][n[21].id])},d(c){c&&nt(e),t=!1,i()}}}function E2(n){let e,t,i,s,c;function u(_,v){return _[2]?kC:wC}let o=u(n),p=o(n);return i=new py({props:{wikidata:n[21]}}),{c(){e=mt("label"),p.c(),t=Jt(),jt(i.$$.fragment),s=Jt(),he(e,"class","low-interaction m-4 flex items-center rounded-xl p-2")},m(_,v){at(_,e,v),p.m(e,null),ve(e,t),Ut(i,e,null),ve(e,s),c=!0},p(_,v){o===(o=u(_))&&p?p.p(_,v):(p.d(1),p=o(_),p&&(p.c(),p.m(e,t)));const M={};v&128&&(M.wikidata=_[21]),i.$set(M)},i(_){c||(Fe(i.$$.fragment,_),c=!0)},o(_){He(i.$$.fragment,_),c=!1},d(_){_&&nt(e),p.d(),Wt(i)}}}function SC(n){let e,t,i,s,c,u,o,p,_,v,M,S;t=new fa({props:{t:yr.t.general.wikipedia.searchWikidata}}),c=new Ax({props:{value:n[0],placeholder:n[1]}});const I=[gC,mC,pC,fC,dC],R=[];function G(Q,ce){return ce&32&&(o=null),ce&32&&(p=null),o==null&&(o=Q[5].trim().length===0),o?0:(p==null&&(p=Q[5].trim().length<3),p?1:Q[6]===void 0?2:Q[6].error!==void 0?3:Q[6].success?4:-1)}~(_=G(n,-1))&&(v=R[_]=I[_](n));let Y=n[7],X=[];for(let Q=0;Q<Y.length;Q+=1)X[Q]=E2(P2(n,Y,Q));const oe=Q=>He(X[Q],1,1,()=>{X[Q]=null});return{c(){e=mt("h3"),jt(t.$$.fragment),i=Jt(),s=mt("form"),jt(c.$$.fragment),u=Jt(),v&&v.c(),M=Jt();for(let Q=0;Q<X.length;Q+=1)X[Q].c()},m(Q,ce){at(Q,e,ce),Ut(t,e,null),at(Q,i,ce),at(Q,s,ce),Ut(c,s,null),ve(s,u),~_&&R[_].m(s,null),ve(s,M);for(let De=0;De<X.length;De+=1)X[De]&&X[De].m(s,null);S=!0},p(Q,[ce]){const De={};ce&1&&(De.value=Q[0]),ce&2&&(De.placeholder=Q[1]),c.$set(De);let Oe=_;if(_=G(Q,ce),_===Oe?~_&&R[_].p(Q,ce):(v&&(Qi(),He(R[Oe],1,1,()=>{R[Oe]=null}),en()),~_?(v=R[_],v?v.p(Q,ce):(v=R[_]=I[_](Q),v.c()),Fe(v,1),v.m(s,M)):v=null),ce&156){Y=Q[7];let Pe;for(Pe=0;Pe<Y.length;Pe+=1){const Se=P2(Q,Y,Pe);X[Pe]?(X[Pe].p(Se,ce),Fe(X[Pe],1)):(X[Pe]=E2(Se),X[Pe].c(),Fe(X[Pe],1),X[Pe].m(s,null))}for(Qi(),Pe=Y.length;Pe<X.length;Pe+=1)oe(Pe);en()}},i(Q){if(!S){Fe(t.$$.fragment,Q),Fe(c.$$.fragment,Q),Fe(v);for(let ce=0;ce<Y.length;ce+=1)Fe(X[ce]);S=!0}},o(Q){He(t.$$.fragment,Q),He(c.$$.fragment,Q),He(v),X=X.filter(Boolean);for(let ce=0;ce<X.length;ce+=1)He(X[ce]);S=!1},d(Q){Q&&nt(e),Wt(t),Q&&nt(i),Q&&nt(s),Wt(c),~_&&R[_].d(),Kr(X,Q)}}}function MC(n,e,t){let i,s=ci,c=()=>(s(),s=Vo(_,ze=>t(5,i=ze)),_),u,o;n.$$.on_destroy.push(()=>s());const p=yr.t.general.wikipedia;let{searchValue:_=new ki(void 0)}=e;c();let{placeholder:v=p.searchWikidata}=e,{allowMultiple:M=!1}=e,{notInstanceOf:S=[]}=e,{instanceOf:I=[]}=e,{value:R}=e,G,Y={},X=new Map,oe=new fd({success:void 0}),Q=_.bind(ze=>{if(ze.length<3&&!ze.match(/[qQ][0-9]+/))return oe;const Re=fm.language.data,Ye=Re+":"+ze;let Xe=Np._searchCache.get(Ye);return Xe===void 0&&(Xe=Lu.searchAndFetch(ze,{lang:Re,maxCount:5,notInstanceOf:S,instanceOf:I}),Np._searchCache.set(Ye,Xe)),dd.FromPromiseWithErr(Xe)});ya(n,Q,ze=>t(6,u=ze));let ce=Q.map(ze=>{var Xe;for(const si of(ze==null?void 0:ze.success)??[])X.set(si.id,si);let Re=new Set((Xe=ze==null?void 0:ze.success)==null?void 0:Xe.map(si=>si.id));const Ye=[G];for(const si in Y)if(Y[si]){const Bt=X.get(si);Ye.push(Bt)}return Gn.NoNull(Ye).filter(si=>!Re.has(si.id))});ya(n,ce,ze=>t(7,o=ze));const De=[[]];function Oe(ze){Y[ze.id]=this.checked,t(4,Y)}function Pe(){G=this.__value,t(3,G)}function Se(ze){Y[ze.id]=this.checked,t(4,Y)}function _e(){G=this.__value,t(3,G)}return n.$$set=ze=>{"searchValue"in ze&&c(t(0,_=ze.searchValue)),"placeholder"in ze&&t(1,v=ze.placeholder),"allowMultiple"in ze&&t(2,M=ze.allowMultiple),"notInstanceOf"in ze&&t(11,S=ze.notInstanceOf),"instanceOf"in ze&&t(12,I=ze.instanceOf),"value"in ze&&t(13,R=ze.value)},n.$$.update=()=>{if(n.$$.dirty&8200&&G&&R.setData(G.id),n.$$.dirty&8208){const ze=[];for(const Re in Y)Y[Re]&&ze.push(Re);R.setData(ze.join(";"))}},[_,v,M,G,Y,i,u,o,p,Q,ce,S,I,R,Oe,Pe,De,Se,_e]}class DC extends Zi{constructor(e){super(),Gi(this,e,MC,SC,$i,{searchValue:0,placeholder:1,allowMultiple:2,notInstanceOf:11,instanceOf:12,value:13})}}function TC(n){let e,t;return e=new DC({props:{searchValue:n[1],value:n[0],instanceOf:n[2],notInstanceOf:n[3],allowMultiple:n[4]}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,[s]){const c={};s&1&&(c.value=i[0]),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function CC(n,e,t){let{args:i=[]}=e,{feature:s}=e,{value:c}=e,o=(i[0]??"name").split(";").map(R=>{var G;return(G=s==null?void 0:s.properties[R])==null?void 0:G.toLowerCase()}).find(R=>!!R)??"";const p=i[1];let _=new ki(o);$r(fm.language.addCallbackAndRunD(R=>{if(console.log(p),o!==void 0&&p!==void 0){const G=p.removePostfixes??[],Y=p.removePrefixes??[],X=Np.removePostAndPrefixes(o,Y,G,R);console.log("Got clipped value:",X,G,Y),_.setData(X)}}));let v=Gn.NoNull(((p==null?void 0:p.instanceOf)??[]).map(R=>Lu.QIdToNumber(R))),M=Gn.NoNull(((p==null?void 0:p.notInstanceOf)??[]).map(R=>Lu.QIdToNumber(R))),S=p==null?void 0:p.multiple,I=S==="yes"||""+S=="true";return n.$$set=R=>{"args"in R&&t(5,i=R.args),"feature"in R&&t(6,s=R.feature),"value"in R&&t(0,c=R.value)},[c,_,v,M,I,i,s]}class PC extends Zi{constructor(e){super(),Gi(this,e,CC,TC,$i,{args:5,feature:6,value:0})}}const AC=n=>({}),L2=n=>({});function IC(n){let e;const t=n[6].fallback,i=Ra(t,n,n[5],L2);return{c(){i&&i.c()},m(s,c){i&&i.m(s,c),e=!0},p(s,c){i&&i.p&&(!e||c&32)&&Fa(i,t,s,s[5],e?Ba(t,s[5],c,AC):Oa(s[5]),L2)},i(s){e||(Fe(i,s),e=!0)},o(s){He(i,s),e=!1},d(s){i&&i.d(s)}}}function EC(n){let e,t;return e=new PC({props:{value:n[1],feature:n[2],state:n[4],args:n[3]}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s&2&&(c.value=i[1]),s&4&&(c.feature=i[2]),s&16&&(c.state=i[4]),s&8&&(c.args=i[3]),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function LC(n){let e,t;return e=new hC({props:{value:n[1],feature:n[2],state:n[4]}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s&2&&(c.value=i[1]),s&4&&(c.feature=i[2]),s&16&&(c.state=i[4]),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function zC(n){let e,t;return e=new rC({props:{value:n[1],args:n[3]}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s&2&&(c.value=i[1]),s&8&&(c.args=i[3]),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function RC(n){let e,t;return e=new TT({props:{value:n[1],args:n[3]}}),e.$on("submit",n[9]),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s&2&&(c.value=i[1]),s&8&&(c.args=i[3]),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function FC(n){let e,t;return e=new VD({props:{value:n[1]}}),e.$on("submit",n[8]),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s&2&&(c.value=i[1]),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function OC(n){let e,t;return e=new mD({props:{value:n[1]}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s&2&&(c.value=i[1]),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function BC(n){let e,t;return e=new NT({props:{value:n[1]}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s&2&&(c.value=i[1]),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function NC(n){let e,t;return e=new FT({props:{value:n[1]}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s&2&&(c.value=i[1]),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function VC(n){let e,t;return e=new LT({props:{value:n[1],state:n[4],mapProperties:cm.constructMapProperties({feature:n[2],args:n[3]??[]})}}),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s&2&&(c.value=i[1]),s&16&&(c.state=i[4]),s&12&&(c.mapProperties=cm.constructMapProperties({feature:i[2],args:i[3]??[]})),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function HC(n){let e,t;return e=new yD({props:{value:n[1],args:n[3]}}),e.$on("submit",n[7]),{c(){jt(e.$$.fragment)},m(i,s){Ut(e,i,s),t=!0},p(i,s){const c={};s&2&&(c.value=i[1]),s&8&&(c.args=i[3]),e.$set(c)},i(i){t||(Fe(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){Wt(e,i)}}}function jC(n){let e,t,i,s;const c=[HC,VC,NC,BC,OC,FC,RC,zC,LC,EC,IC],u=[];function o(p,_){return p[0]==="translation"?0:p[0]==="direction"?1:p[0]==="date"?2:p[0]==="color"?3:p[0]==="image"?4:p[0]==="tag"?5:p[0]==="simple_tag"?6:p[0]==="opening_hours"?7:p[0]==="slope"?8:p[0]==="wikidata"?9:10}return e=o(n),t=u[e]=c[e](n),{c(){t.c(),i=$n()},m(p,_){u[e].m(p,_),at(p,i,_),s=!0},p(p,[_]){let v=e;e=o(p),e===v?u[e].p(p,_):(Qi(),He(u[v],1,1,()=>{u[v]=null}),en(),t=u[e],t?t.p(p,_):(t=u[e]=c[e](p),t.c()),Fe(t,1),t.m(i.parentNode,i))},i(p){s||(Fe(t),s=!0)},o(p){He(t),s=!1},d(p){u[e].d(p),p&&nt(i)}}}function UC(n,e,t){let{$$slots:i={},$$scope:s}=e,{type:c}=e,{value:u}=e,{feature:o=void 0}=e,{args:p=void 0}=e,{state:_=void 0}=e;function v(I){ei.call(this,n,I)}function M(I){ei.call(this,n,I)}function S(I){ei.call(this,n,I)}return n.$$set=I=>{"type"in I&&t(0,c=I.type),"value"in I&&t(1,u=I.value),"feature"in I&&t(2,o=I.feature),"args"in I&&t(3,p=I.args),"state"in I&&t(4,_=I.state),"$$scope"in I&&t(5,s=I.$$scope)},[c,u,o,p,_,s,i,v,M,S]}class sP extends Zi{constructor(e){super(),Gi(this,e,UC,jC,$i,{type:0,value:1,feature:2,args:3,state:4})}}export{my as C,Eo as F,l3 as I,tP as L,Gp as M,za as O,mk as P,nP as S,Xg as T,c3 as U,lm as V,iP as W,G2 as a,Hd as b,W5 as c,q5 as d,$p as e,py as f,Ps as g,aP as h,Om as i,jd as j,sP as k,cm as l,md as m,ST as n,aw as o,fb as p,Kx as q,Nd as r};
//# sourceMappingURL=InputHelper-faaa0b22.js.map
