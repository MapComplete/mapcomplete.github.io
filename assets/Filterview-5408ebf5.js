import{S as oe,i as re,s as fe,e as T,a as z,b as I,W as N,d,f as q,t as c,D as w,E as y,g as _,h,N as P,F as O,V as ae,C as j,c as $,m as k,j as v,n as F,G as J,ad as ue,O as ce,Q as _e}from"./index-34c7dc31.js";import{a as Q,U as me,I as G}from"./UIEventSource-64bbdd19.js";import{T as B,L as pe,a as ge}from"./tw-merge-66414870.js";import"./Searchbar-eb0f1244.js";import"./Constants-823bf632.js";import{F as de,k as he,V as be,T as $e}from"./InputHelper-fb3b5e2c.js";import{C as se}from"./Checkbox-9bedbe7a.js";import{D as ke}from"./Dropdown-8b54df95.js";function A(s,e,i){const t=s.slice();return t[15]=e[i],t[17]=i,t}function ve(s){let e,i=s[15].message+"",t;return{c(){e=new ue(!1),t=j(),e.a=t},m(l,f){e.m(i,l,f),d(l,t,f)},p(l,f){f&1&&i!==(i=l[15].message+"")&&e.p(i)},i:F,o:F,d(l){l&&h(t),l&&e.d()}}}function we(s){let e,i,t;return i=new he({props:{value:s[1][s[15].subs],type:s[2][s[15].subs],$$slots:{fallback:[ye]},$$scope:{ctx:s}}}),{c(){e=T("span"),$(i.$$.fragment),I(e,"class","mx-1")},m(l,f){d(l,e,f),k(i,e,null),t=!0},p(l,f){const o={};f&3&&(o.value=l[1][l[15].subs]),f&5&&(o.type=l[2][l[15].subs]),f&262151&&(o.$$scope={dirty:f,ctx:l}),i.$set(o)},i(l){t||(c(i.$$.fragment,l),t=!0)},o(l){_(i.$$.fragment,l),t=!1},d(l){l&&h(e),v(i)}}}function ye(s){let e,i;return e=new be({props:{slot:"fallback",value:s[1][s[15].subs],type:s[2][s[15].subs],feedback:s[7]}}),{c(){$(e.$$.fragment)},m(t,l){k(e,t,l),i=!0},p(t,l){const f={};l&3&&(f.value=t[1][t[15].subs]),l&5&&(f.type=t[2][t[15].subs]),e.$set(f)},i(t){i||(c(e.$$.fragment,t),i=!0)},o(t){_(e.$$.fragment,t),i=!1},d(t){v(e,t)}}}function K(s){let e,i,t,l;const f=[we,ve],o=[];function r(n,a){return n[15].subs?0:1}return e=r(s),i=o[e]=f[e](s),{c(){i.c(),t=j()},m(n,a){o[e].m(n,a),d(n,t,a),l=!0},p(n,a){let u=e;e=r(n),e===u?o[e].p(n,a):(w(),_(o[u],1,1,()=>{o[u]=null}),y(),i=o[e],i?i.p(n,a):(i=o[e]=f[e](n),i.c()),c(i,1),i.m(t.parentNode,t))},i(n){l||(c(i),l=!0)},o(n){_(i),l=!1},d(n){o[e].d(n),n&&h(t)}}}function M(s){let e,i;return e=new B({props:{cls:"alert",t:s[5]}}),{c(){$(e.$$.fragment)},m(t,l){k(e,t,l),i=!0},p(t,l){const f={};l&32&&(f.t=t[5]),e.$set(f)},i(t){i||(c(e.$$.fragment,t),i=!0)},o(t){_(e.$$.fragment,t),i=!1},d(t){v(e,t)}}}function De(s){let e,i,t,l=s[0],f=[];for(let n=0;n<l.length;n+=1)f[n]=K(A(s,l,n));const o=n=>_(f[n],1,1,()=>{f[n]=null});let r=s[5]&&M(s);return{c(){var n;e=T("div");for(let a=0;a<f.length;a+=1)f[a].c();i=z(),r&&r.c(),I(e,"class","low-interaction rounded-2xl p-1 px-3"),N(e,"interactive",((n=s[4])==null?void 0:n.length)>0)},m(n,a){d(n,e,a);for(let u=0;u<f.length;u+=1)f[u]&&f[u].m(e,null);q(e,i),r&&r.m(e,null),t=!0},p(n,[a]){var u;if(a&135){l=n[0];let m;for(m=0;m<l.length;m+=1){const b=A(n,l,m);f[m]?(f[m].p(b,a),c(f[m],1)):(f[m]=K(b),f[m].c(),c(f[m],1),f[m].m(e,i))}for(w(),m=l.length;m<f.length;m+=1)o(m);y()}n[5]?r?(r.p(n,a),a&32&&c(r,1)):(r=M(n),r.c(),c(r,1),r.m(e,null)):r&&(w(),_(r,1,1,()=>{r=null}),y()),(!t||a&16)&&N(e,"interactive",((u=n[4])==null?void 0:u.length)>0)},i(n){if(!t){for(let a=0;a<l.length;a+=1)c(f[a]);c(r),t=!0}},o(n){f=f.filter(Boolean);for(let a=0;a<f.length;a+=1)_(f[a]);_(r),t=!1},d(n){n&&h(e),P(f,n),r&&r.d()}}}function Le(s,e,i){let t,l,f=F,o=()=>(f(),f=J(C,p=>i(4,l=p)),C),r;s.$$.on_destroy.push(()=>f());let{filteredLayer:n}=e,{option:a}=e,{id:u}=e,m,b=pe.language;O(s,b,p=>i(11,t=p));let L={},V={},S=n.appliedFilters.get(u),U=JSON.parse((S==null?void 0:S.data)??"{}");function E(){const p={};for(const D in L){const g=L[D].data;g===void 0?p[D]=void 0:p[D]=g}S==null||S.setData(de.fieldsToString(p))}let C;for(const p of a.fields){const D=new Q(U[p.name]??"");o(C??(C=D)),V[p.name]=p.type,console.log(p.name,"-->",p.type),L[p.name]=D,ae(D.stabilized(200).addCallback(()=>{E()}))}let H=new Q(void 0);return O(s,H,p=>i(5,r=p)),s.$$set=p=>{"filteredLayer"in p&&i(8,n=p.filteredLayer),"option"in p&&i(9,a=p.option),"id"in p&&i(10,u=p.id)},s.$$.update=()=>{if(s.$$.dirty&2560){const p=a.question.textFor(t);i(0,m=me.splitIntoSubstitutionParts(p))}},[m,L,V,C,l,r,b,H,n,a,u,t]}class Se extends oe{constructor(e){super(),re(this,e,Le,De,fe,{filteredLayer:8,option:9,id:10})}}function R(s,e,i){const t=s.slice();return t[14]=e[i],t}function X(s,e,i){const t=s.slice();return t[17]=e[i],t[19]=i,t}function ze(s){let e;return{c(){e=T("div"),e.textContent=`${s[7].id} (no name)`,I(e,"class","code")},m(i,t){d(i,e,t)},p:F,i:F,o:F,d(i){i&&h(e)}}}function Fe(s){var o;let e,i,t,l;i=new se({props:{selected:s[8],$$slots:{default:[Te]},$$scope:{ctx:s}}});let f=s[4]&&((o=s[0].layerDef.filters)==null?void 0:o.length)>0&&Z(s);return{c(){e=T("div"),$(i.$$.fragment),t=z(),f&&f.c(),I(e,"class","mb-1.5"),N(e,"focus",s[3]===s[0].layerDef.id)},m(r,n){d(r,e,n),k(i,e,null),q(e,t),f&&f.m(e,null),l=!0},p(r,n){var u;const a={};n&1048625&&(a.$$scope={dirty:n,ctx:r}),i.$set(a),r[4]&&((u=r[0].layerDef.filters)==null?void 0:u.length)>0?f?(f.p(r,n),n&17&&c(f,1)):(f=Z(r),f.c(),c(f,1),f.m(e,null)):f&&(w(),_(f,1,1,()=>{f=null}),y()),(!l||n&9)&&N(e,"focus",r[3]===r[0].layerDef.id)},i(r){l||(c(i.$$.fragment,r),c(f),l=!0)},o(r){_(i.$$.fragment,r),_(f),l=!1},d(r){r&&h(e),v(i),f&&f.d()}}}function Y(s){let e,i,t;return i=new B({props:{t:ge.t.general.layerSelection.zoomInToSeeThisLayer}}),{c(){e=T("span"),$(i.$$.fragment),I(e,"class","alert")},m(l,f){d(l,e,f),k(i,e,null),t=!0},p:F,i(l){t||(c(i.$$.fragment,l),t=!0)},o(l){_(i.$$.fragment,l),t=!1},d(l){l&&h(e),v(i)}}}function Te(s){let e,i,t,l,f,o,r;i=new $e({props:{construct:s[13]}}),l=new B({props:{t:s[0].layerDef.name}});let n=s[5]<s[7].minzoom&&Y();return{c(){e=T("div"),$(i.$$.fragment),t=z(),$(l.$$.fragment),f=z(),n&&n.c(),o=j(),I(e,"class","no-image-background block h-6 w-6"),N(e,"opacity-50",!s[4])},m(a,u){d(a,e,u),k(i,e,null),d(a,t,u),k(l,a,u),d(a,f,u),n&&n.m(a,u),d(a,o,u),r=!0},p(a,u){(!r||u&16)&&N(e,"opacity-50",!a[4]);const m={};u&1&&(m.t=a[0].layerDef.name),l.$set(m),a[5]<a[7].minzoom?n?(n.p(a,u),u&32&&c(n,1)):(n=Y(),n.c(),c(n,1),n.m(o.parentNode,o)):n&&(w(),_(n,1,1,()=>{n=null}),y())},i(a){r||(c(i.$$.fragment,a),c(l.$$.fragment,a),c(n),r=!0)},o(a){_(i.$$.fragment,a),_(l.$$.fragment,a),_(n),r=!1},d(a){a&&h(e),v(i),a&&h(t),v(l,a),a&&h(f),n&&n.d(a),a&&h(o)}}}function Z(s){let e,i,t=s[0].layerDef.filters,l=[];for(let o=0;o<t.length;o+=1)l[o]=ie(R(s,t,o));const f=o=>_(l[o],1,1,()=>{l[o]=null});return{c(){e=T("div");for(let o=0;o<l.length;o+=1)l[o].c();I(e,"id","subfilters"),I(e,"class","ml-4 flex flex-col gap-y-1")},m(o,r){d(o,e,r);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null);i=!0},p(o,r){if(r&3073){t=o[0].layerDef.filters;let n;for(n=0;n<t.length;n+=1){const a=R(o,t,n);l[n]?(l[n].p(a,r),c(l[n],1)):(l[n]=ie(a),l[n].c(),c(l[n],1),l[n].m(e,null))}for(w(),n=t.length;n<l.length;n+=1)f(n);y()}},i(o){if(!i){for(let r=0;r<t.length;r+=1)c(l[r]);i=!0}},o(o){l=l.filter(Boolean);for(let r=0;r<l.length;r+=1)_(l[r]);i=!1},d(o){o&&h(e),P(l,o)}}}function x(s){let e,i;return e=new se({props:{selected:s[10](s[14]),$$slots:{default:[Ie]},$$scope:{ctx:s}}}),{c(){$(e.$$.fragment)},m(t,l){k(e,t,l),i=!0},p(t,l){const f={};l&1&&(f.selected=t[10](t[14])),l&1048577&&(f.$$scope={dirty:l,ctx:t}),e.$set(f)},i(t){i||(c(e.$$.fragment,t),i=!0)},o(t){_(e.$$.fragment,t),i=!1},d(t){v(e,t)}}}function Ie(s){let e,i;return e=new B({props:{t:s[14].options[0].question}}),{c(){$(e.$$.fragment)},m(t,l){k(e,t,l),i=!0},p(t,l){const f={};l&1&&(f.t=t[14].options[0].question),e.$set(f)},i(t){i||(c(e.$$.fragment,t),i=!0)},o(t){_(e.$$.fragment,t),i=!1},d(t){v(e,t)}}}function ee(s){let e,i;return e=new Se({props:{id:s[14].id,filteredLayer:s[0],option:s[14].options[0]}}),{c(){$(e.$$.fragment)},m(t,l){k(e,t,l),i=!0},p(t,l){const f={};l&1&&(f.id=t[14].id),l&1&&(f.filteredLayer=t[0]),l&1&&(f.option=t[14].options[0]),e.$set(f)},i(t){i||(c(e.$$.fragment,t),i=!0)},o(t){_(e.$$.fragment,t),i=!1},d(t){v(e,t)}}}function te(s){let e,i;return e=new ke({props:{value:s[11](s[14]),$$slots:{default:[Ve]},$$scope:{ctx:s}}}),{c(){$(e.$$.fragment)},m(t,l){k(e,t,l),i=!0},p(t,l){const f={};l&1&&(f.value=t[11](t[14])),l&1048577&&(f.$$scope={dirty:l,ctx:t}),e.$set(f)},i(t){i||(c(e.$$.fragment,t),i=!0)},o(t){_(e.$$.fragment,t),i=!1},d(t){v(e,t)}}}function le(s){let e=s[17].emoji+"",i;return{c(){i=ce(e)},m(t,l){d(t,i,l)},p(t,l){l&1&&e!==(e=t[17].emoji+"")&&_e(i,e)},d(t){t&&h(i)}}}function ne(s){let e,i,t,l,f,o=s[17].emoji&&le(s);return t=new B({props:{t:s[17].question}}),{c(){e=T("option"),o&&o.c(),i=z(),$(t.$$.fragment),l=z(),e.__value=s[19],e.value=e.__value},m(r,n){d(r,e,n),o&&o.m(e,null),q(e,i),k(t,e,null),q(e,l),f=!0},p(r,n){r[17].emoji?o?o.p(r,n):(o=le(r),o.c(),o.m(e,i)):o&&(o.d(1),o=null);const a={};n&1&&(a.t=r[17].question),t.$set(a)},i(r){f||(c(t.$$.fragment,r),f=!0)},o(r){_(t.$$.fragment,r),f=!1},d(r){r&&h(e),o&&o.d(),v(t)}}}function Ve(s){let e,i,t=s[14].options,l=[];for(let o=0;o<t.length;o+=1)l[o]=ne(X(s,t,o));const f=o=>_(l[o],1,1,()=>{l[o]=null});return{c(){for(let o=0;o<l.length;o+=1)l[o].c();e=j()},m(o,r){for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(o,r);d(o,e,r),i=!0},p(o,r){if(r&1){t=o[14].options;let n;for(n=0;n<t.length;n+=1){const a=X(o,t,n);l[n]?(l[n].p(a,r),c(l[n],1)):(l[n]=ne(a),l[n].c(),c(l[n],1),l[n].m(e.parentNode,e))}for(w(),n=t.length;n<l.length;n+=1)f(n);y()}},i(o){if(!i){for(let r=0;r<t.length;r+=1)c(l[r]);i=!0}},o(o){l=l.filter(Boolean);for(let r=0;r<l.length;r+=1)_(l[r]);i=!1},d(o){P(l,o),o&&h(e)}}}function ie(s){let e,i,t,l,f,o=s[14].options.length===1&&s[14].options[0].fields.length===0&&x(s),r=s[14].options.length===1&&s[14].options[0].fields.length>0&&ee(s),n=s[14].options.length>1&&te(s);return{c(){e=T("div"),o&&o.c(),i=z(),r&&r.c(),t=z(),n&&n.c(),l=z()},m(a,u){d(a,e,u),o&&o.m(e,null),q(e,i),r&&r.m(e,null),q(e,t),n&&n.m(e,null),q(e,l),f=!0},p(a,u){a[14].options.length===1&&a[14].options[0].fields.length===0?o?(o.p(a,u),u&1&&c(o,1)):(o=x(a),o.c(),c(o,1),o.m(e,i)):o&&(w(),_(o,1,1,()=>{o=null}),y()),a[14].options.length===1&&a[14].options[0].fields.length>0?r?(r.p(a,u),u&1&&c(r,1)):(r=ee(a),r.c(),c(r,1),r.m(e,t)):r&&(w(),_(r,1,1,()=>{r=null}),y()),a[14].options.length>1?n?(n.p(a,u),u&1&&c(n,1)):(n=te(a),n.c(),c(n,1),n.m(e,l)):n&&(w(),_(n,1,1,()=>{n=null}),y())},i(a){f||(c(o),c(r),c(n),f=!0)},o(a){_(o),_(r),_(n),f=!1},d(a){a&&h(e),o&&o.d(),r&&r.d(),n&&n.d()}}}function qe(s){let e,i,t,l;const f=[Fe,ze],o=[];function r(n,a){return n[0].layerDef.name?0:n[6]?1:-1}return~(e=r(s))&&(i=o[e]=f[e](s)),{c(){i&&i.c(),t=j()},m(n,a){~e&&o[e].m(n,a),d(n,t,a),l=!0},p(n,[a]){let u=e;e=r(n),e===u?~e&&o[e].p(n,a):(i&&(w(),_(o[u],1,1,()=>{o[u]=null}),y()),~e?(i=o[e],i?i.p(n,a):(i=o[e]=f[e](n),i.c()),c(i,1),i.m(t.parentNode,t)):i=null)},i(n){l||(c(i),l=!0)},o(n){_(i),l=!1},d(n){~e&&o[e].d(n),n&&h(t)}}}function Ce(s,e,i){var D;let t,l=F,f=()=>(l(),l=J(L,g=>i(3,t=g)),L),o,r,n=F,a=()=>(n(),n=J(V,g=>i(5,r=g)),V),u;s.$$.on_destroy.push(()=>l()),s.$$.on_destroy.push(()=>n());let{state:m}=e,{filteredLayer:b}=e,{highlightedLayer:L=new G(void 0)}=e;f();let{zoomlevel:V=new G(22)}=e;a();let S=b.layerDef,U=b.isDisplayed;O(s,U,g=>i(4,o=g));let E=((D=m==null?void 0:m.featureSwitches)==null?void 0:D.featureSwitchIsDebugging)??new G(!1);O(s,E,g=>i(6,u=g));function C(g){return b.appliedFilters.get(g.id).sync(W=>W===0,[],W=>W?0:void 0)}function H(g){return b.appliedFilters.get(g.id)}const p=()=>S.defaultIcon();return s.$$set=g=>{"state"in g&&i(12,m=g.state),"filteredLayer"in g&&i(0,b=g.filteredLayer),"highlightedLayer"in g&&f(i(1,L=g.highlightedLayer)),"zoomlevel"in g&&a(i(2,V=g.zoomlevel))},[b,L,V,t,o,r,u,S,U,E,C,H,m,p]}class Je extends oe{constructor(e){super(),re(this,e,Ce,qe,fe,{state:12,filteredLayer:0,highlightedLayer:1,zoomlevel:2})}}export{Je as F};
//# sourceMappingURL=Filterview-5408ebf5.js.map
