{"version":3,"file":"theme-142feda3.js","sources":["../../src/UI/RemoveOtherLanguages.ts","../../src/Models/ThemeConfig/Conversion/LegacyJsonConvert.ts","../../src/Models/ThemeConfig/Conversion/ValidateThemeAndLayers.ts","../../src/Logic/DetermineTheme.ts","../../src/index.ts"],"sourcesContent":["export {}\nlet lang = (\n    (navigator.languages && navigator.languages[0]) ||\n    navigator.language ||\n    navigator[\"userLanguage\"] ||\n    \"en\"\n).substr(0, 2)\n\nfunction filterLangs(maindiv) {\n    let foundLangs = 0\n    for (const child of Array.from(maindiv.children)) {\n        if (child.attributes.getNamedItem(\"lang\")?.value === lang) {\n            foundLangs++\n        }\n    }\n    if (foundLangs === 0) {\n        lang = \"en\"\n    }\n    for (const child of Array.from(maindiv.children)) {\n        const childLang = child.attributes.getNamedItem(\"lang\")\n        if (childLang === undefined) {\n            continue\n        }\n        if (childLang.value === lang) {\n            child.style.display = \"\"\n            continue\n        }\n        child.parentElement.removeChild(child)\n    }\n}\n\nfilterLangs(document.getElementById(\"descriptions-while-loading\"))\nfilterLangs(document.getElementById(\"default-title\"))\n","import { ThemeConfigJson } from \"../Json/ThemeConfigJson\"\nimport { Utils } from \"../../../Utils\"\nimport LineRenderingConfigJson from \"../Json/LineRenderingConfigJson\"\nimport { LayerConfigJson } from \"../Json/LayerConfigJson\"\nimport { DesugaringStep, Each, Fuse, On } from \"./Conversion\"\nimport PointRenderingConfigJson from \"../Json/PointRenderingConfigJson\"\nimport { ConversionContext } from \"./ConversionContext\"\n\nexport class UpdateLegacyLayer extends DesugaringStep<\n    LayerConfigJson | string | { builtin; override }\n> {\n    constructor() {\n        super(\n            \"Updates various attributes from the old data format to the new to provide backwards compatibility with the formats\",\n            [\"overpassTags\", \"source.osmtags\", \"tagRenderings[*].id\", \"mapRendering\"],\n            \"UpdateLegacyLayer\"\n        )\n    }\n\n    convert(json: LayerConfigJson, context: ConversionContext): LayerConfigJson {\n        if (typeof json === \"string\" || json[\"builtin\"] !== undefined) {\n            // Reuse of an already existing layer; return as-is\n            return json\n        }\n        context = context.enter(json.id)\n        let config = { ...json }\n\n        if (config[\"credits\"] === \"Not logged in\") {\n            delete config[\"credits\"]\n        }\n\n        if (config[\"overpassTags\"]) {\n            config.source = config.source ?? {\n                osmTags: config[\"overpassTags\"],\n            }\n            config.source[\"osmTags\"] = config[\"overpassTags\"]\n            delete config[\"overpassTags\"]\n        }\n\n        if (config.allowMove?.[\"enableImproveAccuraccy\"]) {\n            // Fix common misspelling: 'accuracy' is often typo'ed as 'accuraCCy'\n            config.allowMove[\"enableImproveAccuracy\"] = config.allowMove[\"enableImproveAccuraccy\"]\n            delete config.allowMove[\"enableImproveAccuraccy\"]\n        }\n\n        for (const preset of config.presets ?? []) {\n            const preciseInput = preset[\"preciseInput\"]\n            if (typeof preciseInput === \"boolean\") {\n                delete preset[\"preciseInput\"]\n            } else if (preciseInput !== undefined) {\n                delete preciseInput[\"preferredBackground\"]\n                preset.snapToLayer = preciseInput.snapToLayer\n                delete preciseInput.snapToLayer\n                if (preciseInput.maxSnapDistance) {\n                    preset.maxSnapDistance = preciseInput.maxSnapDistance\n                    delete preciseInput.maxSnapDistance\n                }\n                if (Object.keys(preciseInput).length == 0) {\n                    delete preset[\"preciseInput\"]\n                }\n            }\n\n            if (typeof preset.snapToLayer === \"string\") {\n                preset.snapToLayer = [preset.snapToLayer]\n            }\n        }\n\n        if (config.tagRenderings !== undefined) {\n            let i = 0\n            for (const tagRendering of config.tagRenderings) {\n                if (!tagRendering) {\n                    continue\n                }\n                i++\n                if (\n                    typeof tagRendering === \"string\" ||\n                    tagRendering[\"builtin\"] !== undefined ||\n                    tagRendering[\"rewrite\"] !== undefined\n                ) {\n                    continue\n                }\n                if (tagRendering[\"id\"] === undefined) {\n                    if (tagRendering[\"#\"] !== undefined) {\n                        tagRendering[\"id\"] = tagRendering[\"#\"]\n                        delete tagRendering[\"#\"]\n                    } else if (tagRendering[\"freeform\"]?.key !== undefined) {\n                        tagRendering[\"id\"] = config.id + \"-\" + tagRendering[\"freeform\"][\"key\"]\n                    } else {\n                        tagRendering[\"id\"] = \"tr-\" + i\n                    }\n                }\n            }\n        }\n\n        if (\n            config[\"mapRendering\"] === undefined &&\n            config.pointRendering === undefined &&\n            config.lineRendering === undefined\n        ) {\n            config[\"mapRendering\"] = []\n            // This is a legacy format, lets create a pointRendering\n            let location: (\"point\" | \"centroid\")[] = [\"point\"]\n            let wayHandling: number = config[\"wayHandling\"] ?? 0\n            if (wayHandling !== 0) {\n                location = [\"point\", \"centroid\"]\n            }\n            if (config[\"icon\"] ?? config[\"label\"] !== undefined) {\n                const pointConfig = {\n                    icon: config[\"icon\"],\n                    iconBadges: config[\"iconOverlays\"],\n                    label: config[\"label\"],\n                    iconSize: config[\"iconSize\"],\n                    location,\n                    rotation: config[\"rotation\"],\n                }\n                config[\"mapRendering\"].push(pointConfig)\n            }\n\n            if (wayHandling !== 1) {\n                const lineRenderConfig = <LineRenderingConfigJson>{\n                    color: config[\"color\"],\n                    width: config[\"width\"],\n                    dashArray: config[\"dashArray\"],\n                }\n                if (Object.keys(lineRenderConfig).length > 0) {\n                    config[\"mapRendering\"].push(lineRenderConfig)\n                }\n            }\n            if (config[\"mapRendering\"].length === 0) {\n                throw (\n                    \"Could not convert the legacy theme into a new theme: no renderings defined for layer \" +\n                    config.id\n                )\n            }\n        }\n\n        delete config[\"color\"]\n        delete config[\"width\"]\n        delete config[\"dashArray\"]\n\n        delete config[\"icon\"]\n        delete config[\"iconOverlays\"]\n        delete config[\"label\"]\n        delete config[\"iconSize\"]\n        delete config[\"rotation\"]\n        delete config[\"wayHandling\"]\n        delete config[\"hideUnderlayingFeaturesMinPercentage\"]\n        const src = config.source\n        if (src) {\n            delete src[\"isOsmCache\"]\n            delete src[\"maxCacheAge\"]\n            delete src[\"widenFactor\"]\n        }\n\n        for (const mapRenderingElement of config[\"mapRendering\"] ?? []) {\n            if (mapRenderingElement[\"iconOverlays\"] !== undefined) {\n                mapRenderingElement[\"iconBadges\"] = mapRenderingElement[\"iconOverlays\"]\n            }\n            for (const overlay of mapRenderingElement[\"iconBadges\"] ?? []) {\n                if (overlay[\"badge\"] !== true) {\n                    context.enters(\"iconBadges\", \"badge\").warn(\"Non-overlay element\")\n                }\n                delete overlay[\"badge\"]\n            }\n        }\n\n        if (config[\"mapRendering\"]) {\n            const pointRenderings: PointRenderingConfigJson[] = []\n            const lineRenderings: LineRenderingConfigJson[] = []\n            for (const mapRenderingElement of config[\"mapRendering\"]) {\n                if (mapRenderingElement[\"location\"]) {\n                    // This is a pointRendering\n                    pointRenderings.push(<any>mapRenderingElement)\n                } else {\n                    lineRenderings.push(<any>mapRenderingElement)\n                }\n            }\n            config[\"pointRendering\"] = pointRenderings\n            config[\"lineRendering\"] = lineRenderings\n            delete config[\"mapRendering\"]\n        }\n\n        for (const rendering of config.pointRendering ?? []) {\n            const pr = rendering\n            if (pr[\"icon\"]) {\n                try {\n                    let iconConfig = pr[\"icon\"]\n                    if (\n                        Object.keys(iconConfig).length === 1 &&\n                        iconConfig[\"render\"] !== undefined\n                    ) {\n                        iconConfig = iconConfig.render\n                    }\n                    const icon = Utils.NoEmpty(iconConfig.split(\";\"))\n                    pr.marker = icon.map((i) => {\n                        if (i.startsWith(\"http\")) {\n                            return { icon: i }\n                        }\n                        const [iconPath, color] = i.split(\":\")\n                        return { icon: iconPath, color }\n                    })\n                    delete pr[\"icon\"]\n                } catch (e) {\n                    console.error(\"Could not handle icon in\", json.id)\n                    pr.marker = [{ icon: pr[\"icon\"] }]\n                    delete pr[\"icon\"]\n                }\n            }\n\n            let iconSize = pr.iconSize\n            if (!iconSize) {\n                continue\n            }\n\n            if (Object.keys(pr.iconSize).length === 1 && pr.iconSize[\"render\"] !== undefined) {\n                iconSize = pr.iconSize[\"render\"]\n            }\n\n            if (typeof iconSize === \"string\")\n                if ([\"bottom\", \"center\", \"top\"].some((a) => (<string>iconSize).endsWith(a))) {\n                    const parts = iconSize.split(\",\").map((parts) => parts.toLowerCase().trim())\n                    pr.anchor = parts.pop()\n                    pr.iconSize = parts.join(\",\")\n                }\n        }\n\n        if (config.pointRendering)\n            for (const rendering of config.pointRendering) {\n                for (const key in rendering) {\n                    if (!rendering[key]) {\n                        continue\n                    }\n                    if (\n                        typeof rendering[key][\"render\"] === \"string\" &&\n                        Object.keys(rendering[key]).length === 1\n                    ) {\n                        rendering[key] = rendering[key][\"render\"]\n                    }\n                }\n            }\n        if (config.lineRendering)\n            for (const rendering of config.lineRendering) {\n                for (const key in rendering) {\n                    if (!rendering[key]) {\n                        continue\n                    }\n                    if (\n                        typeof rendering[key][\"render\"] === \"string\" &&\n                        Object.keys(rendering[key]).length === 1\n                    ) {\n                        rendering[key] = rendering[key][\"render\"]\n                    }\n                }\n            }\n\n        return config\n    }\n}\n\nclass UpdateLegacyTheme extends DesugaringStep<ThemeConfigJson> {\n    constructor() {\n        super(\"Small fixes in the theme config\", [\"roamingRenderings\"], \"UpdateLegacyTheme\")\n    }\n\n    convert(json: ThemeConfigJson, context: ConversionContext): ThemeConfigJson {\n        const oldThemeConfig = { ...json }\n\n        if (oldThemeConfig.socialImage === \"\") {\n            delete oldThemeConfig.socialImage\n        }\n\n        if (typeof oldThemeConfig.credits === \"string\") {\n            oldThemeConfig.credits = [oldThemeConfig.credits]\n        }\n\n        if (oldThemeConfig[\"roamingRenderings\"] !== undefined) {\n            if (oldThemeConfig[\"roamingRenderings\"].length == 0) {\n                delete oldThemeConfig[\"roamingRenderings\"]\n            } else {\n                context.err(\"The theme contains roamingRenderings. These are not supported anymore\")\n                return null\n            }\n        }\n\n        oldThemeConfig.layers = Utils.NoNull(oldThemeConfig.layers)\n        delete oldThemeConfig[\"language\"]\n        delete oldThemeConfig[\"version\"]\n        delete oldThemeConfig[\"clustering\"]\n\n        if (oldThemeConfig.startLat === 0) {\n            delete oldThemeConfig.startLat\n        }\n        if (oldThemeConfig.startLon === 0) {\n            delete oldThemeConfig.startLon\n        }\n        if (oldThemeConfig.startZoom <= 2) {\n            delete oldThemeConfig.startZoom\n        }\n        if (oldThemeConfig[\"maintainer\"] !== undefined) {\n            if (oldThemeConfig.credits === undefined) {\n                oldThemeConfig[\"credits\"] = oldThemeConfig[\"maintainer\"]\n                delete oldThemeConfig[\"maintainer\"]\n            } else if (oldThemeConfig[\"maintainer\"].toLowerCase().trim() === \"mapcomplete\") {\n                delete oldThemeConfig[\"maintainer\"]\n            } else if (oldThemeConfig[\"maintainer\"].toLowerCase().trim() === \"\") {\n                delete oldThemeConfig[\"maintainer\"]\n            }\n        }\n\n        return oldThemeConfig\n    }\n}\n\nexport class FixLegacyTheme extends Fuse<ThemeConfigJson> {\n    constructor() {\n        super(\n            \"Fixes a legacy theme to the modern JSON format geared to humans. Syntactic sugars are kept (i.e. no tagRenderings are expandend, no dependencies are automatically gathered)\",\n            new UpdateLegacyTheme(),\n            new On(\"layers\", new Each(new UpdateLegacyLayer()))\n        )\n    }\n}\n","import { Bypass, Each, Fuse, On } from \"./Conversion\"\nimport { ThemeConfigJson } from \"../Json/ThemeConfigJson\"\nimport Constants from \"../../Constants\"\nimport { DoesImageExist, ValidateLayerConfig } from \"./Validation\"\nimport { ValidateTheme } from \"./ValidateTheme\"\n\nexport class ValidateThemeAndLayers extends Fuse<ThemeConfigJson> {\n    constructor(\n        doesImageExist: DoesImageExist,\n        path: string,\n        isBuiltin: boolean,\n        sharedTagRenderings?: Set<string>\n    ) {\n        super(\n            \"Validates a theme and the contained layers\",\n            new ValidateTheme(doesImageExist, path, isBuiltin, sharedTagRenderings),\n            new On(\n                \"layers\",\n                new Each(\n                    new Bypass(\n                        (layer) => Constants.added_by_default.indexOf(<any>layer.id) < 0,\n                        new ValidateLayerConfig(undefined, isBuiltin, doesImageExist, false, true)\n                    )\n                )\n            )\n        )\n    }\n}\n","import ThemeConfig from \"../Models/ThemeConfig/ThemeConfig\"\nimport { QueryParameters } from \"./Web/QueryParameters\"\nimport { AllKnownLayouts } from \"../Customizations/AllKnownLayouts\"\nimport { FixedUiElement } from \"../UI/Base/FixedUiElement\"\nimport { Utils } from \"../Utils\"\nimport LZString from \"lz-string\"\nimport { FixLegacyTheme } from \"../Models/ThemeConfig/Conversion/LegacyJsonConvert\"\nimport { LayerConfigJson } from \"../Models/ThemeConfig/Json/LayerConfigJson\"\nimport known_layers from \"../assets/generated/known_layers.json\"\nimport { PrepareTheme } from \"../Models/ThemeConfig/Conversion/PrepareTheme\"\nimport licenses from \"../assets/generated/license_info.json\"\nimport TagRenderingConfig from \"../Models/ThemeConfig/TagRenderingConfig\"\nimport { FixImages } from \"../Models/ThemeConfig/Conversion/FixImages\"\nimport questions from \"../assets/generated/layers/questions.json\"\nimport { DoesImageExist, PrevalidateTheme } from \"../Models/ThemeConfig/Conversion/Validation\"\nimport { DesugaringContext } from \"../Models/ThemeConfig/Conversion/Conversion\"\nimport { TagRenderingConfigJson } from \"../Models/ThemeConfig/Json/TagRenderingConfigJson\"\nimport Hash from \"./Web/Hash\"\nimport { QuestionableTagRenderingConfigJson } from \"../Models/ThemeConfig/Json/QuestionableTagRenderingConfigJson\"\nimport { ThemeConfigJson } from \"../Models/ThemeConfig/Json/ThemeConfigJson\"\nimport { ValidateThemeAndLayers } from \"../Models/ThemeConfig/Conversion/ValidateThemeAndLayers\"\n\nexport default class DetermineTheme {\n    private static readonly _knownImages = new Set(Array.from(licenses).map((l) => l.path))\n    private static readonly loadCustomThemeParam = QueryParameters.GetQueryParameter(\n        \"userlayout\",\n        \"false\",\n        \"If the parameter is an URL, it should point to a .json of a theme which will be loaded and used\"\n    )\n\n    public static getCustomDefinition(): string {\n        const layoutFromBase64 = decodeURIComponent(DetermineTheme.loadCustomThemeParam.data)\n\n        if (layoutFromBase64.startsWith(\"http\")) {\n            return layoutFromBase64\n        }\n\n        return undefined\n    }\n\n    private static async expandRemoteLayers(\n        layoutConfig: ThemeConfigJson\n    ): Promise<ThemeConfigJson> {\n        if (!layoutConfig.layers) {\n            // This is probably a layer in 'layer-only-mode'\n            return layoutConfig\n        }\n        for (let i = 0; i < layoutConfig.layers.length; i++) {\n            const l = layoutConfig.layers[i]\n            if (typeof l !== \"string\") {\n                continue\n            }\n            try {\n                new URL(l)\n                console.log(\"Downloading remote layer \" + l)\n                layoutConfig.layers[i] = <LayerConfigJson>await Utils.downloadJson(l)\n            } catch (_) {\n                continue\n            }\n        }\n        return layoutConfig\n    }\n\n    /**\n     * Gets the correct layout for this website\n     */\n    public static async getTheme(): Promise<ThemeConfig | undefined> {\n        const layoutFromBase64 = decodeURIComponent(DetermineTheme.loadCustomThemeParam.data)\n\n        if (layoutFromBase64.startsWith(\"http\")) {\n            return await DetermineTheme.LoadRemoteTheme(layoutFromBase64)\n        }\n\n        let layoutId: string = undefined\n\n        const path = window.location.pathname.split(\"/\").slice(-1)[0]\n        if (path !== \"theme.html\" && path !== \"\") {\n            layoutId = path\n            if (path.endsWith(\".html\")) {\n                layoutId = path.substr(0, path.length - 5)\n            }\n            console.log(\"Using layout\", layoutId)\n        }\n        layoutId = QueryParameters.GetQueryParameter(\n            \"layout\",\n            layoutId,\n            \"The layout to load into MapComplete\"\n        ).data\n        const id = layoutId?.toLowerCase()\n        const layouts = AllKnownLayouts.allKnownLayouts\n        if (layouts.size() == 0) {\n            throw \"Build failed or running, no layouts are known at all\"\n        }\n        if (layouts.getConfig(id) === undefined) {\n            const alternatives = Utils.sortedByLevenshteinDistance(\n                id,\n                Array.from(layouts.keys()),\n                (i) => i\n            ).slice(0, 3)\n            const msg = `No builtin map theme with name ${layoutId} exists. Perhaps you meant one of ${alternatives.join(\n                \", \"\n            )}`\n            throw msg\n        }\n        return layouts.get(id)\n    }\n\n    private static getSharedTagRenderings(): Map<string, QuestionableTagRenderingConfigJson> {\n        const dict = new Map<string, QuestionableTagRenderingConfigJson>()\n\n        for (const tagRendering of questions.tagRenderings) {\n            dict.set(tagRendering.id, <QuestionableTagRenderingConfigJson>tagRendering)\n        }\n\n        return dict\n    }\n\n    private static getSharedTagRenderingOrder(): string[] {\n        return questions.tagRenderings.map((tr) => tr.id)\n    }\n\n    private static prepCustomTheme(json: any, sourceUrl?: string, forceId?: string): ThemeConfig {\n        if (json.layers === undefined && json.tagRenderings !== undefined) {\n            // We got fed a layer instead of a theme\n            const layerConfig = <LayerConfigJson>json\n            let icon = Utils.NoNull(\n                layerConfig.pointRendering\n                    .flatMap((pr) => pr.marker)\n                    .map((iconSpec) => {\n                        if (!iconSpec) {\n                            return undefined\n                        }\n                        const icon = new TagRenderingConfig(<TagRenderingConfigJson>iconSpec.icon)\n                            .render.txt\n                        if (\n                            iconSpec.color === undefined ||\n                            icon.startsWith(\"http:\") ||\n                            icon.startsWith(\"https:\")\n                        ) {\n                            return icon\n                        }\n                        const color = new TagRenderingConfig(<TagRenderingConfigJson>iconSpec.color)\n                            .render.txt\n                        return icon + \":\" + color\n                    })\n            ).join(\";\")\n\n            if (!icon) {\n                icon = \"./assets/svg/bug.svg\"\n            }\n\n            json = {\n                id: json.id,\n                description: json.description,\n                descriptionTail: {\n                    en: \"<div class='alert'>Layer only mode.</div> The loaded custom theme actually isn't a custom theme, but only contains a layer.\",\n                },\n                icon,\n                title: json.name,\n                layers: [json],\n            }\n        }\n\n        const knownLayersDict = new Map<string, LayerConfigJson>()\n        for (const key in known_layers[\"layers\"]) {\n            const layer = known_layers[\"layers\"][key]\n            knownLayersDict.set(layer.id, <LayerConfigJson>layer)\n        }\n        const convertState: DesugaringContext = {\n            tagRenderings: DetermineTheme.getSharedTagRenderings(),\n            tagRenderingOrder: DetermineTheme.getSharedTagRenderingOrder(),\n            sharedLayers: knownLayersDict,\n            publicLayers: new Set<string>(),\n        }\n        json = new FixLegacyTheme().convertStrict(json)\n        const raw = json\n\n        json = new FixImages(DetermineTheme._knownImages).convertStrict(json)\n        json.enableNoteImports = json.enableNoteImports ?? false\n        json = new PrepareTheme(convertState).convertStrict(json)\n        console.log(\"The layoutconfig is \", json)\n\n        json.id = forceId ?? json.id\n\n        {\n            new PrevalidateTheme().convertStrict(json)\n        }\n        {\n            new ValidateThemeAndLayers(\n                new DoesImageExist(new Set<string>(), () => true),\n                \"\",\n                false\n            ).convertStrict(json)\n        }\n        return new ThemeConfig(json, false, {\n            definitionRaw: JSON.stringify(raw, null, \"  \"),\n            definedAtUrl: sourceUrl,\n        })\n    }\n\n    private static async LoadRemoteTheme(link: string): Promise<ThemeConfig | null> {\n        console.log(\"Downloading map theme from \", link)\n\n        new FixedUiElement(`Downloading the theme from the <a href=\"${link}\">link</a>...`).AttachTo(\n            \"maindiv\"\n        )\n\n        let parsed = <ThemeConfigJson>await Utils.downloadJson(link)\n        let forcedId = parsed.id\n        const url = new URL(link)\n        if (!(url.hostname === \"localhost\" || url.hostname === \"127.0.0.1\")) {\n            forcedId = link\n        }\n        console.log(\"Loaded remote link:\", link)\n        parsed = await this.expandRemoteLayers(parsed)\n        return DetermineTheme.prepCustomTheme(parsed, link, forcedId)\n    }\n}\n","import DetermineTheme from \"./Logic/DetermineTheme\"\nimport ThemeViewState from \"./Models/ThemeViewState\"\nimport SvelteUIElement from \"./UI/Base/SvelteUIElement\"\nimport ThemeViewGUI from \"./UI/ThemeViewGUI.svelte\"\nimport { FixedUiElement } from \"./UI/Base/FixedUiElement\"\nimport Combine from \"./UI/Base/Combine\"\nimport { SubtleButton } from \"./UI/Base/SubtleButton\"\nimport { Utils } from \"./Utils\"\nimport Constants from \"./Models/Constants\"\nimport ArrowDownTray from \"@babeard/svelte-heroicons/mini/ArrowDownTray\"\n\nfunction webgl_support() {\n    try {\n        const canvas = document.createElement(\"canvas\")\n        return (\n            !!window.WebGLRenderingContext &&\n            (canvas.getContext(\"webgl\") || canvas.getContext(\"experimental-webgl\"))\n        )\n    } catch (e) {\n        return false\n    }\n}\n\nasync function timeout(timeMS: number): Promise<{ layers: string[] }> {\n    await Utils.waitFor(timeMS)\n    return { layers: [] }\n}\n\nasync function getAvailableLayers(): Promise<Set<string>> {\n    if (!Constants.SummaryServer) {\n        return new Set<string>()\n    }\n    try {\n        const host = new URL(Constants.SummaryServer).host\n        const status: { layers: string[] } = await Promise.any([\n            Utils.downloadJson<{ layers }>(\"https://\" + host + \"/summary/status.json\"),\n            timeout(2500),\n        ])\n        return new Set<string>(status.layers)\n    } catch (e) {\n        console.error(\"Could not get MVT available layers due to\", e)\n        return new Set<string>()\n    }\n}\n\nasync function main() {\n    try {\n        if (!webgl_support()) {\n            throw \"WebGL is not supported or not enabled. This is essential for MapComplete to function, please enable this.\"\n        }\n        const [theme, availableLayers] = await Promise.all([\n            DetermineTheme.getTheme(),\n            await getAvailableLayers(),\n        ])\n        availableLayers?.delete(\"cycle_highways\") // TODO remove after next cache.mapcomplete.org update\n        console.log(\"The available layers on server are\", Array.from(availableLayers))\n        const state = new ThemeViewState(theme, availableLayers)\n        const target = document.getElementById(\"maindiv\")\n        const childs = Array.from(target.children)\n        new ThemeViewGUI({\n            target,\n            props: { state },\n        })\n        childs.forEach((ch) => target.removeChild(ch))\n        Array.from(document.getElementsByClassName(\"delete-on-load\")).forEach((el) => {\n            el.parentElement.removeChild(el)\n        })\n    } catch (err) {\n        console.error(\"Error while initializing: \", err, err.stack)\n        const customDefinition = DetermineTheme.getCustomDefinition()\n        new Combine([\n            new FixedUiElement(err.toString().split(\"\\n\").join(\"<br/>\")).SetClass(\"block alert\"),\n\n            customDefinition?.length > 0\n                ? new SubtleButton(\n                      new SvelteUIElement(ArrowDownTray),\n                      \"Download the raw file\"\n                  ).onClick(() =>\n                      Utils.offerContentsAsDownloadableFile(\n                          DetermineTheme.getCustomDefinition(),\n                          \"mapcomplete-theme.json\",\n                          { mimetype: \"application/json\" }\n                      )\n                  )\n                : undefined,\n        ]).AttachTo(\"maindiv\")\n    }\n}\n\nmain().then((_) => {})\n"],"names":["lang","filterLangs","maindiv","foundLangs","child","_a","childLang","UpdateLegacyLayer","DesugaringStep","json","context","config","preset","preciseInput","i","tagRendering","_b","location","wayHandling","pointConfig","lineRenderConfig","src","mapRenderingElement","overlay","pointRenderings","lineRenderings","rendering","pr","iconConfig","icon","Utils","iconPath","color","iconSize","a","parts","key","UpdateLegacyTheme","oldThemeConfig","FixLegacyTheme","Fuse","On","Each","ValidateThemeAndLayers","doesImageExist","path","isBuiltin","sharedTagRenderings","ValidateTheme","Bypass","layer","Constants","ValidateLayerConfig","_DetermineTheme","layoutFromBase64","layoutConfig","l","layoutId","QueryParameters","id","layouts","AllKnownLayouts","alternatives","dict","questions","tr","sourceUrl","forceId","layerConfig","iconSpec","TagRenderingConfig","knownLayersDict","known_layers","convertState","raw","FixImages","PrepareTheme","PrevalidateTheme","DoesImageExist","ThemeConfig","link","FixedUiElement","parsed","forcedId","url","__publicField","licenses","DetermineTheme","webgl_support","canvas","timeout","timeMS","getAvailableLayers","host","status","e","main","theme","availableLayers","state","ThemeViewState","target","childs","ThemeViewGUI","ch","el","err","customDefinition","Combine","SubtleButton","SvelteUIElement","ArrowDownTray","_"],"mappings":"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"}